    @import url('https://fonts.googleapis.com/css2?family=Caveat:wght@400;600;700&family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&family=Noto+Sans+JP:wght@300;400;500;600&family=Noto+Serif+JP:wght@400;500&family=Cinzel:wght@400;700&family=Space+Mono:ital,wght@0,400;0,700;1,400&family=Playfair+Display:ital,wght@0,400;1,400&display=swap');

    :root {
      /* Viewport sizing (Android/iOS full-height without vh bugs) */
      --app-height: 100vh;
      --app-width: 100vw;

      /* ğŸ”¥ é¡¶æ å…¨å±€Paddingç®¡ç†ç³»ç»Ÿ */
      --custom-top-offset: 0px; /* ç”¨æˆ·è‡ªå®šä¹‰åç§»é‡ï¼ˆé€šè¿‡è®¾ç½®è°ƒæ•´ï¼‰ */
      --base-top-padding: 12px; /* åŸºç¡€é¡¶éƒ¨padding */
      --safe-area-top: env(safe-area-inset-top, 0px); /* å®‰å…¨åŒºåŸŸï¼ˆåˆ˜æµ·å±ï¼‰ */
      --total-top-padding: calc(var(--base-top-padding) + var(--safe-area-top) + var(--custom-top-offset)); /* æ€»padding */

      /* App Headerä¸“ç”¨ï¼ˆé€šå¸¸æ›´å¤§ï¼‰ */
      --app-header-base-padding: 40px; /* App HeaderåŸºç¡€padding */
      --app-header-total-padding: calc(var(--app-header-base-padding) + var(--safe-area-top) + var(--custom-top-offset)); /* App Headeræ€»padding */

      /* Light Mode Colors - æ¸©åº¦æ¨¡å—æ¸…çˆ½é…è‰² */
      --bg-primary: #ffffff;
      --bg-secondary: #fafafa;
      --bg-tertiary: #f5f5f5;
      --text-primary: #000000;
      --text-secondary: #666666;
      --text-tertiary: #888888;
      --border-color: #e0e0e0;
      --post-separator: #00000008;
      --progress-bg: rgba(0, 0, 0, 0.1);
      --progress-fill: rgba(0, 0, 0, 0.8);
      --accent-color: #000000;
      --hover-bg: #fafafa;
      --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.04);
      --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
      --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);
      --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.15);

      /* æ‰‹æœºé¢œè‰²ä¸“ç”¨å˜é‡ - ä¼˜å…ˆçº§é«˜äºä¸»é¢˜ç³»ç»Ÿ */
      --phone-frame-color: #1a1a1a;
      --phone-notch-color: #0a0a0a;
      --phone-island-color: #1a1a1a;
      --home-app-label-color: var(--text-secondary);

      /* æ—¥è®°æœ¬å˜é‡ - Light Mode */
      --diary-cover: #f0ede8;
      --diary-cover-accent: rgba(0,0,0,0.06);
      --diary-cover-text: #2a2a2a;
      --diary-cover-text-sub: rgba(0,0,0,0.45);
      --diary-cover-border: rgba(0,0,0,0.08);
      --diary-cover-star: rgba(0,0,0,0.15);
      --diary-spine: linear-gradient(90deg, rgba(0,0,0,0.12) 0%, rgba(0,0,0,0.04) 50%, rgba(255,255,255,0.2) 100%);
      --diary-spine-inner: linear-gradient(90deg, rgba(0,0,0,0.06) 0%, transparent 50%, rgba(255,255,255,0.08) 100%);
      --diary-page: #fdfcfa;
      --diary-line: rgba(0,0,0,0.05);
      --diary-text: #2a2a2a;
      --diary-text-light: #666666;
      --diary-ink-1: #000000;
      --diary-ink-2: #4a4a4a;
      --diary-ink-3: #7a7a7a;
      --sticky-bg-1: rgba(255,250,205,0.92);
      --sticky-border-1: #d4b800;
      --sticky-bg-2: rgba(255,228,235,0.92);
      --sticky-border-2: #c44569;
      --sticky-bg-3: rgba(230,240,255,0.92);
      --sticky-border-3: #5588cc;

      /* SMS Detail çŸ­ä¿¡è¯¦æƒ…é¡µå˜é‡ - Light Mode */
      --sms-bg: #e5e5e5;
      --sms-bg-pattern: linear-gradient(180deg, #ededed 0%, #e0e0e0 100%);
      --sms-header-bg: linear-gradient(180deg, #f8f8f8 0%, #e8e8e8 100%);
      --sms-header-border: #b8b8b8;
      --sms-header-text: #1a1a1a;
      --sms-input-bg: #ffffff;
      --sms-input-border: #c0c0c0;
      --sms-send-bg: linear-gradient(180deg, #f0f0f0 0%, #d8d8d8 100%);
      --sms-send-text: #1a1a1a;
      --sms-bubble-user: linear-gradient(180deg, #1a1a1a 0%, #0a0a0a 100%);
      --sms-bubble-user-text: #ffffff;
      --sms-bubble-other: linear-gradient(180deg, #ffffff 0%, #f5f5f5 100%);
      --sms-bubble-other-text: #1a1a1a;
      --sms-bubble-shadow: 0 1px 2px rgba(0,0,0,0.15);
      --sms-time-text: #666666;
      --sms-date-bg: rgba(0,0,0,0.06);
      --sms-date-text: #555555;
      --sms-typing-dot: #888888;
    }

    @supports (height: 100svh) {
      :root { --app-height: 100svh; }
    }

    @supports (height: 100dvh) {
      :root { --app-height: 100dvh; }
    }

    [data-theme='dark'] {
      /* Dark Mode Colors - æ¸©åº¦æ¨¡å—æ¸…çˆ½é…è‰² */
      --bg-primary: #0a0a0a;
      --bg-secondary: #0f0f0f;
      --bg-tertiary: #141414;
      --text-primary: #ffffff;
      --text-secondary: #888888;
      --text-tertiary: #666666;
      --border-color: #2a2a2a;
      --post-separator: #262626;
      --progress-bg: rgba(255, 255, 255, 0.15);
      --progress-fill: rgba(255, 255, 255, 0.9);
      --accent-color: #ffffff;
      --hover-bg: #141414;
      --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
      --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.5);
      --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.7);
      --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.9);

      /* æ—¥è®°æœ¬å˜é‡ - Dark Mode */
      --diary-cover: #141414;
      --diary-cover-accent: rgba(255,255,255,0.04);
      --diary-cover-text: #e0e0e0;
      --diary-cover-text-sub: rgba(255,255,255,0.4);
      --diary-cover-border: rgba(255,255,255,0.08);
      --diary-cover-star: rgba(255,255,255,0.2);
      --diary-spine: linear-gradient(90deg, rgba(0,0,0,0.5) 0%, rgba(0,0,0,0.15) 50%, rgba(255,255,255,0.03) 100%);
      --diary-spine-inner: linear-gradient(90deg, rgba(0,0,0,0.25) 0%, transparent 50%, rgba(255,255,255,0.02) 100%);
      --diary-page: #1a1a1a;
      --diary-line: rgba(255,255,255,0.04);
      --diary-text: #d0d0d0;
      --diary-text-light: #808080;
      --diary-ink-1: #e0e0e0;
      --diary-ink-2: #888888;
      --diary-ink-3: #707070;
      --sticky-bg-1: rgba(80,75,40,0.92);
      --sticky-border-1: #8a7800;
      --sticky-bg-2: rgba(80,50,60,0.92);
      --sticky-border-2: #8a3550;
      --sticky-bg-3: rgba(45,55,75,0.92);
      --sticky-border-3: #3568aa;

      /* SMS Detail çŸ­ä¿¡è¯¦æƒ…é¡µå˜é‡ - Dark Mode */
      --sms-bg: #0a0a0a;
      --sms-bg-pattern: linear-gradient(180deg, #0f0f0f 0%, #0a0a0a 100%);
      --sms-header-bg: linear-gradient(180deg, #1a1a1a 0%, #141414 100%);
      --sms-header-border: #2a2a2a;
      --sms-header-text: #ffffff;
      --sms-input-bg: #1a1a1a;
      --sms-input-border: #333333;
      --sms-send-bg: linear-gradient(180deg, #2a2a2a 0%, #1a1a1a 100%);
      --sms-send-text: #ffffff;
      --sms-bubble-user: linear-gradient(180deg, #ffffff 0%, #e8e8e8 100%);
      --sms-bubble-user-text: #0a0a0a;
      --sms-bubble-other: linear-gradient(180deg, #2a2a2a 0%, #1f1f1f 100%);
      --sms-bubble-other-text: #e0e0e0;
      --sms-bubble-shadow: 0 1px 3px rgba(0,0,0,0.5);
      --sms-time-text: #666666;
      --sms-date-bg: rgba(255,255,255,0.06);
      --sms-date-text: #888888;
      --sms-typing-dot: #666666;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    /* é˜²æ­¢é¡µé¢æ»šåŠ¨æ¡å‡ºç°å¯¼è‡´åç§» */
    html {
      overflow: hidden;
      height: 100%;
      -webkit-text-size-adjust: 100%;
      text-size-adjust: 100%;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-secondary);
      color: var(--text-primary);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 0;
      margin: 0;
      overflow: hidden;
      transition: background 0.3s ease, color 0.3s ease;
    }

    button,
    input,
    textarea,
    select {
      font-family: inherit;
    }

    /* Phone Container - å…¨å±è®¾è®¡ */
    .phone-container {
      width: 100%; /* ä¿®å¤ï¼šä½¿ç”¨ 100% è€Œé 100vwï¼Œé¿å…æ»šåŠ¨æ¡å®½åº¦å¯¼è‡´é¡µé¢åç§» */
      height: 100vh;
      max-width: 430px;
      max-height: 932px;
      background: var(--phone-frame-color);
      position: relative;
      overflow: hidden;
      box-shadow: var(--shadow-xl);
    }

    /* æ‰‹æœºè¾¹æ¡†æ•ˆæœ - å·²ç§»é™¤å¤šä½™çš„borderç»†çº¿ */
    .phone-frame {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      /* è¿™æ¡1pxçš„borderçœ‹ç€å¾ˆçªå…€ï¼Œè·Ÿæ‰‹æœºæ¡†ä¸æ˜¯ä¸€ä½“çš„ï¼Œå·²åˆ é™¤ */
      pointer-events: none;
      z-index: 9999;
    }

    /* åˆ˜æµ·å±è®¾è®¡ - å¤‡ä»½ç‰ˆæœ¬ç®€å•æ–¹å¼ */
    .notch {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 160px;
      height: 32px;
      background: var(--phone-notch-color);
      border-bottom-left-radius: 20px;
      border-bottom-right-radius: 20px;
      z-index: 10000;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 0 20px;
    }

    .notch::before {
      content: '';
      width: 12px;
      height: 12px;
      background: var(--bg-tertiary);
      border-radius: 50%;
      border: 1px solid var(--border-color);
    }

    .notch::after {
      content: '';
      width: 80px;
      height: 6px;
      background: var(--bg-tertiary);
      border-radius: 3px;
      border: 1px solid var(--border-color);
    }

    /* Screen Content */
    .screen {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: var(--bg-primary);
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      z-index: 10;
    }

    /* Boot Animation */
    .boot-screen {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      width: 100%;
      height: 100%;
      background: var(--bg-primary);
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      z-index: 9000;
      opacity: 1;
      transition: opacity 0.5s ease;
    }

    .boot-screen.hidden {
      opacity: 0;
      pointer-events: none;
    }

    /* é»˜è®¤å¼€æœºåŠ¨ç”» - ä¸‰ç‚¹åŠ è½½æ ·å¼ */
    .boot-dots {
      display: flex;
      gap: 6px;
      justify-content: center;
      margin-bottom: 12px;
    }

    .boot-dot {
      width: 6px;
      height: 6px;
      background: var(--text-primary);
      border-radius: 50%;
      animation: bootDotPulse 1.4s ease-in-out infinite;
      box-shadow: 0 0 8px rgba(0, 0, 0, 0.3);
    }

    @media (prefers-color-scheme: dark) {
      .boot-dot {
        box-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
      }
    }

    .boot-dot:nth-child(1) {
      animation-delay: 0s;
    }

    .boot-dot:nth-child(2) {
      animation-delay: 0.2s;
    }

    .boot-dot:nth-child(3) {
      animation-delay: 0.4s;
    }

    @keyframes bootDotPulse {
      0%, 80%, 100% {
        transform: scale(0.5);
        opacity: 0.3;
      }
      40% {
        transform: scale(1.2);
        opacity: 1;
      }
    }

    .boot-text {
      font-size: 11px;
      font-weight: 500;
      color: var(--text-primary);
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      letter-spacing: 0.15em;
      animation: bootTextFade 2s ease-in-out infinite;
      font-family: 'JetBrains Mono', monospace;
    }

    @media (prefers-color-scheme: dark) {
      .boot-text {
        text-shadow: 0 2px 8px rgba(255, 255, 255, 0.2);
      }
    }

    @keyframes bootTextFade {
      0%, 100% {
        opacity: 0.4;
      }
      50% {
        opacity: 1;
      }
    }

    /* å¼€æœºåŠ¨ç”»å®¹å™¨æ§åˆ¶ */
    .boot-anim {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .boot-anim.active {
      display: flex;
    }

    /* Defaultå¼€æœºåŠ¨ç”»æ ·å¼ - æ— èƒŒæ™¯ï¼Œä½¿ç”¨boot-screençš„å£çº¸ */
    .boot-anim-default {
      /* é€æ˜èƒŒæ™¯ï¼Œæ˜¾ç¤ºå£çº¸ */
    }

    /* Blogå¼€æœºåŠ¨ç”»æ ·å¼ - æ— èƒŒæ™¯ï¼Œä½¿ç”¨boot-screençš„å£çº¸ */
    .boot-anim-blog {
      /* é€æ˜èƒŒæ™¯ï¼Œæ˜¾ç¤ºå£çº¸ */
      position: relative;
      overflow: hidden;
    }

    .boot-blog-container {
      width: 75%;
      max-width: 300px;
      background: white;
      border-radius: 20px 4px 20px 4px;
      padding: 24px 18px;
      box-shadow: 0 15px 50px rgba(0,0,0,0.15);
      position: relative;
      animation: blogCardIn 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @media (prefers-color-scheme: dark) {
      .boot-blog-container {
        background: #141414;
        box-shadow: 0 20px 60px rgba(0,0,0,0.6);
      }
    }

    @keyframes blogCardIn {
      from {
        opacity: 0;
        transform: translateY(20px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .boot-blog-date {
      font-size: 10px;
      color: #999;
      letter-spacing: 0.5px;
      margin-bottom: 12px;
      font-family: 'Courier New', monospace;
      animation: fadeInUp 0.6s 0.3s both;
    }

    .boot-blog-title {
      font-size: 19px;
      font-weight: 600;
      color: #000000;
      margin-bottom: 10px;
      font-family: Georgia, serif;
      line-height: 1.3;
      animation: typewriter 1.2s 0.5s steps(20) both;
      overflow: hidden;
      white-space: nowrap;
      border-right: 2px solid #000000;
    }

    @media (prefers-color-scheme: dark) {
      .boot-blog-title {
        color: #e5e5e5;
        border-right-color: #e5e5e5;
      }
    }

    @keyframes typewriter {
      from {
        width: 0;
      }
      to {
        width: 100%;
      }
    }

    .boot-blog-tags {
      display: flex;
      gap: 6px;
      margin-bottom: 14px;
      animation: fadeInUp 0.6s 0.8s both;
    }

    .boot-blog-tag {
      padding: 3px 10px;
      background: #f0f0f0;
      border-radius: 10px 2px 10px 2px;
      font-size: 9px;
      color: #666;
      letter-spacing: 0.3px;
    }

    @media (prefers-color-scheme: dark) {
      .boot-blog-tag {
        background: #2a2a2a;
        color: #999;
      }
    }

    .boot-blog-loading {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 10px;
      color: #999;
      animation: fadeInUp 0.6s 1s both;
    }

    .boot-blog-dots {
      display: flex;
      gap: 3px;
    }

    .boot-blog-dot {
      width: 3px;
      height: 3px;
      background: #999;
      border-radius: 50%;
      animation: dotPulse 1.4s infinite;
    }

    .boot-blog-dot:nth-child(2) {
      animation-delay: 0.2s;
    }

    .boot-blog-dot:nth-child(3) {
      animation-delay: 0.4s;
    }

    @keyframes dotPulse {
      0%, 100% {
        opacity: 0.3;
        transform: scale(0.8);
      }
      50% {
        opacity: 1;
        transform: scale(1.2);
      }
    }

    .boot-blog-stars {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    .boot-blog-star {
      position: absolute;
      width: 5px;
      height: 5px;
      background: rgba(0, 0, 0, 0.08);
      clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
      animation: starFloat 3s infinite;
    }

    @media (prefers-color-scheme: dark) {
      .boot-blog-star {
        background: rgba(255, 255, 255, 0.08);
      }
    }

    .boot-blog-star:nth-child(1) {
      top: 10%;
      left: 15%;
      animation-delay: 0s;
      animation-duration: 2.5s;
    }

    .boot-blog-star:nth-child(2) {
      top: 20%;
      right: 10%;
      animation-delay: 0.5s;
      animation-duration: 3s;
    }

    .boot-blog-star:nth-child(3) {
      bottom: 15%;
      left: 10%;
      animation-delay: 1s;
      animation-duration: 2.8s;
    }

    .boot-blog-star:nth-child(4) {
      bottom: 25%;
      right: 20%;
      animation-delay: 1.5s;
      animation-duration: 3.2s;
    }

    @keyframes starFloat {
      0%, 100% {
        transform: translateY(0) rotate(0deg);
        opacity: 0.3;
      }
      50% {
        transform: translateY(-10px) rotate(180deg);
        opacity: 0.8;
      }
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Ringå¼€æœºåŠ¨ç”»æ ·å¼ - æ— èƒŒæ™¯ï¼Œä½¿ç”¨boot-screençš„å£çº¸ */
    .boot-anim-ring {
      /* é€æ˜èƒŒæ™¯ï¼Œæ˜¾ç¤ºå£çº¸ */
    }

    .boot-ring-wrapper {
      position: relative;
      width: 140px;
      height: 140px;
      animation: fadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: scale(0.9);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .boot-ring-circle {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 2px solid rgba(0, 0, 0, 0.08);
      border-radius: 50%;
    }

    @media (prefers-color-scheme: dark) {
      .boot-ring-circle {
        border-color: rgba(255, 255, 255, 0.08);
      }
    }

    .boot-ring-progress {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 2px solid var(--text-primary);
      border-radius: 50%;
      border-right-color: transparent;
      border-bottom-color: transparent;
      animation: ringRotate 1.5s cubic-bezier(0.4, 0, 0.2, 1) infinite;
    }

    @keyframes ringRotate {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }

    .boot-ring-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
    }

    .boot-ring-text {
      font-size: 12px;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 6px;
      letter-spacing: 1px;
      animation: fadeInUp 0.6s 0.3s both;
    }

    .boot-ring-subtext {
      font-size: 10px;
      color: var(--text-secondary);
      font-family: 'Courier New', monospace;
      animation: fadeInUp 0.6s 0.5s both;
    }

    .boot-ring-dots-outer {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 110px;
      height: 110px;
      margin-left: -55px;
      margin-top: -55px;
    }

    .boot-ring-dot {
      position: absolute;
      width: 3px;
      height: 3px;
      background: var(--text-secondary);
      border-radius: 50%;
      top: 50%;
      left: 50%;
      margin-left: -1.5px;
      margin-top: -1.5px;
    }

    .boot-ring-dot:nth-child(1) {
      transform: rotate(0deg) translateX(55px);
      animation: dotFade 2s 0s infinite;
    }

    .boot-ring-dot:nth-child(2) {
      transform: rotate(60deg) translateX(55px);
      animation: dotFade 2s 0.2s infinite;
    }

    .boot-ring-dot:nth-child(3) {
      transform: rotate(120deg) translateX(55px);
      animation: dotFade 2s 0.4s infinite;
    }

    .boot-ring-dot:nth-child(4) {
      transform: rotate(180deg) translateX(55px);
      animation: dotFade 2s 0.6s infinite;
    }

    .boot-ring-dot:nth-child(5) {
      transform: rotate(240deg) translateX(55px);
      animation: dotFade 2s 0.8s infinite;
    }

    .boot-ring-dot:nth-child(6) {
      transform: rotate(300deg) translateX(55px);
      animation: dotFade 2s 1s infinite;
    }

    @keyframes dotFade {
      0%, 100% {
        opacity: 0.2;
        transform: rotate(var(--rotate, 0deg)) translateX(55px) scale(0.8);
      }
      50% {
        opacity: 1;
        transform: rotate(var(--rotate, 0deg)) translateX(55px) scale(1.2);
      }
    }

    /* Pulseå¼€æœºåŠ¨ç”»æ ·å¼ - æ— èƒŒæ™¯ï¼Œä½¿ç”¨boot-screençš„å£çº¸ */
    .boot-anim-pulse {
      /* é€æ˜èƒŒæ™¯ï¼Œæ˜¾ç¤ºå£çº¸ */
    }

    .boot-pulse-container {
      position: relative;
      width: 150px;
      height: 150px;
    }

    .boot-pulse-square {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 60px;
      height: 60px;
      margin-left: -30px;
      margin-top: -30px;
      border: 2px solid var(--text-primary);
      border-radius: 12px 2px 12px 2px;
      animation: squarePulse 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;
    }

    @keyframes squarePulse {
      0%, 100% {
        transform: scale(1) rotate(0deg);
        opacity: 1;
      }
      50% {
        transform: scale(1.3) rotate(90deg);
        opacity: 0.6;
      }
    }

    .boot-pulse-square-2 {
      animation-delay: 0.3s;
      width: 44px;
      height: 44px;
      margin-left: -22px;
      margin-top: -22px;
      border-radius: 9px 2px 9px 2px;
    }

    .boot-pulse-square-3 {
      animation-delay: 0.6s;
      width: 28px;
      height: 28px;
      margin-left: -14px;
      margin-top: -14px;
      border-radius: 6px 1px 6px 1px;
    }

    .boot-pulse-text-wrapper {
      position: absolute;
      bottom: -50px;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      width: 150px;
    }

    .boot-pulse-text {
      font-size: 11px;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 6px;
      letter-spacing: 2px;
      animation: fadeInUp 0.6s 0.5s both;
    }

    .boot-pulse-progress {
      width: 100%;
      height: 2px;
      background: rgba(0, 0, 0, 0.08);
      border-radius: 1px;
      overflow: hidden;
      animation: fadeInUp 0.6s 0.7s both;
    }

    @media (prefers-color-scheme: dark) {
      .boot-pulse-progress {
        background: rgba(255, 255, 255, 0.08);
      }
    }

    .boot-pulse-progress-bar {
      height: 100%;
      background: var(--text-primary);
      border-radius: 1px;
      animation: progressGrow 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;
    }

    @keyframes progressGrow {
      0% {
        width: 0%;
      }
      50% {
        width: 70%;
      }
      100% {
        width: 100%;
      }
    }

    .boot-pulse-corners {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 100px;
      height: 100px;
      margin-left: -50px;
      margin-top: -50px;
    }

    .boot-pulse-corner {
      position: absolute;
      width: 10px;
      height: 10px;
      border: 2px solid var(--text-secondary);
    }

    .boot-pulse-corner:nth-child(1) {
      top: 0;
      left: 0;
      border-right: none;
      border-bottom: none;
      border-radius: 4px 0 0 0;
      animation: cornerPulse 2s 0s infinite;
    }

    .boot-pulse-corner:nth-child(2) {
      top: 0;
      right: 0;
      border-left: none;
      border-bottom: none;
      border-radius: 0 4px 0 0;
      animation: cornerPulse 2s 0.5s infinite;
    }

    .boot-pulse-corner:nth-child(3) {
      bottom: 0;
      right: 0;
      border-left: none;
      border-top: none;
      border-radius: 0 0 4px 0;
      animation: cornerPulse 2s 1s infinite;
    }

    .boot-pulse-corner:nth-child(4) {
      bottom: 0;
      left: 0;
      border-right: none;
      border-top: none;
      border-radius: 0 0 0 4px;
      animation: cornerPulse 2s 1.5s infinite;
    }

    @keyframes cornerPulse {
      0%, 100% {
        opacity: 0.3;
      }
      50% {
        opacity: 1;
      }
    }

    /* Home Screen */
    .home-screen {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      overflow: hidden; /* é˜²æ­¢å†…éƒ¨ç»„ä»¶æº¢å‡ºå¯¼è‡´é¡µé¢æ‹‰å®½ */
      opacity: 0;
      animation: fadeIn 0.5s ease 2.2s forwards;
    }

    @keyframes fadeIn {
      to { opacity: 1; }
    }

    /* Status Bar */
    .status-bar {
      /* é«˜åº¦éœ€è¦è€ƒè™‘safe-area */
      height: calc(44px + var(--safe-area-top) + var(--custom-top-offset));
      padding: 0 24px;
      /* ğŸ”¥ ä½¿ç”¨å…¨å±€é¡¶æ paddingå˜é‡ */
      padding-top: var(--total-top-padding);
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      font-weight: 500;
      color: var(--text-primary);
      position: relative;
      z-index: 100;
    }

    .status-left, .status-right {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .status-icon {
      width: 16px;
      height: 16px;
      fill: none;
      stroke: currentColor;
      stroke-width: 2;
    }

    /* Clock Widget - è‡ªé€‚åº”ç½‘æ ¼å¤§å° */
    .clock-widget {
      padding: 0;
      text-align: center;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .clock-time {
      font-size: clamp(36px, 8vw, 64px);
      font-weight: 200;
      letter-spacing: -2px;
      line-height: 1;
      font-family: -apple-system, 'SF Pro Display', 'Helvetica Neue', sans-serif;
    }

    .clock-date {
      font-size: clamp(12px, 3vw, 15px);
      color: var(--text-secondary);
      font-weight: 400;
      margin-top: 4px;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }
      to {
        transform: rotate(360deg);
      }
    }

    /* App Grid - 32ç½‘æ ¼ç³»ç»Ÿï¼ˆ8è¡ŒÃ—4åˆ—ï¼‰*/
    .app-grid {
      flex: 1;
      padding: 20px;
      display: grid;
      /* å…³é”®ä¿®å¤ï¼šå…è®¸ç½‘æ ¼é¡¹åœ¨å°å±ä¸‹æ”¶ç¼©ï¼Œé¿å…è¢«å°ç»„ä»¶/min-content æ’‘åˆ°æ¨ªå‘æº¢å‡ºå¯¼è‡´â€œæ•´ä½“å³ç§»â€ */
      grid-template-columns: repeat(4, minmax(0, 1fr));
      grid-template-rows: repeat(8, auto);
      gap: 16px;
      align-content: start;
      justify-items: center;
      overflow-x: hidden; /* é˜²æ­¢4x2ç»„ä»¶ç­‰æº¢å‡ºå¯¼è‡´é¡µé¢æ‹‰å®½ */
      overflow-y: auto;
      scrollbar-width: none;
      box-sizing: border-box;
      /* é˜²æ­¢åŠ è½½æ—¶é—ªçƒ */
      will-change: contents;
      min-width: 0;
    }

    /* å…³é”®ä¿®å¤ï¼šGrid/Flex å­é¡¹é»˜è®¤ min-width:auto å¯èƒ½å¯¼è‡´æ’‘çˆ†ï¼›ç»Ÿä¸€å…è®¸æ”¶ç¼© */
    .app-grid > * {
      min-width: 0;
      min-height: 0;
    }

    /* ğŸ§­ Desktop Pagerï¼ˆåŒæ¡Œé¢ï¼‰ï¼šé»˜è®¤éšè—ï¼Œæ¨ªå‘æ»‘åŠ¨/åˆ‡æ¢æ—¶çŸ­æš‚å‡ºç°ï¼ˆINS / iOSå°å·§é£æ ¼ï¼‰ */
    #desktopPagerIndicator {
      position: absolute;
      left: 50%;
      bottom: 110px; /* Dockä¸Šæ–¹ */
      z-index: 150;
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(20, 20, 20, 0.22);
      border: 1px solid rgba(255, 255, 255, 0.10);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.24);
      backdrop-filter: blur(14px) saturate(160%);
      -webkit-backdrop-filter: blur(14px) saturate(160%);

      opacity: 0;
      pointer-events: none;
      transform: translateX(-50%);
      transition: opacity 180ms ease;
      user-select: none;
      -webkit-user-select: none;
    }

    #desktopPagerIndicator.visible {
      opacity: 1;
      pointer-events: auto;
      transform: translateX(-50%);
    }

    /* è¦†ç›–é€šç”¨ dot æ ·å¼ï¼šæ›´å°æ›´ iOS */
    #desktopPagerIndicator .tgd-page-dot {
      width: 6px;
      height: 6px;
      opacity: 0.55;
      background: rgba(255, 255, 255, 0.38);
      transition: transform 200ms cubic-bezier(0.2, 0.9, 0.2, 1), opacity 200ms ease, background 200ms ease;
    }

    #desktopPagerIndicator .tgd-page-dot.active {
      opacity: 1;
      background: rgba(255, 255, 255, 0.95);
      transform: scale(1.35);
    }

    .app-grid::-webkit-scrollbar {
      display: none;
    }

    /* Grid Cell - æ¯ä¸ªç½‘æ ¼å•å…ƒï¼ˆæ­£æ–¹å½¢ï¼‰*/
    .grid-cell {
      aspect-ratio: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      min-width: 0;
      width: 100%;
      max-width: 100%;
      transition: background 0.2s ease;
      box-sizing: border-box;
    }

    .app-icon {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 8px;
      cursor: pointer;
      animation: fadeInUp 0.5s ease backwards;
      position: relative;
      user-select: none;
      -webkit-user-select: none;
      touch-action: none;
      transition: transform 0.2s ease, opacity 0.2s ease;
      width: 100%;
      max-width: 100%;
      min-width: 0;
      box-sizing: border-box;
    }

    .app-icon:nth-child(1) { animation-delay: 2.5s; }
    .app-icon:nth-child(2) { animation-delay: 2.6s; }
    .app-icon:nth-child(3) { animation-delay: 2.7s; }
    .app-icon:nth-child(4) { animation-delay: 2.8s; }
    .app-icon:nth-child(5) { animation-delay: 2.9s; }
    .app-icon:nth-child(6) { animation-delay: 3.0s; }
    .app-icon:nth-child(7) { animation-delay: 3.1s; }
    .app-icon:nth-child(8) { animation-delay: 3.2s; }

    /* é¦–æ¬¡å¼€æœºå¯ç”¨å…¥åœºåŠ¨ç”»ï¼›åç»­é‡æ¸²æŸ“/åˆ‡é¡µä¸å†è·‘å»¶è¿ŸåŠ¨ç”»ï¼ˆé¿å…åˆ‡æ¡Œé¢æ—¶â€œæ¶ˆå¤±ç­‰å¾…â€ï¼‰ */
    .app-grid.no-entrance .app-icon {
      animation: none !important;
      animation-delay: 0s !important;
    }

    /* ç¼–è¾‘æ¨¡å¼ */
    .app-grid.edit-mode .app-icon {
      animation: wiggle 0.3s ease-in-out infinite alternate !important;
    }

    /* æŠ–åŠ¨åŠ¨ç”» - iOSé£æ ¼ */
    @keyframes wiggle {
      0% {
        transform: rotate(-1.5deg) translateY(-1px);
      }
      100% {
        transform: rotate(1.5deg) translateY(1px);
      }
    }

    /* æ‹–åŠ¨ä¸­çš„å›¾æ ‡æ ·å¼ */
    .app-icon.dragging {
      opacity: 0.95;
      z-index: 10000;
      pointer-events: none;
      filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.25));
      transition: none;
    }

    /* æ‹–æ‹½æŠ¬èµ·åŠ¨ç”» */
    @keyframes dragLift {
      0% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.12);
      }
      100% {
        transform: scale(1.08);
      }
    }

    /* å ä½ç¬¦æ•ˆæœ */
    .grid-cell.drag-over {
      background: var(--bg-tertiary);
      border-radius: 16px;
      border: 2px dashed var(--accent-color);
      opacity: 0.5;
    }

    /* ç¼–è¾‘æ¨¡å¼æŒ‡ç¤ºå™¨ - å·²è¢«WIDGETSæŒ‰é’®æ›¿ä»£ï¼Œéšè—æ­¤å…ƒç´  */
    .edit-mode-indicator {
      display: none !important;
      position: fixed;
      bottom: 120px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--accent-color);
      color: var(--bg-primary);
      padding: 10px 24px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
      z-index: 10001;
      opacity: 0;
      pointer-events: none;
      transition: all 0.3s ease;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
      font-family: 'Inter', sans-serif;
      backdrop-filter: blur(10px);
    }

    .edit-mode-indicator.active {
      opacity: 1;
      animation: slideUpBounce 0.4s ease;
    }

    /* å®ŒæˆæŒ‰é’® - ç§»åˆ°åº•æ ä¸Šæ–¹å³ä¾§ */
    .edit-done-btn {
      position: fixed;
      bottom: 120px;
      right: 24px;
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
      padding: 10px 20px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      z-index: 10002;
      opacity: 0;
      pointer-events: none;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      font-family: 'Inter', sans-serif;
      backdrop-filter: blur(10px);
    }

    .edit-done-btn.active {
      opacity: 1;
      pointer-events: auto;
      animation: slideUpBounceRight 0.4s ease 0.1s backwards;
    }

    .edit-done-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
      background: var(--accent-color);
      color: var(--bg-primary);
      border-color: var(--accent-color);
    }

    .edit-done-btn:active {
      transform: translateY(0);
    }

    /* å¼¹å‡ºåŠ¨ç”» - ä¿®å¤transformå†²çª */
    @keyframes slideUpBounce {
      0% {
        opacity: 0;
        transform: translateX(-50%) translateY(20px);
      }
      60% {
        transform: translateX(-50%) translateY(-5px);
      }
      100% {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
    }

    /* å®ŒæˆæŒ‰é’®å¼¹å‡ºåŠ¨ç”» */
    @keyframes slideUpBounceRight {
      0% {
        opacity: 0;
        transform: translateY(20px);
      }
      60% {
        transform: translateY(-5px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* ========== ğŸ¨ æ¡Œé¢ç¾åŒ–ç³»ç»Ÿæ ·å¼ - INSé£æ ¼ ========== */

    /* æ·»åŠ ç»„ä»¶æŒ‰é’® - èƒ¶å›Šå¼‚å½¢è®¾è®¡ */
    .add-widget-btn {
      position: fixed;
      bottom: 115px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--text-primary);
      color: var(--bg-primary);
      border: none;
      padding: 10px 18px 10px 12px;
      border-radius: 14px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      z-index: 10002;
      opacity: 0;
      pointer-events: none;
      transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
      font-family: -apple-system, 'SF Pro Display', sans-serif;
      display: flex;
      align-items: center;
      gap: 8px;
      letter-spacing: 0.5px;
    }

    .add-widget-btn-icon {
      width: 26px;
      height: 26px;
      background: var(--bg-primary);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .add-widget-btn-icon svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-primary);
      stroke-width: 1.5;
    }

    .add-widget-btn-text {
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .add-widget-btn-star {
      font-size: 10px;
      opacity: 0.6;
      animation: starFloat 2s ease-in-out infinite;
    }

    @keyframes starFloat {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-2px); }
    }

    .add-widget-btn.active {
      opacity: 1;
      pointer-events: auto;
      animation: buttonPopIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    @keyframes buttonPopIn {
      0% {
        opacity: 0;
        transform: translateX(-50%) translateY(20px) scale(0.8);
      }
      100% {
        opacity: 1;
        transform: translateX(-50%) translateY(0) scale(1);
      }
    }

    .add-widget-btn:hover {
      transform: translateX(-50%) translateY(-2px);
      box-shadow: 0 8px 28px rgba(0, 0, 0, 0.35);
    }

    .add-widget-btn:active {
      transform: translateX(-50%) scale(0.96);
    }

    /* æ¡Œé¢ç»„ä»¶åŸºç¡€æ ·å¼ - ä¸¥æ ¼æŒ‰ç½‘æ ¼å¤§å° */
    .desktop-widget {
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      position: relative;
      width: 100%;
      height: 100%;
      min-width: 0;
      min-height: 0;
      max-width: 100%;
      max-height: 100%;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* éŸ³ä¹æ’­æ”¾å™¨ç»„ä»¶ */
    .desktop-widget.widget-music .ipod-widget {
      width: 100%;
      height: 100%;
    }

    /* Albumç»„ä»¶å…è®¸å”±ç‰‡æº¢å‡º */
    .desktop-widget.widget-album {
      overflow: visible;
    }

    /* ç¼–è¾‘æ¨¡å¼ä¸‹å…è®¸åˆ é™¤æŒ‰é’®æº¢å‡º */
    .app-grid.edit-mode .desktop-widget {
      overflow: visible;
    }

    /* ç»„ä»¶è£…é¥°è§’æ ‡ */
    .desktop-widget::before {
      content: 'âœ¦';
      position: absolute;
      top: 8px;
      right: 10px;
      font-size: 8px;
      color: var(--text-tertiary);
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .desktop-widget:hover::before {
      opacity: 0.5;
    }

    .desktop-widget:hover {
      transform: scale(1.015);
      border-color: var(--text-tertiary);
    }


    /* ç¼–è¾‘æ¨¡å¼ä¸‹ç»„ä»¶æ ·å¼ */
    .app-grid.edit-mode .desktop-widget {
      animation: widgetWiggle 0.35s ease-in-out infinite alternate !important;
    }


    @keyframes widgetWiggle {
      0% { transform: rotate(-0.5deg); }
      100% { transform: rotate(0.5deg); }
    }

    /* ç»„ä»¶å ä½ç¬¦ - é»‘ç™½é£æ ¼ */
    .widget-placeholder {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 8px;
      width: 100%;
      height: 100%;
      padding: 14px;
      text-align: center;
      background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
    }

    .widget-placeholder-icon {
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--text-primary);
      border-radius: 10px;
      opacity: 0.9;
    }

    .widget-placeholder-icon svg {
      width: 20px;
      height: 20px;
      stroke: var(--bg-primary);
      stroke-width: 1.5;
    }

    .widget-placeholder-name {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
      letter-spacing: -0.2px;
    }

    /* ç»„ä»¶é”™è¯¯çŠ¶æ€ */
    .widget-error {
      background: rgba(255, 59, 48, 0.1);
      border: 1px dashed rgba(255, 59, 48, 0.3);
    }

    .widget-error .widget-placeholder-icon svg {
      stroke: #ff3b30;
    }

    .widget-error .widget-placeholder-name {
      color: #ff3b30;
    }

    /* è‡ªå®šä¹‰ç»„ä»¶å†…å®¹å®¹å™¨ */
    .custom-widget-content {
      width: 100%;
      height: 100%;
      overflow: hidden;
      border-radius: 16px;
      position: relative;
    }

    .custom-widget-content * {
      box-sizing: border-box;
    }

    /* è‡ªå®šä¹‰ç»„ä»¶ï¼šå¯ç‚¹å‡»æ¢å›¾ç›®æ ‡ */
    .custom-widget-content .cw-image-target {
      cursor: pointer;
    }

    /* è‡ªå®šä¹‰ç»„ä»¶ï¼šå¯ç‚¹å‡»ç¼–è¾‘æ–‡å­—ç›®æ ‡ */
    .custom-widget-content .cw-text-target {
      cursor: text;
    }

    /* è‡ªå®šä¹‰ç»„ä»¶ç±»å‹æ ‡è¯† */
    .widget-custom {
      background: transparent;
      padding: 0;
      border: none;
    }

    .widget-custom::before {
      display: none;
    }

    /* ========== æ—¶é’Ÿç»„ä»¶ - 2x2å°ºå¯¸ ========== */
    .widget-clock {
      background: transparent;
      border: none;
      aspect-ratio: 1;
    }

    .widget-clock::before {
      display: none;
    }

    .widget-clock .clock-widget {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 0;
    }

    .widget-clock .clock-time {
      font-size: clamp(32px, 8vw, 48px);
      font-weight: 200;
      letter-spacing: -2px;
      font-family: -apple-system, 'SF Pro Display', 'Helvetica Neue', sans-serif;
      color: var(--text-primary);
      line-height: 1;
      margin-bottom: 2px;
    }

    .widget-clock .clock-date {
      font-size: clamp(10px, 2.5vw, 12px);
      color: var(--text-secondary);
      font-weight: 400;
      letter-spacing: 0.3px;
    }

    /* ========== iOSéŸ³ä¹ç»„ä»¶ - 4x2å°ºå¯¸ ========== */
    .widget-music {
      background: transparent !important;
      border: none !important;
      padding: 0 !important;
    }

    .widget-music::before,
    .widget-music::after {
      display: none !important;
    }

    .ios-music-widget {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      padding: 14px;
      gap: 14px;
      background: #404040;
      border-radius: 22px;
      position: relative;
      overflow: hidden;
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', 'Helvetica Neue', sans-serif;
    }

    /* ç£¨ç ‚è´¨æ„Ÿ - å™ªç‚¹å±‚ */
    .ios-music-widget::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
      opacity: 0.04;
      pointer-events: none;
      z-index: 1;
      border-radius: 22px;
    }

    /* å¾®å…‰æ³½å±‚ */
    .ios-music-widget::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0) 50%, rgba(0,0,0,0.05) 100%);
      pointer-events: none;
      z-index: 1;
      border-radius: 22px;
    }

    /* ä¸“è¾‘å°é¢ */
    .ios-music-widget .music-album {
      width: 142px;
      height: 142px;
      flex-shrink: 0;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
      position: relative;
      z-index: 2;
    }

    .ios-music-widget .music-album img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    /* å³ä¾§å†…å®¹ */
    .ios-music-widget .music-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      height: 100%;
      min-width: 0;
      justify-content: space-between;
      padding: 6px 0;
      position: relative;
      z-index: 2;
    }

    /* æ­Œæ›²ä¿¡æ¯ */
    .ios-music-widget .music-info {
      text-align: center;
    }

    .ios-music-widget .music-title {
      font-size: 20px;
      font-weight: 600;
      color: #fff;
      letter-spacing: -0.3px;
      margin-bottom: 2px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .ios-music-widget .music-artist {
      font-size: 14px;
      font-weight: 400;
      color: rgba(255, 255, 255, 0.6);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* æ§åˆ¶æŒ‰é’® */
    .ios-music-widget .music-controls {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 24px;
    }

    .ios-music-widget .music-btn {
      background: none;
      border: none;
      cursor: pointer;
      padding: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: rgba(255, 255, 255, 0.9);
      transition: transform 0.1s ease, opacity 0.1s ease;
      -webkit-tap-highlight-color: transparent;
    }

    .ios-music-widget .music-btn:active {
      transform: scale(0.9);
      opacity: 0.6;
    }

    .ios-music-widget .music-btn.skip-btn svg {
      width: 36px;
      height: 36px;
      fill: currentColor;
    }

    .ios-music-widget .music-btn.play-btn svg {
      width: 48px;
      height: 48px;
      fill: currentColor;
    }

    /* è¿›åº¦æ¡åŒºåŸŸ */
    .ios-music-widget .music-progress {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .ios-music-widget .progress-track {
      flex: 1;
      height: 5px;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 2.5px;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .ios-music-widget .progress-fill {
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      background: rgba(255, 255, 255, 0.85);
      border-radius: 2.5px;
      transition: width 0.15s linear;
    }

    .ios-music-widget .music-time {
      font-size: 11px;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.55);
      font-variant-numeric: tabular-nums;
      min-width: 32px;
    }

    .ios-music-widget .music-time.current {
      text-align: right;
    }

    .ios-music-widget .music-time.total {
      text-align: left;
    }

    /* ä¸“è¾‘å°é¢ç¼–è¾‘æç¤º */
    .ios-music-widget .music-album {
      cursor: pointer;
    }

    .ios-music-widget .music-album-edit-hint {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.2s ease;
      border-radius: 10px;
    }

    .ios-music-widget .music-album-edit-hint svg {
      width: 32px;
      height: 32px;
      stroke: #fff;
      stroke-width: 2;
      fill: none;
    }

    .ios-music-widget .music-album:hover .music-album-edit-hint,
    .ios-music-widget .music-album:active .music-album-edit-hint {
      opacity: 1;
    }

    /* æ­Œæ›²å/æ­Œæ‰‹åå¯ç¼–è¾‘æ ·å¼ */
    .ios-music-widget .music-title,
    .ios-music-widget .music-artist {
      cursor: pointer;
      transition: background 0.15s ease;
      border-radius: 4px;
      padding: 2px 6px;
      margin: -2px -6px;
    }

    .ios-music-widget .music-title:hover,
    .ios-music-widget .music-artist:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .ios-music-widget .music-title:active,
    .ios-music-widget .music-artist:active {
      background: rgba(255, 255, 255, 0.15);
    }

    /* ========== ç»„ä»¶é€‰æ‹©å™¨ - INSé£æ ¼é‡è®¾è®¡ ========== */

    /* é®ç½©å±‚ - æ¯›ç»ç’ƒæ•ˆæœ */
    .widget-picker-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      z-index: 20000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      align-items: flex-end;
      justify-content: center;
    }

    .widget-picker-overlay.active {
      opacity: 1;
      pointer-events: auto;
    }

    /* ä¸»é¢æ¿ - å¼‚å½¢è®¾è®¡ */
    .widget-picker-sheet {
      width: 100%;
      max-width: 400px;
      max-height: 75vh;
      background: var(--bg-primary);
      border-radius: 28px 28px 0 0;
      padding: 0;
      transform: translateY(100%);
      transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.15);
      position: relative;
    }

    /* è£…é¥°æ˜Ÿæ˜Ÿ */
    .widget-picker-sheet::before {
      content: 'âœ¦';
      position: absolute;
      top: 16px;
      right: 60px;
      font-size: 10px;
      color: var(--text-tertiary);
      opacity: 0.5;
      animation: starTwinkle 2s ease-in-out infinite;
    }

    .widget-picker-sheet::after {
      content: 'âœ§';
      position: absolute;
      top: 24px;
      right: 45px;
      font-size: 8px;
      color: var(--text-tertiary);
      opacity: 0.3;
      animation: starTwinkle 2s ease-in-out infinite 0.5s;
    }

    @keyframes starTwinkle {
      0%, 100% { opacity: 0.3; transform: scale(1); }
      50% { opacity: 0.7; transform: scale(1.2); }
    }

    .widget-picker-overlay.active .widget-picker-sheet {
      transform: translateY(0);
    }

    /* é¡¶éƒ¨æ‹–æ‹½æ‰‹æŸ„ - åƒç´ é£æ ¼ */
    .widget-picker-handle {
      width: 40px;
      height: 4px;
      background: var(--text-tertiary);
      border-radius: 2px;
      margin: 14px auto 6px;
      position: relative;
    }

    /* å¤´éƒ¨åŒºåŸŸ */
    .widget-picker-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 18px 14px;
      border-bottom: 1px solid var(--border-color);
    }

    .widget-picker-title {
      font-size: 15px;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.3px;
      font-family: -apple-system, 'SF Pro Display', sans-serif;
    }

    /* å…³é—­æŒ‰é’® - å¼‚å½¢èƒ¶å›Šè®¾è®¡ */
    .widget-picker-close {
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .widget-picker-close:hover {
      background: var(--text-primary);
    }

    .widget-picker-close:hover svg {
      stroke: var(--bg-primary);
    }

    .widget-picker-close svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-secondary);
      stroke-width: 2;
    }

    /* å†…å®¹åŒºåŸŸ */
    .widget-picker-grid {
      flex: 1;
      overflow-y: auto;
      padding: 14px 16px 28px;
      scroll-behavior: smooth;
    }

    .widget-picker-grid::-webkit-scrollbar {
      width: 3px;
    }

    .widget-picker-grid::-webkit-scrollbar-track {
      background: transparent;
    }

    .widget-picker-grid::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 2px;
    }

    /* åˆ†ç±»åŒºå— */
    .widget-picker-category {
      margin-bottom: 18px;
    }

    .widget-picker-category:last-child {
      margin-bottom: 0;
    }

    /* åˆ†ç±»æ ‡é¢˜ - èƒ¶å›Šæ ‡ç­¾æ ·å¼ */
    .widget-picker-category-title {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.8px;
      margin-bottom: 10px;
      padding: 4px 10px;
      background: var(--bg-secondary);
      border-radius: 20px;
      border: 1px solid var(--border-color);
    }

    .widget-picker-category-title::before {
      content: 'â—†';
      font-size: 6px;
      opacity: 0.6;
    }

    /* ç»„ä»¶ç½‘æ ¼ - ç´§å‡‘å¸ƒå±€ */
    .widget-picker-items {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    /* ========== æ¡Œé¢é¢„è®¾ï¼ˆWidget Picker å†…ï¼‰ ========== */
    .desktop-presets-row {
      display: flex;
      gap: 10px;
      overflow-x: auto;
      padding: 4px 2px 2px;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
      /* éšè—æ¨ªå‘æ»šåŠ¨æ¡ï¼ˆä¿ç•™æ»šåŠ¨èƒ½åŠ›ï¼‰ */
      scrollbar-width: none; /* Firefox */
      -ms-overflow-style: none; /* IE/Edge Legacy */
    }

    .desktop-presets-row::-webkit-scrollbar {
      width: 0;
      height: 0;
    }

    .desktop-presets-row::-webkit-scrollbar-track {
      background: transparent;
    }

    .desktop-presets-row::-webkit-scrollbar-thumb {
      background: transparent;
      border-radius: 2px;
    }

    .desktop-preset-card {
      position: relative;
      min-width: 148px;
      flex: 0 0 auto;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 12px 12px 12px;
      cursor: pointer;
      transition: transform 0.18s ease, background 0.2s ease, border-color 0.2s ease;
      scroll-snap-align: start;
      overflow: hidden;
    }

    .desktop-preset-card:hover {
      background: var(--bg-tertiary);
      border-color: var(--text-tertiary);
    }

    .desktop-preset-card:active {
      transform: scale(0.985);
    }

    .desktop-preset-card.active {
      border-color: var(--accent-color);
      box-shadow: 0 10px 24px rgba(0, 0, 0, 0.12);
    }

    .desktop-preset-card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }

    .desktop-preset-card-name {
      font-size: 13px;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.2px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .desktop-preset-card-meta {
      margin-top: 8px;
      font-size: 10px;
      color: var(--text-tertiary);
      line-height: 1.35;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .desktop-preset-card-badge {
      position: absolute;
      right: 10px;
      bottom: 10px;
      padding: 2px 8px;
      border-radius: 10px;
      background: var(--text-primary);
      color: var(--bg-primary);
      font-size: 9px;
      font-weight: 600;
      letter-spacing: 0.2px;
      opacity: 0.9;
    }

    .desktop-preset-card-action {
      width: 26px;
      height: 26px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .desktop-preset-card-action svg {
      width: 13px;
      height: 13px;
      stroke: var(--text-secondary);
    }

    .desktop-preset-card-action.delete:hover {
      background: var(--text-primary);
      border-color: var(--text-primary);
    }

    .desktop-preset-card-action.delete:hover svg {
      stroke: var(--bg-primary);
    }

    .desktop-preset-card-action.lock {
      opacity: 0.55;
      cursor: default;
    }

    .desktop-preset-card-action.lock:hover {
      background: var(--bg-primary);
      border-color: var(--border-color);
    }

    .desktop-presets-hint {
      margin-top: 8px;
      font-size: 11px;
      color: var(--text-tertiary);
      line-height: 1.4;
    }

    /* ç»„ä»¶é¡¹ - åˆ—è¡¨å¡ç‰‡æ ·å¼ï¼ˆä»¿æ–‡ä»¶åˆ—è¡¨ï¼‰ */
    .widget-picker-item {
      position: relative;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 14px;
      padding: 12px 14px;
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      overflow: hidden;
    }

    .widget-picker-item::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 3px;
      background: var(--text-tertiary);
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .widget-picker-item:hover {
      background: var(--bg-tertiary);
      border-color: var(--text-tertiary);
      transform: translateX(4px);
    }

    .widget-picker-item:hover::before {
      opacity: 1;
    }

    .widget-picker-item:active {
      transform: translateX(4px) scale(0.99);
    }

    /* å›¾æ ‡å®¹å™¨ - æ–¹å½¢åœ†è§’ */
    .widget-picker-item-icon {
      width: 38px;
      height: 38px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      font-size: 18px;
      flex-shrink: 0;
    }

    /* ä½¿ç”¨SVGå›¾æ ‡æ›¿ä»£emoji */
    .widget-picker-item-icon svg {
      width: 20px;
      height: 20px;
      stroke: var(--text-primary);
      stroke-width: 1.5;
      fill: none;
    }

    /* æ–‡å­—ä¿¡æ¯åŒº */
    .widget-picker-item-info {
      flex: 1;
      min-width: 0;
    }

    .widget-picker-item-name {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
      letter-spacing: -0.2px;
      margin-bottom: 2px;
    }

    /* å°ºå¯¸æ ‡ç­¾ - èƒ¶å›Šæ ·å¼ */
    .widget-picker-item-size {
      display: inline-block;
      font-size: 10px;
      color: var(--text-tertiary);
      background: var(--bg-primary);
      padding: 2px 8px;
      border-radius: 10px;
      border: 1px solid var(--border-color);
      font-family: 'SF Mono', monospace;
    }

    /* å¤šå°ºå¯¸æ ‡è®° - å³ä¾§ç®­å¤´ */
    .widget-picker-item-multi {
      position: absolute;
      top: 50%;
      right: 12px;
      transform: translateY(-50%);
      padding: 3px 8px;
      background: var(--text-primary);
      color: var(--bg-primary);
      font-size: 9px;
      border-radius: 8px;
      font-weight: 600;
      letter-spacing: 0.3px;
    }

    /* å³ä¾§ç®­å¤´æŒ‡ç¤º */
    .widget-picker-item-arrow {
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0.4;
      transition: opacity 0.2s ease, transform 0.2s ease;
    }

    .widget-picker-item:hover .widget-picker-item-arrow {
      opacity: 0.8;
      transform: translateX(2px);
    }

    .widget-picker-item-arrow svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-primary);
      stroke-width: 2;
    }

    /* Widget Picker ç©ºçŠ¶æ€ - åˆ›å»ºè‡ªå®šä¹‰ç»„ä»¶æç¤º */
    .widget-picker-empty {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 12px;
      padding: 32px 24px;
      border-radius: 16px;
      background: var(--bg-secondary);
      border: 2px dashed var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
      width: 100%;
    }

    .widget-picker-empty:hover {
      border-color: var(--accent-color);
      background: rgba(var(--accent-rgb, 0, 122, 255), 0.08);
    }

    .widget-picker-empty svg {
      width: 40px;
      height: 40px;
      stroke: var(--text-secondary);
      transition: stroke 0.2s ease;
    }

    .widget-picker-empty:hover svg {
      stroke: var(--accent-color);
    }

    .widget-picker-empty span {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
      transition: color 0.2s ease;
    }

    .widget-picker-empty:hover span {
      color: var(--accent-color);
    }

    /* Widget Picker Header Actions */
    .widget-picker-header-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .widget-picker-action-btn {
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .widget-picker-action-btn:hover {
      background: var(--accent-color);
      border-color: var(--accent-color);
    }

    .widget-picker-action-btn:hover svg {
      stroke: #fff;
    }

    .widget-picker-action-btn svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-secondary);
      stroke-width: 1.5;
    }

    /* ========== æ¡Œé¢é¢„è®¾å¯¼å‡ºå¼¹çª—ï¼ˆWidget Picker å†…ï¼‰ ========== */
    .desktop-preset-export-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      z-index: 20050;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      align-items: flex-end;
      justify-content: center;
    }

    .desktop-preset-export-overlay.active {
      opacity: 1;
      pointer-events: auto;
    }

    .desktop-preset-export-sheet {
      width: 100%;
      max-width: 400px;
      background: var(--bg-primary);
      border-radius: 28px 28px 0 0;
      transform: translateY(100%);
      transition: transform 0.35s cubic-bezier(0.32, 0.72, 0, 1);
      box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.15);
      overflow: hidden;
    }

    .desktop-preset-export-overlay.active .desktop-preset-export-sheet {
      transform: translateY(0);
    }

    .desktop-preset-export-handle {
      width: 40px;
      height: 4px;
      background: var(--text-tertiary);
      border-radius: 2px;
      margin: 14px auto 6px;
    }

    .desktop-preset-export-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 18px 14px;
      border-bottom: 1px solid var(--border-color);
    }

    .desktop-preset-export-title {
      font-size: 15px;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.3px;
      font-family: -apple-system, 'SF Pro Display', sans-serif;
    }

    .desktop-preset-export-close {
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .desktop-preset-export-close:hover {
      background: var(--text-primary);
      border-color: var(--text-primary);
    }

    .desktop-preset-export-close:hover svg {
      stroke: var(--bg-primary);
    }

    .desktop-preset-export-close svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-secondary);
    }

    .desktop-preset-export-body {
      padding: 14px 18px 16px;
    }

    .desktop-preset-export-field {
      margin-bottom: 12px;
    }

    .desktop-preset-export-label {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: 6px;
    }

    .desktop-preset-export-input {
      width: 100%;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid var(--border-color);
      background: var(--bg-secondary);
      color: var(--text-primary);
      font-size: 13px;
      outline: none;
      transition: border-color 0.2s ease, background 0.2s ease;
      box-sizing: border-box;
    }

    .desktop-preset-export-input:focus {
      border-color: var(--accent-color);
      background: var(--bg-tertiary);
    }

    .desktop-preset-export-input::placeholder {
      color: var(--text-tertiary);
    }

    .desktop-preset-export-tip {
      font-size: 11px;
      color: var(--text-tertiary);
      line-height: 1.5;
      padding-top: 2px;
    }

    .desktop-preset-export-footer {
      display: flex;
      gap: 10px;
      padding: 12px 18px 16px;
      border-top: 1px solid var(--border-color);
    }

    .desktop-preset-export-btn {
      flex: 1;
      height: 36px;
      border-radius: 12px;
      border: 1px solid var(--border-color);
      background: var(--bg-secondary);
      color: var(--text-primary);
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .desktop-preset-export-btn:hover {
      background: var(--bg-tertiary);
    }

    .desktop-preset-export-btn.primary {
      background: var(--accent-color);
      border-color: var(--accent-color);
      color: #ffffff;
    }

    .desktop-preset-export-btn.primary:hover {
      filter: brightness(1.03);
    }

    /* ========== è‡ªå®šä¹‰ç»„ä»¶å·¥ä½œå° - åŒ¹é…Widget Pickeré£æ ¼ ========== */

    /* å·¥ä½œå°é®ç½©å±‚ */
    .cww-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      z-index: 20000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      align-items: flex-end;
      justify-content: center;
    }

    .cww-overlay.active {
      opacity: 1;
      pointer-events: auto;
    }

    /* å·¥ä½œå°ä¸»é¢æ¿ */
    .cww-sheet {
      width: 100%;
      max-height: 80vh;
      background: var(--bg-primary);
      border-radius: 28px 28px 0 0;
      transform: translateY(100%);
      transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.15);
    }

    .cww-overlay.active .cww-sheet {
      transform: translateY(0);
    }

    /* æ‹–æ‹½æ‰‹æŸ„ */
    .cww-handle {
      width: 40px;
      height: 4px;
      background: var(--text-tertiary);
      border-radius: 2px;
      margin: 14px auto 6px;
    }

    /* å¤´éƒ¨åŒºåŸŸ */
    .cww-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 18px 14px;
      border-bottom: 1px solid var(--border-color);
    }

    .cww-title {
      font-size: 15px;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.3px;
    }

    .cww-header-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .cww-action-btn, .cww-close-btn {
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .cww-action-btn:hover, .cww-close-btn:hover {
      background: var(--text-primary);
    }

    .cww-action-btn:hover svg, .cww-close-btn:hover svg {
      stroke: var(--bg-primary);
    }

    .cww-action-btn svg, .cww-close-btn svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-secondary);
      stroke-width: 2;
    }

    .cww-action-btn.active {
      background: var(--accent-color);
      border-color: var(--accent-color);
    }

    .cww-action-btn.active svg {
      stroke: #fff;
    }

    /* é€‰æ‹©æ  */
    .cww-select-bar {
      display: none;
      align-items: center;
      justify-content: space-between;
      padding: 8px 18px;
      background: var(--bg-secondary);
      font-size: 12px;
      color: var(--text-secondary);
    }

    .cww-select-bar.active {
      display: flex;
    }

    .cww-select-bar span span {
      color: var(--accent-color);
      font-weight: 600;
    }

    .cww-select-actions {
      display: flex;
      gap: 8px;
    }

    .cww-select-actions button {
      padding: 5px 10px;
      font-size: 11px;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      color: var(--text-primary);
      cursor: pointer;
    }

    .cww-select-actions button.danger {
      color: #ff4757;
      border-color: rgba(255, 71, 87, 0.3);
    }

    /* å†…å®¹åŒºåŸŸ */
    .cww-content {
      flex: 1;
      overflow-y: auto;
      padding: 14px 16px 28px;
      scroll-behavior: smooth;
    }

    .cww-content::-webkit-scrollbar {
      width: 3px;
    }

    .cww-content::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 2px;
    }

    /* åˆ†ç±»åŒºå— */
    .cww-category {
      margin-bottom: 18px;
    }

    .cww-category:last-child {
      margin-bottom: 0;
    }

    /* åˆ†ç±»æ ‡é¢˜ - èƒ¶å›Šæ ‡ç­¾æ ·å¼ */
    .cww-category-title {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.8px;
      margin-bottom: 10px;
      padding: 4px 10px;
      background: var(--bg-secondary);
      border-radius: 20px;
      border: 1px solid var(--border-color);
    }

    .cww-category-title::before {
      content: 'â—†';
      font-size: 6px;
      opacity: 0.6;
    }

    /* åˆ›å»ºé¡¹ - åˆ—è¡¨å¡ç‰‡æ ·å¼ */
    .cww-create-item {
      position: relative;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 14px;
      padding: 12px 14px;
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .cww-create-item::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 3px;
      background: var(--accent-color);
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .cww-create-item:hover {
      background: var(--bg-tertiary);
      border-color: var(--accent-color);
      transform: translateX(4px);
    }

    .cww-create-item:hover::before {
      opacity: 1;
    }

    /* é¡¹ç›®åˆ—è¡¨ */
    .cww-items {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    /* é¡¹ç›®é¡¹ - åˆ—è¡¨å¡ç‰‡æ ·å¼ */
    .cww-item {
      position: relative;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 14px;
      padding: 12px 14px;
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .cww-item::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 3px;
      background: var(--text-tertiary);
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .cww-item:hover {
      background: var(--bg-tertiary);
      border-color: var(--text-tertiary);
      transform: translateX(4px);
    }

    .cww-item:hover::before {
      opacity: 1;
    }

    .cww-item.selected {
      border-color: var(--accent-color);
    }

    .cww-item.selected::before {
      background: var(--accent-color);
      opacity: 1;
    }

    /* å›¾æ ‡å®¹å™¨ */
    .cww-item-icon {
      width: 38px;
      height: 38px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      flex-shrink: 0;
    }

    .cww-item-icon svg {
      width: 20px;
      height: 20px;
      stroke: var(--text-primary);
      stroke-width: 1.5;
      fill: none;
    }

    /* æ–‡å­—ä¿¡æ¯åŒº */
    .cww-item-info {
      flex: 1;
      min-width: 0;
    }

    .cww-item-name {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
      letter-spacing: -0.2px;
      margin-bottom: 2px;
    }

    .cww-item-desc, .cww-item-size {
      display: inline-block;
      font-size: 10px;
      color: var(--text-tertiary);
      background: var(--bg-primary);
      padding: 2px 8px;
      border-radius: 10px;
      border: 1px solid var(--border-color);
      font-family: 'SF Mono', monospace;
    }

    /* å³ä¾§ç®­å¤´ */
    .cww-item-arrow {
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0.4;
      transition: opacity 0.2s ease, transform 0.2s ease;
    }

    .cww-item:hover .cww-item-arrow,
    .cww-create-item:hover .cww-item-arrow {
      opacity: 0.8;
      transform: translateX(2px);
    }

    .cww-item-arrow svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-primary);
      stroke-width: 2;
    }

    /* ç©ºçŠ¶æ€ */
    .cww-empty {
      display: none;
      padding: 24px;
      text-align: center;
    }

    .cww-empty.show {
      display: block;
    }

    .cww-empty-text {
      font-size: 13px;
      color: var(--text-tertiary);
    }

    /* ç»„ä»¶åˆ—è¡¨é¡¹ - JSåŠ¨æ€ç”Ÿæˆ */
    .cww-widget-item {
      position: relative;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 14px;
      padding: 12px 14px;
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      margin-bottom: 8px;
    }

    .cww-widget-item:last-child {
      margin-bottom: 0;
    }

    .cww-widget-item::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 3px;
      background: var(--text-tertiary);
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .cww-widget-item:hover {
      background: var(--bg-tertiary);
      border-color: var(--text-tertiary);
      transform: translateX(4px);
    }

    .cww-widget-item:hover::before {
      opacity: 1;
    }

    .cww-widget-item.selected {
      border-color: var(--accent-color);
    }

    .cww-widget-item.selected::before {
      background: var(--accent-color);
      opacity: 1;
    }

    /* é€‰æ‹©æ¡† */
    .cww-widget-checkbox {
      width: 20px;
      height: 20px;
      border: 2px solid var(--border-color);
      border-radius: 6px;
      display: none;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: all 0.2s;
    }

    .cww-widget-checkbox svg {
      width: 14px;
      height: 14px;
      stroke: #fff;
      opacity: 0;
    }

    .select-mode .cww-widget-checkbox {
      display: flex;
    }

    .cww-widget-item.selected .cww-widget-checkbox {
      background: var(--accent-color);
      border-color: var(--accent-color);
    }

    .cww-widget-item.selected .cww-widget-checkbox svg {
      opacity: 1;
    }

    /* é¢„è§ˆå›¾æ ‡ */
    .cww-widget-preview {
      width: 42px;
      height: 42px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      flex-shrink: 0;
    }

    .cww-widget-preview svg {
      width: 22px;
      height: 22px;
      stroke: var(--text-secondary);
    }

    /* ç»„ä»¶ä¿¡æ¯ */
    .cww-widget-info {
      flex: 1;
      min-width: 0;
    }

    .cww-widget-name {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .cww-widget-meta {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .cww-widget-meta span {
      font-size: 10px;
      color: var(--text-tertiary);
      background: var(--bg-primary);
      padding: 2px 6px;
      border-radius: 6px;
      border: 1px solid var(--border-color);
    }

    .cww-widget-meta span:first-child {
      color: var(--accent-color);
      font-weight: 600;
    }

    /* æ“ä½œæŒ‰é’® */
    .cww-widget-actions {
      display: flex;
      gap: 6px;
      flex-shrink: 0;
    }

    .cww-widget-action-btn {
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .cww-widget-action-btn:hover {
      background: var(--accent-color);
      border-color: var(--accent-color);
    }

    .cww-widget-action-btn:hover svg {
      stroke: #fff;
    }

    .cww-widget-action-btn svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-secondary);
    }

    .cww-widget-action-btn.delete:hover {
      background: #ff4757;
      border-color: #ff4757;
    }

    /* å¤šé€‰æ¨¡å¼ */
    .cww-content.select-mode .cww-widget-actions {
      display: none;
    }

    /* å¯¼å‡ºå¯¹è¯æ¡† */
    .cww-export-dialog {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10;
      border-radius: 24px;
    }

    .cww-export-dialog.active {
      display: flex;
    }

    .cww-export-content {
      background: var(--bg-primary);
      border-radius: 16px;
      padding: 20px;
      width: 280px;
      border: 1px solid var(--border-color);
    }

    .cww-export-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 8px;
    }

    .cww-export-count {
      font-size: 13px;
      color: var(--text-secondary);
      margin-bottom: 16px;
    }

    .cww-export-author {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 20px;
    }

    .cww-export-author label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      color: var(--text-primary);
      cursor: pointer;
    }

    .cww-export-author input[type="checkbox"] {
      width: 16px;
      height: 16px;
      accent-color: var(--accent-color);
    }

    .cww-export-author input[type="text"] {
      width: 100%;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid var(--border-color);
      background: var(--bg-secondary);
      color: var(--text-primary);
      font-size: 14px;
      outline: none;
      transition: border-color 0.2s, opacity 0.2s;
      box-sizing: border-box;
    }

    .cww-export-author input[type="text"]:disabled {
      opacity: 0.5;
    }

    .cww-export-author input[type="text"]:focus {
      border-color: var(--accent-color);
    }

    .cww-export-actions {
      display: flex;
      gap: 10px;
    }

    .cww-export-actions button {
      flex: 1;
      padding: 12px;
      border-radius: 12px;
      border: none;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .cww-export-cancel {
      background: var(--bg-secondary);
      color: var(--text-primary);
    }

    .cww-export-cancel:hover {
      background: var(--bg-tertiary, #3a3a3c);
    }

    .cww-export-confirm {
      background: var(--accent-color);
      color: #fff;
    }

    .cww-export-confirm:hover {
      filter: brightness(1.1);
    }

    /* ä½œè€…æ ‡ç­¾ */
    .cww-widget-author {
      font-size: 10px;
      color: var(--accent-color);
      background: rgba(var(--accent-rgb, 0, 122, 255), 0.15);
      padding: 2px 6px;
      border-radius: 4px;
      margin-left: 6px;
    }

    /* ========== è‡ªå®šä¹‰ç»„ä»¶ç¼–è¾‘å™¨ - åŒ¹é…Widget Pickeré£æ ¼ ========== */

    /* ç¼–è¾‘å™¨é®ç½©å±‚ */
    .cwe-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      z-index: 20010;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      align-items: flex-end;
      justify-content: center;
    }

    .cwe-overlay.active {
      opacity: 1;
      pointer-events: auto;
    }

    /* ç¼–è¾‘å™¨ä¸»é¢æ¿ */
    .cwe-sheet {
      width: 100%;
      max-height: 90vh;
      background: var(--bg-primary);
      border-radius: 28px 28px 0 0;
      transform: translateY(100%);
      transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.15);
    }

    .cwe-overlay.active .cwe-sheet {
      transform: translateY(0);
    }

    /* æ‹–æ‹½æ‰‹æŸ„ */
    .cwe-handle {
      width: 40px;
      height: 4px;
      background: var(--text-tertiary);
      border-radius: 2px;
      margin: 14px auto 6px;
    }

    /* å¤´éƒ¨åŒºåŸŸ */
    .cwe-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 18px 14px;
      border-bottom: 1px solid var(--border-color);
    }

    .cwe-title {
      font-size: 15px;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.3px;
    }

    .cwe-header-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .cwe-save-btn {
      padding: 6px 14px;
      background: var(--accent-color);
      color: #000;
      border: none;
      border-radius: 10px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .cwe-save-btn:hover {
      filter: brightness(1.1);
    }

    .cwe-close-btn {
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .cwe-close-btn:hover {
      background: var(--text-primary);
    }

    .cwe-close-btn:hover svg {
      stroke: var(--bg-primary);
    }

    .cwe-close-btn svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-secondary);
      stroke-width: 2;
    }

    /* å†…å®¹åŒºåŸŸ */
    .cwe-content {
      flex: 1;
      overflow-y: auto;
      padding: 14px 16px 28px;
      scroll-behavior: smooth;
    }

    .cwe-content::-webkit-scrollbar {
      width: 3px;
    }

    .cwe-content::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 2px;
    }

    /* åˆ†ç±»åŒºå— */
    .cwe-category {
      margin-bottom: 18px;
    }

    .cwe-category:last-child {
      margin-bottom: 0;
    }

    /* åˆ†ç±»æ ‡é¢˜ */
    .cwe-category-title {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.8px;
      margin-bottom: 10px;
      padding: 4px 10px;
      background: var(--bg-secondary);
      border-radius: 20px;
      border: 1px solid var(--border-color);
    }

    .cwe-category-title::before {
      content: 'â—†';
      font-size: 6px;
      opacity: 0.6;
    }

    /* è¡¨å•æ ·å¼ */
    .cwe-form {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .cwe-form-item {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .cwe-form-item label {
      font-size: 12px;
      font-weight: 500;
      color: var(--text-secondary);
    }

    .cwe-form-item input,
    .cwe-form-item select {
      width: 100%;
      padding: 10px 14px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      font-size: 14px;
      color: var(--text-primary);
      box-sizing: border-box;
      transition: border-color 0.2s;
    }

    .cwe-form-item input:focus,
    .cwe-form-item select:focus {
      outline: none;
      border-color: var(--accent-color);
    }

    /* ä»£ç æç¤º */
    .cwe-code-hint {
      font-size: 11px;
      color: var(--text-tertiary);
      margin-bottom: 8px;
      padding: 6px 10px;
      background: var(--bg-secondary);
      border-radius: 8px;
      border: 1px dashed var(--border-color);
    }

    /* ä»£ç ç¼–è¾‘åŒº */
    .cwe-code-area {
      width: 100%;
      min-height: 160px;
      padding: 12px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      font-family: 'SF Mono', 'Monaco', 'Menlo', monospace;
      font-size: 12px;
      line-height: 1.5;
      color: var(--text-primary);
      resize: vertical;
      box-sizing: border-box;
      transition: border-color 0.2s;
    }

    .cwe-code-area:focus {
      outline: none;
      border-color: var(--accent-color);
    }

    .cwe-code-area::placeholder {
      color: var(--text-tertiary);
    }

    /* å›¾ç‰‡æ§½ */
    .cwe-slots {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .cwe-slot {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 10px;
    }

    .cwe-slot-name {
      font-size: 12px;
      color: var(--text-primary);
      font-family: 'SF Mono', monospace;
    }

    .cwe-slot-btn {
      padding: 4px 10px;
      background: var(--accent-color);
      color: #000;
      border: none;
      border-radius: 6px;
      font-size: 11px;
      cursor: pointer;
    }

    /* é¢„è§ˆåŒºåŸŸ */
    .cwe-preview-area {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 16px;
      overflow: auto;
      max-height: 420px;
    }

    .cwe-preview {
      background: var(--bg-primary);
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid var(--border-color);
      margin: 0 auto;
    }

    .cwe-preview-size {
      font-size: 10px;
      font-weight: 400;
      color: var(--text-tertiary);
      font-family: 'SF Mono', monospace;
      margin-left: 6px;
    }

    /* å‚è€ƒæ ‡ç­¾ */
    .cwe-ref-tabs {
      display: flex;
      gap: 0;
      border-bottom: 1px solid var(--border-color);
      margin-bottom: 12px;
    }

    .cwe-ref-tabs button {
      flex: 1;
      padding: 10px;
      background: none;
      border: none;
      border-bottom: 2px solid transparent;
      font-size: 12px;
      font-weight: 500;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s;
    }

    .cwe-ref-tabs button:hover {
      color: var(--text-primary);
    }

    .cwe-ref-tabs button.active {
      color: var(--accent-color);
      border-bottom-color: var(--accent-color);
    }

    /* å‚è€ƒå†…å®¹ */
    .cwe-ref-content {
      display: none;
    }

    .cwe-ref-content.active {
      display: block;
    }

    /* å˜é‡åˆ—è¡¨ */
    .cwe-var-list {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .cwe-var-list span {
      padding: 5px 10px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 11px;
      font-family: 'SF Mono', monospace;
      color: var(--text-primary);
      cursor: pointer;
      transition: all 0.2s;
    }

    .cwe-var-list span:hover {
      border-color: var(--accent-color);
      background: var(--bg-tertiary);
    }

    /* å°ºå¯¸å‚è€ƒ */
    .cwe-size-ref {
      padding: 10px 12px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      font-size: 11px;
      font-family: 'SF Mono', monospace;
      color: var(--text-secondary);
      text-align: center;
    }

    /* æ¨¡æ¿é¡¹ */
    .cwe-tpl-items {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .cwe-tpl-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 14px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .cwe-tpl-item:hover {
      border-color: var(--accent-color);
      background: var(--bg-tertiary);
    }

    .cwe-tpl-item span:first-child {
      font-size: 13px;
      font-weight: 500;
      color: var(--text-primary);
    }

    .cwe-tpl-size {
      font-size: 10px;
      color: var(--accent-color);
      background: rgba(0, 122, 255, 0.1);
      padding: 2px 8px;
      border-radius: 8px;
    }

    /* Sizesè¡¨æ ¼ */
    .cwe-size-table {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .cwe-size-group {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 10px;
    }

    .cwe-size-group-title {
      font-size: 11px;
      font-weight: 600;
      color: var(--accent-color);
      margin-bottom: 8px;
      padding-bottom: 6px;
      border-bottom: 1px solid var(--border-color);
    }

    .cwe-size-row {
      display: flex;
      justify-content: space-between;
      padding: 4px 0;
      font-size: 11px;
    }

    .cwe-size-row span:first-child {
      font-weight: 600;
      color: var(--text-primary);
    }

    .cwe-size-row span:last-child {
      color: var(--text-tertiary);
      font-family: 'SF Mono', monospace;
      font-size: 10px;
    }

    /* TXTæç¤ºè¯åŒº */
    .cwe-txt-prompt {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 14px;
    }

    .cwe-txt-title {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .cwe-txt-desc {
      font-size: 11px;
      color: var(--text-tertiary);
      margin-bottom: 12px;
    }

    .cwe-txt-box {
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 12px;
      font-size: 11px;
      line-height: 1.6;
      color: var(--text-secondary);
      font-family: 'SF Mono', monospace;
      white-space: pre-wrap;
      max-height: 150px;
      overflow-y: auto;
      margin-bottom: 12px;
    }

    .cwe-txt-copy {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      width: 100%;
      padding: 10px;
      background: var(--accent-color);
      color: #fff;
      border: none;
      border-radius: 10px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    .cwe-txt-copy:hover {
      filter: brightness(1.1);
    }

    .cwe-txt-copy svg {
      width: 16px;
      height: 16px;
    }

    /* é¢„è§ˆç©ºçŠ¶æ€ */
    .cwe-preview-empty {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 30px;
      text-align: center;
    }

    .cwe-preview-empty svg {
      width: 40px;
      height: 40px;
      stroke: rgba(255, 255, 255, 0.5);
      margin-bottom: 10px;
    }

    .cwe-preview-empty span {
      font-size: 12px;
      color: rgba(255, 255, 255, 0.7);
    }

    /* ========================================
     * Theme Guide Drawer - ä¸»é¢˜æ•™ç¨‹æŠ½å±‰
     * ======================================== */

    /* é®ç½©å±‚ */
    .tgd-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      z-index: 20011;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      align-items: flex-end;
      justify-content: center;
    }

    .tgd-overlay.active {
      opacity: 1;
      pointer-events: auto;
    }

    /* æŠ½å±‰ä¸»é¢æ¿ */
    .tgd-sheet {
      width: 100%;
      max-height: 85vh;
      background: var(--bg-primary);
      border-radius: 24px 24px 0 0;
      transform: translateY(100%);
      transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
    }

    .tgd-overlay.active .tgd-sheet {
      transform: translateY(0);
    }

    /* æ‹–æ‹½æ‰‹æŸ„ */
    .tgd-handle {
      width: 36px;
      height: 4px;
      background: var(--text-tertiary);
      border-radius: 2px;
      margin: 10px auto 4px;
      opacity: 0.5;
    }

    /* å¤´éƒ¨åŒºåŸŸ */
    .tgd-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 16px 12px;
      border-bottom: 1px solid var(--border-color);
    }

    .tgd-title {
      font-size: 14px;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.3px;
    }

    .tgd-header-actions {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    /* é¡µç æŒ‡ç¤ºå™¨ */
    .tgd-page-indicator {
      display: flex;
      gap: 5px;
      align-items: center;
    }

    .tgd-page-dot {
      width: 5px;
      height: 5px;
      border-radius: 50%;
      background: var(--text-tertiary);
      opacity: 0.3;
      transition: all 0.3s;
      cursor: pointer;
    }

    .tgd-page-dot.active {
      opacity: 1;
      background: var(--text-primary);
      transform: scale(1.2);
    }

    /* å…³é—­æŒ‰é’® */
    .tgd-close-btn {
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .tgd-close-btn:hover {
      background: var(--text-primary);
    }

    .tgd-close-btn:hover svg {
      stroke: var(--bg-primary);
    }

    .tgd-close-btn svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-secondary);
    }

    /* å†…å®¹åŒºåŸŸ */
    .tgd-content {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
      position: relative;
    }

    /* é¡µé¢å®¹å™¨ */
    .tgd-page {
      padding: 20px 18px;
      display: none;
      animation: tgdFadeIn 0.3s ease;
    }

    .tgd-page.active {
      display: block;
    }

    @keyframes tgdFadeIn {
      from {
        opacity: 0;
        transform: translateX(20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .tgd-page-title {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 16px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 18px;
      letter-spacing: -0.3px;
    }

    .tgd-page-title svg {
      width: 20px;
      height: 20px;
      stroke: var(--text-primary);
      flex-shrink: 0;
    }

    /* å†…å®¹åŒºå— */
    .tgd-section {
      margin-bottom: 20px;
    }

    /* åˆ†ç±»æ ‡é¢˜ - èƒ¶å›Šæ ‡ç­¾æ ·å¼ */
    .tgd-section-title {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 10px;
      padding: 5px 10px;
      background: var(--bg-secondary);
      border-radius: 16px;
      border: 1px solid var(--border-color);
    }

    .tgd-section-title svg {
      width: 12px;
      height: 12px;
      stroke: var(--text-secondary);
      flex-shrink: 0;
    }

    .tgd-text {
      font-size: 12px;
      line-height: 1.7;
      color: var(--text-secondary);
      margin-bottom: 8px;
    }

    .tgd-text code {
      font-family: 'JetBrains Mono', 'SF Mono', monospace;
      background: var(--bg-secondary);
      color: var(--text-primary);
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 10px;
      border: 1px solid var(--border-color);
    }

    .tgd-text strong {
      color: var(--text-primary);
      font-weight: 600;
    }

    /* å˜é‡è¡¨æ ¼ */
    .tgd-var-table {
      background: var(--bg-secondary);
      border-radius: 10px;
      border: 1px solid var(--border-color);
      overflow: hidden;
    }

    .tgd-var-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 12px;
      border-bottom: 1px solid var(--border-color);
    }

    .tgd-var-row:last-child {
      border-bottom: none;
    }

    .tgd-var-name {
      font-family: 'JetBrains Mono', 'SF Mono', monospace;
      font-size: 10px;
      color: var(--text-primary);
      background: var(--bg-primary);
      padding: 3px 7px;
      border-radius: 5px;
      font-weight: 600;
      border: 1px solid var(--border-color);
    }

    .tgd-var-desc {
      font-size: 11px;
      color: var(--text-tertiary);
      flex: 1;
      text-align: right;
      margin-left: 10px;
    }

    /* AIæç¤ºè¯æ¡† */
    .tgd-prompt-box {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 12px;
      font-family: 'JetBrains Mono', 'SF Mono', monospace;
      font-size: 10px;
      line-height: 1.7;
      color: var(--text-secondary);
      margin-bottom: 10px;
      white-space: pre-wrap;
      word-break: break-word;
      max-height: 280px;
      overflow-y: auto;
    }

    .tgd-prompt-box strong {
      color: var(--text-primary);
      font-weight: 700;
    }

    .tgd-prompt-box em {
      color: var(--text-tertiary);
      font-style: italic;
    }

    /* é”™è¯¯/æ­£ç¡®æ ‡è®° */
    .tgd-error-mark {
      color: var(--text-primary);
      opacity: 0.5;
      font-weight: 600;
    }

    .tgd-success-mark {
      color: var(--text-primary);
      font-weight: 600;
    }

    /* å¤åˆ¶æŒ‰é’® - é»‘ç™½ä¸»é¢˜ */
    .tgd-copy-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      width: 100%;
      padding: 11px;
      background: var(--text-primary);
      color: var(--bg-primary);
      border: none;
      border-radius: 10px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .tgd-copy-btn:hover {
      opacity: 0.85;
      transform: translateY(-1px);
    }

    .tgd-copy-btn:active {
      transform: translateY(0);
    }

    .tgd-copy-btn svg {
      width: 16px;
      height: 16px;
      stroke: var(--bg-primary);
    }

    /* åº•éƒ¨å¯¼èˆª */
    .tgd-footer {
      display: flex;
      gap: 8px;
      padding: 12px 16px;
      border-top: 1px solid var(--border-color);
      background: var(--bg-primary);
    }

    .tgd-nav-btn {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
      padding: 10px 14px;
      background: var(--bg-secondary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    .tgd-nav-btn:hover:not(:disabled) {
      background: var(--text-primary);
      color: var(--bg-primary);
      border-color: var(--text-primary);
    }

    .tgd-nav-btn:hover:not(:disabled) svg {
      stroke: var(--bg-primary);
    }

    .tgd-nav-btn:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    .tgd-nav-btn svg {
      width: 14px;
      height: 14px;
      stroke: currentColor;
    }

    /* æ»šåŠ¨æ¡æ ·å¼ */
    .tgd-content::-webkit-scrollbar {
      width: 4px;
    }

    .tgd-content::-webkit-scrollbar-track {
      background: transparent;
    }

    .tgd-content::-webkit-scrollbar-thumb {
      background: var(--text-tertiary);
      border-radius: 2px;
      opacity: 0.3;
    }

    .tgd-prompt-box::-webkit-scrollbar {
      width: 4px;
    }

    .tgd-prompt-box::-webkit-scrollbar-track {
      background: transparent;
    }

    .tgd-prompt-box::-webkit-scrollbar-thumb {
      background: var(--text-tertiary);
      border-radius: 2px;
      opacity: 0.3;
    }

    /* ========== ç»„ä»¶åˆ é™¤æŒ‰é’® - è½»ç£¨ç ‚é£æ ¼ ========== */
    .widget-delete-btn {
      position: absolute;
      top: -6px;
      left: -6px;
      width: 18px;
      height: 18px;
      background: rgba(0, 0, 0, 0.45);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      display: none;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 9999;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.25);
      transition: all 0.15s ease;
    }

    [data-theme="dark"] .widget-delete-btn {
      background: rgba(255, 255, 255, 0.18);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .widget-delete-btn:hover {
      transform: scale(1.15);
      background: rgba(220, 50, 50, 0.75);
      border-color: rgba(255, 100, 100, 0.4);
    }

    .widget-delete-btn:active {
      transform: scale(0.9);
    }

    .widget-delete-btn svg {
      width: 9px;
      height: 9px;
      stroke: #fff;
      stroke-width: 2.5;
    }

    .app-grid.edit-mode .widget-delete-btn {
      display: flex;
      animation: deleteButtonPop 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    /* ğŸ”¥ ã€è€ç‹ä¿®å¤ã€‘ç¼–è¾‘æ¨¡å¼ä¸‹ç¦ç”¨Widgetå†…éƒ¨æ‰€æœ‰äº¤äº’å…ƒç´ çš„äº‹ä»¶å“åº”
     * é—®é¢˜ï¼šWidgetå†…éƒ¨çš„å¯ç¼–è¾‘å…ƒç´ ä½¿ç”¨äº† event.stopPropagation()
     *       å¯¼è‡´äº‹ä»¶æ— æ³•å†’æ³¡åˆ° appGridï¼Œæ‹–åŠ¨å¤±æ•ˆä¸”è¯¯è§¦ç¼–è¾‘åŠŸèƒ½
     * æ–¹æ¡ˆï¼šç¼–è¾‘æ¨¡å¼ä¸‹ç”¨ pointer-events: none ç¦ç”¨å†…éƒ¨å…ƒç´ 
     *       åªä¿ç•™åˆ é™¤æŒ‰é’®å¯ç‚¹å‡»
     */
    .app-grid.edit-mode .desktop-widget > *:not(.widget-delete-btn) {
      pointer-events: none;
    }

    @keyframes deleteButtonPop {
      0% { transform: scale(0); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }

    /* æ‹–æ‹½ä¸­çš„ç»„ä»¶æ ·å¼ */
    .desktop-widget.dragging {
      opacity: 0.92;
      z-index: 10000;
      pointer-events: none;
      filter: drop-shadow(0 12px 24px rgba(0, 0, 0, 0.25));
      transition: none;
    }

    /* ========== SpotifyéŸ³ä¹ç»„ä»¶ - 4x2 ========== */
    .spotify-widget {
      width: 100%;
      height: 100%;
      border-radius: 22px;
      display: flex;
      padding: 16px 20px;
      gap: 16px;
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
    }

    /* é»‘è‰²ä¸»é¢˜ */
    .spotify-widget.theme-dark {
      background: #000;
    }
    .spotify-widget.theme-dark .spotify-album-label { color: #fff; }
    .spotify-widget.theme-dark .spotify-song-title { color: #fff; }
    .spotify-widget.theme-dark .spotify-artist { color: #b3b3b3; }
    .spotify-widget.theme-dark .spotify-heart svg { stroke: #b3b3b3; }
    .spotify-widget.theme-dark .spotify-progress-bar { background: #4d4d4d; }
    .spotify-widget.theme-dark .spotify-progress-fill { background: #fff; }
    .spotify-widget.theme-dark .spotify-progress-thumb { background: #fff; }
    .spotify-widget.theme-dark .spotify-time { color: #b3b3b3; }
    .spotify-widget.theme-dark .spotify-ctrl-btn svg { fill: #fff; }
    .spotify-widget.theme-dark .spotify-play-btn { background: #fff; }
    .spotify-widget.theme-dark .spotify-play-btn svg { fill: #000; }

    /* ç™½è‰²ä¸»é¢˜ */
    .spotify-widget.theme-light {
      background: #fff;
    }
    .spotify-widget.theme-light .spotify-album-label { color: #000; }
    .spotify-widget.theme-light .spotify-song-title { color: #000; }
    .spotify-widget.theme-light .spotify-artist { color: #666; }
    .spotify-widget.theme-light .spotify-heart svg { stroke: #666; }
    .spotify-widget.theme-light .spotify-progress-bar { background: #ddd; }
    .spotify-widget.theme-light .spotify-progress-fill { background: #000; }
    .spotify-widget.theme-light .spotify-progress-thumb { background: #000; }
    .spotify-widget.theme-light .spotify-time { color: #666; }
    .spotify-widget.theme-light .spotify-ctrl-btn svg { fill: #000; }
    .spotify-widget.theme-light .spotify-play-btn { background: #000; }
    .spotify-widget.theme-light .spotify-play-btn svg { fill: #fff; }

    /* å·¦ä¾§ä¸“è¾‘åŒºåŸŸ */
    .spotify-album-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 120px;
      flex-shrink: 0;
    }

    .spotify-album-label {
      font-size: 7px;
      text-align: center;
      margin-bottom: 8px;
      letter-spacing: 0.2px;
      line-height: 1.3;
      font-weight: 500;
      max-width: 100%;
      word-wrap: break-word;
      overflow-wrap: break-word;
      hyphens: auto;
      cursor: pointer;
    }

    .spotify-album-label span {
      font-style: italic;
    }

    .spotify-album-cover {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      overflow: hidden;
      flex-shrink: 0;
      cursor: pointer;
      position: relative;
    }

    .spotify-album-cover.playing {
      animation: spotifyAlbumSpin 8s linear infinite;
    }

    @keyframes spotifyAlbumSpin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .spotify-album-cover img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .spotify-album-cover .upload-hint {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.2s;
      border-radius: 50%;
    }

    .spotify-album-cover:hover .upload-hint {
      opacity: 1;
    }

    .spotify-album-cover .upload-hint svg {
      width: 24px;
      height: 24px;
      stroke: #fff;
      stroke-width: 2;
    }

    /* å³ä¾§æ§åˆ¶åŒºåŸŸ */
    .spotify-control-section {
      flex: 1;
      min-width: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .spotify-song-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2px;
    }

    .spotify-song-title {
      font-size: 20px;
      font-weight: 700;
      letter-spacing: -0.5px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      flex: 1;
      cursor: pointer;
    }

    .spotify-heart {
      background: none;
      border: none;
      cursor: pointer;
      padding: 4px;
      flex-shrink: 0;
    }

    .spotify-heart svg {
      width: 20px;
      height: 20px;
      fill: none;
      stroke-width: 1.8;
    }

    .spotify-artist {
      font-size: 13px;
      margin-bottom: 8px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      cursor: pointer;
    }

    /* è¿›åº¦æ¡ */
    .spotify-progress-wrapper {
      margin-bottom: 10px;
    }

    .spotify-progress-bar {
      width: 100%;
      height: 3px;
      border-radius: 1.5px;
      position: relative;
      cursor: pointer;
    }

    .spotify-progress-fill {
      height: 100%;
      border-radius: 1.5px;
      width: 25%;
      position: relative;
      transition: width 0.3s linear;
    }

    .spotify-progress-thumb {
      position: absolute;
      right: -6px;
      top: 50%;
      transform: translateY(-50%);
      width: 12px;
      height: 12px;
      border-radius: 50%;
    }

    .spotify-time-row {
      display: flex;
      justify-content: space-between;
      margin-top: 5px;
    }

    .spotify-time {
      font-size: 10px;
      font-weight: 400;
    }

    /* æ§åˆ¶æŒ‰é’® */
    .spotify-controls {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 22px;
    }

    .spotify-ctrl-btn {
      background: none;
      border: none;
      cursor: pointer;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .spotify-ctrl-btn svg {
      width: 22px;
      height: 22px;
    }

    .spotify-play-btn {
      width: 42px;
      height: 42px;
      border-radius: 50%;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .spotify-play-btn svg {
      width: 16px;
      height: 16px;
    }

    /* é¢œè‰²/æ•ˆæœé€‰æ‹©é¢„è§ˆ */
    .widget-color-options {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      padding: 12px;
    }

    .widget-color-option {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      padding: 8px;
      cursor: pointer;
      border-radius: 12px;
      background: var(--bg-secondary);
      border: 2px solid transparent;
      transition: all 0.2s ease;
    }

    .widget-color-option:hover {
      transform: translateY(-2px);
      border-color: var(--border-color);
      background: var(--bg-tertiary);
    }

    .widget-color-preview {
      width: 100%;
      aspect-ratio: 2/1;
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid var(--border-color);
      transition: all 0.2s ease;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    .widget-color-option:hover .widget-color-preview {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
    }

    .widget-color-label {
      font-size: 11px;
      color: var(--text-secondary);
      font-weight: 600;
      text-align: center;
    }

    /* åˆ†ç»„æ ‡é¢˜ */
    .widget-size-section-title {
      font-size: 12px;
      font-weight: 700;
      color: var(--text-secondary);
      padding: 12px 16px 8px;
      text-align: left;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .widget-size-section {
      margin-bottom: 8px;
    }

    /* ========== å°ºå¯¸é€‰æ‹©å™¨ - INSé£æ ¼ ========== */
    .widget-size-selector {
      display: flex;
      flex-direction: column;
      height: 100%;
      padding: 4px 0;
    }

    .widget-size-header {
      display: flex;
      align-items: center;
      gap: 10px;
      padding-bottom: 14px;
      border-bottom: 1px solid var(--border-color);
      margin-bottom: 16px;
    }

    /* è¿”å›æŒ‰é’® - æ–¹å½¢åœ†è§’ */
    .widget-size-back {
      width: 32px;
      height: 32px;
      border: 1px solid var(--border-color);
      background: var(--bg-secondary);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: var(--text-primary);
      transition: all 0.2s ease;
    }

    .widget-size-back:hover {
      background: var(--text-primary);
      border-color: var(--text-primary);
    }

    .widget-size-back:hover svg {
      stroke: var(--bg-primary);
    }

    .widget-size-back svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-secondary);
      stroke-width: 2;
    }

    .widget-size-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 8px;
      letter-spacing: -0.2px;
    }

    /* å›¾æ ‡å®¹å™¨ - ä½¿ç”¨SVGæ›¿ä»£emoji */
    .widget-size-icon {
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
    }

    .widget-size-icon svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-primary);
      stroke-width: 1.5;
    }

    /* å°ºå¯¸é€‰é¡¹ç½‘æ ¼ */
    .widget-size-options {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      padding: 12px;
    }

    /* å°ºå¯¸é€‰é¡¹å¡ç‰‡ */
    .widget-size-option {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      padding: 14px 12px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 14px;
      cursor: pointer;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .widget-size-option::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--text-primary);
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .widget-size-option:hover {
      border-color: var(--text-tertiary);
      background: var(--bg-tertiary);
      transform: translateY(-2px);
    }

    .widget-size-option:hover::before {
      opacity: 1;
    }

    .widget-size-option:active {
      transform: translateY(-2px) scale(0.98);
    }

    /* é€‰ä¸­çŠ¶æ€ */
    .widget-size-option.selected {
      border-color: var(--text-primary);
      background: var(--bg-tertiary);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .widget-size-option.selected::before {
      opacity: 1;
    }

    /* å°ºå¯¸é¢„è§ˆæ¡† - é»‘ç™½é£æ ¼ */
    .widget-size-preview {
      background: var(--text-primary);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 36px;
      min-height: 36px;
      max-width: 140px;
      max-height: 100px;
      position: relative;
    }

    /* åƒç´ ç½‘æ ¼è£…é¥° */
    .widget-size-preview::after {
      content: '';
      position: absolute;
      inset: 4px;
      border: 1px dashed var(--bg-primary);
      border-radius: 6px;
      opacity: 0.3;
    }

    .widget-size-preview-icon {
      font-size: 18px;
      color: var(--bg-primary);
      opacity: 0;
    }

    .widget-size-preview svg {
      width: 20px;
      height: 20px;
      stroke: var(--bg-primary);
      stroke-width: 1.5;
      opacity: 0.8;
    }

    /* å°ºå¯¸æ ‡ç­¾ */
    .widget-size-label {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
      font-family: 'SF Mono', monospace;
      letter-spacing: 0.5px;
    }

    .widget-size-desc {
      font-size: 10px;
      color: var(--text-tertiary);
      padding: 2px 8px;
      background: var(--bg-primary);
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }

    .widget-picker-item {
      position: relative;
    }

    /* ========== æ¡Œé¢ç¾åŒ–ç³»ç»Ÿæ ·å¼ç»“æŸ ========== */

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .app-icon-img {
      width: 64px;
      height: 64px;
      background: var(--bg-tertiary);
      /* border: 1px solid var(--border-color); */ /* è€ç‹æ³¨é‡Šï¼šå–æ¶ˆå›¾æ ‡è¾¹æ¡†ï¼Œæ›´ç®€æ´ */
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .app-icon-img::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, transparent 0%, var(--accent-color) 100%);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .app-icon:active .app-icon-img {
      transform: scale(0.92);
    }

    .app-icon:hover .app-icon-img {
      transform: scale(1.05);
      box-shadow: var(--shadow-md);
    }

    .app-icon:hover .app-icon-img::before {
      opacity: 0.03;
    }

    .app-icon-img svg {
      width: 32px;
      height: 32px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
      position: relative;
      z-index: 1;
    }

    /* ğŸ”¥ è‡ªå®šä¹‰å›¾æ ‡æ ·å¼ - æ”¯æŒé€æ˜åº• */
    .app-icon-img.has-custom-image {
      background: transparent !important;
      padding: 0;
      border: none !important; /* ğŸ”¥ ç§»é™¤è¾¹æ¡† */
    }

    /* ğŸ”¥ ç¦ç”¨è‡ªå®šä¹‰å›¾æ ‡çš„ä¼ªå…ƒç´ èƒŒæ™¯ */
    .app-icon-img.has-custom-image::before {
      display: none !important; /* ğŸ”¥ å½»åº•ç¦ç”¨ä¼ªå…ƒç´  */
    }

    .app-icon-img.has-custom-image img {
      width: 100%;
      height: 100%;
      object-fit: contain; /* æ”¹ä¸ºcontainï¼Œä¿æŒå›¾æ ‡å®Œæ•´æ€§ï¼Œä¸è£å‰ª */
      border-radius: inherit;
      position: relative;
      z-index: 2;
    }

    .app-label {
      font-size: 11px;
      color: var(--home-app-label-color);
      font-weight: 500;
      text-align: center;
      max-width: 72px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    /* Dock */
    .dock {
      /* ğŸ”¥ æ‚¬æµ®åº•æ  - ä¸å æ®ç©ºé—´ï¼Œæµ®åŠ¨åœ¨ä¸»å±å¹•ä¸Š */
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 100; /* ç¡®ä¿åœ¨app-gridä¹‹ä¸Š */
      height: auto;
      padding: 0 24px 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      animation: fadeInUp 0.6s ease 3.3s backwards;
      pointer-events: none; /* èƒŒæ™¯åŒºåŸŸä¸æ‹¦æˆªç‚¹å‡» */
    }

    .dock-bg {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 24px;
      padding: 12px 20px;
      display: flex;
      gap: 20px;
      backdrop-filter: blur(10px);
      pointer-events: auto; /* ğŸ”¥ æ¢å¤ç‚¹å‡»äº‹ä»¶ */
    }

    .dock-icon {
      width: 60px;
      height: 60px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .dock-icon::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, transparent 0%, var(--accent-color) 100%);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .dock-icon:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-md);
    }

    .dock-icon:hover::before {
      opacity: 0.05;
    }

    .dock-icon:active {
      transform: translateY(-2px);
    }

    .dock-icon svg {
      width: 28px;
      height: 28px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
      position: relative;
      z-index: 1;
    }

    /* ğŸ”¥ Dockè‡ªå®šä¹‰å›¾æ ‡æ ·å¼ - æ”¯æŒé€æ˜åº• */
    .dock-icon.has-custom-image {
      background: transparent !important;
      border: none !important;
      padding: 0;
    }

    /* ğŸ”¥ ç¦ç”¨Dockè‡ªå®šä¹‰å›¾æ ‡çš„ä¼ªå…ƒç´ èƒŒæ™¯ */
    .dock-icon.has-custom-image::before {
      display: none !important; /* ğŸ”¥ å½»åº•ç¦ç”¨ä¼ªå…ƒç´  */
    }

    .dock-icon.has-custom-image img {
      width: 100%;
      height: 100%;
      object-fit: contain; /* ä¿æŒå›¾æ ‡å®Œæ•´æ€§ï¼Œä¸è£å‰ª */
      border-radius: inherit;
      position: relative;
      z-index: 2;
    }

    /* Decorative Elements */
    .deco-stars {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      z-index: 1;
    }

    .star {
      position: absolute;
      width: 3px;
      height: 3px;
      background: var(--text-tertiary);
      opacity: 0.4;
      animation: starTwinkle 3s ease-in-out infinite;
    }

    .star:nth-child(1) {
      top: 15%;
      left: 10%;
      animation-delay: 0s;
    }

    .star:nth-child(2) {
      top: 25%;
      right: 15%;
      animation-delay: 1s;
    }

    .star:nth-child(3) {
      top: 60%;
      left: 20%;
      animation-delay: 2s;
    }

    .star:nth-child(4) {
      top: 70%;
      right: 10%;
      animation-delay: 1.5s;
    }

    .star:nth-child(5) {
      top: 40%;
      right: 25%;
      animation-delay: 0.5s;
    }

    @keyframes starTwinkle {
      0%, 100% {
        opacity: 0.2;
        transform: scale(1);
      }
      50% {
        opacity: 0.6;
        transform: scale(1.5);
      }
    }

    .pixel-border {
      position: absolute;
      width: 8px;
      height: 8px;
      background: var(--text-tertiary);
      opacity: 0.2;
    }

    .pixel-border:nth-child(6) {
      top: 100px;
      left: 0;
    }

    .pixel-border:nth-child(7) {
      top: 200px;
      right: 0;
    }

    .pixel-border:nth-child(8) {
      bottom: 150px;
      left: 0;
    }

    /* App Screen Base */
    /* App Screen - ç¡®ä¿å®Œå…¨è¦†ç›–æ— ç¼éš™ */
    .app-screen {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      width: 100%;
      height: 100%;
      background: var(--bg-primary);
      /* ç¡®ä¿èƒŒæ™¯å›¾ç‰‡æ­£ç¡®è¦†ç›– */
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      z-index: 8000;
      display: none;
      flex-direction: column;
      opacity: 0;
      transform: scale(0.95);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .app-screen.active {
      display: flex;
      opacity: 1;
      transform: scale(1);
    }

    /* é˜²æ­¢ç‚¹å‡»ç©¿é€ï¼šappåˆšæ‰“å¼€æ—¶çŸ­æš‚é˜»æ­¢ç‚¹å‡»äº‹ä»¶ */
    .app-screen.just-opened {
      pointer-events: none;
    }

    /* ä½†å…è®¸headerï¼ˆè¿”å›æŒ‰é’®ï¼‰å§‹ç»ˆå¯ç‚¹å‡» */
    .app-screen.just-opened > .app-header {
      pointer-events: auto;
    }

    /* X App (Twitter) Screen - Special handling */
    /* JavaScript ä¼šåŠ¨æ€è®¾ç½®ä½ç½®å’Œå°ºå¯¸ï¼Œè®©å®ƒå®Œç¾å¯¹é½æ‰‹æœºæ¡† */
    #x-social-screen {
      /* è§†è§‰æ•ˆæœ */
      z-index: 8000;
      overflow: hidden;
      box-shadow: var(--shadow-xl);

      /* éšè—çŠ¶æ€ */
      display: none !important;
      opacity: 0;
      pointer-events: none;
      visibility: hidden;

      /* å¹³æ»‘è¿‡æ¸¡ï¼ˆä¸åŒ…æ‹¬ transformï¼Œé¿å…å¹²æ‰° JS è®¾ç½®çš„ä½ç½®ï¼‰*/
      transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                  visibility 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    #x-social-screen.active {
      display: flex !important;
      opacity: 1;
      pointer-events: auto;
      visibility: visible;
    }

    /* X é¡µé¢åº•æ  - ä½¿ç”¨safe-areaå¤„ç†åº•éƒ¨å®‰å…¨åŒºåŸŸ */
    #x-social-screen.active .x-bottom-nav {
      padding-bottom: calc(8px + env(safe-area-inset-bottom, 0));
      transition: padding-bottom 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Xç§ä¿¡è¯¦æƒ…é¡µé¢è¾“å…¥æ¡† - ä½¿ç”¨safe-areaå¤„ç†åº•éƒ¨å®‰å…¨åŒºåŸŸ */
    #x-message-detail-page .message-input-area {
      padding-bottom: calc(20px + env(safe-area-inset-bottom, 0)) !important;
      transition: all 0.15s ease-out !important;
    }

    /* Xç§ä¿¡è¾“å…¥æ¡† - é”®ç›˜å¼¹èµ·æ—¶çš„å›ºå®šå®šä½ */
    #x-message-detail-page .message-input-area.keyboard-visible {
      position: fixed !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      z-index: 9999 !important;
      max-width: 430px !important;
      margin: 0 auto !important;
    }

    /* X çš„æ‰€æœ‰å…¨å±é¡µé¢ - JavaScript ä¼šåŠ¨æ€è®¾ç½®ä½ç½®å’Œå°ºå¯¸ */
    #x-askbox-page,
    #account-askbox-page,
    #x-live-page,
    #x-article-page,
    #x-message-detail-page,
    #live-room-container,
    #x-map-container {
      width: 100% !important; /* ä¿®å¤ï¼šä½¿ç”¨ 100% é¿å…æ»šåŠ¨æ¡å®½åº¦å¯¼è‡´åç§» */
      height: var(--app-height) !important;
      max-width: none !important;
      max-height: none !important;
      overflow: hidden !important;
      box-shadow: none !important;
      border-radius: 0 !important;
    }

    /* App Header */
    .app-header {
      /* ğŸ”¥ ä½¿ç”¨å…¨å±€App Header paddingå˜é‡ */
      padding: var(--app-header-total-padding) 16px 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid var(--border-color);
      background: var(--bg-primary);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .app-back-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .app-back-btn:hover {
      background: var(--hover-bg);
      transform: scale(1.05);
    }

    .app-back-btn:active {
      transform: scale(0.95);
    }

    .app-title {
      font-size: 16px;
      font-weight: 600;
      letter-spacing: -0.01em;
    }

    .app-header-actions {
      width: 36px;
    }

    /* App Content */
    /* App Content - ç¡®ä¿èƒŒæ™¯å®Œå…¨è¦†ç›–æ— ç¼éš™ */
    .app-content {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      /* ğŸ”¥ é»˜è®¤ä½¿ç”¨å…¨å±€App Header paddingå˜é‡ */
      padding-top: var(--app-header-total-padding);
      scrollbar-width: none;
      /* ç¡®ä¿èƒŒæ™¯å›¾ç‰‡æ­£ç¡®è¦†ç›– */
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-origin: border-box;
    }

    .app-content::-webkit-scrollbar {
      display: none;
    }

    /* ğŸ”¥ chatScreençš„app-contentä¸éœ€è¦padding-topï¼ˆå› ä¸ºchat-app-headeræœ‰è‡ªå·±çš„paddingï¼‰ */
    #chatScreen > .app-content {
      padding-top: 0;
      padding-bottom: 80px;
    }

    /* Blog App Styles */
    .blog-post-card {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      padding: 20px;
      margin-bottom: 16px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .blog-post-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--accent-color) 0%, transparent 100%);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .blog-post-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-md);
    }

    .blog-post-card:hover::before {
      opacity: 0.6;
    }

    .blog-post-meta {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
      font-size: 11px;
      color: var(--text-tertiary);
      font-family: 'JetBrains Mono', monospace;
    }

    .blog-post-meta-dot {
      width: 3px;
      height: 3px;
      background: var(--text-tertiary);
      border-radius: 50%;
    }

    .blog-post-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 8px;
      letter-spacing: -0.02em;
      color: var(--text-primary);
    }

    .blog-post-excerpt {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.6;
      margin-bottom: 12px;
    }

    .blog-post-tags {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .blog-tag {
      padding: 4px 10px;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 10px;
      font-weight: 500;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* Profile App Styles */
    .profile-header-card {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 24px;
      padding: 24px;
      margin-bottom: 20px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .profile-header-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 100px;
      background: linear-gradient(135deg, var(--accent-color) 0%, transparent 100%);
      opacity: 0.03;
    }

    .profile-avatar-large {
      width: 96px;
      height: 96px;
      border-radius: 24px;
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      margin: 0 auto 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 40px;
      font-weight: 600;
      position: relative;
      overflow: hidden;
    }

    .profile-avatar-large::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      animation: shine 3s infinite;
    }

    .profile-name {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 6px;
      letter-spacing: -0.02em;
    }

    .profile-username {
      font-size: 13px;
      color: var(--text-secondary);
      font-family: 'JetBrains Mono', monospace;
      margin-bottom: 16px;
    }

    .profile-bio-text {
      font-size: 14px;
      color: var(--text-secondary);
      line-height: 1.6;
      margin-bottom: 16px;
    }

    .profile-stats-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 20px;
    }

    .profile-stat-item {
      text-align: center;
      padding: 16px;
      background: var(--bg-primary);
      border-radius: 16px;
      border: 1px solid var(--border-color);
      transition: all 0.2s ease;
    }

    .profile-stat-item:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-sm);
    }

    .profile-stat-value {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .profile-stat-label {
      font-size: 11px;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .profile-section {
      margin-bottom: 20px;
    }

    .profile-section-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 12px;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .profile-link-card {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .profile-link-card:hover {
      background: var(--hover-bg);
      transform: translateX(4px);
    }

    .profile-link-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .profile-link-icon {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .profile-link-icon svg {
      width: 18px;
      height: 18px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    .profile-link-text {
      font-size: 14px;
      font-weight: 500;
    }

    /* Mail App Styles */
    .mail-item {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      position: relative;
    }

    .mail-item.unread {
      background: var(--bg-secondary);
      border-left: 3px solid var(--accent-color);
    }

    .mail-item:hover {
      transform: translateX(4px);
      box-shadow: var(--shadow-sm);
    }

    .mail-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 8px;
    }

    .mail-sender {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .mail-time {
      font-size: 11px;
      color: var(--text-tertiary);
      font-family: 'JetBrains Mono', monospace;
    }

    .mail-subject {
      font-size: 13px;
      color: var(--text-primary);
      margin-bottom: 6px;
      font-weight: 500;
    }

    .mail-preview {
      font-size: 12px;
      color: var(--text-secondary);
      line-height: 1.5;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }

    /* TV App Styles */
    .tv-player {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      aspect-ratio: 16/9;
      margin-bottom: 20px;
      position: relative;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .tv-player::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: repeating-linear-gradient(
        0deg,
        var(--bg-tertiary) 0px,
        var(--border-color) 2px,
        var(--bg-tertiary) 4px
      );
      opacity: 0.1;
      animation: tvScanlines 8s linear infinite;
    }

    @keyframes tvScanlines {
      0% { transform: translateY(0); }
      100% { transform: translateY(20px); }
    }

    .tv-play-btn {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background: var(--accent-color);
      border: 2px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 1;
    }

    .tv-play-btn:hover {
      transform: scale(1.1);
      box-shadow: var(--shadow-lg);
    }

    .tv-play-btn svg {
      width: 28px;
      height: 28px;
      stroke: var(--bg-primary);
      fill: var(--bg-primary);
      stroke-width: 2;
    }

    .tv-controls {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      margin-bottom: 20px;
    }

    .tv-control-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .tv-control-btn:hover {
      background: var(--hover-bg);
      transform: scale(1.05);
    }

    .tv-control-btn svg {
      width: 18px;
      height: 18px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    .tv-video-list {
      display: grid;
      gap: 12px;
    }

    .tv-video-card {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 12px;
      display: flex;
      gap: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .tv-video-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-sm);
    }

    .tv-video-thumb {
      width: 100px;
      height: 60px;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .tv-video-thumb svg {
      width: 20px;
      height: 20px;
      stroke: var(--text-secondary);
      fill: none;
      stroke-width: 2;
    }

    .tv-video-info {
      flex: 1;
    }

    .tv-video-title {
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 4px;
      color: var(--text-primary);
    }

    .tv-video-meta {
      font-size: 11px;
      color: var(--text-tertiary);
      font-family: 'JetBrains Mono', monospace;
    }

    /* Settings App Styles */
    .settings-header-section {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 28px;
      animation: slideDown 0.6s ease;
    }

    .settings-logo-area {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .settings-logo-icon {
      width: 40px;
      height: 40px;
      background: var(--accent-color);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--bg-primary);
    }

    .settings-logo-icon svg {
      width: 20px;
      height: 20px;
      stroke: var(--bg-primary);
      fill: none;
      stroke-width: 2;
    }

    .settings-logo-text {
      font-size: 18px;
      font-weight: 600;
      letter-spacing: -0.02em;
    }

    .settings-header-actions {
      display: flex;
      gap: 8px;
    }

    .settings-icon-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .settings-icon-btn:hover {
      background: var(--hover-bg);
      transform: scale(1.05);
    }

    .settings-icon-btn svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }


    /* ==================== å¤šå¼€èŠå¤©æ¡†æ ·å¼ V2 - INSç®€çº¦é£ ==================== */

    /* èŠå¤©æ¡†å¡ç‰‡ */
    .chat-session-card-v2 {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 16px;
      background: var(--bg-secondary);
      border: 1.5px solid var(--border-color);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .chat-session-card-v2::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      width: 3px;
      height: 100%;
      background: transparent;
      transition: all 0.25s ease;
    }

    .chat-session-card-v2:hover {
      border-color: var(--text-tertiary);
      transform: translateX(2px);
    }

    .chat-session-card-v2.active {
      background: var(--bg-primary);
      border-color: var(--text-primary);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    .chat-session-card-v2.active::before {
      background: var(--text-primary);
    }

    /* å·¦ä¾§å†…å®¹åŒº */
    .chat-session-left {
      display: flex;
      align-items: center;
      gap: 12px;
      flex: 1;
      min-width: 0;
    }

    /* å›¾æ ‡ */
    .chat-session-icon-v2 {
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-tertiary);
      border-radius: 10px;
      flex-shrink: 0;
      transition: all 0.2s ease;
    }

    .chat-session-icon-v2 svg {
      width: 18px;
      height: 18px;
      stroke: var(--text-secondary);
      fill: none;
      stroke-width: 2;
      transition: stroke 0.2s ease;
    }

    .chat-session-card-v2:hover .chat-session-icon-v2 {
      background: var(--bg-primary);
    }

    .chat-session-card-v2:hover .chat-session-icon-v2 svg {
      stroke: var(--text-primary);
    }

    .chat-session-card-v2.active .chat-session-icon-v2 {
      background: var(--bg-secondary);
    }

    .chat-session-card-v2.active .chat-session-icon-v2 svg {
      stroke: var(--text-primary);
    }

    /* ä¿¡æ¯åŒº */
    .chat-session-info-v2 {
      flex: 1;
      min-width: 0;
    }

    .chat-session-name-v2 {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 2px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .chat-session-meta-v2 {
      font-size: 11px;
      color: var(--text-tertiary);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    /* æ“ä½œæŒ‰é’®å®¹å™¨ */
    .chat-session-actions-v2 {
      display: flex;
      align-items: center;
      gap: 6px;
      flex-shrink: 0;
    }

    /* æ“ä½œæŒ‰é’®å›¾æ ‡ */
    .session-action-icon {
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: transparent;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      padding: 0;
      position: relative;
    }

    .session-action-icon svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-tertiary);
      fill: none;
      stroke-width: 2;
      transition: all 0.2s ease;
    }

    .session-action-icon:hover {
      background: var(--bg-tertiary);
    }

    .session-action-icon:hover svg {
      stroke: var(--text-secondary);
    }

    .session-action-icon:active {
      transform: scale(0.95);
    }

    /* åŒæ­¥æŒ‰é’®ç‰¹æ®Šæ ·å¼ */
    .session-action-icon[data-synced="false"] .sync-icon {
      fill: none;
      stroke: var(--text-tertiary);
    }

    .session-action-icon[data-synced="true"] .sync-icon {
      fill: var(--text-primary);
      stroke: var(--text-primary);
    }

    .session-action-icon[data-synced="false"]:hover .sync-icon {
      stroke: var(--text-secondary);
      fill: none;
    }

    .session-action-icon[data-synced="true"]:hover {
      background: var(--bg-secondary);
    }

    .session-action-icon[data-synced="true"]:hover .sync-icon {
      fill: var(--text-primary);
      stroke: var(--text-primary);
    }

    /* åˆ é™¤æŒ‰é’® */
    .session-action-icon.delete svg {
      stroke: var(--text-tertiary);
    }

    .session-action-icon.delete:hover {
      background: rgba(239, 68, 68, 0.1);
    }

    .session-action-icon.delete:hover svg {
      stroke: #ef4444;
    }

    /* Darkä¸»é¢˜ä¼˜åŒ– */
    [data-theme='dark'] .chat-session-card-v2 {
      background: #151515;
      border-color: #2a2a2a;
    }

    [data-theme='dark'] .chat-session-card-v2:hover {
      border-color: #404040;
    }

    [data-theme='dark'] .chat-session-card-v2.active {
      background: #141414;
      border-color: #505050;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.3);
    }

    [data-theme='dark'] .chat-session-icon-v2 {
      background: #1f1f1f;
    }

    [data-theme='dark'] .chat-session-card-v2:hover .chat-session-icon-v2 {
      background: #252525;
    }

    [data-theme='dark'] .chat-session-card-v2.active .chat-session-icon-v2 {
      background: #202020;
    }

    [data-theme='dark'] .session-action-icon:hover {
      background: #202020;
    }

    /* Lightä¸»é¢˜ä¼˜åŒ– */
    [data-theme='light'] .chat-session-card-v2 {
      background: #ffffff;
      border-color: #e5e5e5;
    }

    [data-theme='light'] .chat-session-card-v2:hover {
      border-color: #d4d4d4;
    }

    [data-theme='light'] .chat-session-card-v2.active {
      background: #fafafa;
      border-color: #a3a3a3;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    [data-theme='light'] .chat-session-icon-v2 {
      background: #fafafa;
    }

    [data-theme='light'] .chat-session-card-v2:hover .chat-session-icon-v2 {
      background: #ffffff;
    }

    [data-theme='light'] .chat-session-card-v2.active .chat-session-icon-v2 {
      background: #f5f5f5;
    }

    [data-theme='light'] .session-action-icon:hover {
      background: #fafafa;
    }

    /* ==================== å¤šå¼€èŠå¤©æ¡†æ ·å¼ç»“æŸ ==================== */

    .settings-section {
      margin-bottom: 28px;
    }

    .settings-section-header {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-secondary);
      margin-bottom: 12px;
      padding-left: 4px;
      position: relative;
    }

    .settings-section-header::before {
      content: '';
      position: absolute;
      left: -12px;
      top: 50%;
      transform: translateY(-50%);
      width: 4px;
      height: 4px;
      background: var(--accent-color);
      border-radius: 50%;
    }

    .settings-card {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 12px;
      transition: all 0.2s ease;
      position: relative;
      overflow: hidden;
    }

    .settings-card::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, transparent, var(--accent-color));
      opacity: 0.02;
      border-radius: 0 16px 0 100%;
    }

    .settings-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-sm);
    }

    .settings-input-group {
      margin-bottom: 16px;
    }

    .settings-input-group:last-child {
      margin-bottom: 0;
    }

    .settings-label {
      display: block;
      font-size: 13px;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 8px;
      font-family: inherit;
    }

    .settings-input,
    .settings-textarea,
    .settings-select {
      width: 100%;
      padding: 12px;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      font-size: 13px;
      color: var(--text-primary);
      font-family: inherit;
      transition: all 0.2s ease;
      resize: none;
    }

    .settings-textarea {
      min-height: 120px;
      line-height: 1.6;
      font-family: inherit;
    }

    .settings-input:focus,
    .settings-textarea:focus,
    .settings-select:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 3px rgba(42, 42, 42, 0.05);
    }

    [data-theme='dark'] .settings-input:focus,
    [data-theme='dark'] .settings-textarea:focus,
    [data-theme='dark'] .settings-select:focus {
      box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.05);
    }

    .settings-btn-group {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }

    .settings-btn {
      flex: 1;
      padding: 10px 16px;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      font-size: 12px;
      font-weight: 500;
      color: var(--text-primary);
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: 'Inter', sans-serif;
      text-align: center;
    }

    .settings-btn.primary {
      background: var(--accent-color);
      color: var(--bg-primary);
      border-color: var(--accent-color);
    }

    .settings-btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-sm);
    }

    .settings-btn:active {
      transform: translateY(0);
    }

    /* æ•°æ®ç®¡ç†åŒºåŸŸæ ·å¼ */
    .data-management-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
    }

    .data-management-info {
      flex: 1;
      margin-right: 16px;
    }

    .data-management-title {
      display: flex;
      align-items: center;
      font-size: 13px;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .data-management-title svg {
      stroke: var(--text-secondary);
      flex-shrink: 0;
    }

    .data-management-desc {
      font-size: 11px;
      color: var(--text-tertiary);
      line-height: 1.4;
    }

    .data-management-divider {
      height: 1px;
      background: var(--border-color);
      margin: 4px 0;
    }

    .data-management-item .settings-btn {
      flex: 0 0 auto;
      min-width: 60px;
    }

    .knowledge-item {
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 12px;
      margin-bottom: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.2s ease;
      cursor: pointer;
    }

    .knowledge-item:hover {
      background: var(--hover-bg);
      transform: translateX(4px);
    }

    .knowledge-item-info {
      flex: 1;
    }

    .knowledge-item-name {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .knowledge-item-category {
      font-size: 11px;
      color: var(--text-tertiary);
      font-family: 'JetBrains Mono', monospace;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .knowledge-item-actions {
      display: flex;
      gap: 8px;
    }

    .knowledge-item-btn {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .knowledge-item-btn:hover {
      background: var(--hover-bg);
      transform: scale(1.05);
    }

    .knowledge-item-btn svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    .preset-selector {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-bottom: 12px;
      /* ğŸ”¥ ã€è€ç‹ä¿®å¤ã€‘è¦†ç›–çˆ¶å®¹å™¨çš„overflow:hiddenï¼Œç¡®ä¿æŒ‰é’®çƒ­åŒºä¸è¢«è£å‰ª */
      overflow: visible;
      position: relative;
      z-index: 1;
    }

    .preset-selector select {
      flex: 1;
    }

    .preset-manager-btn {
      /* ğŸ”¥ ã€è€ç‹ä¼˜åŒ–ã€‘å¢å¤§æŒ‰é’®åˆ°44pxï¼ˆiOSæœ€ä½³è§¦æ‘¸å°ºå¯¸ï¼‰ */
      width: 44px;
      height: 44px;
      border-radius: 12px;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      flex-shrink: 0;
      /* ğŸ”¥ ç¡®ä¿ä¸è¢«é®æŒ¡ */
      position: relative;
      z-index: 10;
      /* ğŸ”¥ ç¡®ä¿ç‚¹å‡»äº‹ä»¶æœ‰æ•ˆ */
      pointer-events: auto;
    }

    /* ğŸ”¥ ã€è€ç‹æ–°å¢ã€‘æ‰©å¤§ç‚¹å‡»çƒ­åŒºï¼ˆè§†è§‰44pxï¼Œå®é™…è§¦æ‘¸åŒºåŸŸ52pxï¼‰ */
    .preset-manager-btn::before {
      content: '';
      position: absolute;
      top: -4px;
      left: -4px;
      right: -4px;
      bottom: -4px;
      /* ç”¨äºè°ƒè¯•æ—¶å¯è§†åŒ–çƒ­åŒºï¼ˆç”Ÿäº§ç¯å¢ƒæ³¨é‡Šæ‰ï¼‰
      background: rgba(255, 0, 0, 0.1);
      */
    }

    .preset-manager-btn:hover {
      background: var(--hover-bg);
      transform: scale(1.05);
    }

    /* ğŸ”¥ ç‚¹å‡»æ—¶è§†è§‰åé¦ˆ */
    .preset-manager-btn:active {
      transform: scale(0.95);
      opacity: 0.7;
    }

    .preset-manager-btn svg {
      width: 18px;
      height: 18px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
      /* ğŸ”¥ ç¡®ä¿SVGä¸é˜»æ­¢ç‚¹å‡» */
      pointer-events: none;
    }

    .empty-state {
      text-align: center;
      padding: 32px 16px;
      color: var(--text-tertiary);
    }

    .empty-state-icon {
      width: 48px;
      height: 48px;
      margin: 0 auto 12px;
      opacity: 0.3;
    }

    .empty-state-text {
      font-size: 13px;
      line-height: 1.6;
    }

    /* Irregular Modal/Popup Styles */
    .irregular-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.95);
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      padding: 24px;
      z-index: 9500;
      min-width: 280px;
      max-width: 90%;
      box-shadow: var(--shadow-xl);
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
      transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                  transform 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                  visibility 0s 0.3s;
      /* Irregular shape using clip-path */
      clip-path: polygon(
        0 8px,
        8px 0,
        calc(100% - 8px) 0,
        100% 8px,
        100% calc(100% - 8px),
        calc(100% - 8px) 100%,
        8px 100%,
        0 calc(100% - 8px)
      );
    }

    .irregular-modal.active {
      opacity: 1;
      visibility: visible;
      pointer-events: auto;
      transform: translate(-50%, -50%) scale(1);
      transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                  transform 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                  visibility 0s 0s;
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(4px);
      z-index: 9400;
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
      transition: opacity 0.3s ease, visibility 0s 0.3s;
    }

    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
      pointer-events: auto;
      transition: opacity 0.3s ease, visibility 0s 0s;
    }

    .modal-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 12px;
      letter-spacing: -0.02em;
    }

    .modal-content {
      font-size: 14px;
      color: var(--text-secondary);
      line-height: 1.6;
      margin-bottom: 20px;
    }

    .modal-actions {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
    }

    .modal-btn {
      padding: 10px 20px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .modal-btn.primary {
      background: var(--accent-color);
      color: var(--bg-primary);
      border-color: var(--accent-color);
    }

    .modal-btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-sm);
    }

    /* ==================== New Contact Sheet - æ–°å»ºè”ç³»äººåº•éƒ¨æŠ½å±‰ ==================== */
    .new-contact-sheet-overlay {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      z-index: 200;
      display: flex;
      align-items: flex-end;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .new-contact-sheet-overlay.active {
      opacity: 1;
      pointer-events: all;
    }

    .new-contact-sheet {
      width: 100%;
      max-height: 85vh;
      background: var(--bg-primary);
      border-radius: 24px 24px 0 0;
      padding: 0;
      transform: translateY(100%);
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      flex-direction: column;
      box-shadow: 0 -8px 32px rgba(0, 0, 0, 0.3);
    }

    .new-contact-sheet-overlay.active .new-contact-sheet {
      transform: translateY(0);
    }

    .new-contact-sheet-header {
      padding: 16px 20px 12px;
      border-bottom: 1px solid var(--border-color);
      flex-shrink: 0;
      text-align: center;
    }

    .new-contact-sheet-handle {
      width: 40px;
      height: 4px;
      background: var(--text-tertiary);
      border-radius: 2px;
      margin: 0 auto 16px;
      opacity: 0.6;
    }

    .new-contact-sheet-title {
      font-family: 'Inter', sans-serif;
      font-size: 18px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .new-contact-sheet-subtitle {
      font-family: 'JetBrains Mono', monospace;
      font-size: 11px;
      color: var(--text-secondary);
      letter-spacing: 0.5px;
      text-transform: uppercase;
    }

    .new-contact-sheet-content {
      padding: 20px;
      overflow-y: auto;
      flex: 1;
    }

    /* Avatar Section */
    .new-contact-avatar-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 24px;
    }

    .new-contact-avatar {
      width: 88px;
      height: 88px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 3px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      overflow: hidden;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .new-contact-avatar:hover {
      border-color: var(--accent-color);
      transform: scale(1.08);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }

    .new-contact-avatar svg {
      width: 44px;
      height: 44px;
      stroke: var(--text-tertiary);
      fill: none;
      stroke-width: 1.5;
    }

    .new-contact-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .new-contact-avatar-hint {
      margin-top: 10px;
      font-size: 12px;
      color: var(--text-tertiary);
    }

    /* Input Groups */
    .new-contact-input-group {
      margin-bottom: 16px;
    }

    .new-contact-label {
      display: block;
      font-size: 12px;
      font-weight: 500;
      color: var(--text-secondary);
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .new-contact-input {
      width: 100%;
      padding: 14px 16px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      font-size: 15px;
      color: var(--text-primary);
      transition: all 0.2s ease;
      box-sizing: border-box;
    }

    .new-contact-input:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 3px rgba(var(--accent-color-rgb), 0.1);
    }

    .new-contact-input.readonly {
      background: var(--bg-secondary);
      color: var(--text-secondary);
      cursor: default;
    }

    .new-contact-input::placeholder {
      color: var(--text-tertiary);
    }

    /* Persona Info Box */
    .new-contact-persona-info,
    .new-contact-character-info {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 16px;
      margin-top: 16px;
    }

    .new-contact-persona-title {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 12px;
    }

    .new-contact-persona-title svg {
      stroke: var(--text-secondary);
      fill: none;
      stroke-width: 2;
    }

    .new-contact-persona-content {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.7;
    }

    .new-contact-persona-content .persona-item {
      display: flex;
      margin-bottom: 6px;
    }

    .new-contact-persona-content .persona-label {
      color: var(--text-tertiary);
      min-width: 65px;
      flex-shrink: 0;
    }

    .new-contact-persona-content .persona-value {
      color: var(--text-primary);
    }

    .new-contact-persona-note {
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid var(--border-color);
      font-size: 11px;
      color: var(--text-tertiary);
      line-height: 1.6;
    }

    .new-contact-character-name {
      font-size: 15px;
      font-weight: 500;
      color: var(--text-primary);
    }

    /* Bottom Actions */
    .new-contact-sheet-actions {
      display: flex;
      gap: 12px;
      padding: 16px 20px 24px;
      border-top: 1px solid var(--border-color);
      background: var(--bg-primary);
    }

    .new-contact-sheet-btn {
      flex: 1;
      padding: 14px 20px;
      border-radius: 14px;
      font-size: 15px;
      font-weight: 600;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .new-contact-sheet-btn.cancel {
      background: var(--bg-tertiary);
      color: var(--text-secondary);
      border: 1px solid var(--border-color);
    }

    .new-contact-sheet-btn.cancel:hover {
      background: var(--bg-secondary);
    }

    .new-contact-sheet-btn.primary {
      background: var(--accent-color);
      color: #fff;
      border: none;
    }

    .new-contact-sheet-btn.primary:hover {
      opacity: 0.9;
      transform: translateY(-1px);
    }

    /* Dark mode adjustments */
    [data-theme="dark"] .new-contact-sheet-overlay {
      background: rgba(0, 0, 0, 0.8);
    }

    [data-theme="dark"] .new-contact-input.readonly {
      background: rgba(255, 255, 255, 0.03);
    }

    [data-theme="dark"] .new-contact-sheet-btn.primary {
      color: #000;
    }
    /* ==================== End New Contact Sheet ==================== */

    /* Icon Management Modal Styles */
    .icon-management-content {
      max-height: 60vh;
      overflow-y: auto;
      padding: 4px;
    }

    .icon-mgmt-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 16px;
    }

    @media (max-width: 600px) {
      .icon-mgmt-grid {
        grid-template-columns: 1fr;
      }
    }

    .icon-mgmt-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 16px 4px 16px 4px;
      padding: 16px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .icon-mgmt-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
      border-color: var(--text-tertiary);
    }

    .icon-mgmt-preview {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 12px;
    }

    .icon-mgmt-preview-icon {
      width: 56px;
      height: 56px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-tertiary);
      border: 2px solid var(--border-color);
      border-radius: 14px 2px 14px 2px;
      transition: all 0.2s ease;
    }

    .icon-mgmt-preview-icon svg {
      width: 32px;
      height: 32px;
      fill: none;
      stroke: var(--text-primary);
      stroke-width: 1.5;
    }

    .icon-mgmt-preview-icon.has-custom-image {
      padding: 0;
      border: none !important; /* ğŸ”¥ å¼ºåˆ¶ç§»é™¤è¾¹æ¡† */
      background: transparent !important; /* ğŸ”¥ æ”¯æŒé€æ˜åº• */
    }

    .icon-mgmt-preview-icon.has-custom-image img {
      width: 100%;
      height: 100%;
      object-fit: contain; /* ğŸ”¥ æ”¹ä¸ºcontainï¼Œä¿æŒå›¾æ ‡å®Œæ•´æ€§ï¼Œä¸è£å‰ª */
      border-radius: 14px 2px 14px 2px;
      position: relative;
      z-index: 2;
    }

    .icon-mgmt-preview-icon.dock-icon-preview {
      background: var(--accent-color);
      border-color: var(--accent-color);
    }

    .icon-mgmt-preview-icon.dock-icon-preview svg {
      fill: var(--bg-primary);
      stroke: none;
    }

    .icon-mgmt-name {
      font-size: 14px;
      font-weight: 500;
      text-align: center;
      margin-bottom: 12px;
      color: var(--text-primary);
      /* å¯ç‚¹å‡»ç¼–è¾‘ */
      cursor: pointer;
      padding: 4px 8px;
      border-radius: 4px;
      border: 1px solid transparent;
      transition: all 0.2s ease;
      min-width: 60px;
    }

    .icon-mgmt-name:hover {
      background: var(--bg-tertiary);
      border-color: var(--border-color);
    }

    /* ç¼–è¾‘æ¨¡å¼ */
    .icon-mgmt-name.editing {
      background: var(--bg-primary);
      border-color: var(--accent-color);
      outline: none;
      box-shadow: 0 0 0 2px rgba(var(--accent-rgb, 255,255,255), 0.2);
    }

    .icon-mgmt-name-hint {
      font-size: 10px;
      color: var(--text-tertiary);
      text-align: center;
      margin-top: -8px;
      margin-bottom: 8px;
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .icon-mgmt-card:hover .icon-mgmt-name-hint {
      opacity: 1;
    }

    .icon-mgmt-controls {
      display: flex;
      gap: 6px;
      align-items: center;
      flex-wrap: wrap;
    }

    .icon-mgmt-btn {
      width: 32px;
      height: 32px;
      min-width: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 8px 2px 8px 2px;
      cursor: pointer;
      transition: all 0.2s ease;
      padding: 0;
    }

    .icon-mgmt-btn svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-secondary);
    }

    .icon-mgmt-btn:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-sm);
      border-color: var(--text-tertiary);
    }

    .icon-mgmt-btn:active {
      transform: translateY(0);
    }

    .icon-mgmt-btn.upload:hover {
      background: var(--accent-color);
      border-color: var(--accent-color);
    }

    .icon-mgmt-btn.upload:hover svg {
      stroke: var(--bg-primary);
    }

    .icon-mgmt-btn.apply {
      background: rgba(76, 175, 80, 0.1);
      border-color: rgba(76, 175, 80, 0.3);
    }

    .icon-mgmt-btn.apply:hover {
      background: rgb(76, 175, 80);
      border-color: rgb(76, 175, 80);
    }

    .icon-mgmt-btn.apply:hover svg {
      stroke: white;
    }

    .icon-mgmt-btn.restore {
      background: rgba(244, 67, 54, 0.1);
      border-color: rgba(244, 67, 54, 0.3);
    }

    .icon-mgmt-btn.restore:hover {
      background: rgb(244, 67, 54);
      border-color: rgb(244, 67, 54);
    }

    .icon-mgmt-btn.restore:hover svg {
      stroke: white;
    }

    .icon-mgmt-url-input {
      flex: 1;
      min-width: 0;
      padding: 6px 10px;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 8px 2px 8px 2px;
      font-size: 12px;
      color: var(--text-primary);
      transition: all 0.2s ease;
      outline: none;
    }

    .icon-mgmt-url-input:focus {
      border-color: var(--accent-color);
      box-shadow: 0 0 0 2px rgba(var(--accent-rgb), 0.1);
    }

    .icon-mgmt-url-input::placeholder {
      color: var(--text-tertiary);
    }

    /* Icon Management Modal - æ–°æ ·å¼ (ä¸Typography Modalç»Ÿä¸€) */
    .icon-management-modal .wallpaper-container {
      max-height: 85vh;
    }

    .icon-management-container .typography-section {
      padding: 40px 20px 24px 20px;
    }

    .icon-management-container .typography-section:not(:last-child) {
      border-bottom: 1px solid var(--border-color);
    }

    .icon-management-container .icon-mgmt-grid {
      margin-top: 16px;
    }

    /* å“åº”å¼è°ƒæ•´ */
    @media (max-width: 768px) {
      .icon-management-container .icon-mgmt-grid {
        grid-template-columns: 1fr;
        gap: 12px;
      }
    }

    /* Scrollbar styling for icon management */
    .icon-management-content::-webkit-scrollbar {
      width: 6px;
    }

    .icon-management-content::-webkit-scrollbar-track {
      background: var(--bg-secondary);
      border-radius: 3px;
    }

    .icon-management-content::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 3px;
    }

    .icon-management-content::-webkit-scrollbar-thumb:hover {
      background: var(--text-tertiary);
    }

    /* Modal subtitle style */
    .modal-subtitle {
      font-size: 13px;
      color: var(--text-secondary);
      margin-top: 4px;
      margin-bottom: 16px;
    }

    /* Dynamic Island - iOS Style (åœ¨æ‰‹æœºæ¡†å†…éƒ¨) */
    .dynamic-island {
      position: absolute;
      /* è€ƒè™‘safe-areaè®©Dynamic Islandåœ¨æ­£ç¡®ä½ç½®æ˜¾ç¤º */
      top: calc(8px + env(safe-area-inset-top, 0));
      left: 50%;
      transform: translateX(-50%);
      /* ä½¿ç”¨æ‰‹æœºé¢œè‰²ä¸“ç”¨å˜é‡ï¼Œä¸å—ä¸»é¢˜å½±å“ */
      background: var(--phone-island-color);
      border-radius: 20px;
      /* ä¿æŒåœ¨æ‰€æœ‰å…¨å±æ¯›ç»ç’ƒé®ç½©ï¼ˆå¦‚ç»„ä»¶é€‰æ‹©å™¨ï¼‰ä¹‹ä¸Šï¼Œé¿å…è¢«æ¨¡ç³Šé®æŒ¡ */
      z-index: 30010;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      overflow: hidden;
      /* ä½¿ç”¨width/heightè¿‡æ¸¡ï¼Œé…åˆcubic-bezierå®ç°æµç•…åŠ¨ç”» */
      transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1),
                  height 0.5s cubic-bezier(0.4, 0, 0.2, 1),
                  border-radius 0.5s cubic-bezier(0.4, 0, 0.2, 1),
                  padding 0.5s cubic-bezier(0.4, 0, 0.2, 1),
                  opacity 0.3s ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      width: 160px;
      height: 32px;
      opacity: 1;
    }

    .dynamic-island.compact {
      width: 130px;
      height: 28px;
      border-radius: 16px;
      padding: 0;
    }

    .dynamic-island.expanded {
      width: 220px;
      height: 70px;
      border-radius: 20px;
      padding: 12px 16px;
    }

    .dynamic-island.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .island-content {
      display: flex;
      align-items: center;
      gap: 10px;
      opacity: 0;
      transition: opacity 0.25s ease 0.15s;
      width: 100%;
    }

    .dynamic-island.expanded .island-content {
      opacity: 1;
    }

    .island-icon {
      width: 36px;
      height: 36px;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .island-icon svg {
      width: 18px;
      height: 18px;
      /* å§‹ç»ˆä½¿ç”¨ç™½è‰²å›¾æ ‡ */
      stroke: #ffffff;
      fill: none;
      stroke-width: 2;
    }

    .island-text-wrapper {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 3px;
    }

    .island-title {
      font-size: 13px;
      font-weight: 600;
      /* å§‹ç»ˆä½¿ç”¨ç™½è‰²æ–‡å­— */
      color: #ffffff;
      line-height: 1.2;
    }

    .island-subtitle {
      font-size: 11px;
      /* å§‹ç»ˆä½¿ç”¨åŠé€æ˜ç™½è‰² */
      color: rgba(255, 255, 255, 0.8);
      line-height: 1.2;
    }

    [data-theme='dark'] .island-subtitle {
      color: rgba(255, 255, 255, 0.75);
    }

    /* Responsive Design - å¤§å±å¹•æ ·å¼ï¼ˆæ¡Œé¢ç«¯æŸ¥çœ‹æ—¶æœ‰åœ†è§’æ•ˆæœï¼‰*/
    @media (min-width: 431px) {
      body {
        padding: 20px;
      }

      .phone-container {
        border-radius: 48px;
        border: 12px solid var(--phone-frame-color);
      }

      .phone-frame {
        border-radius: 36px;
      }

      .screen {
        border-radius: 36px;
      }

      .home-screen,
      .boot-screen {
        border-radius: 36px;
      }

      .app-screen {
        border-radius: 36px;
      }

      .char-profile-overlay {
        border-radius: 36px;
      }
    }

    @media (max-width: 430px) {
      .clock-time {
        font-size: 64px;
      }

      .app-grid {
        gap: 16px;
        padding: 16px;
      }

      .app-icon-img {
        width: 58px;
        height: 58px;
      }

      .dock-icon {
        width: 56px;
        height: 56px;
      }
    }

    /* æ›´å°å±ï¼ˆå¦‚ 320/360 å®½ï¼‰ï¼šè¿›ä¸€æ­¥æ”¶ç´§é—´è·ä¸å›¾æ ‡å°ºå¯¸ï¼Œç¡®ä¿å››åˆ—ç¨³å®šä¸”ä¸æº¢å‡º */
    @media (max-width: 360px) {
      .app-grid {
        gap: 12px;
        padding: 12px;
      }

      .app-icon-img {
        width: 52px;
        height: 52px;
      }

      .dock-icon {
        width: 50px;
        height: 50px;
      }

      .app-label {
        max-width: 64px;
      }
    }

    /* ==========================================
     * æ’ç‰ˆç®¡ç†Modalæ ·å¼ - Typography Management
     * INSç®€çº¦é£æ ¼ + é»‘ç™½ç°é…è‰² + ç²¾è‡´åŠ¨æ•ˆ
     * ========================================== */

    /* æ’ç‰ˆåŒºåŸŸ */
    .typography-section {
      padding: 20px;
      animation: fadeIn 0.6s ease;
    }

    .typography-section-header {
      display: flex;
      align-items: center;
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 16px;
      font-family: 'Inter', sans-serif;
    }

    /* ä¸»é¢˜åˆ‡æ¢å¡ç‰‡ç½‘æ ¼ */
    .theme-toggle-cards {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-bottom: 20px;
    }

    /* ä¸»é¢˜å¡ç‰‡ - å¼‚å½¢è®¾è®¡ */
    .theme-card {
      background: var(--bg-secondary);
      border: 1.5px solid var(--border-color);
      /* å¼‚å½¢åœ†è§’ */
      border-radius: 16px 4px 16px 4px;
      padding: 0;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .theme-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
      border-color: var(--text-primary);
    }

    .theme-card.active {
      border-color: var(--text-primary);
      border-width: 2px;
      background: var(--bg-tertiary);
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
    }

    .theme-card.active .theme-card-checkmark {
      opacity: 1;
      transform: scale(1);
    }

    /* ä¸»é¢˜é¢„è§ˆåŒºåŸŸ */
    .theme-card-preview {
      position: relative;
      height: 120px;
      padding: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    /* æµ…è‰²ä¸»é¢˜é¢„è§ˆ */
    .light-preview {
      background: linear-gradient(135deg, #fafafa 0%, #f0f0f0 100%);
    }

    /* æ·±è‰²ä¸»é¢˜é¢„è§ˆ */
    .dark-preview {
      background: linear-gradient(135deg, #141414 0%, #0a0a0a 100%);
    }

    /* é¢„è§ˆçª—å£ - æ¨¡æ‹Ÿç•Œé¢ */
    .preview-window {
      width: 100%;
      max-width: 100px;
      background: transparent;
      border-radius: 8px 2px 8px 2px;
      overflow: hidden;
      position: relative;
      z-index: 1;
    }

    .preview-bar {
      height: 4px;
      border-radius: 2px;
      margin-bottom: 6px;
    }

    .light-bar {
      background: #e0e0e0;
    }

    .dark-bar {
      background: #2a2a2a;
    }

    .preview-content {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .preview-box {
      height: 8px;
      border-radius: 4px 1px 4px 1px;
      animation: previewPulse 2s ease-in-out infinite;
    }

    .preview-box.small {
      height: 6px;
      opacity: 0.7;
    }

    .light-box {
      background: #ffffff;
      border: 1px solid #e0e0e0;
    }

    .dark-box {
      background: #141414;
      border: 1px solid #2a2a2a;
    }

    @keyframes previewPulse {
      0%, 100% {
        opacity: 1;
      }
      50% {
        opacity: 0.6;
      }
    }

    /* ä¸»é¢˜å›¾æ ‡è¦†ç›–å±‚ */
    .theme-icon-overlay {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2;
      opacity: 0.3;
      transition: all 0.3s ease;
    }

    .theme-card:hover .theme-icon-overlay {
      opacity: 0.6;
      transform: translate(-50%, -50%) scale(1.1);
    }

    .theme-card.active .theme-icon-overlay {
      opacity: 0.8;
    }

    .theme-icon-overlay svg {
      width: 100%;
      height: 100%;
      stroke: var(--text-primary);
      fill: none;
    }

    .light-preview .theme-icon-overlay svg {
      stroke: #000000;
    }

    .dark-preview .theme-icon-overlay svg {
      stroke: #ffffff;
    }

    /* ä¸»é¢˜å¡ç‰‡æ ‡ç­¾ */
    .theme-card-label {
      padding: 12px 14px;
      background: var(--bg-primary);
      border-top: 1px solid var(--border-color);
    }

    .theme-card-name {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 4px;
      font-family: 'Inter', sans-serif;
    }

    .theme-card-desc {
      font-size: 10px;
      color: var(--text-tertiary);
      font-family: 'Inter', sans-serif;
      letter-spacing: 0.01em;
      line-height: 1.4;
    }

    /* é€‰ä¸­æ ‡è®° */
    .theme-card-checkmark {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 20px;
      height: 20px;
      background: var(--text-primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transform: scale(0.8);
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      z-index: 3;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    .theme-card-checkmark svg {
      width: 12px;
      height: 12px;
      stroke: var(--bg-primary);
      fill: none;
    }

    /* é¢„ç•™åŒºåŸŸå ä½ç¬¦ */
    .typography-placeholder {
      padding: 40px 20px;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      opacity: 0.5;
    }

    /* ç§»åŠ¨ç«¯é€‚é… */
    @media (max-width: 430px) {
      .theme-toggle-cards {
        gap: 10px;
      }

      .theme-card-preview {
        height: 100px;
        padding: 12px;
      }

      .preview-window {
        max-width: 80px;
      }

      .theme-icon-overlay {
        width: 32px;
        height: 32px;
      }
    }

    /* ==========================================
     * å­—ä½“ç®¡ç†æ ·å¼ - Font Management
     * ========================================== */

    /* å­—ä½“å¡ç‰‡ç½‘æ ¼ */
    .font-cards-grid {
      display: flex;
      gap: 12px;
      overflow-x: auto;
      overflow-y: hidden;
      padding: 2px 0 8px 0;
      margin: 0 -2px 20px -2px;
      scrollbar-width: none; /* Firefox */
      -ms-overflow-style: none; /* IE 10+ */
    }

    .font-cards-grid::-webkit-scrollbar {
      display: none; /* Chrome, Safari, Opera */
    }

    /* æ¨ªå‘æ»šåŠ¨ä¸­çš„é»˜è®¤å­—ä½“å¡ç‰‡ */
    .font-cards-grid .font-card {
      flex-shrink: 0;
      width: 160px;
      min-width: 160px;
    }

    /* å­—ä½“å¡ç‰‡ - å¼‚å½¢è®¾è®¡ */
    .font-card {
      background: var(--bg-secondary);
      border: 1.5px solid var(--border-color);
      /* å¼‚å½¢åœ†è§’ */
      border-radius: 16px 4px 16px 4px;
      padding: 0;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .font-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
      border-color: var(--text-primary);
    }

    .font-card.active {
      border-color: var(--text-primary);
      border-width: 2px;
      background: var(--bg-tertiary);
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
    }

    .font-card.active .font-card-checkmark {
      opacity: 1;
      transform: scale(1);
    }

    /* å­—ä½“é¢„è§ˆåŒºåŸŸ */
    .font-card-preview {
      position: relative;
      height: 100px;
      padding: 16px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 8px;
      background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
      border-bottom: 1px solid var(--border-color);
    }

    .font-preview-text {
      font-size: 36px;
      font-weight: 600;
      color: var(--text-primary);
      line-height: 1;
      letter-spacing: -0.02em;
    }

    .font-preview-sample {
      font-size: 11px;
      color: var(--text-secondary);
      letter-spacing: 0.02em;
      opacity: 0.8;
    }

    /* å­—ä½“å¡ç‰‡æ ‡ç­¾ */
    .font-card-label {
      padding: 12px 14px;
      background: var(--bg-primary);
    }

    .font-card-name {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 4px;
      font-family: 'Inter', sans-serif;
    }

    .font-card-type {
      font-size: 10px;
      color: var(--text-tertiary);
      font-family: 'JetBrains Mono', monospace;
      letter-spacing: 0.01em;
    }

    /* é€‰ä¸­æ ‡è®° */
    .font-card-checkmark {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 20px;
      height: 20px;
      background: var(--text-primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transform: scale(0.8);
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      z-index: 3;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    .font-card-checkmark svg {
      width: 12px;
      height: 12px;
      stroke: var(--bg-primary);
      fill: none;
    }

    /* æ·»åŠ è‡ªå®šä¹‰å­—ä½“åŒºåŸŸ */
    .add-custom-font-area {
      margin-top: 20px;
      padding: 16px;
      background: var(--bg-secondary);
      border: 1.5px dashed var(--border-color);
      border-radius: 16px 4px 16px 4px;
      animation: fadeIn 0.6s ease 0.2s both;
    }

    .custom-font-header {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 12px;
      font-family: inherit;
    }

    .custom-font-form {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 10px;
    }

    .custom-font-input {
      width: 100%;
      padding: 10px 14px;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 8px 2px 8px 2px;
      font-size: 12px;
      color: var(--text-primary);
      font-family: inherit;
      transition: all 0.25s ease;
      outline: none;
    }

    .custom-font-input:focus {
      border-color: var(--text-primary);
      box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.05);
    }

    .custom-font-input::placeholder {
      color: var(--text-tertiary);
      opacity: 0.6;
    }

    .custom-font-add-btn {
      width: 100%;
      padding: 12px;
      background: var(--text-primary);
      color: var(--bg-primary);
      border: none;
      border-radius: 8px 2px 8px 2px;
      font-size: 12px;
      font-weight: 600;
      font-family: inherit;
      cursor: pointer;
      transition: all 0.25s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .custom-font-add-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    .custom-font-add-btn:active {
      transform: translateY(0);
    }

    .custom-font-hint {
      display: flex;
      align-items: center;
      font-size: 10px;
      color: var(--text-tertiary);
      font-family: 'Inter', sans-serif;
      opacity: 0.7;
      line-height: 1.4;
    }

    /* ğŸ”¥ é¡¶éƒ¨é—´è·è°ƒæ•´æ ·å¼ */
    /* é¢„è®¾æŒ‰é’®å®¹å™¨ */
    .padding-preset-buttons {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 8px;
      margin-bottom: 16px;
    }

    /* é¢„è®¾æŒ‰é’® */
    .padding-preset-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 12px 6px;
      background: var(--bg-tertiary);
      border: 2px solid var(--border-color);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: 'Inter', sans-serif;
    }

    .padding-preset-btn:hover {
      background: var(--bg-secondary);
      border-color: var(--text-tertiary);
      transform: translateY(-2px);
    }

    .padding-preset-btn.active {
      background: var(--text-primary);
      border-color: var(--text-primary);
    }

    .padding-preset-btn.active .preset-value,
    .padding-preset-btn.active .preset-label {
      color: var(--bg-primary);
    }

    .preset-value {
      font-size: 13px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 2px;
      letter-spacing: -0.02em;
    }

    .preset-label {
      font-size: 9px;
      font-weight: 500;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* è‡ªå®šä¹‰è¾“å…¥è¡Œ */
    .custom-padding-input-row {
      display: flex;
      gap: 10px;
      margin-bottom: 16px;
    }

    .custom-padding-input-wrapper {
      flex: 1;
      position: relative;
      display: flex;
      align-items: center;
    }

    .custom-padding-input {
      width: 100%;
      padding: 12px 40px 12px 16px;
      background: var(--bg-tertiary);
      border: 2px solid var(--border-color);
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      font-family: 'JetBrains Mono', monospace;
      color: var(--text-primary);
      transition: all 0.2s ease;
    }

    .custom-padding-input:focus {
      outline: none;
      border-color: var(--text-primary);
      background: var(--bg-secondary);
    }

    .padding-input-unit {
      position: absolute;
      right: 16px;
      font-size: 12px;
      font-weight: 600;
      color: var(--text-tertiary);
      font-family: 'Inter', sans-serif;
      pointer-events: none;
    }

    .custom-padding-input-row .custom-font-add-btn {
      width: auto;
      min-width: 100px;
      flex-shrink: 0;
    }

    /* å½“å‰å€¼æ˜¾ç¤º */
    .current-padding-display {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px 16px;
      background: var(--bg-tertiary);
      border: 1px dashed var(--border-color);
      border-radius: 6px;
      margin-bottom: 12px;
      font-family: 'Inter', sans-serif;
    }

    .current-padding-label {
      font-size: 11px;
      font-weight: 500;
      color: var(--text-secondary);
      margin-right: 8px;
    }

    .current-padding-value {
      font-size: 14px;
      font-weight: 700;
      color: var(--text-primary);
      font-family: 'JetBrains Mono', monospace;
      letter-spacing: -0.02em;
    }

    /* å­—ä½“åŒºåŸŸæ ‡ç­¾ */
    .font-section-label {
      font-size: 11px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 12px;
      font-family: 'Inter', sans-serif;
      opacity: 0.8;
    }

    /* é»˜è®¤å­—ä½“æ¨ªå‘æ»šåŠ¨å®¹å™¨ - æ‰€æœ‰é»˜è®¤å­—ä½“åœ¨ä¸€è¡Œæ»‘åŠ¨ */
    .default-fonts-scroll {
      display: flex;
      gap: 12px;
      overflow-x: auto;
      overflow-y: hidden;
      padding: 2px 0 8px 0;
      margin: 0 -2px;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .default-fonts-scroll::-webkit-scrollbar {
      display: none;
    }

    /* é»˜è®¤å­—ä½“æ¨ªå‘æ»šåŠ¨ä¸­çš„å¡ç‰‡ */
    .default-fonts-scroll .font-card {
      flex-shrink: 0;
      width: 140px;
      min-width: 140px;
    }

    /* è‡ªå®šä¹‰å­—ä½“åŒºåŸŸ */
    .custom-fonts-section {
      margin-top: 20px;
      animation: fadeIn 0.5s ease;
    }

    /* è‡ªå®šä¹‰å­—ä½“æ¨ªå‘æ»šåŠ¨å®¹å™¨ */
    .custom-fonts-scroll {
      display: flex;
      gap: 12px;
      overflow-x: auto;
      overflow-y: hidden;
      padding: 2px 0 8px 0;
      margin: 0 -2px;
      scrollbar-width: none; /* Firefox */
      -ms-overflow-style: none; /* IE 10+ */
    }

    .custom-fonts-scroll::-webkit-scrollbar {
      display: none; /* Chrome, Safari, Opera */
    }

    /* æ¨ªå‘æ»šåŠ¨ä¸­çš„å­—ä½“å¡ç‰‡ */
    .custom-fonts-scroll .font-card {
      flex-shrink: 0;
      width: 160px;
      min-width: 160px;
    }

    /* è‡ªå®šä¹‰å­—ä½“åˆ é™¤æŒ‰é’®ï¼ˆå¡ç‰‡å³ä¸‹è§’åœ†å½¢Ã—ï¼Œé€‚é…æ—¥é—´/å¤œé—´ï¼‰ */
    .custom-fonts-scroll .custom-font-delete-btn {
      position: absolute;
      right: 10px;
      bottom: 10px;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      padding: 0;
      line-height: 1;
      font-size: 14px;
      font-weight: 700;
      color: var(--text-primary);
      z-index: 3;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      user-select: none;
      -webkit-tap-highlight-color: transparent;
      opacity: 0.75;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
    }

    .custom-fonts-scroll .font-card:hover .custom-font-delete-btn {
      opacity: 1;
    }

    .custom-fonts-scroll .custom-font-delete-btn:hover {
      background: var(--text-primary);
      border-color: var(--text-primary);
      color: var(--bg-primary);
      transform: scale(1.05);
    }

    .custom-fonts-scroll .custom-font-delete-btn:active {
      transform: scale(0.95);
    }

    /* è‡ªå®šä¹‰å­—ä½“å¡ç‰‡æ ‡ç­¾ç•™å‡ºæŒ‰é’®ç©ºé—´ï¼ˆé¿å…å‹ä½æ–‡å­—ï¼‰ */
    .custom-fonts-scroll .font-card-label {
      padding-right: 44px;
    }

    /* åˆ é™¤è¿‡æ¸¡åŠ¨ç”» */
    .font-card.removing,
    .font-card.removing:hover {
      opacity: 0;
      transform: scale(0.96);
      pointer-events: none;
      transition: opacity 0.22s ease, transform 0.22s ease;
    }

    /* ==========================================
       æ‰‹æœºé¢œè‰²ç®¡ç†æ ·å¼ - Phone Color Management
       ========================================== */

    /* é¢œè‰²æ–¹æ¡ˆæ¨ªå‘æ»šåŠ¨å®¹å™¨ */
    .color-schemes-scroll {
      display: flex;
      gap: 12px;
      overflow-x: auto;
      overflow-y: hidden;
      padding: 2px 0 8px 0;
      margin: 0 -2px 20px -2px;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .color-schemes-scroll::-webkit-scrollbar {
      display: none;
    }

    /* é¢œè‰²æ–¹æ¡ˆå¡ç‰‡ */
    .color-scheme-card {
      flex-shrink: 0;
      width: 160px;
      min-width: 160px;
      background: var(--bg-secondary);
      border: 1.5px solid var(--border-color);
      border-radius: 16px 4px 16px 4px;
      padding: 0;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .color-scheme-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
      border-color: var(--text-primary);
    }

    .color-scheme-card.active {
      border-color: var(--text-primary);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    /* é¢œè‰²æ–¹æ¡ˆé¢„è§ˆåŒºåŸŸ */
    .color-scheme-preview {
      height: 120px;
      background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      border-bottom: 1px solid var(--border-color);
    }

    /* æ‰‹æœºé¢„è§ˆ */
    .color-preview-phone {
      width: 80px;
      height: 100px;
      position: relative;
      background: var(--bg-secondary);
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    /* æ‰‹æœºæ¡†é¢„è§ˆ */
    .color-preview-frame {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border: 2px solid #000000;
      border-radius: 12px;
      pointer-events: none;
    }

    /* åˆ˜æµ·å±é¢„è§ˆ */
    .color-preview-notch {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 30px;
      height: 8px;
      background: #0a0a0a;
      border-bottom-left-radius: 6px;
      border-bottom-right-radius: 6px;
    }

    /* çµåŠ¨å²›é¢„è§ˆ */
    .color-preview-island {
      position: absolute;
      top: 2px;
      left: 50%;
      transform: translateX(-50%);
      width: 28px;
      height: 6px;
      background: #1a1a1a;
      border-radius: 3px;
    }

    /* é¢œè‰²æ–¹æ¡ˆæ ‡ç­¾ */
    .color-scheme-label {
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .color-scheme-name {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-primary);
      font-family: 'Inter', sans-serif;
    }

    .color-scheme-colors {
      display: flex;
      gap: 4px;
      align-items: center;
    }

    .color-dot {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      border: 1px solid var(--border-color);
    }

    /* é¢œè‰²æ–¹æ¡ˆé€‰ä¸­æ ‡è®° */
    .color-scheme-checkmark {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 20px;
      height: 20px;
      background: var(--text-primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transform: scale(0);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .color-scheme-checkmark svg {
      width: 12px;
      height: 12px;
      stroke: var(--bg-primary);
    }

    .color-scheme-card.active .color-scheme-checkmark {
      opacity: 1;
      transform: scale(1);
    }

    /* ==========================================
       ğŸ¨ åº•æ åˆ‡æ¢é€‰æ‹©å™¨æ ·å¼
       ========================================== */

    .dock-styles-scroll {
      display: flex;
      gap: 12px;
      overflow-x: auto;
      overflow-y: hidden;
      padding: 2px 0 8px 0;
      margin: 0 -2px 20px -2px;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .dock-styles-scroll::-webkit-scrollbar {
      display: none;
    }

    /* åº•æ æ ·å¼å¡ç‰‡ */
    .dock-style-card {
      flex-shrink: 0;
      width: 120px;
      min-width: 120px;
      background: var(--bg-secondary);
      border: 1.5px solid var(--border-color);
      border-radius: 16px 4px 16px 4px;
      padding: 0;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .dock-style-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
      border-color: var(--text-primary);
    }

    .dock-style-card.active {
      border-color: var(--text-primary);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    /* åº•æ æ ·å¼é¢„è§ˆåŒºåŸŸ - é»‘ç™½ç°é£æ ¼ */
    .dock-style-preview {
      height: 80px;
      background: linear-gradient(180deg, #3a3a3a 0%, #2a2a2a 100%);
      display: flex;
      align-items: flex-end;
      justify-content: center;
      padding: 0 0 10px 0;
      border-bottom: 1px solid var(--border-color);
    }

    /* åº•æ é¢„è§ˆèƒŒæ™¯ */
    .dock-preview-bg {
      display: flex;
      gap: 8px;
      padding: 8px 14px;
      border-radius: 20px;
    }

    /* é»˜è®¤æ ·å¼é¢„è§ˆ */
    .dock-preview-default {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
    }

    /* ç£¨ç ‚æ ·å¼é¢„è§ˆ - çº¯å‡€ç£¨ç ‚ç»ç’ƒï¼Œæ ¹æ®èƒŒæ™¯å–è‰² */
    .dock-preview-frosted {
      background-color: rgba(120, 120, 120, 0.25);
      backdrop-filter: blur(20px) saturate(150%);
      -webkit-backdrop-filter: blur(20px) saturate(150%);
      border: none;
      box-shadow: none;
    }

    /* æ¶²æ€æ ·å¼é¢„è§ˆ - çƒŸé›¾æ„Ÿç»ç’ƒæ•ˆæœ */
    .dock-preview-liquid {
      background-color: rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(6px) contrast(1.05) brightness(0.95);
      -webkit-backdrop-filter: blur(6px) contrast(1.05) brightness(0.95);
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.4), inset 0 0 5px rgba(255, 255, 255, 0.05);
    }

    /* é¢„è§ˆå›¾æ ‡ */
    .dock-preview-icon {
      width: 20px;
      height: 20px;
      background-color: rgba(255, 255, 255, 0.3);
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2), inset 0 0 3px rgba(255, 255, 255, 0.1);
    }

    /* åº•æ æ ·å¼æ ‡ç­¾åŒºåŸŸ */
    .dock-style-label {
      padding: 12px;
      text-align: center;
    }

    .dock-style-name {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 2px;
    }

    .dock-style-desc {
      font-size: 10px;
      color: var(--text-tertiary);
    }

    /* åº•æ æ ·å¼é€‰ä¸­æ ‡è®° */
    .dock-style-checkmark {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 20px;
      height: 20px;
      background: var(--text-primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transform: scale(0);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .dock-style-checkmark svg {
      width: 12px;
      height: 12px;
      stroke: var(--bg-primary);
    }

    .dock-style-card.active .dock-style-checkmark {
      opacity: 1;
      transform: scale(1);
    }

    /* ==========================================
       ğŸ¨ çœŸå®Dockæ ·å¼å˜ä½“ - å®Œå…¨å¤åˆ»dock-effects.html
       ========================================== */

    /* ç£¨ç ‚è´¨åœ° Dock - Frosted */
    /* ç£¨ç ‚è´¨åœ° Dock - çº¯å‡€ç£¨ç ‚ç»ç’ƒï¼Œæ ¹æ®èƒŒæ™¯å–è‰² */
    .dock-bg.dock-style-frosted {
      background-color: rgba(120, 120, 120, 0.25) !important;
      backdrop-filter: blur(20px) saturate(150%) !important;
      -webkit-backdrop-filter: blur(20px) saturate(150%) !important;
      border: none !important;
      box-shadow: none !important;
    }

    /* æ¶²æ€è½»æ¨¡ç³Š Dock - Liquid */
    /* æ¶²æ€è½»æ¨¡ç³Š Dock - çƒŸé›¾æ„Ÿç»ç’ƒæ•ˆæœ */
    .dock-bg.dock-style-liquid {
      background-color: rgba(0, 0, 0, 0.4) !important;
      backdrop-filter: blur(6px) contrast(1.05) brightness(0.95) !important;
      -webkit-backdrop-filter: blur(6px) contrast(1.05) brightness(0.95) !important;
      border: 1px solid rgba(255, 255, 255, 0.08) !important;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.4), inset 0 0 5px rgba(255, 255, 255, 0.05) !important;
    }

    /* ç£¨ç ‚å’Œæ¶²æ€æ¨¡å¼ä¸‹çš„å›¾æ ‡æ ·å¼è°ƒæ•´ */
    .dock-bg.dock-style-frosted .dock-icon,
    .dock-bg.dock-style-liquid .dock-icon {
      background-color: rgba(0, 0, 0, 0.2);
      border: none;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2), inset 0 0 5px rgba(255, 255, 255, 0.1);
    }

    .dock-bg.dock-style-frosted .dock-icon:hover,
    .dock-bg.dock-style-liquid .dock-icon:hover {
      background-color: rgba(0, 0, 0, 0.3);
    }

    .dock-bg.dock-style-frosted .dock-icon svg,
    .dock-bg.dock-style-liquid .dock-icon svg {
      stroke: rgba(255, 255, 255, 0.9);
    }

    /* è‡ªå®šä¹‰é¢œè‰²åŒºåŸŸ */
    .add-custom-color-area {
      margin-top: 20px;
      padding: 16px;
      background: var(--bg-secondary);
      border: 1.5px dashed var(--border-color);
      border-radius: 16px 4px 16px 4px;
      animation: fadeIn 0.6s ease 0.2s both;
    }

    .custom-color-form {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 10px;
    }

    .custom-color-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .custom-color-label {
      font-size: 12px;
      font-weight: 500;
      color: var(--text-secondary);
      font-family: 'Inter', sans-serif;
      flex-shrink: 0;
    }

    .custom-color-input {
      width: 60px;
      height: 36px;
      border: 1px solid var(--border-color);
      border-radius: 8px 2px 8px 2px;
      cursor: pointer;
      transition: all 0.25s ease;
      background: var(--bg-primary);
    }

    .custom-color-input:hover {
      border-color: var(--text-primary);
    }

    .custom-color-input::-webkit-color-swatch-wrapper {
      padding: 4px;
    }

    .custom-color-input::-webkit-color-swatch {
      border: none;
      border-radius: 4px;
    }

    /* ==================== å…¨å±é€‚é…é€‰é¡¹æ ·å¼ ==================== */

    /* å…¨å±é€‚é…é€‰é¡¹åˆ—è¡¨å®¹å™¨ */
    .fullscreen-options-list {
      display: flex;
      flex-direction: column;
      gap: 2px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 12px 4px 12px 4px;
      overflow: hidden;
      margin-bottom: 16px;
    }

    /* å…¨å±é€‚é…é€‰é¡¹å•é¡¹ */
    .fullscreen-option-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 16px;
      background: var(--bg-primary);
      transition: background 0.2s ease;
    }

    .fullscreen-option-item:hover {
      background: var(--bg-secondary);
    }

    /* åˆ†éš”çº¿æ•ˆæœ - é™¤äº†æœ€åä¸€ä¸ª */
    .fullscreen-option-item:not(:last-child) {
      border-bottom: 1px solid var(--border-color);
    }

    /* é€‰é¡¹ä¿¡æ¯åŒºåŸŸ */
    .fullscreen-option-info {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .fullscreen-option-name {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-primary);
      font-family: 'Inter', sans-serif;
    }

    .fullscreen-option-desc {
      font-size: 11px;
      color: var(--text-tertiary);
      font-family: 'Inter', sans-serif;
      opacity: 0.8;
    }

    /* ==================== å…¨å±é€‚é…åŠŸèƒ½ç±» ==================== */

    /* éšè—åˆ˜æµ·å± */
    .notch-hidden .notch {
      opacity: 0 !important;
      pointer-events: none !important;
      visibility: hidden !important;
    }

    /* æ—¶é—´æ¡†è´´é¡¶ - ç§»é™¤safe-areaåç§» */
    .status-bar-top .status-bar {
      height: 44px !important;
      padding-top: 8px !important;
    }

    /* çµåŠ¨å²›è´´é¡¶ - ç§»é™¤safe-areaåç§» */
    .dynamic-island-top .dynamic-island {
      top: 8px !important;
    }

    /* åˆ˜æµ·å±è´´é¡¶ (é…åˆéšè—åˆ˜æµ·æ—¶ä½¿ç”¨ï¼Œè®©å…¶ä»–å…ƒç´ è¡¥ä½) */
    .notch-hidden .notch-holder {
      display: none !important;
    }

    /* ğŸ”¥ ã€è€ç‹æ–°å¢ã€‘éšè—æ—¶é—´æ¡† - è§£å†³iOSæ—¶é—´é‡å é—®é¢˜ */
    /* åªéšè—è§†è§‰æ•ˆæœï¼Œä¿ç•™å ä½é«˜åº¦ï¼Œé˜²æ­¢app-gridæ‰©å±•å¯¼è‡´å†…å®¹"æ”¾å¤§" */
    .status-bar-hidden .status-bar {
      opacity: 0 !important;
      pointer-events: none !important;
      visibility: hidden !important;
      /* ä¸è®¾ç½® height/padding/margin: 0ï¼Œä¿æŒåŸæœ‰å¸ƒå±€å ä½ */
    }

    /* ğŸ”¥ ã€è€ç‹æ–°å¢ã€‘å…¨å±€æ—¶é—´æ è¦†ç›–å±‚ - ç‹¬ç«‹äºhomeScreen */
    .global-status-bar-overlay {
      display: none; /* é»˜è®¤éšè— */
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: calc(44px + env(safe-area-inset-top, 0));
      padding: 0 24px;
      padding-top: calc(12px + env(safe-area-inset-top, 0));
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      font-weight: 500;
      z-index: 9999;
      /* æ— èƒŒæ™¯è‰²ï¼Œä¸åŸstatus-barä¿æŒä¸€è‡´ */
      color: var(--text-primary);
      pointer-events: none;
    }

    .global-status-bar-overlay .status-left,
    .global-status-bar-overlay .status-right {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .global-status-bar-overlay .status-icon {
      opacity: 0.8;
    }

    /* å¼€å¯å…¨å±€æ—¶é—´æ æ—¶æ˜¾ç¤ºè¦†ç›–å±‚ */
    .global-status-bar .global-status-bar-overlay {
      display: flex !important;
    }

    /* å¼€å¯å…¨å±€æ—¶é—´æ æ—¶ï¼Œéšè—homeScreenå†…çš„åŸstatus-baré¿å…é‡å¤ */
    .global-status-bar .home-screen .status-bar {
      opacity: 0 !important;
      visibility: hidden !important;
    }

    /* å¯åŠ¨ç”»é¢æ—¶éšè—å…¨å±€æ—¶é—´æ  */
    .boot-screen:not(.hidden) ~ .global-status-bar-overlay,
    .global-status-bar .boot-screen:not(.hidden) ~ * .global-status-bar-overlay {
      display: none !important;
    }

    /* æ—¶é—´æ è´´é¡¶æ—¶çš„å…¨å±€æ—¶é—´æ é€‚é… */
    .status-bar-top .global-status-bar-overlay {
      height: 44px !important;
      padding-top: 8px !important;
    }

    /* éšè—æ—¶é—´æ¡†æ—¶ä¹Ÿéšè—å…¨å±€æ—¶é—´æ  */
    .status-bar-hidden .global-status-bar-overlay {
      display: none !important;
    }

    /* ç§»åŠ¨ç«¯é€‚é… */
    @media (max-width: 430px) {
      .font-cards-grid {
        gap: 10px;
      }

      .font-card-preview {
        height: 90px;
        padding: 12px;
      }

      .font-preview-text {
        font-size: 32px;
      }

      .font-preview-sample {
        font-size: 10px;
      }
    }

    /* ==========================================
       è´´çº¸ç³»ç»Ÿæ ·å¼ - Sticker System
       ========================================== */

    /* è´´çº¸ä¸Šä¼ åŒºåŸŸ */
    .sticker-upload-section {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-top: 16px;
    }

    /* å½“å‰è´´çº¸é¢„è§ˆ */
    .sticker-current-preview {
      width: 100%;
      height: 200px;
      background: var(--bg-secondary);
      border: 1.5px solid var(--border-color);
      border-radius: 16px 4px 16px 4px;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    .sticker-preview-empty {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      color: var(--text-tertiary);
    }

    .sticker-preview-empty svg {
      width: 48px;
      height: 48px;
      opacity: 0.4;
    }

    .sticker-preview-empty p {
      font-size: 14px;
      margin: 0;
    }

    /* è´´çº¸é¢„è§ˆå›¾ç‰‡ */
    .sticker-preview-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* æŒ‰é’®ç»„ */
    .sticker-button-group {
      display: flex;
      gap: 12px;
    }

    /* ä¸Šä¼ æŒ‰é’® */
    .sticker-upload-btn {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 14px 20px;
      background: var(--text-primary);
      color: var(--bg-primary);
      border: none;
      border-radius: 12px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
    }

    .sticker-upload-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
    }

    .sticker-upload-btn svg {
      width: 18px;
      height: 18px;
    }

    /* ç§»é™¤æŒ‰é’® */
    .sticker-remove-btn {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 14px 20px;
      background: var(--bg-secondary);
      color: var(--text-secondary);
      border: 1.5px solid var(--border-color);
      border-radius: 12px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
    }

    .sticker-remove-btn:hover {
      border-color: #ff4757;
      color: #ff4757;
      background: rgba(255, 71, 87, 0.1);
      transform: translateY(-2px);
    }

    .sticker-remove-btn svg {
      width: 18px;
      height: 18px;
    }


    /* ==========================================
       CHARACTER SYSTEM STYLES
       ========================================== */

    /* Character Header */
    .character-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 24px;
      padding: 0 20px;
      animation: slideDown 0.6s ease;
    }

    .character-logo-area {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .character-logo-icon {
      width: 40px;
      height: 40px;
      background: var(--accent-color);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--bg-primary);
    }

    .character-logo-icon svg {
      width: 20px;
      height: 20px;
      stroke: var(--bg-primary);
      fill: none;
      stroke-width: 2;
    }

    .character-logo-text {
      font-size: 18px;
      font-weight: 600;
      letter-spacing: -0.02em;
    }

    .character-header-actions {
      display: flex;
      gap: 8px;
    }

    .character-icon-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .character-icon-btn:hover {
      background: var(--hover-bg);
      transform: scale(1.05);
    }

    .character-icon-btn svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    /* Worldview Tabs */
    .worldview-tabs {
      display: flex;
      gap: 8px;
      margin: 0 20px 20px;
      overflow-x: auto;
      scrollbar-width: none;
      padding-bottom: 4px;
      animation: fadeIn 0.6s ease 0.1s both;
    }

    .worldview-tabs::-webkit-scrollbar {
      display: none;
    }

    .worldview-tab {
      flex-shrink: 0;
      padding: 8px 16px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: 'Noto Sans JP', sans-serif;
      position: relative;
    }

    .worldview-tab:hover {
      background: var(--hover-bg);
    }

    .worldview-tab.active {
      background: var(--accent-color);
      color: var(--bg-primary);
      border-color: var(--accent-color);
    }

    .worldview-tab.active::after {
      content: '';
      position: absolute;
      bottom: -6px;
      left: 50%;
      transform: translateX(-50%);
      width: 4px;
      height: 4px;
      background: var(--accent-color);
      border-radius: 50%;
    }

    /* Character Grid */
    .character-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      padding: 0 20px 20px;
      animation: fadeIn 0.6s ease 0.2s both;
    }

    /* Character Card */
    .character-card {
      background: var(--bg-tertiary);
      border: 2px solid var(--border-color);
      border-radius: 16px;
      padding: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      min-height: 200px;
      display: flex;
      flex-direction: column;
    }

    .character-card::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, transparent, var(--accent-color));
      opacity: 0.02;
      border-radius: 0 16px 0 100%;
    }

    .character-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-md);
      border-color: var(--accent-color);
    }

    /* Card Header */
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 12px;
    }

    .card-id {
      font-size: 10px;
      font-family: 'JetBrains Mono', monospace;
      color: var(--text-tertiary);
      letter-spacing: 0.05em;
      background: var(--bg-primary);
      padding: 4px 8px;
      border-radius: 6px;
      border: 1px solid var(--border-color);
      max-width: 140px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .card-status {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--text-tertiary);
    }

    .card-status.active {
      background: #22c55e;
      box-shadow: 0 0 8px rgba(34, 197, 94, 0.3);
    }

    /* Character Avatar */
    .character-avatar {
      width: 100%;
      aspect-ratio: 1;
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      border-radius: 12px;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 48px;
      color: var(--text-tertiary);
      overflow: hidden;
      position: relative;
    }

    .character-avatar svg {
      width: 60%;
      height: 60%;
      stroke: var(--text-tertiary);
      fill: none;
      stroke-width: 1.5;
    }

    .character-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .character-avatar::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 30%;
      background: linear-gradient(to top, var(--bg-primary), transparent);
      pointer-events: none;
    }

    /* Character Info */
    .character-name {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 4px;
      line-height: 1.3;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }

    .character-meta {
      display: flex;
      gap: 4px;
      flex-wrap: wrap;
      margin-top: auto;
    }

    .character-tag {
      font-size: 9px;
      font-family: 'JetBrains Mono', monospace;
      color: var(--text-tertiary);
      background: var(--bg-primary);
      padding: 2px 6px;
      border-radius: 4px;
      border: 1px solid var(--border-color);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* Create New Card */
    .create-card {
      background: var(--bg-primary);
      border: 2px dashed var(--border-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 12px;
    }

    .create-card:hover {
      border-color: var(--accent-color);
      background: var(--bg-tertiary);
    }

    .create-icon {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 2px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .create-card:hover .create-icon {
      transform: rotate(90deg);
      background: var(--accent-color);
      border-color: var(--accent-color);
    }

    .create-icon svg {
      width: 24px;
      height: 24px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    .create-card:hover .create-icon svg {
      stroke: var(--bg-primary);
    }

    .create-text {
      font-size: 12px;
      font-weight: 500;
      color: var(--text-secondary);
    }

    /* ========== è§’è‰²å¡å¯¼å…¥/å¯¼å‡ºï¼ˆé»‘ç™½ç°é£æ ¼ï¼‰ ========== */

    .character-share-overlay {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.45);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      display: flex;
      align-items: flex-end;
      justify-content: center;
      z-index: 12000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.25s ease;
    }

    .character-share-overlay.active {
      opacity: 1;
      pointer-events: auto;
    }

    .character-share-sheet {
      width: 100%;
      max-height: 86vh;
      background: var(--bg-primary);
      border-radius: 28px 28px 0 0;
      border: 1px solid var(--border-color);
      padding: 16px 16px 18px;
      box-sizing: border-box;
      transform: translateY(14px);
      transition: transform 0.28s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .character-share-overlay.active .character-share-sheet {
      transform: translateY(0);
    }

    .character-share-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 12px;
    }

    .character-share-title {
      font-size: 16px;
      font-weight: 650;
      color: var(--text-primary);
      letter-spacing: -0.01em;
    }

    .character-share-subtitle {
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 2px;
    }

    .character-share-close {
      width: 34px;
      height: 34px;
      border-radius: 12px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .character-share-close:hover {
      background: var(--hover-bg);
      transform: scale(1.03);
    }

    .character-share-close svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    .character-share-list {
      max-height: 40vh;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding-right: 2px;
      margin-bottom: 14px;
      scrollbar-width: none;
    }

    .character-share-list::-webkit-scrollbar {
      display: none;
    }

    .character-share-item {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 14px;
      padding: 10px 10px;
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      transition: all 0.2s ease;
      user-select: none;
      -webkit-user-select: none;
    }

    .character-share-item:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-sm);
      border-color: rgba(0, 0, 0, 0.15);
    }

    [data-theme='dark'] .character-share-item:hover {
      border-color: rgba(255, 255, 255, 0.12);
    }

    .character-share-item.selected {
      border-color: var(--accent-color);
      box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.12), var(--shadow-sm);
    }

    [data-theme='dark'] .character-share-item.selected {
      box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.12), var(--shadow-sm);
    }

    .character-share-item-check {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid var(--border-color);
      background: var(--bg-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: all 0.2s ease;
    }

    .character-share-item.selected .character-share-item-check {
      border-color: var(--accent-color);
      background: var(--accent-color);
    }

    .character-share-item-check svg {
      width: 12px;
      height: 12px;
      stroke: #fff;
      fill: none;
      stroke-width: 3;
      opacity: 0;
      transform: scale(0.9);
      transition: all 0.18s ease;
    }

    .character-share-item.selected .character-share-item-check svg {
      opacity: 1;
      transform: scale(1);
    }

    .character-share-avatar {
      width: 34px;
      height: 34px;
      border-radius: 10px;
      border: 1px solid var(--border-color);
      background: var(--bg-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      flex-shrink: 0;
    }

    .character-share-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .character-share-avatar svg {
      width: 18px;
      height: 18px;
      stroke: var(--text-tertiary);
      fill: none;
      stroke-width: 2;
    }

    .character-share-info {
      min-width: 0;
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .character-share-name {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .character-share-meta {
      font-size: 12px;
      color: var(--text-secondary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .character-share-author {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 14px;
      padding: 12px;
      margin-bottom: 14px;
    }

    .character-share-author-label {
      font-size: 12px;
      color: var(--text-secondary);
      margin-bottom: 8px;
      font-weight: 600;
    }

    .character-share-author-input {
      width: 100%;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid var(--border-color);
      background: var(--bg-primary);
      color: var(--text-primary);
      font-size: 14px;
      outline: none;
      transition: border-color 0.2s ease;
      box-sizing: border-box;
    }

    .character-share-author-input:focus {
      border-color: var(--accent-color);
    }

    .character-share-author-hint {
      font-size: 11px;
      color: var(--text-tertiary);
      margin-top: 8px;
      line-height: 1.4;
    }

    .character-share-actions {
      display: flex;
      gap: 10px;
    }

    .character-share-btn {
      flex: 1;
      padding: 12px 12px;
      border-radius: 14px;
      border: none;
      cursor: pointer;
      font-size: 14px;
      font-weight: 650;
      transition: transform 0.15s ease, filter 0.15s ease, opacity 0.15s ease;
    }

    .character-share-btn:active {
      transform: scale(0.98);
    }

    .character-share-btn.secondary {
      background: var(--bg-secondary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }

    .character-share-btn.primary {
      background: var(--accent-color);
      color: #fff;
    }

    /* å¤œé—´æ¨¡å¼ï¼šaccent-color é»˜è®¤æ˜¯ç™½è‰²ï¼Œé¿å…ç™½åº•ç™½å­—çœ‹ä¸æ¸… */
    [data-theme='dark'] .character-share-btn.primary {
      background: var(--bg-tertiary);
      color: #fff;
      border: 1px solid var(--accent-color);
    }

    [data-theme='dark'] .character-share-btn.primary:disabled {
      border-color: rgba(255, 255, 255, 0.22);
    }

    .character-share-btn.primary:disabled {
      opacity: 0.55;
      cursor: not-allowed;
      filter: grayscale(0.2);
    }

    /* å¯¼å…¥ååˆ·æ–°åŠ¨ç”» */
    @keyframes characterGridRefresh {
      0% { opacity: 0.6; transform: translateY(8px); }
      100% { opacity: 1; transform: translateY(0); }
    }

    .character-grid.refreshing {
      animation: characterGridRefresh 0.55s ease both;
    }

    /* Character Detail Modal */
    .character-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(8px);
      z-index: 10000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
      animation: fadeIn 0.3s ease;
    }

    .character-modal.active {
      display: flex;
    }

    .character-modal.closing {
      animation: fadeOut 0.3s ease;
    }

    .character-modal.closing .id-card {
      animation: modalSlideOut 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* ID Card Container */
    .id-card {
      width: 100%;
      max-width: 380px;
      background: var(--bg-primary);
      border-radius: 24px;
      position: relative;
      overflow: hidden;
      animation: modalSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      max-height: 90vh;
      overflow-y: auto;
      scrollbar-width: thin;
    }

    .id-card::-webkit-scrollbar {
      width: 6px;
    }

    .id-card::-webkit-scrollbar-track {
      background: transparent;
    }

    .id-card::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 3px;
    }

    /* ID Card Header */
    .id-card-header {
      background: var(--accent-color);
      color: var(--bg-primary);
      padding: 16px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 1;
    }

    .id-card-header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: repeating-linear-gradient(
        90deg,
        var(--bg-primary) 0px,
        var(--bg-primary) 4px,
        transparent 4px,
        transparent 8px
      );
    }

    .id-card-title {
      font-size: 11px;
      font-family: 'JetBrains Mono', monospace;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      opacity: 0.9;
    }

    .id-card-number {
      font-size: 13px;
      font-family: 'JetBrains Mono', monospace;
      font-weight: 600;
      letter-spacing: 0.05em;
    }

    .id-card-close {
      position: absolute;
      top: -40px;
      right: 0;
      width: 32px;
      height: 32px;
      background: var(--bg-primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      z-index: 2;
    }

    .id-card-close:hover {
      transform: scale(1.1) rotate(90deg);
      background: var(--accent-color);
    }

    .id-card-close svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    .id-card-close:hover svg {
      stroke: var(--bg-primary);
    }

    /* ID Card Body */
    .id-card-body {
      padding: 24px 20px;
    }

    /* Profile Section */
    .id-profile {
      display: flex;
      gap: 16px;
      margin-bottom: 24px;
      padding-bottom: 24px;
      border-bottom: 2px dashed var(--border-color);
      position: relative;
    }

    .id-profile::after {
      content: '';
      position: absolute;
      bottom: -6px;
      left: 50%;
      transform: translateX(-50%);
      width: 40px;
      height: 4px;
      background: var(--accent-color);
      opacity: 0.2;
    }

    .id-avatar-large {
      width: 100px;
      height: 120px;
      background: var(--bg-tertiary);
      border: 2px solid var(--border-color);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      position: relative;
      overflow: hidden;
    }

    .id-avatar-large svg {
      width: 50%;
      height: 50%;
      stroke: var(--text-tertiary);
      fill: none;
      stroke-width: 1.5;
    }

    .id-avatar-large img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .id-avatar-large::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 40%;
      background: linear-gradient(to top, var(--bg-tertiary), transparent);
    }

    /* Barcode */
    .id-barcode {
      position: absolute;
      bottom: 4px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 1px;
      height: 24px;
      opacity: 0.4;
      z-index: 1;
    }

    .barcode-line {
      width: 2px;
      background: var(--text-primary);
      height: 100%;
    }

    .barcode-line:nth-child(odd) {
      height: 80%;
    }

    .barcode-line:nth-child(3n) {
      height: 60%;
    }

    .id-info-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .id-name {
      font-size: 18px;
      font-weight: 700;
      color: var(--text-primary);
      line-height: 1.2;
      margin-bottom: 4px;
      font-family: 'Noto Sans JP', sans-serif;
    }

    .id-role {
      font-size: 12px;
      color: var(--text-secondary);
      font-family: 'JetBrains Mono', monospace;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      background: var(--bg-tertiary);
      padding: 4px 8px;
      border-radius: 6px;
      display: inline-block;
      align-self: flex-start;
    }

    .id-meta-grid {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 6px 12px;
      margin-top: auto;
      font-size: 11px;
    }

    .id-meta-label {
      color: var(--text-tertiary);
      font-family: 'JetBrains Mono', monospace;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }

    .id-meta-value {
      color: var(--text-primary);
      font-weight: 500;
    }

    /* Bio Section */
    .id-section {
      margin-bottom: 20px;
    }

    .id-section:last-child {
      margin-bottom: 0;
    }

    .id-section-header {
      font-size: 10px;
      font-family: 'JetBrains Mono', monospace;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-tertiary);
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .id-section-header::before {
      content: '';
      width: 12px;
      height: 2px;
      background: var(--accent-color);
      opacity: 0.3;
    }

    .id-bio-text {
      font-size: 13px;
      line-height: 1.6;
      color: var(--text-secondary);
      background: var(--bg-tertiary);
      padding: 12px;
      border-radius: 12px;
      border: 1px solid var(--border-color);
      font-family: 'Noto Sans JP', sans-serif;
      max-height: 150px;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: var(--border-color) transparent;
    }

    .id-bio-text::-webkit-scrollbar {
      width: 6px;
    }

    .id-bio-text::-webkit-scrollbar-track {
      background: transparent;
    }

    .id-bio-text::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 3px;
    }

    /* Action Buttons */
    .char-action-btn {
      padding: 6px 12px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      background: var(--bg-primary);
      color: var(--text-secondary);
      font-size: 11px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
    }

    .char-action-btn:hover {
      background: var(--bg-tertiary);
      transform: scale(1.02);
    }

    .char-action-btn:active {
      transform: scale(0.98);
    }

    .char-action-btn.primary {
      color: var(--accent-color);
      border-color: var(--accent-color);
    }

    .char-action-btn.primary:hover {
      background: var(--accent-color);
      color: var(--bg-primary);
    }

    .char-action-btn.danger {
      color: #ef4444;
      border-color: #ef4444;
    }

    .char-action-btn.danger:hover {
      background: #ef4444;
      color: white;
    }

    /* ID Card Footer */
    .id-card-footer {
      background: var(--bg-tertiary);
      padding: 12px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-top: 1px solid var(--border-color);
      position: sticky;
      bottom: 0;
    }

    .id-watermark {
      font-size: 9px;
      color: var(--text-tertiary);
      font-family: 'JetBrains Mono', monospace;
      letter-spacing: 0.05em;
    }

    .id-status-badge {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 10px;
      color: var(--text-secondary);
      font-weight: 500;
    }

    .id-status-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #22c55e;
      box-shadow: 0 0 8px rgba(34, 197, 94, 0.5);
      animation: pulse 2s infinite;
    }

    /* Corner Decorations */
    .corner-decoration {
      position: absolute;
      width: 40px;
      height: 40px;
      opacity: 0.1;
      pointer-events: none;
    }

    .corner-decoration.top-left {
      top: 0;
      left: 0;
      border-top: 3px solid var(--accent-color);
      border-left: 3px solid var(--accent-color);
      border-top-left-radius: 24px;
    }

    .corner-decoration.bottom-right {
      bottom: 0;
      right: 0;
      border-bottom: 3px solid var(--accent-color);
      border-right: 3px solid var(--accent-color);
      border-bottom-right-radius: 24px;
    }

    /* Modal Animations */
    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: scale(0.9) translateY(20px);
      }
      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }

    @keyframes modalSlideOut {
      from {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
      to {
        opacity: 0;
        transform: scale(0.9) translateY(20px);
      }
    }

    /* Character Edit/Create Modal */
    .character-edit-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(10px);
      z-index: 10001;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
      animation: fadeIn 0.3s ease;
    }

    .character-edit-modal.active {
      display: flex;
    }

    .character-edit-modal.closing {
      animation: fadeOut 0.3s ease;
    }

    .character-edit-modal.closing .edit-card {
      animation: modalSlideOut 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Edit Card */
    .edit-card {
      width: 100%;
      max-width: 420px;
      background: var(--bg-primary);
      border-radius: 24px;
      overflow: hidden;
      animation: modalSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
      max-height: 90vh;
      display: flex;
      flex-direction: column;
    }

    /* Edit Card Header */
    .edit-card-header {
      background: var(--accent-color);
      color: var(--bg-primary);
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-shrink: 0;
    }

    .edit-card-title {
      font-size: 16px;
      font-weight: 700;
      letter-spacing: -0.02em;
    }

    .edit-card-close {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .edit-card-close:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: rotate(90deg);
    }

    .edit-card-close svg {
      width: 16px;
      height: 16px;
      stroke: var(--bg-primary);
      fill: none;
      stroke-width: 2;
    }

    /* Edit Card Body */
    .edit-card-body {
      padding: 24px;
      overflow-y: auto;
      flex: 1;
      scrollbar-width: thin;
      scrollbar-color: var(--border-color) transparent;
    }

    .edit-card-body::-webkit-scrollbar {
      width: 6px;
    }

    .edit-card-body::-webkit-scrollbar-track {
      background: transparent;
    }

    .edit-card-body::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 3px;
    }

    /* Edit Section */
    .edit-section {
      margin-bottom: 20px;
    }

    .edit-section:last-child {
      margin-bottom: 0;
    }

    .edit-section-label {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 8px;
      letter-spacing: -0.01em;
    }

    /* Edit Input */
    .edit-input {
      width: 100%;
      padding: 12px 16px;
      background: var(--bg-tertiary);
      border: 2px solid var(--border-color);
      border-radius: 12px;
      font-size: 14px;
      color: var(--text-primary);
      transition: all 0.2s ease;
      font-family: inherit;
    }

    .edit-input:focus {
      outline: none;
      border-color: var(--accent-color);
      background: var(--bg-secondary);
    }

    .edit-input::placeholder {
      color: var(--text-tertiary);
    }

    /* Edit Textarea */
    .edit-textarea {
      width: 100%;
      min-height: 120px;
      padding: 12px 16px;
      background: var(--bg-tertiary);
      border: 2px solid var(--border-color);
      border-radius: 12px;
      font-size: 14px;
      color: var(--text-primary);
      transition: all 0.2s ease;
      font-family: inherit;
      resize: vertical;
    }

    .edit-textarea:focus {
      outline: none;
      border-color: var(--accent-color);
      background: var(--bg-secondary);
    }

    .edit-textarea::placeholder {
      color: var(--text-tertiary);
    }

    /* Edit Section Hint - å°æç¤ºæ–‡å­— */
    .edit-section-hint {
      font-size: 11px;
      font-weight: 400;
      color: var(--text-tertiary);
      margin-left: 6px;
    }

    /* ==================== BaoBaoBook Binding Selector - ç™¾å®ä¹¦ç»‘å®šé€‰æ‹©å™¨ ==================== */

    .baobaobook-binding-container {
      background: var(--bg-tertiary);
      border: 2px solid var(--border-color);
      border-radius: 12px;
      overflow: hidden;
      transition: all 0.2s ease;
    }

    .baobaobook-binding-container.active {
      border-color: var(--accent-color);
    }

    .baobaobook-binding-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 16px;
      cursor: pointer;
      transition: background 0.2s ease;
    }

    .baobaobook-binding-header:hover {
      background: var(--bg-secondary);
    }

    .baobaobook-binding-summary {
      font-size: 14px;
      color: var(--text-secondary);
      font-family: 'Inter', sans-serif;
    }

    .baobaobook-binding-summary.has-selection {
      color: var(--text-primary);
      font-weight: 500;
    }

    .baobaobook-binding-arrow {
      width: 18px;
      height: 18px;
      stroke: var(--text-tertiary);
      fill: none;
      stroke-width: 2;
      transition: transform 0.3s ease;
    }

    .baobaobook-binding-container.expanded .baobaobook-binding-arrow {
      transform: rotate(180deg);
    }

    .baobaobook-binding-list {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
      border-top: 1px solid transparent;
    }

    .baobaobook-binding-container.expanded .baobaobook-binding-list {
      max-height: 220px;
      overflow-y: auto;
      border-top-color: var(--border-color);
    }

    .baobaobook-binding-empty {
      padding: 20px 16px;
      text-align: center;
      font-size: 13px;
      color: var(--text-tertiary);
    }

    .baobaobook-binding-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
      cursor: pointer;
      transition: background 0.15s ease;
      border-bottom: 1px solid var(--border-color);
    }

    .baobaobook-binding-item:last-child {
      border-bottom: none;
    }

    .baobaobook-binding-item:hover {
      background: var(--bg-secondary);
    }

    .baobaobook-binding-item.selected {
      background: rgba(var(--accent-rgb, 0, 0, 0), 0.08);
    }

    [data-theme="dark"] .baobaobook-binding-item.selected {
      background: rgba(255, 255, 255, 0.08);
    }

    .baobaobook-binding-checkbox {
      width: 18px;
      height: 18px;
      border: 2px solid var(--border-color);
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: all 0.2s ease;
    }

    .baobaobook-binding-item.selected .baobaobook-binding-checkbox {
      background: var(--accent-color);
      border-color: var(--accent-color);
    }

    .baobaobook-binding-checkbox svg {
      width: 12px;
      height: 12px;
      stroke: var(--bg-primary);
      fill: none;
      stroke-width: 2.5;
      opacity: 0;
      transform: scale(0.5);
      transition: all 0.2s ease;
    }

    .baobaobook-binding-item.selected .baobaobook-binding-checkbox svg {
      opacity: 1;
      transform: scale(1);
    }

    .baobaobook-binding-info {
      flex: 1;
      min-width: 0;
    }

    .baobaobook-binding-name {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-primary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .baobaobook-binding-category {
      font-size: 11px;
      color: var(--text-tertiary);
      margin-top: 2px;
    }

    /* ç™¾å®ä¹¦ç»‘å®š - åˆ†ç±»æ ‡ç­¾æ  */
    .baobaobook-binding-category-tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      padding: 8px 12px;
      background: var(--bg-tertiary);
      border-bottom: 1px solid var(--border-color);
    }

    .baobaobook-binding-cat-tab {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 6px 10px;
      font-size: 12px;
      font-weight: 500;
      color: var(--text-secondary);
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      cursor: pointer;
      transition: all 0.15s ease;
      white-space: nowrap;
    }

    .baobaobook-binding-cat-tab:hover {
      background: var(--bg-primary);
      border-color: var(--text-tertiary);
    }

    .baobaobook-binding-cat-tab:active {
      transform: scale(0.96);
    }

    .baobaobook-binding-cat-tab.all-selected {
      background: var(--text-primary);
      color: var(--bg-primary);
      border-color: var(--text-primary);
    }

    [data-theme="dark"] .baobaobook-binding-cat-tab.all-selected {
      background: var(--text-primary);
      color: var(--bg-primary);
      border-color: var(--text-primary);
    }

    .baobaobook-binding-cat-tab .cat-count {
      font-size: 10px;
      font-weight: 400;
      opacity: 0.7;
    }

    .baobaobook-binding-cat-tab.all-selected .cat-count {
      opacity: 0.9;
    }

    /* ç™¾å®ä¹¦ç»‘å®š - åˆ†ç»„æ ‡é¢˜ */
    .baobaobook-binding-group-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 14px 6px;
      background: var(--bg-tertiary);
      border-top: 1px solid var(--border-color);
      margin-top: 4px;
    }

    .baobaobook-binding-group-header:first-of-type {
      margin-top: 0;
      border-top: none;
    }

    .baobaobook-binding-group-header .group-name {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .baobaobook-binding-group-header .group-count {
      font-size: 11px;
      color: var(--text-tertiary);
    }

    .baobaobook-binding-group-header .group-count.all-selected {
      color: var(--text-secondary);
      font-weight: 500;
    }

    /* ç™¾å®ä¹¦ä½ç½®å¾½ç«  - é»‘ç™½ç°é£æ ¼ */
    .baobaobook-position-badge {
      padding: 1px 6px;
      border-radius: 8px;
      font-size: 9px;
      margin-left: 6px;
      font-weight: 600;
      display: inline-block;
      vertical-align: middle;
    }

    /* æ—¥é—´æ¨¡å¼ - æ·±åˆ°æµ…çš„ç°åº¦æ¸å˜ */
    .baobaobook-position-badge.position-before {
      background: linear-gradient(135deg, #1a1a1a 0%, #333333 100%);
      color: #ffffff;
    }

    .baobaobook-position-badge.position-middle {
      background: linear-gradient(135deg, #4a4a4a 0%, #666666 100%);
      color: #ffffff;
    }

    .baobaobook-position-badge.position-mid_after {
      background: linear-gradient(135deg, #888888 0%, #a0a0a0 100%);
      color: #ffffff;
    }

    .baobaobook-position-badge.position-after {
      background: linear-gradient(135deg, #b0b0b0 0%, #c8c8c8 100%);
      color: #333333;
    }

    /* å¤œé—´æ¨¡å¼ - åå‘ç°åº¦ä¿æŒå¯è¯»æ€§ */
    [data-theme="dark"] .baobaobook-position-badge.position-before {
      background: linear-gradient(135deg, #e0e0e0 0%, #c8c8c8 100%);
      color: #1a1a1a;
    }

    [data-theme="dark"] .baobaobook-position-badge.position-middle {
      background: linear-gradient(135deg, #a0a0a0 0%, #888888 100%);
      color: #1a1a1a;
    }

    [data-theme="dark"] .baobaobook-position-badge.position-mid_after {
      background: linear-gradient(135deg, #666666 0%, #555555 100%);
      color: #ffffff;
    }

    [data-theme="dark"] .baobaobook-position-badge.position-after {
      background: linear-gradient(135deg, #444444 0%, #333333 100%);
      color: #e0e0e0;
    }

    /* ==================== Chatbox Binding Selector - èŠå¤©æ¡†ç»‘å®šé€‰æ‹©å™¨ ==================== */

    .chatbox-binding-container {
      background: var(--bg-tertiary);
      border: 2px solid var(--border-color);
      border-radius: 12px;
      overflow: hidden;
      transition: all 0.2s ease;
    }

    .chatbox-binding-container.active {
      border-color: var(--accent-color);
    }

    .chatbox-binding-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 16px;
      cursor: pointer;
      transition: background 0.2s ease;
    }

    .chatbox-binding-header:hover {
      background: var(--bg-secondary);
    }

    .chatbox-binding-summary {
      font-size: 14px;
      color: var(--text-secondary);
      font-family: 'Inter', sans-serif;
    }

    .chatbox-binding-summary.has-selection {
      color: var(--text-primary);
      font-weight: 500;
    }

    .chatbox-binding-arrow {
      width: 18px;
      height: 18px;
      stroke: var(--text-tertiary);
      fill: none;
      stroke-width: 2;
      transition: transform 0.3s ease;
    }

    .chatbox-binding-container.expanded .chatbox-binding-arrow {
      transform: rotate(180deg);
    }

    .chatbox-binding-list {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
      border-top: 1px solid transparent;
    }

    .chatbox-binding-container.expanded .chatbox-binding-list {
      max-height: 220px;
      overflow-y: auto;
      border-top-color: var(--border-color);
    }

    .chatbox-binding-empty {
      padding: 18px 16px;
      text-align: center;
      font-size: 13px;
      color: var(--text-tertiary);
      line-height: 1.5;
    }

    .chatbox-binding-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
      cursor: pointer;
      transition: background 0.15s ease;
      border-bottom: 1px solid var(--border-color);
      user-select: none;
      -webkit-user-select: none;
    }

    .chatbox-binding-item:last-child {
      border-bottom: none;
    }

    .chatbox-binding-item:hover {
      background: var(--bg-secondary);
    }

    .chatbox-binding-item.selected {
      background: rgba(var(--accent-rgb, 0, 0, 0), 0.08);
    }

    [data-theme="dark"] .chatbox-binding-item.selected {
      background: rgba(255, 255, 255, 0.08);
    }

    .chatbox-binding-checkbox {
      width: 18px;
      height: 18px;
      border: 2px solid var(--border-color);
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: all 0.2s ease;
    }

    .chatbox-binding-item.selected .chatbox-binding-checkbox {
      background: var(--accent-color);
      border-color: var(--accent-color);
    }

    .chatbox-binding-checkbox svg {
      width: 12px;
      height: 12px;
      stroke: var(--bg-primary);
      fill: none;
      stroke-width: 2.5;
      opacity: 0;
      transform: scale(0.5);
      transition: all 0.2s ease;
    }

    .chatbox-binding-item.selected .chatbox-binding-checkbox svg {
      opacity: 1;
      transform: scale(1);
    }

    .chatbox-binding-info {
      flex: 1;
      min-width: 0;
    }

    .chatbox-binding-name {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-primary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .chatbox-binding-meta {
      font-size: 11px;
      color: var(--text-tertiary);
      margin-top: 2px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Avatar Upload Area */
    .avatar-upload-area {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      padding: 20px;
      background: var(--bg-tertiary);
      border: 2px dashed var(--border-color);
      border-radius: 16px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .avatar-upload-area:hover {
      border-color: var(--accent-color);
      background: var(--bg-secondary);
    }

    .avatar-preview {
      width: 100px;
      height: 100px;
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      position: relative;
    }

    .avatar-preview svg {
      width: 50%;
      height: 50%;
      stroke: var(--text-tertiary);
      fill: none;
      stroke-width: 1.5;
    }

    .avatar-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .avatar-upload-hint {
      font-size: 12px;
      color: var(--text-secondary);
      text-align: center;
    }

    /* Edit Card Footer */
    .edit-card-footer {
      padding: 20px;
      background: var(--bg-secondary);
      border-top: 1px solid var(--border-color);
      display: flex;
      gap: 12px;
      flex-shrink: 0;
    }

    .edit-btn {
      flex: 1;
      padding: 14px 20px;
      border-radius: 12px;
      border: 2px solid var(--border-color);
      background: var(--bg-tertiary);
      color: var(--text-primary);
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: 'Inter', sans-serif;
    }

    .edit-btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-sm);
    }

    .edit-btn.primary {
      background: var(--accent-color);
      color: var(--bg-primary);
      border-color: var(--accent-color);
    }

    .edit-btn.primary:hover {
      box-shadow: var(--shadow-md);
    }

    /* ==================== Chat App Styles ==================== */

    /* Chat Header */
    .chat-app-header {
      /* ğŸ”¥ ä½¿ç”¨å…¨å±€App Header paddingå˜é‡ */
      padding: var(--app-header-total-padding) 20px 12px;
      background: var(--bg-primary);
      border-bottom: 1px solid var(--border-color);
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(20px);
      animation: slideDown 0.6s ease;
    }

    .chat-header-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .chat-user-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .chat-user-avatar-mini {
      width: 42px;
      height: 42px;
      border-radius: 50%;
      border: 2px solid var(--border-color);
      overflow: hidden;
    }

    .chat-user-avatar-mini img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .chat-user-text-mini {
      flex: 1;
    }

    .chat-user-name-mini {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
      font-family: 'Noto Sans JP', sans-serif;
      margin-bottom: 2px;
    }

    .chat-user-status-mini {
      font-size: 12px;
      color: var(--text-secondary);
      font-family: 'Inter', sans-serif;
      font-style: italic;
    }

    .chat-header-actions-mini {
      display: flex;
      gap: 8px;
    }

    .chat-icon-btn-mini {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .chat-icon-btn-mini:hover {
      background: var(--accent-color);
      transform: scale(1.1);
    }

    .chat-icon-btn-mini svg {
      width: 18px;
      height: 18px;
      stroke: var(--text-primary);
      fill: none;
    }

    .chat-search-bar-mini {
      position: relative;
    }

    .chat-search-input-mini {
      width: 100%;
      height: 36px;
      padding: 0 16px;
      border-radius: 18px;
      border: 1px solid var(--border-color);
      background: var(--bg-secondary);
      color: var(--text-primary);
      font-size: 14px;
      font-family: inherit;
      outline: none;
      transition: all 0.3s ease;
    }

    .chat-search-input-mini:focus {
      border-color: var(--accent-color);
      background: var(--bg-primary);
    }

    /* Stories Section */
    .chat-stories-section {
      padding: 16px 0 16px 20px;
      overflow-x: auto;
      overflow-y: hidden;
      white-space: nowrap;
      scrollbar-width: none;
      animation: fadeIn 0.6s ease 0.2s both;
    }

    .chat-stories-section::-webkit-scrollbar {
      display: none;
    }

    .chat-stories-inner-scroll {
      display: inline-flex;
      gap: 12px;
      padding-right: 20px;
    }

    .story-item-mini {
      display: inline-flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .story-item-mini:hover {
      transform: translateY(-4px);
    }

    .story-avatar-mini {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      position: relative;
      background: var(--bg-tertiary);
      overflow: hidden;
      border: 2px solid var(--accent-color);
      padding: 3px;
    }

    .story-avatar-mini.add-story-mini {
      border: 2px dashed var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
    }

    .story-avatar-mini.add-story-mini svg {
      width: 24px;
      height: 24px;
      stroke: var(--text-secondary);
    }

    .story-avatar-mini img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 50%;
    }

    .story-name-mini {
      font-size: 11px;
      color: var(--text-secondary);
      max-width: 64px;
      overflow: hidden;
      text-overflow: ellipsis;
      font-family: 'Inter', sans-serif;
    }

    /* Chat Requests Section */
    .chat-requests-mini {
      display: none;
      align-items: center;
      justify-content: space-between;
      padding: 16px;
      margin: 0 16px 16px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      animation: slideRight 0.4s ease;
    }

    .chat-requests-mini.has-requests {
      display: flex;
    }

    .chat-requests-mini:hover {
      background: var(--bg-tertiary);
    }

    .requests-left-mini {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .requests-icon-mini {
      width: 36px;
      height: 36px;
      background: var(--bg-tertiary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    .requests-icon-mini svg {
      width: 18px;
      height: 18px;
      stroke: var(--text-primary);
    }

    .requests-icon-mini::after {
      content: '';
      position: absolute;
      top: -2px;
      right: -2px;
      width: 8px;
      height: 8px;
      background: var(--badge-color);
      border-radius: 50%;
      animation: pulse 2s ease infinite;
    }

    .requests-text-mini {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-primary);
    }

    .requests-count-mini {
      font-size: 12px;
      color: var(--text-tertiary);
      font-family: 'JetBrains Mono', monospace;
    }

    .requests-arrow-mini svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-tertiary);
    }

    /* Chat List */
    .chat-list-container {
      padding: 8px 16px 16px;
    }

    .chat-list-header-mini {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 4px;
      margin-bottom: 8px;
    }

    .chat-list-title-mini {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-primary);
      font-family: 'Noto Sans JP', sans-serif;
    }

    .chat-list-count-mini {
      font-size: 12px;
      color: var(--text-tertiary);
      font-family: 'JetBrains Mono', monospace;
    }

    .chat-list-items {
      min-height: 200px;
    }

    .chat-item-mini {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      margin-bottom: 8px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      animation: slideRight 0.4s ease backwards;
    }

    .chat-item-mini:hover {
      background: var(--bg-tertiary);
      transform: translateX(4px);
    }

    .chat-item-mini.pinned::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 3px;
      background: var(--accent-color);
    }

    .chat-avatar-mini {
      width: 52px;
      height: 52px;
      border-radius: 50%;
      border: 2px solid var(--border-color);
      overflow: hidden;
      flex-shrink: 0;
    }

    .chat-avatar-mini img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .chat-info-mini {
      flex: 1;
      min-width: 0;
    }

    .chat-info-top-mini {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 4px;
    }

    .chat-name-mini {
      font-size: 15px;
      font-weight: 600;
      color: var(--text-primary);
      font-family: 'Noto Sans JP', sans-serif;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .chat-time-mini {
      font-size: 11px;
      color: var(--text-tertiary);
      font-family: 'JetBrains Mono', monospace;
      flex-shrink: 0;
      margin-left: 8px;
    }

    .chat-preview-mini {
      font-size: 13px;
      color: var(--text-secondary);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      font-family: 'Inter', sans-serif;
    }

    .chat-badge-mini {
      min-width: 18px;
      height: 18px;
      padding: 0 6px;
      background: var(--badge-color);
      color: white;
      border-radius: 9px;
      font-size: 11px;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'JetBrains Mono', monospace;
      margin-left: 8px;
    }

    /* Empty State */
    .chat-empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 60px 20px;
      text-align: center;
    }

    .chat-empty-state svg {
      width: 80px;
      height: 80px;
      stroke: var(--border-color);
      margin-bottom: 20px;
    }

    .empty-text {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 8px;
    }

    .empty-subtext {
      font-size: 13px;
      color: var(--text-secondary);
    }

    /* Bottom Navigation */
    .chat-bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: auto;
      min-height: 72px;
      background: var(--bg-primary);
      border-top: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: space-around;
      padding: 12px 12px 20px 12px;
      z-index: 1000;
      backdrop-filter: blur(20px);
    }

    .chat-nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      padding: 8px 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }

    .chat-nav-item:hover {
      transform: translateY(-2px);
    }

    .chat-nav-item.active .chat-nav-icon {
      background: var(--accent-color);
      transform: scale(1.1);
    }

    .chat-nav-item.active .chat-nav-label {
      color: var(--text-primary);
      font-weight: 600;
    }

    .chat-nav-icon {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .chat-nav-icon svg {
      width: 18px;
      height: 18px;
      stroke: var(--text-primary);
      fill: none;
    }

    .chat-nav-icon img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 50%;
    }

    .chat-nav-item.center .chat-nav-icon {
      width: 48px;
      height: 48px;
      border: 2px solid var(--accent-color);
      transform: translateY(-8px);
    }

    .chat-nav-label {
      font-size: 10px;
      color: var(--text-secondary);
      font-family: 'Inter', sans-serif;
      transition: all 0.3s ease;
    }

    .chat-nav-item.center .chat-nav-label {
      display: none;
    }

    .chat-nav-badge {
      position: absolute;
      top: 4px;
      right: 8px;
      min-width: 16px;
      height: 16px;
      padding: 0 4px;
      background: var(--badge-color);
      color: white;
      border-radius: 8px;
      font-size: 10px;
      font-weight: 600;
      display: none;
      align-items: center;
      justify-content: center;
      font-family: 'JetBrains Mono', monospace;
    }

    .chat-nav-badge:not(:empty) {
      display: flex;
    }

    /* ==================== Moments Screen (User Feed) ==================== */
    .moments-main-screen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      /* ä½äº Chat åº•éƒ¨æ ï¼ˆ.chat-bottom-nav z-index: 1000ï¼‰ï¼Œä¿æŒä¸€è‡´çš„â€œåº•æ å¸¸é©»â€ä½“éªŒ */
      z-index: 999;
      display: none;
      flex-direction: column;
      opacity: 0;
      transform: translateX(100%);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      overflow: hidden;
      background: var(--bg-primary);
    }

    .moments-main-screen.active {
      display: flex;
      opacity: 1;
      transform: translateX(0);
    }

    /* è¯„è®ºæŠ½å±‰æ‰“å¼€æ—¶éœ€è¦ç›–è¿‡åº•æ  */
    .moments-main-screen.comments-open {
      z-index: 1300;
    }

    #momentsScreen {
      --moments-page: #F2F2F2;
      --moments-card: #FFFFFF;
      --moments-comp: #E0E0E0;
      --moments-text-main: #000000;
      --moments-text-sub: #666666;
      --moments-text-meta: #888888;
      --moments-border: #E5E5E5;
      --moments-reply: #FAFAFA;
      --moments-input: #FAFAFA;
    }

    [data-theme='dark'] #momentsScreen {
      --moments-page: #050505;
      --moments-card: #141414;
      --moments-comp: #1F1F1F;
      --moments-text-main: #FFFFFF;
      --moments-text-sub: #A0A0A0;
      --moments-text-meta: #666666;
      --moments-border: #262626;
      --moments-reply: #1A1A1A;
      --moments-input: #1A1A1A;
    }

    #momentsScreen {
      color: var(--moments-text-main);
      background: var(--moments-page);
      transition: background 0.3s ease, color 0.3s ease;
    }

    #momentsScreen ::selection {
      background: var(--moments-text-main);
      color: var(--moments-card);
    }

    .moments-content {
      width: 100%;
      height: 100%;
      overflow-y: auto;
      scrollbar-width: none;
      /* ç»™åº•æ ç•™å‡ºç©ºé—´ */
      padding: 48px 16px calc(110px + env(safe-area-inset-bottom, 0));
      padding-top: calc(48px + env(safe-area-inset-top, 0));
      background: var(--moments-page);
      color: var(--moments-text-main);
    }

    .moments-content::-webkit-scrollbar {
      display: none;
    }

    #momentsScreen .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }

    #momentsScreen .no-scrollbar::-webkit-scrollbar {
      display: none;
    }

    #momentsScreen .moments-aesthetic-img {
      filter: grayscale(100%) contrast(110%);
      transition: filter 0.5s ease;
    }

    #momentsScreen .moments-aesthetic-img:hover {
      filter: grayscale(0%) contrast(100%);
    }

    #momentsScreen .grayscale {
      filter: grayscale(100%);
    }

    .chat-moments-inner {
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 0;
    }

    .moments-music-card {
      width: 100%;
      background: var(--moments-comp);
      border: 1px solid var(--moments-border);
      box-shadow: var(--shadow-sm);
      padding: 20px;
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 24px;
      transition: background 0.3s ease, border-color 0.3s ease;
    }

    .moments-music-play {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: transparent;
      border: none;
      cursor: pointer;
      padding: 0;
    }

    .moments-music-play:active {
      transform: scale(0.98);
    }

    .moments-music-play-triangle {
      width: 0;
      height: 0;
      border-top: 8px solid transparent;
      border-bottom: 8px solid transparent;
      border-left: 14px solid rgba(0, 0, 0, 0.75);
      margin-left: 2px;
      transition: border-left-color 0.25s ease;
    }

    [data-theme='dark'] .moments-music-play-triangle {
      border-left-color: rgba(255, 255, 255, 0.85);
    }

    .moments-music-meta {
      display: flex;
      flex-direction: column;
      gap: 4px;
      min-width: 0;
    }

    .moments-music-title {
      font-size: 18px;
      font-weight: 400;
      color: var(--moments-text-main);
      line-height: 1.2;
    }

    .moments-music-subtitle {
      font-size: 11px;
      color: var(--moments-text-meta);
      font-weight: 300;
      letter-spacing: 0.02em;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .moments-music-progress {
      font-size: 10px;
      color: var(--moments-text-meta);
      font-weight: 300;
      letter-spacing: 0.08em;
    }

    .moments-posts {
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .moments-post {
      width: 100%;
      background: var(--moments-card);
      border: 1px solid var(--moments-border);
      box-shadow: 0 4px 20px -5px rgba(0, 0, 0, 0.05);
      padding: 28px;
      transition: background 0.3s ease, border-color 0.3s ease;
    }

    [data-theme='dark'] .moments-post {
      box-shadow: 0 4px 20px -5px rgba(0, 0, 0, 0.35);
    }

    .moments-post-meta {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-bottom: 14px;
    }

    .moments-post-meta-line {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 10px;
      color: var(--moments-text-meta);
      font-weight: 300;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      flex-wrap: wrap;
    }

    .moments-post-meta-line .moments-dot {
      font-size: 8px;
      opacity: 0.8;
    }

    .moments-post-meta-action {
      color: var(--moments-text-meta);
      cursor: pointer;
      transition: color 0.2s ease;
    }

    .moments-post-meta-action:hover {
      color: var(--moments-text-sub);
    }

    .moments-post-tags-line {
      font-size: 10px;
      font-weight: 300;
      letter-spacing: 0.08em;
    }

    .moments-post-tags-prefix {
      color: var(--moments-text-meta);
    }

    .moments-post-tags {
      color: rgba(0, 0, 0, 0.8);
      cursor: pointer;
      transition: color 0.2s ease;
    }

    [data-theme='dark'] .moments-post-tags {
      color: rgba(255, 255, 255, 0.85);
    }

    .moments-post-tags:hover {
      color: var(--moments-text-main);
    }

    .moments-post-image {
      width: 100%;
      height: 350px;
      overflow: hidden;
      background: #f2f2f2;
      margin-bottom: 18px;
    }

    [data-theme='dark'] .moments-post-image {
      background: #0f0f0f;
    }

    .moments-post-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .moments-post-title {
      font-size: 32px;
      font-weight: 900;
      letter-spacing: -0.02em;
      color: var(--moments-text-main);
      margin: 0 0 12px 0;
    }

    .moments-post-text {
      font-size: 13px;
      color: var(--moments-text-sub);
      line-height: 1.8;
      text-align: justify;
      word-break: break-word;
    }

    .moments-post-text .moments-bold {
      font-weight: 700;
      color: var(--moments-text-sub);
    }

    .moments-post-extra {
      margin-top: 14px;
      padding-top: 12px;
      border-top: 1px dotted var(--moments-border);
      font-size: 10px;
      color: var(--moments-text-meta);
      line-height: 1.6;
      font-weight: 300;
    }

    .moments-post-stats {
      margin-top: 12px;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 10px;
      color: var(--moments-text-meta);
      font-weight: 300;
      letter-spacing: 0.08em;
    }

    .moments-post-stats button {
      background: transparent;
      border: none;
      padding: 0;
      color: inherit;
      cursor: pointer;
      transition: color 0.2s ease;
    }

    .moments-post-stats button:hover {
      color: var(--moments-text-main);
    }

    .moments-bottom-nav {
      width: 100%;
      background: var(--moments-comp);
      border: 1px solid var(--moments-border);
      padding: 12px;
      margin-top: 14px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      font-size: 10px;
      color: var(--moments-text-meta);
    }

    .moments-nav-btn {
      background: transparent;
      border: none;
      padding: 0;
      cursor: pointer;
      color: inherit;
      font-weight: 300;
      letter-spacing: 0.12em;
      transition: color 0.2s ease;
    }

    .moments-nav-btn:hover {
      color: var(--moments-text-main);
    }

    .moments-credits {
      margin-top: 14px;
      text-align: center;
      font-size: 10px;
      color: rgba(0, 0, 0, 0.35);
      font-weight: 300;
      letter-spacing: 0.08em;
    }

    [data-theme='dark'] .moments-credits {
      color: rgba(255, 255, 255, 0.25);
    }

    /* Comments Backdrop */
    .moments-comment-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.30);
      backdrop-filter: blur(2px);
      z-index: 1500;
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
      transition: opacity 0.28s ease, visibility 0.28s ease;
    }

    .moments-comment-backdrop.active {
      opacity: 1;
      visibility: visible;
      pointer-events: auto;
    }

    /* Comments Drawer */
    .moments-comment-drawer {
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      height: 80%;
      background: var(--moments-card);
      border-top: 1px solid var(--moments-border);
      z-index: 1501;
      transform: translateY(100%);
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), background 0.3s ease, border-color 0.3s ease;
      box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.12);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    [data-theme='dark'] .moments-comment-drawer {
      box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.45);
    }

    .moments-comment-drawer.active {
      transform: translateY(0);
    }

    .moments-comment-drawer-header {
      padding: 12px 18px 12px;
      border-bottom: 1px solid var(--moments-border);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      flex-shrink: 0;
      cursor: grab;
      user-select: none;
      -webkit-user-select: none;
    }

    .moments-comment-drawer-header:active {
      cursor: grabbing;
    }

    .moments-comment-handle {
      width: 40px;
      height: 4px;
      background: rgba(0, 0, 0, 0.18);
    }

    [data-theme='dark'] .moments-comment-handle {
      background: rgba(255, 255, 255, 0.18);
    }

    .moments-comment-title {
      font-size: 14px;
      font-weight: 800;
      color: var(--moments-text-main);
    }

    .moments-comment-divider {
      width: 32px;
      height: 1px;
      background: var(--moments-border);
    }

    .moments-comment-list {
      flex: 1;
      overflow-y: auto;
      padding: 18px;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .moments-comment-row {
      display: flex;
      gap: 12px;
      align-items: flex-start;
    }

    .moments-comment-row.reply {
      margin-left: 44px;
      background: var(--moments-reply);
      border: 1px solid var(--moments-border);
      padding: 12px;
    }

    .moments-comment-avatar {
      width: 32px;
      height: 32px;
      overflow: hidden;
      background: rgba(0, 0, 0, 0.08);
      flex-shrink: 0;
      margin-top: 2px;
    }

    .moments-comment-row.reply .moments-comment-avatar {
      width: 24px;
      height: 24px;
    }

    .moments-comment-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      filter: none;
      transition: opacity 0.5s ease;
    }

    .moments-comment-row:hover .moments-comment-avatar img {
      filter: none;
    }

    .moments-comment-body {
      flex: 1;
      min-width: 0;
    }

    .moments-comment-head {
      display: flex;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 4px;
      flex-wrap: wrap;
    }

    .moments-comment-user {
      font-size: 13px;
      font-weight: 800;
      color: var(--moments-text-main);
    }

    .moments-comment-time {
      font-size: 10px;
      font-weight: 300;
      color: var(--moments-text-meta);
    }

    .moments-comment-text {
      font-size: 13px;
      color: var(--moments-text-sub);
      line-height: 1.6;
      margin-bottom: 8px;
      word-break: break-word;
    }

    .moments-comment-actions {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 10px;
      font-weight: 300;
      letter-spacing: 0.08em;
      color: var(--moments-text-meta);
    }

    .moments-comment-actions button {
      background: transparent;
      border: none;
      padding: 0;
      cursor: pointer;
      color: inherit;
      transition: color 0.2s ease;
    }

    .moments-comment-actions button:hover {
      color: var(--moments-text-main);
    }

    .moments-comment-input-wrap {
      flex-shrink: 0;
      padding: 14px 18px;
      border-top: 1px solid var(--moments-border);
      background: var(--moments-card);
    }

    .moments-comment-input-row {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .moments-comment-input {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 10px;
      background: var(--moments-input);
      border: 1px solid var(--moments-border);
      padding: 10px 12px;
      transition: border-color 0.2s ease;
    }

    .moments-comment-input:focus-within {
      border-color: var(--moments-text-meta);
    }

    .moments-comment-input input {
      flex: 1;
      background: transparent;
      border: none;
      outline: none;
      color: var(--moments-text-main);
      font-size: 13px;
    }

    .moments-comment-input input::placeholder {
      color: var(--moments-text-meta);
    }

    .moments-comment-send {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: transparent;
      border: none;
      padding: 0;
      cursor: pointer;
      color: var(--moments-text-sub);
      transition: color 0.2s ease;
    }

    .moments-comment-send:hover {
      color: var(--moments-text-main);
    }

    .moments-comment-send svg {
      width: 20px;
      height: 20px;
      stroke: currentColor;
      fill: none;
    }

    /* ==================== Moments Screen (Cinematic - è§‚å½±ç‰ˆ) ==================== */
    /* è¯´æ˜ï¼šè¿™ä¸ªå—æ”¾åœ¨æ—§ Moments æ ·å¼ä¹‹åï¼Œç”¨äºå®Œå…¨è¦†ç›–æ—§å®ç°ã€‚ */

    #momentsScreen {
      --cine-black: #0a0a0a;
      --cine-dark: #121212;
      --cine-gray: #2a2a2a;
      --cine-light: #e5e5e5;
      --cine-white: #ffffff;

      --moments-cine-bg: var(--cine-light);
      --moments-cine-shell: var(--cine-white);
      --moments-cine-text: var(--cine-black);
      --moments-cine-border: #e5e5e5;
      --moments-cine-border-2: #dcdcdc;
      --moments-cine-muted: rgba(0, 0, 0, 0.55);
      --moments-cine-muted-2: rgba(0, 0, 0, 0.40);
    }

    [data-theme='dark'] #momentsScreen {
      --moments-cine-bg: var(--cine-black);
      --moments-cine-shell: var(--cine-black);
      --moments-cine-text: var(--cine-white);
      --moments-cine-border: #111111;
      --moments-cine-border-2: #202020;
      --moments-cine-muted: rgba(255, 255, 255, 0.55);
      --moments-cine-muted-2: rgba(255, 255, 255, 0.40);
    }

    /* è¦†ç›–æ—§çš„ moments-main-screen è¡Œä¸ºï¼šä¸ä½¿ç”¨ display:noneï¼Œä¿è¯é€€å‡ºåŠ¨ç”»å­˜åœ¨ */
    #momentsScreen.moments-main-screen {
      z-index: 2200;
      display: flex;
      background: var(--moments-cine-bg);
      transform: translateX(100%);
      opacity: 0;
      pointer-events: none;
      transition: transform 0.35s cubic-bezier(0.28, 0.84, 0.42, 1),
                  opacity 0.35s cubic-bezier(0.28, 0.84, 0.42, 1);
      will-change: transform, opacity;
      contain: layout style paint;
      touch-action: pan-y;
    }

    #momentsScreen.moments-main-screen.active {
      transform: translateX(0);
      opacity: 1;
      pointer-events: auto;
    }

    #momentsScreen.moments-main-screen.moments-dragging {
      transition: none !important;
    }

    #momentsScreen ::selection {
      background: var(--moments-cine-text);
      color: var(--moments-cine-shell);
    }

    #momentsScreen .hide-scrollbar::-webkit-scrollbar { display: none; }
    #momentsScreen .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

    #momentsScreen .moments-film-grain {
      position: absolute;
      inset: 0;
      pointer-events: none;
      z-index: 50;
      opacity: 0.05;
      background-image: url("moments-grain.svg");
    }

    #momentsScreen .moments-cine-shell {
      position: relative;
      width: 100%;
      height: 100%;
      background: var(--moments-cine-shell);
      color: var(--moments-cine-text);
      font-family: 'Inter', sans-serif;
      box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);
    }

    #momentsScreen .moments-cine-topbar {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      padding: 16px;
      /* ğŸ”¥ åŒæ­¥å…¨å±€é¡¶æ paddingç®¡ç†ç³»ç»Ÿï¼ˆé¿å…é®æŒ¡ç³»ç»ŸçŠ¶æ€æ /åˆ˜æµ·åŒºåŸŸï¼‰ */
      padding-top: calc(var(--total-top-padding) + 4px);
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 120;
      color: #ffffff;
      mix-blend-mode: difference;
      pointer-events: none;
    }

    #momentsScreen .moments-cine-top-left,
    #momentsScreen .moments-cine-top-right {
      display: flex;
      align-items: center;
      gap: 12px;
      pointer-events: auto;
    }

    #momentsScreen .moments-cine-top-right {
      gap: 16px;
    }

    #momentsScreen .moments-cine-top-btn {
      width: 38px;
      height: 38px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 0;
      background: transparent;
      border: none;
      backdrop-filter: none;
      cursor: pointer;
      padding: 0;
      transition: opacity 0.2s ease, transform 0.15s ease;
      color: #ffffff;
      opacity: 0.92;
    }

    #momentsScreen .moments-cine-icon-btn {
      width: 38px;
      height: 38px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 0;
      background: transparent;
      border: none;
      backdrop-filter: none;
      cursor: pointer;
      padding: 0;
      transition: opacity 0.2s ease, transform 0.15s ease;
      color: #ffffff;
      opacity: 0.92;
    }

    #momentsScreen .moments-cine-top-btn:hover { opacity: 1; }

    #momentsScreen .moments-cine-icon-btn:hover {
      opacity: 1;
    }

    #momentsScreen .moments-cine-top-btn:active,
    #momentsScreen .moments-cine-icon-btn:active {
      transform: scale(0.98);
    }

    #momentsScreen .moments-cine-top-btn svg {
      width: 18px;
      height: 18px;
      display: block;
    }

    #momentsScreen .moments-cine-icon-btn svg {
      width: 20px;
      height: 20px;
      display: block;
    }

    #momentsScreen .moments-cine-scroll {
      height: 100%;
      width: 100%;
      overflow-y: auto;
      overflow-x: hidden;
      background: var(--moments-cine-shell);
      padding-bottom: 84px;
      -webkit-overflow-scrolling: touch;
      position: relative;
    }

    /* Bottom Fade (å›ºå®šåœ¨å†…å®¹ä¸Šæ–¹ï¼Œä¸éšæ»šåŠ¨) */
    #momentsScreen .moments-cine-bottom-fade {
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      height: 80px;
      background: linear-gradient(to top, var(--moments-cine-shell), transparent);
      pointer-events: none;
      z-index: 40;
    }

    /* ==================== Moments Settings Sheet (Cinematic) ==================== */
    #momentsScreen {
      --moments-settings-card-bg: rgba(0, 0, 0, 0.035);
      --moments-settings-muted: rgba(0, 0, 0, 0.55);
      --moments-settings-muted-2: rgba(0, 0, 0, 0.35);
      --moments-settings-backdrop: rgba(0, 0, 0, 0.55);
    }

    [data-theme='dark'] #momentsScreen {
      --moments-settings-card-bg: rgba(255, 255, 255, 0.06);
      --moments-settings-muted: rgba(255, 255, 255, 0.55);
      --moments-settings-muted-2: rgba(255, 255, 255, 0.35);
      --moments-settings-backdrop: rgba(0, 0, 0, 0.62);
    }

    #momentsScreen .moments-settings-overlay {
      position: absolute;
      inset: 0;
      z-index: 2600;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.25s ease;
    }

    #momentsScreen .moments-settings-overlay.active {
      opacity: 1;
      pointer-events: auto;
    }

    #momentsScreen .moments-settings-backdrop {
      position: absolute;
      inset: 0;
      background: var(--moments-settings-backdrop);
      backdrop-filter: blur(10px);
      opacity: 0;
      transition: opacity 0.25s ease;
    }

    #momentsScreen .moments-settings-overlay.active .moments-settings-backdrop {
      opacity: 1;
    }

    #momentsScreen .moments-settings-sheet {
      position: relative;
      width: min(420px, 100%);
      max-height: calc(92% - env(safe-area-inset-top, 0px));
      background: var(--moments-cine-shell);
      color: var(--moments-cine-text);
      border: 1px solid var(--moments-cine-border);
      border-bottom: none;
      border-radius: 22px 22px 0 0;
      box-shadow: 0 -18px 60px rgba(0, 0, 0, 0.35);
      overflow: hidden;
      transform: translateY(110%);
      transition: transform 0.38s cubic-bezier(0.22, 1, 0.36, 1);
      padding-bottom: env(safe-area-inset-bottom, 0px);
    }

    #momentsScreen .moments-settings-overlay.active .moments-settings-sheet {
      transform: translateY(0);
    }

    #momentsScreen .moments-settings-handle {
      width: 54px;
      height: 4px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.18);
      margin: 10px auto 2px;
    }

    [data-theme='dark'] #momentsScreen .moments-settings-handle {
      background: rgba(255, 255, 255, 0.22);
    }

    /* ä¸€ç‚¹â€œå¼‚å½¢â€å…ƒç´ ï¼šæ–œåˆ‡ç¥¨æ ¹/èƒ¶ç‰‡æ ‡è¯† */
    #momentsScreen .moments-settings-quirk {
      position: absolute;
      top: 10px;
      left: 16px;
      width: 72px;
      height: 18px;
      background: var(--moments-settings-card-bg);
      border: 1px solid var(--moments-cine-border);
      border-radius: 10px;
      clip-path: polygon(0 0, 86% 0, 100% 50%, 86% 100%, 0 100%, 6% 50%);
      opacity: 0.9;
      pointer-events: none;
    }

    #momentsScreen .moments-settings-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 16px 10px;
    }

    #momentsScreen .moments-settings-title {
      font-size: 14px;
      font-weight: 900;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
    }

    #momentsScreen .moments-settings-close {
      width: 34px;
      height: 34px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border: none;
      background: transparent;
      color: var(--moments-cine-text);
      cursor: pointer;
      padding: 0;
      opacity: 0.7;
      transition: opacity 0.2s ease, transform 0.15s ease;
    }

    #momentsScreen .moments-settings-close:hover { opacity: 1; }
    #momentsScreen .moments-settings-close:active { transform: scale(0.98); }
    #momentsScreen .moments-settings-close svg { width: 18px; height: 18px; display: block; }

    #momentsScreen .moments-settings-content {
      padding: 8px 16px 14px;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      max-height: calc(92vh - 88px);
    }

    #momentsScreen .moments-settings-card {
      background: var(--moments-settings-card-bg);
      border: 1px solid var(--moments-cine-border);
      border-radius: 18px;
      padding: 14px;
      margin-bottom: 12px;
    }

    #momentsScreen .moments-settings-card-title {
      font-size: 12px;
      font-weight: 800;
      letter-spacing: 0.06em;
      margin-bottom: 10px;
      opacity: 0.9;
    }

    #momentsScreen .moments-settings-row {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 12px 12px;
      border-radius: 14px;
      border: 1px solid var(--moments-cine-border);
      background: transparent;
      color: var(--moments-cine-text);
      cursor: pointer;
      transition: background 0.2s ease, transform 0.15s ease, opacity 0.2s ease;
    }

    #momentsScreen .moments-settings-row.disabled {
      cursor: not-allowed;
      opacity: 0.6;
    }

    #momentsScreen .moments-settings-row-left { min-width: 0; }
    #momentsScreen .moments-settings-row-label {
      font-size: 13px;
      font-weight: 800;
    }
    #momentsScreen .moments-settings-row-desc {
      margin-top: 4px;
      font-size: 10px;
      color: var(--moments-settings-muted);
      letter-spacing: 0.02em;
    }
    #momentsScreen .moments-settings-row-right {
      font-size: 10px;
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
      color: var(--moments-settings-muted-2);
      letter-spacing: 0.12em;
      text-transform: uppercase;
      white-space: nowrap;
    }

    #momentsScreen .moments-settings-field { margin-top: 10px; }
    #momentsScreen .moments-settings-label {
      font-size: 11px;
      font-weight: 700;
      margin-bottom: 8px;
      color: var(--moments-settings-muted);
      letter-spacing: 0.02em;
    }

    #momentsScreen .moments-settings-input,
    #momentsScreen .moments-settings-textarea {
      width: 100%;
      border: 1px solid var(--moments-cine-border);
      background: transparent;
      color: var(--moments-cine-text);
      border-radius: 14px;
      padding: 10px 12px;
      font-size: 13px;
      outline: none;
      transition: border-color 0.2s ease, background 0.2s ease;
    }

    #momentsScreen .moments-settings-textarea {
      resize: none;
      line-height: 1.5;
      min-height: 68px;
    }

    #momentsScreen .moments-settings-input:focus,
    #momentsScreen .moments-settings-textarea:focus {
      border-color: rgba(0, 0, 0, 0.45);
    }

    [data-theme='dark'] #momentsScreen .moments-settings-input:focus,
    [data-theme='dark'] #momentsScreen .moments-settings-textarea:focus {
      border-color: rgba(255, 255, 255, 0.35);
    }

    #momentsScreen .moments-settings-hint {
      margin-top: 8px;
      font-size: 10px;
      color: var(--moments-settings-muted-2);
      line-height: 1.4;
    }

    #momentsScreen .moments-settings-media {
      margin-top: 12px;
      border: 1px solid var(--moments-cine-border);
      border-radius: 16px;
      padding: 12px;
      background: transparent;
    }

    #momentsScreen .moments-settings-media-line {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    #momentsScreen .moments-settings-media-preview {
      border: 1px solid var(--moments-cine-border);
      background: var(--moments-cine-bg);
      overflow: hidden;
      flex: 0 0 auto;
      position: relative;
    }

    #momentsScreen .moments-settings-media-preview.avatar {
      width: 46px;
      height: 46px;
      border-radius: 999px;
    }

    #momentsScreen .moments-settings-media-preview.cover {
      width: 78px;
      height: 46px;
      border-radius: 14px;
    }

    #momentsScreen .moments-settings-media-preview img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    #momentsScreen .moments-settings-media-meta { min-width: 0; }
    #momentsScreen .moments-settings-media-title {
      font-size: 12px;
      font-weight: 800;
      letter-spacing: 0.02em;
    }
    #momentsScreen .moments-settings-media-sub {
      margin-top: 4px;
      font-size: 10px;
      color: var(--moments-settings-muted);
      line-height: 1.35;
    }

    #momentsScreen .moments-settings-media-actions {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    #momentsScreen .moments-settings-mini-btn {
      height: 34px;
      padding: 0 12px;
      border-radius: 999px;
      border: 1px solid var(--moments-cine-border);
      background: transparent;
      color: var(--moments-cine-text);
      font-size: 12px;
      font-weight: 800;
      cursor: pointer;
      transition: transform 0.15s ease, opacity 0.2s ease, background 0.2s ease;
    }

    #momentsScreen .moments-settings-mini-btn:disabled {
      cursor: not-allowed;
      opacity: 0.4;
    }

    #momentsScreen .moments-settings-mini-btn.danger {
      color: rgba(180, 40, 40, 0.95);
      border-color: rgba(180, 40, 40, 0.35);
    }

    [data-theme='dark'] #momentsScreen .moments-settings-mini-btn.danger {
      color: rgba(255, 120, 120, 0.95);
      border-color: rgba(255, 120, 120, 0.25);
    }

    #momentsScreen .moments-settings-mini-btn:not(:disabled):hover {
      background: rgba(0, 0, 0, 0.04);
    }

    [data-theme='dark'] #momentsScreen .moments-settings-mini-btn:not(:disabled):hover {
      background: rgba(255, 255, 255, 0.06);
    }

    #momentsScreen .moments-settings-mini-btn:not(:disabled):active { transform: scale(0.98); }

    #momentsScreen .moments-settings-footer {
      position: sticky;
      bottom: 0;
      padding: 10px 16px calc(22px + env(safe-area-inset-bottom, 0px));
      background: linear-gradient(to top, var(--moments-cine-shell), rgba(0, 0, 0, 0));
      display: flex;
      gap: 10px;
    }

    #momentsScreen .moments-settings-footer-btn {
      flex: 1;
      height: 42px;
      border-radius: 14px;
      border: 1px solid var(--moments-cine-border);
      background: transparent;
      color: var(--moments-cine-text);
      font-size: 13px;
      font-weight: 900;
      cursor: pointer;
      transition: transform 0.15s ease, background 0.2s ease;
    }

    #momentsScreen .moments-settings-footer-btn.primary {
      background: var(--moments-cine-text);
      color: var(--moments-cine-shell);
      border-color: transparent;
    }

    #momentsScreen .moments-settings-footer-btn:active { transform: scale(0.99); }

    #momentsScreen .moments-cine-img {
      filter: none;
      transition: opacity 0.7s ease, transform 0.7s ease;
    }

    /* Header */
    #momentsScreen .moments-cine-header {
      position: relative;
    }

    #momentsScreen .moments-cine-cover {
      position: relative;
      width: 100%;
      height: 256px;
      overflow: hidden;
    }

    #momentsScreen .moments-cine-cover img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    #momentsScreen .moments-cine-cover-grad {
      position: absolute;
      inset: 0;
      background: linear-gradient(to bottom, transparent, rgba(10, 10, 10, 0.90));
      z-index: 10;
      pointer-events: none;
    }

    #momentsScreen .moments-cine-user-row {
      position: relative;
      z-index: 20;
      margin-top: -48px;
      padding: 0 24px;
      display: flex;
      align-items: flex-end;
      gap: 16px;
    }

    #momentsScreen .moments-cine-avatar {
      width: 96px;
      height: 96px;
      border-radius: 999px;
      overflow: hidden;
      border: 4px solid #ffffff;
      background: #1a1a1a;
      box-shadow: 0 16px 40px rgba(0, 0, 0, 0.18);
      flex-shrink: 0;
      transition: border-color 0.3s ease;
    }

    [data-theme='dark'] #momentsScreen .moments-cine-avatar {
      border-color: var(--cine-black);
    }

    #momentsScreen .moments-cine-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    #momentsScreen .moments-cine-user-meta {
      padding-bottom: 8px;
      min-width: 0;
    }

    #momentsScreen .moments-cine-name {
      font-size: 22px;
      font-weight: 800;
      letter-spacing: 0.02em;
      color: var(--moments-cine-text);
    }

    #momentsScreen .moments-cine-since {
      margin-top: 6px;
      font-size: 12px;
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
      color: var(--moments-cine-muted);
    }

    #momentsScreen .moments-cine-group {
      margin-top: 6px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
      color: rgba(255, 255, 255, 0.60);
    }

    [data-theme='light'] #momentsScreen .moments-cine-group {
      color: rgba(0, 0, 0, 0.45);
    }

    #momentsScreen .moments-cine-group svg {
      width: 14px;
      height: 14px;
      opacity: 0.9;
    }

    /* Signature */
    #momentsScreen .moments-cine-signature {
      padding: 20px 40px 0;
      text-align: center;
      position: relative;
    }

    #momentsScreen .moments-cine-quote {
      position: absolute;
      top: 16px;
      left: 24px;
      font-size: 22px;
      opacity: 0.28;
      font-family: 'Playfair Display', serif;
      color: var(--moments-cine-muted);
    }

    #momentsScreen .moments-cine-signature-text {
      font-size: 13px;
      color: var(--moments-cine-muted);
      font-family: 'Playfair Display', serif;
      font-style: italic;
      line-height: 1.7;
      letter-spacing: 0.02em;
    }

    #momentsScreen .moments-cine-signature-line {
      width: 32px;
      height: 1px;
      background: var(--moments-cine-border-2);
      margin: 14px auto 0;
      opacity: 0.65;
    }

    /* Sections */
    #momentsScreen .moments-cine-section {
      padding: 0 16px;
      margin-top: 28px;
    }

    #momentsScreen .moments-cine-section-title {
      font-size: 13px;
      font-weight: 700;
      letter-spacing: 0.02em;
      color: var(--moments-cine-text);
      margin-bottom: 14px;
    }

    /* Stats Card */
    #momentsScreen .moments-cine-stats-card {
      background: rgba(0, 0, 0, 0.04);
      border: 1px solid var(--moments-cine-border);
      border-radius: 18px;
      padding: 18px;
      box-shadow: 0 12px 28px rgba(0, 0, 0, 0.10);
      cursor: pointer;
      transition: transform 0.16s ease, box-shadow 0.2s ease;
    }

    #momentsScreen .moments-cine-stats-card:active {
      transform: translateY(1px) scale(0.995);
    }

    [data-theme='dark'] #momentsScreen .moments-cine-stats-card {
      background: #1A1A1A;
      border-color: #222;
      box-shadow: 0 12px 28px rgba(0, 0, 0, 0.45);
    }

    #momentsScreen .moments-cine-stats-head {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 14px;
    }

    #momentsScreen .moments-cine-info-btn {
      width: 28px;
      height: 28px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border: none;
      background: transparent;
      padding: 0;
      cursor: pointer;
      color: var(--moments-cine-muted);
    }

    #momentsScreen .moments-cine-info-btn svg {
      width: 18px;
      height: 18px;
    }

    #momentsScreen .moments-cine-stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      text-align: center;
    }

    #momentsScreen .moments-cine-stat-split {
      border-left: 1px solid rgba(0, 0, 0, 0.16);
    }

    [data-theme='dark'] #momentsScreen .moments-cine-stat-split {
      border-left-color: rgba(255, 255, 255, 0.16);
    }

    #momentsScreen .moments-cine-stat-value {
      font-size: 20px;
      font-weight: 800;
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
      color: var(--moments-cine-text);
    }

    #momentsScreen .moments-cine-stat-label {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: var(--moments-cine-muted);
      margin-top: 6px;
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
    }

    /* Favorites */
    #momentsScreen .moments-cine-favs {
      display: flex;
      gap: 12px;
      overflow-x: auto;
      padding-bottom: 12px;
    }

    #momentsScreen .moments-cine-poster {
      flex: 0 0 auto;
      width: 112px;
      aspect-ratio: 2 / 3;
      position: relative;
      overflow: hidden;
      border-radius: 12px;
      background: #111;
      box-shadow: 0 10px 22px rgba(0, 0, 0, 0.12);
      cursor: pointer;
      user-select: none;
      transition: transform 0.16s ease, box-shadow 0.2s ease;
    }

    #momentsScreen .moments-cine-poster:active {
      transform: translateY(1px) scale(0.99);
    }

    #momentsScreen .moments-cine-poster img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    #momentsScreen .moments-cine-poster-grad {
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      padding: 10px 10px 8px;
      background: linear-gradient(to top, rgba(0, 0, 0, 0.95), transparent);
    }

    #momentsScreen .moments-cine-poster-title {
      font-size: 10px;
      color: #fff;
      text-align: center;
      font-family: 'Cinzel', serif;
      letter-spacing: 0.02em;
    }

    #momentsScreen .moments-cine-divider {
      border: none;
      height: 1px;
      background: rgba(0, 0, 0, 0.14);
      margin: 24px 16px 0;
      opacity: 0.6;
    }

    [data-theme='dark'] #momentsScreen .moments-cine-divider {
      background: rgba(255, 255, 255, 0.16);
    }

    /* Feed */
    #momentsScreen .moments-cine-feed {
      padding-bottom: 80px;
    }

    #momentsScreen .moments-cine-feed-head {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 18px;
    }

    #momentsScreen .moments-cine-rec {
      font-size: 12px;
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
      color: var(--moments-cine-muted);
      letter-spacing: 0.08em;
    }

    #momentsScreen .moments-cine-timeline {
      position: relative;
      padding-left: 16px;
      border-left: 1px dashed rgba(255, 255, 255, 0.16);
      display: flex;
      flex-direction: column;
      gap: 48px;
    }

    [data-theme='light'] #momentsScreen .moments-cine-timeline {
      border-left-color: rgba(0, 0, 0, 0.18);
    }

    #momentsScreen .moments-cine-item {
      position: relative;
    }

    #momentsScreen .moments-cine-dot {
      position: absolute;
      left: -22px;
      top: 8px;
      width: 12px;
      height: 12px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.30);
      z-index: 10;
    }

    [data-theme='light'] #momentsScreen .moments-cine-dot {
      border-color: rgba(0, 0, 0, 0.24);
    }

    #momentsScreen .moments-cine-dot-dark { background: var(--cine-black); }
    #momentsScreen .moments-cine-dot-light { background: #ffffff; }
    #momentsScreen .moments-cine-dot-gray { background: #777; }

    #momentsScreen .moments-cine-meta {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }

    #momentsScreen .moments-cine-time {
      font-size: 12px;
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
      color: var(--moments-cine-muted);
    }

    #momentsScreen .moments-cine-badge {
      font-size: 10px;
      border: 1px solid rgba(255, 255, 255, 0.24);
      padding: 2px 6px;
      border-radius: 6px;
      color: rgba(255, 255, 255, 0.55);
      letter-spacing: 0.08em;
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
    }

    [data-theme='light'] #momentsScreen .moments-cine-badge {
      border-color: rgba(0, 0, 0, 0.20);
      color: rgba(0, 0, 0, 0.45);
    }

    /* Frame Card */
    #momentsScreen .moments-cine-frame {
      position: relative;
      width: 100%;
      aspect-ratio: 16 / 9;
      background: #000;
      overflow: hidden;
      border-top: 4px solid #000;
      border-bottom: 4px solid #000;
      box-shadow: 0 12px 26px rgba(0, 0, 0, 0.20);
    }

    #momentsScreen .moments-cine-frame-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0.86;
      transition: opacity 0.7s ease, transform 0.7s ease;
    }

    #momentsScreen .moments-cine-item:hover .moments-cine-frame-img {
      opacity: 1;
      transform: scale(1.02);
    }

    #momentsScreen .moments-cine-viewfinder {
      position: absolute;
      inset: 0;
      margin: 16px;
      border: 1px solid rgba(255, 255, 255, 0.20);
      pointer-events: none;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    #momentsScreen .moments-cine-vf-top,
    #momentsScreen .moments-cine-vf-bot {
      padding: 8px;
      display: flex;
      justify-content: space-between;
      font-size: 8px;
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
      color: rgba(255, 255, 255, 0.70);
      letter-spacing: 0.08em;
    }

    #momentsScreen .moments-cine-vf-mid {
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 22px;
      color: rgba(255, 255, 255, 0.55);
      line-height: 1;
    }

    #momentsScreen .moments-cine-caption {
      margin-top: 12px;
    }

    #momentsScreen .moments-cine-caption-text {
      font-size: 14px;
      font-family: 'Playfair Display', serif;
      font-style: italic;
      color: rgba(255, 255, 255, 0.70);
      line-height: 1.6;
    }

    [data-theme='light'] #momentsScreen .moments-cine-caption-text {
      color: rgba(0, 0, 0, 0.62);
    }

    #momentsScreen .moments-cine-actions {
      margin-top: 12px;
      display: flex;
      gap: 16px;
      font-size: 10px;
      color: rgba(255, 255, 255, 0.55);
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
      letter-spacing: 0.18em;
      text-transform: uppercase;
    }

    [data-theme='light'] #momentsScreen .moments-cine-actions {
      color: rgba(0, 0, 0, 0.55);
    }

    #momentsScreen .moments-cine-actions button {
      background: transparent;
      border: none;
      padding: 0;
      cursor: pointer;
      color: inherit;
      transition: color 0.2s ease;
      font-family: inherit;
    }

    #momentsScreen .moments-cine-actions button:hover {
      color: var(--moments-cine-text);
    }

    /* Comments (Cinematic) */
    #momentsScreen .moments-comments-container {
      max-height: 0;
      overflow: hidden;
      opacity: 0;
      margin-top: 0;
      transition: max-height 0.6s cubic-bezier(0.22, 1, 0.36, 1),
                  opacity 0.6s ease,
                  margin-top 0.6s ease;
      will-change: max-height, opacity;
    }

    #momentsScreen .moments-comments-container.open {
      max-height: 560px;
      opacity: 1;
      margin-top: 14px;
    }

    #momentsScreen .moments-comments-inner {
      margin-top: 16px;
      padding-left: 16px;
      border-left: 2px solid var(--moments-cine-border-2);
      position: relative;
    }

    [data-theme='light'] #momentsScreen .moments-comments-inner {
      border-left-color: var(--moments-cine-border-2);
    }

    #momentsScreen .moments-comments-label {
      position: absolute;
      top: -12px;
      left: 12px;
      font-size: 10px;
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
      letter-spacing: 0.14em;
      color: rgba(255, 255, 255, 0.40);
      background: var(--cine-dark);
      padding: 2px 6px;
      user-select: none;
    }

    [data-theme='light'] #momentsScreen .moments-comments-label {
      color: rgba(0, 0, 0, 0.45);
      background: var(--moments-cine-shell);
    }

    #momentsScreen .moments-comments-list {
      display: flex;
      flex-direction: column;
      gap: 14px;
      padding-top: 10px;
    }

    #momentsScreen .moments-comment-item {
      display: flex;
      gap: 12px;
      align-items: flex-start;
    }

    #momentsScreen .moments-comment-avatar {
      width: 24px;
      height: 24px;
      border-radius: 2px;
      overflow: hidden;
      flex: 0 0 auto;
      background: rgba(255, 255, 255, 0.10);
    }

    [data-theme='light'] #momentsScreen .moments-comment-avatar {
      background: rgba(0, 0, 0, 0.10);
    }

    #momentsScreen .moments-comment-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      filter: none;
      opacity: 0.72;
    }

    #momentsScreen .moments-comment-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    #momentsScreen .moments-comment-name {
      font-size: 10px;
      font-weight: 800;
      letter-spacing: 0.06em;
      color: rgba(255, 255, 255, 0.78);
    }

    [data-theme='light'] #momentsScreen .moments-comment-name {
      color: rgba(0, 0, 0, 0.70);
    }

    #momentsScreen .moments-comment-time {
      font-size: 10px;
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
      color: rgba(255, 255, 255, 0.38);
      letter-spacing: 0.06em;
      white-space: nowrap;
    }

    [data-theme='light'] #momentsScreen .moments-comment-time {
      color: rgba(0, 0, 0, 0.45);
    }

    #momentsScreen .moments-comment-text {
      margin-top: 6px;
      font-size: 12px;
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
      line-height: 1.55;
      color: rgba(255, 255, 255, 0.55);
    }

    [data-theme='light'] #momentsScreen .moments-comment-text {
      color: rgba(0, 0, 0, 0.55);
    }

    #momentsScreen .moments-comment-inputrow {
      margin-top: 14px;
      display: flex;
      align-items: flex-end;
      gap: 12px;
      opacity: 0.6;
      transition: opacity 0.25s ease;
    }

    #momentsScreen .moments-comment-inputrow:hover {
      opacity: 1;
    }

    #momentsScreen .moments-comment-prompt {
      font-size: 12px;
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
      color: rgba(255, 255, 255, 0.38);
      padding-bottom: 6px;
    }

    [data-theme='light'] #momentsScreen .moments-comment-prompt {
      color: rgba(0, 0, 0, 0.45);
    }

    #momentsScreen .moments-cine-input {
      background: transparent;
      border: none;
      border-bottom: 1px solid #444;
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
      width: 100%;
      padding: 8px 0;
      font-size: 12px;
      outline: none;
      border-radius: 0;
      color: rgba(255, 255, 255, 0.78);
      transition: border-color 0.3s ease;
    }

    [data-theme='light'] #momentsScreen .moments-cine-input {
      border-bottom-color: #444;
      color: rgba(0, 0, 0, 0.75);
    }

    #momentsScreen .moments-cine-input:focus {
      border-bottom-color: rgba(255, 255, 255, 0.9);
    }

    [data-theme='light'] #momentsScreen .moments-cine-input:focus {
      border-bottom-color: rgba(0, 0, 0, 0.9);
    }

    #momentsScreen .moments-comment-send {
      background: transparent;
      border: none;
      padding: 0 0 6px;
      cursor: pointer;
    }

    #momentsScreen .moments-record-dot {
      width: 10px;
      height: 10px;
      display: inline-block;
      background-color: #666;
      border-radius: 50%;
      transition: transform 0.2s ease, background-color 0.2s ease;
    }

    [data-theme='light'] #momentsScreen .moments-record-dot {
      background-color: #666;
    }

    #momentsScreen .moments-comment-send:hover .moments-record-dot {
      background-color: #fff;
      transform: scale(1.15);
    }

    [data-theme='light'] #momentsScreen .moments-comment-send:hover .moments-record-dot {
      background-color: #000;
    }

    /* Script Card */
    #momentsScreen .moments-cine-script {
      position: relative;
      background: #181818;
      padding: 22px;
      border-left: 2px solid #ffffff;
      box-shadow: 0 10px 24px rgba(0, 0, 0, 0.30);
      overflow: hidden;
    }

    [data-theme='light'] #momentsScreen .moments-cine-script {
      background: #121212;
    }

    #momentsScreen .moments-cine-script-quote {
      position: absolute;
      top: -6px;
      right: 10px;
      font-size: 64px;
      color: rgba(255, 255, 255, 0.06);
      font-family: 'Playfair Display', serif;
      line-height: 1;
      user-select: none;
      pointer-events: none;
    }

    #momentsScreen .moments-cine-script-scene {
      font-size: 11px;
      color: rgba(255, 255, 255, 0.45);
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
      text-transform: uppercase;
      letter-spacing: 0.20em;
      margin-bottom: 10px;
    }

    #momentsScreen .moments-cine-script-text {
      font-size: 18px;
      line-height: 1.6;
      color: rgba(255, 255, 255, 0.86);
      font-family: 'Playfair Display', serif;
    }

    #momentsScreen .moments-cine-underline {
      font-style: italic;
      text-decoration: underline;
      text-decoration-color: rgba(255, 255, 255, 0.30);
      text-underline-offset: 3px;
    }

    #momentsScreen .moments-cine-script-sign {
      margin-top: 14px;
      font-size: 12px;
      color: rgba(255, 255, 255, 0.45);
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
      text-align: right;
    }

    /* Cassette Card */
    @keyframes momentsSpin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    #momentsScreen .moments-cine-cassette {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 12px;
      border-radius: 14px;
      background: #ffffff;
      color: #000000;
      box-shadow: 0 10px 22px rgba(0, 0, 0, 0.14);
      transform: translateY(0);
      transition: transform 0.25s ease;
    }

    [data-theme='dark'] #momentsScreen .moments-cine-cassette {
      background: #e5e5e5;
    }

    #momentsScreen .moments-cine-cassette:hover {
      transform: translateY(-2px);
    }

    #momentsScreen .moments-cine-cassette-icon {
      width: 48px;
      height: 48px;
      background: #000000;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
      flex-shrink: 0;
    }

    #momentsScreen .moments-cine-reel {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #ffffff;
      animation: momentsSpin 3s linear infinite;
    }

    #momentsScreen .moments-cine-reel-left {
      margin-right: 12px;
    }

    #momentsScreen .moments-cine-cassette-line {
      position: absolute;
      left: 0;
      right: 0;
      top: 50%;
      height: 1px;
      background: rgba(255, 255, 255, 0.20);
    }

    #momentsScreen .moments-cine-cassette-meta {
      flex: 1;
      min-width: 0;
    }

    #momentsScreen .moments-cine-cassette-title {
      font-size: 14px;
      font-weight: 800;
      letter-spacing: -0.02em;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #momentsScreen .moments-cine-cassette-sub {
      margin-top: 2px;
      font-size: 11px;
      font-family: 'Space Mono', 'JetBrains Mono', monospace;
      color: rgba(0, 0, 0, 0.55);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #momentsScreen .moments-cine-play {
      width: 34px;
      height: 34px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #000000;
      flex-shrink: 0;
    }

    #momentsScreen .moments-cine-play svg {
      width: 28px;
      height: 28px;
      display: block;
    }

    /* ==================== Character Selector Modal Styles ==================== */

    /* Character grid layout */
    .character-grid-selector {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      padding: 4px 0;
    }

    /* Character card in selector */
    .character-card-selector {
      display: flex;
      flex-direction: column;
      padding: 14px;
      background: var(--bg-tertiary);
      border: 2px solid var(--border-color);
      border-radius: 14px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      animation: fadeInScale 0.3s ease backwards;
      position: relative;
      overflow: hidden;
      min-height: 200px;
    }

    /* Card corner decoration */
    .character-card-selector::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, transparent, var(--accent-color));
      opacity: 0.03;
      border-radius: 0 14px 0 100%;
    }

    .character-card-selector:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-md);
      border-color: var(--accent-color);
    }

    .character-card-selector:active {
      transform: translateY(-2px);
    }

    /* Card header */
    .card-header-selector {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 10px;
    }

    .card-id-selector {
      font-size: 9px;
      font-family: 'JetBrains Mono', monospace;
      color: var(--text-tertiary);
      letter-spacing: 0.05em;
      background: var(--bg-primary);
      padding: 3px 6px;
      border-radius: 4px;
      border: 1px solid var(--border-color);
    }

    .card-status-selector {
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: #22c55e;
      box-shadow: 0 0 6px rgba(34, 197, 94, 0.3);
    }

    /* Character avatar in selector */
    .character-avatar-selector {
      width: 100%;
      aspect-ratio: 1;
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    .character-avatar-selector img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .character-avatar-selector svg {
      width: 55%;
      height: 55%;
      stroke: var(--text-tertiary);
      stroke-width: 1.5;
    }

    /* Avatar gradient overlay */
    .character-avatar-selector::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 30%;
      background: linear-gradient(to top, var(--bg-primary), transparent);
    }

    /* Character name in selector */
    .character-name-selector {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 6px;
      line-height: 1.3;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }

    /* Character meta tags */
    .character-meta-selector {
      display: flex;
      gap: 4px;
      flex-wrap: wrap;
      margin-top: auto;
    }

    /* Character type badge in selector */
    .character-tag-selector {
      font-size: 8px;
      font-family: 'JetBrains Mono', monospace;
      color: var(--text-tertiary);
      background: var(--bg-primary);
      padding: 2px 5px;
      border-radius: 3px;
      border: 1px solid var(--border-color);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* Empty state for character selector */
    .character-selector-empty {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
      text-align: center;
    }

    /* Modal subtitle */
    .modal-subtitle {
      font-size: 13px;
      color: var(--text-secondary);
      margin-top: 4px;
      margin-bottom: 16px;
      line-height: 1.4;
    }

    /* Staggered animation for character cards */
    .character-card-selector:nth-child(1) { animation-delay: 0.05s; }
    .character-card-selector:nth-child(2) { animation-delay: 0.1s; }
    .character-card-selector:nth-child(3) { animation-delay: 0.15s; }
    .character-card-selector:nth-child(4) { animation-delay: 0.2s; }
    .character-card-selector:nth-child(5) { animation-delay: 0.25s; }
    .character-card-selector:nth-child(6) { animation-delay: 0.3s; }
    .character-card-selector:nth-child(7) { animation-delay: 0.35s; }
    .character-card-selector:nth-child(8) { animation-delay: 0.4s; }

    /* Fade in scale animation */
    @keyframes fadeInScale {
      from {
        opacity: 0;
        transform: scale(0.9);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    /* ==========================================
       Chat Detail Screen Styles - èŠå¤©è¯¦æƒ…é¡µæ ·å¼
       ========================================== */

    /* Chat Detail Container */
    .chat-detail-screen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg-primary);
      z-index: 1000;
      display: none;
      flex-direction: column;
      opacity: 0;
      transform: translateX(100%);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .chat-detail-screen.active {
      display: flex;
      opacity: 1;
      transform: translateX(0);
    }

    /* Chat Detail Header */
    .chat-detail-header {
      /* ğŸ”¥ é¡¶æ å›ºå®šå®šä½ï¼Œä¸å†å—å†…å®¹æµå½±å“ */
      position: fixed !important; /* ä½¿ç”¨ fixed å®šä½ */
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      z-index: 1000 !important; /* ç¡®ä¿åœ¨æœ€ä¸Šå±‚ */
      /* ä¿æŒåŸæœ‰èƒŒæ™¯å’Œè¾¹æ¡† */
      background: var(--bg-primary);
      border-bottom: 1px solid var(--border-color);
      /* å†…éƒ¨å…ƒç´ ä»ç„¶ä½¿ç”¨ flex å¸ƒå±€ */
      display: flex;
      align-items: center;
      gap: 12px;
      /* ç§»é™¤ min-height å’Œ flex-shrinkï¼Œè®©é«˜åº¦è‡ªé€‚åº”å†…å®¹ */
      min-height: auto; /* è®©é«˜åº¦æ ¹æ®å†…å®¹è‡ªé€‚åº” */
      height: auto; /* ç¡®ä¿é«˜åº¦è‡ªé€‚åº” */
      /* ä¿æŒåŸæœ‰ paddingï¼Œä½†éœ€è¦è€ƒè™‘å®‰å…¨åŒºåŸŸ */
      padding: var(--app-header-total-padding) 20px 12px;
    }

    /* ğŸ¨ ä¸»é¢˜è£…é¥°å±‚ - æä¾›é¢å¤–çš„DOMå…ƒç´ ç”¨äºå¤æ‚ä¸»é¢˜è®¾è®¡ */
    .theme-decor-layer {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none; /* ä¸é˜»æŒ¡ç‚¹å‡»äº‹ä»¶ */
      z-index: 0; /* åœ¨å†…å®¹å±‚ä¹‹ä¸‹ */
      overflow: hidden;
    }

    .theme-decor {
      position: absolute;
      display: none; /* é»˜è®¤éšè—ï¼Œä¸»é¢˜CSSå¯ä»¥æ¿€æ´» */
      pointer-events: none;
    }

    /* ç¡®ä¿å†…å®¹å±‚åœ¨è£…é¥°å±‚ä¹‹ä¸Š */
    .chat-detail-header > *:not(.theme-decor-layer) {
      position: relative;
      z-index: 1;
    }

    .chat-input-area > *:not(.theme-decor-layer) {
      position: relative;
      z-index: 1;
    }

    .chat-detail-back-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .chat-detail-back-btn:hover {
      background: var(--hover-bg);
      transform: scale(1.05);
    }

    .chat-detail-back-btn svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    .chat-detail-avatar {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      border: 2px solid var(--border-color);
      overflow: hidden;
      cursor: pointer;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .chat-detail-avatar:hover {
      transform: scale(1.05);
      box-shadow: var(--shadow-md);
    }

    .chat-detail-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .chat-detail-info {
      flex: 1;
      min-width: 0;
      cursor: pointer;
    }

    .chat-detail-name {
      font-size: 15px;
      font-weight: 600;
      color: var(--text-primary);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      font-family: 'Noto Sans JP', sans-serif;
    }

    .chat-detail-status {
      font-size: 11px;
      color: var(--text-secondary);
      margin-top: 2px;
      font-family: 'Inter', sans-serif;
      max-width: 150px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    /* è§’è‰²æ­£åœ¨è¾“å…¥ä¸­ï¼ˆå‘é€è§¦å‘AIæ—¶ä¸´æ—¶æ˜¾ç¤ºï¼Œé˜²æ­¢é”™è¿‡çµåŠ¨å²›æç¤ºï¼‰ */
    .chat-detail-status.is-typing {
      font-style: italic;
      font-family: 'JetBrains Mono', 'Inter', sans-serif;
      color: var(--text-tertiary);
    }

    .chat-detail-status.is-typing::after {
      content: '...';
      display: inline-block;
      width: 0ch;
      overflow: hidden;
      vertical-align: bottom;
      margin-left: 1px;
      animation: chatDetailTypingDots 1.2s steps(4, end) infinite;
    }

    @keyframes chatDetailTypingDots {
      to { width: 3ch; }
    }

    /* ğŸ­ çŠ¶æ€æ›´æ–°åŠ¨ç”» */
    @keyframes statusPulse {
      0% { opacity: 0.5; transform: scale(0.95); }
      50% { opacity: 1; transform: scale(1.02); }
      100% { opacity: 1; transform: scale(1); }
    }

    .chat-detail-actions {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-shrink: 0;
    }

    .chat-detail-icon-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .chat-detail-icon-btn:hover {
      background: var(--hover-bg);
      transform: scale(1.05);
    }

    .chat-detail-icon-btn svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    /* Messages Area */
    /* Chat Messages Area - ç¡®ä¿èƒŒæ™¯å®Œå…¨è¦†ç›–æ— ç¼éš™ */
    .chat-messages-area {
      /* ğŸ”¥ æ¶ˆæ¯åŒºåŸŸç»å¯¹å®šä½ï¼Œå æ®å¤´éƒ¨å’Œåº•éƒ¨ä¹‹é—´çš„ç©ºé—´ */
      position: absolute !important;
      top: var(--chat-header-height, 0px) !important;    /* å¤´éƒ¨é«˜åº¦ */
      bottom: var(--chat-input-height, 0px) !important;  /* åº•éƒ¨é«˜åº¦ */
      left: 0 !important;
      right: 0 !important;
      z-index: 50 !important; /* åœ¨å¤´éƒ¨å’Œåº•éƒ¨ä¹‹ä¸‹ */

      /* ä¿æŒæ»šåŠ¨å’ŒFlexå¸ƒå±€ */
      overflow-y: auto;
      padding: 16px; /* å†…éƒ¨paddingï¼Œä¸ fixed header/input ç•™å‡ºçš„ç©ºé—´æ— å…³ */
      display: flex;
      flex-direction: column;
      gap: 12px;
      scrollbar-width: none;
      /* ç¡®ä¿èƒŒæ™¯å›¾ç‰‡æ­£ç¡®è¦†ç›– */
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      /* ç¡®ä¿èƒŒæ™¯å»¶ä¼¸åˆ°paddingåŒºåŸŸ */
      background-origin: border-box;
    }

    .chat-messages-area::-webkit-scrollbar {
      display: none;
    }

    /* Date Divider */
    .chat-date-divider {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 8px 0;
      position: relative;
    }

    .chat-date-divider-line {
      flex: 1;
      height: 1px;
      background: var(--border-color);
    }

    .chat-date-divider-text {
      padding: 4px 12px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      font-size: 11px;
      color: var(--text-tertiary);
      font-family: 'JetBrains Mono', monospace;
      margin: 0 12px;
    }

    /* ğŸ”¥ é€šè¯è®°å½•ç³»ç»Ÿæ¶ˆæ¯æ ·å¼ï¼ˆåŒºåˆ«äºæ—¶é—´åˆ†éš”å™¨ï¼‰ */
    .chat-call-record {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 12px 0;
      padding: 0 20px;
    }

    .chat-call-record-content {
      display: flex;
      align-items: center;
      padding: 6px 14px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      font-size: 12px;
      color: var(--text-secondary);
      font-family: 'Inter', sans-serif;
      opacity: 0.75;
      transition: opacity 0.2s;
    }

    .chat-call-record-content:hover {
      opacity: 1;
    }

    /* ğŸ”¥ Load More Messages Button */
    .load-more-messages-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 16px auto;
      padding: 10px 20px;
      background: var(--bg-tertiary);
      color: var(--text-secondary);
      border-radius: 20px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 1px solid var(--border-color);
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }

    .load-more-messages-btn:hover {
      background: var(--hover-bg);
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .load-more-messages-btn:active {
      transform: translateY(0);
      box-shadow: none;
    }

    .load-more-messages-btn svg {
      flex-shrink: 0;
    }

    /* Message Group */
    .chat-message-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
      animation: messageSlideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative; /* è®©ååº”æ°”æ³¡å¯ä»¥ç»å¯¹å®šä½ */
    }

    /* è§’è‰²æ’¤å›æ¶ˆæ¯åŠ¨ç”»ï¼ˆå…ˆæ˜¾ç¤ºï¼Œå†æ’¤å›æ¶ˆå¤±ï¼‰ */
    .chat-message-group.recalling {
      animation: messageRecallOut 0.28s ease forwards !important;
      pointer-events: none;
      will-change: opacity, transform;
    }

    @keyframes messageRecallOut {
      from {
        opacity: 1;
        transform: translateY(0) scale(1);
        filter: blur(0);
      }
      to {
        opacity: 0;
        transform: translateY(-6px) scale(0.96);
        filter: blur(1px);
      }
    }

    @keyframes messageSlideIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .chat-message-group.user {
      align-items: flex-end;
    }

    .chat-message-group.character {
      align-items: flex-start;
    }

    .chat-message-group.system {
      align-items: center;  /* ğŸ”¥ ç³»ç»Ÿæ¶ˆæ¯ï¼ˆå¦‚é€šè¯è®°å½•ï¼‰å±…ä¸­å¯¹é½ */
    }

    /* Message Bubble */
    .chat-message-bubble {
      max-width: 75%;
      padding: 10px 14px;
      border-radius: 18px;
      position: relative;
      word-wrap: break-word;
      line-height: 1.5;
      font-size: 14px;
      transition: all 0.2s ease;
    }

    .chat-message-bubble:hover {
      transform: scale(1.02);
    }

    /* User Messages (Right) */
    .chat-message-group.user .chat-message-bubble {
      background: var(--accent-color);
      color: var(--bg-primary);
      border-bottom-right-radius: 4px;
      border: 1px solid rgba(0, 0, 0, 0.08);  /* æ—¥é—´æ¨¡å¼ä¹Ÿæ·»åŠ å¾®å¦™è¾¹æ¡† */
    }

    [data-theme='dark'] .chat-message-group.user .chat-message-bubble {
      background: #3a3a3a !important;  /* æäº®ç”¨æˆ·æ°”æ³¡ï¼šæ˜æ˜¾çš„ä¸­ç° */
      color: #ffffff !important;
      border: 1px solid #555555 !important;  /* å¢å¼ºè¾¹æ¡†å¯¹æ¯” */
    }

    /* Character Messages (Left) */
    .chat-message-group.character .chat-message-bubble {
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border-bottom-left-radius: 4px;
      border: 1px solid rgba(0, 0, 0, 0.06);  /* æ—¥é—´æ¨¡å¼æ·»åŠ å¾®å¦™è¾¹æ¡† */
    }

    [data-theme='dark'] .chat-message-group.character .chat-message-bubble {
      background: #252525 !important;  /* æäº®è§’è‰²æ°”æ³¡ï¼šæ˜æ˜¾çš„æ·±ç° */
      color: #e0e0e0 !important;
      border: 1px solid #3d3d3d !important;  /* å¢å¼ºè¾¹æ¡†å¯¹æ¯” */
    }

    /* ==================== Cute Chat v1 æ ·å¼ï¼ˆä¾§è¾¹ä¸‰è§’+æ ‡ç­¾ï¼‰ ==================== */
    /* å‘é€è€…æ ‡ç­¾ */
    .chat-sender-label {
      font-size: 12px;
      font-weight: 700;
      margin-bottom: 6px;
      opacity: 0.9;
      display: none;  /* é»˜è®¤éšè—ï¼Œåªåœ¨cute-v1æ ·å¼ä¸‹æ˜¾ç¤º */
    }

    .chat-message-group.character .chat-sender-label {
      color: #FFFFFF;
      padding-left: 4px;
    }

    .chat-message-group.user .chat-sender-label {
      color: #E9A8D0;
      padding-right: 4px;
    }

    /* Cute v1 æ ·å¼çš„å®¹å™¨æ ‡è®° */
    #chatMessagesArea.cute-v1-style .chat-sender-label {
      display: block;  /* cute-v1æ ·å¼ä¸‹æ˜¾ç¤ºæ ‡ç­¾ */
    }

    #chatMessagesArea.cute-v1-style .chat-message-group {
      margin-bottom: 4px;
    }

    #chatMessagesArea.cute-v1-style .chat-message-group.new-conversation {
      margin-top: 16px;
    }

    #chatMessagesArea.cute-v1-style .chat-message-bubble {
      padding: 12px 16px;
      border-radius: 16px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      margin-top: 0;
    }

    /* è§’è‰²æ°”æ³¡ - æ·±ç°è‰²ï¼Œå·¦ä¾§ä¸‰è§’ */
    #chatMessagesArea.cute-v1-style .chat-message-group.character .chat-message-bubble {
      background: #2C2C2E !important;
      color: #FFFFFF !important;
      border: none !important;
      border-top-left-radius: 4px;
    }

    #chatMessagesArea.cute-v1-style .chat-message-group.character .chat-message-bubble::before {
      content: '';
      position: absolute;
      left: -6px;
      top: 0;
      width: 12px;
      height: 12px;
      background: #2C2C2E;
      clip-path: polygon(100% 0, 0 0, 100% 100%);
    }

    /* ç”¨æˆ·æ°”æ³¡ - ç²‰è‰²ï¼Œå³ä¾§ä¸‰è§’ */
    #chatMessagesArea.cute-v1-style .chat-message-group.user .chat-message-bubble {
      background: #E9A8D0 !important;
      color: #FFFFFF !important;
      border: none !important;
      border-top-right-radius: 4px;
    }

    #chatMessagesArea.cute-v1-style .chat-message-group.user .chat-message-bubble::before {
      content: '';
      position: absolute;
      right: -6px;
      top: 0;
      width: 12px;
      height: 12px;
      background: #E9A8D0;
      clip-path: polygon(0 0, 100% 0, 0 100%);
    }

    /* æš—è‰²æ¨¡å¼ä¸‹ä¿æŒCute v1æ ·å¼çš„é¢œè‰²ä¸å˜ */
    [data-theme='dark'] #chatMessagesArea.cute-v1-style .chat-message-group.character .chat-message-bubble {
      background: #2C2C2E !important;
      color: #FFFFFF !important;
    }

    [data-theme='dark'] #chatMessagesArea.cute-v1-style .chat-message-group.character .chat-message-bubble::before {
      background: #2C2C2E;
    }

    [data-theme='dark'] #chatMessagesArea.cute-v1-style .chat-message-group.user .chat-message-bubble {
      background: #E9A8D0 !important;
      color: #FFFFFF !important;
    }

    [data-theme='dark'] #chatMessagesArea.cute-v1-style .chat-message-group.user .chat-message-bubble::before {
      background: #E9A8D0;
    }

    /* ==================== Cute Chat v2 æ ·å¼ï¼ˆä¸Šæ–¹ä¸‰è§’+æ ‡ç­¾ï¼‰ ==================== */
    /* Cute v2 æ ·å¼çš„å®¹å™¨æ ‡è®° */
    #chatMessagesArea.cute-v2-style .chat-sender-label {
      display: block;  /* cute-v2æ ·å¼ä¸‹æ˜¾ç¤ºæ ‡ç­¾ */
    }

    #chatMessagesArea.cute-v2-style .chat-message-group {
      margin-bottom: 16px;
    }

    #chatMessagesArea.cute-v2-style .chat-message-group.new-conversation {
      margin-top: 16px;
    }

    #chatMessagesArea.cute-v2-style .chat-message-bubble {
      padding: 12px 16px;
      border-radius: 12px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      margin-top: 0;
    }

    /* è§’è‰²æ°”æ³¡ - æ·±ç°è‰²ï¼Œä¸Šæ–¹ä¸‰è§’ */
    #chatMessagesArea.cute-v2-style .chat-message-group.character .chat-message-bubble {
      background: #2C2C2E !important;
      color: #FFFFFF !important;
      border: none !important;
    }

    #chatMessagesArea.cute-v2-style .chat-message-group.character .chat-message-bubble::before {
      content: '';
      position: absolute;
      top: -8px;
      left: 20px;
      width: 0;
      height: 0;
      border-left: 5px solid transparent;
      border-right: 5px solid transparent;
      border-bottom: 12px solid #2C2C2E;
    }

    /* ç”¨æˆ·æ°”æ³¡ - ç²‰è‰²ï¼Œä¸Šæ–¹ä¸‰è§’ */
    #chatMessagesArea.cute-v2-style .chat-message-group.user .chat-message-bubble {
      background: #E9A8D0 !important;
      color: #FFFFFF !important;
      border: none !important;
    }

    #chatMessagesArea.cute-v2-style .chat-message-group.user .chat-message-bubble::before {
      content: '';
      position: absolute;
      top: -8px;
      right: 20px;
      width: 0;
      height: 0;
      border-left: 5px solid transparent;
      border-right: 5px solid transparent;
      border-bottom: 12px solid #E9A8D0;
    }

    /* æš—è‰²æ¨¡å¼ä¸‹ä¿æŒCute v2æ ·å¼çš„é¢œè‰²ä¸å˜ */
    [data-theme='dark'] #chatMessagesArea.cute-v2-style .chat-message-group.character .chat-message-bubble {
      background: #2C2C2E !important;
      color: #FFFFFF !important;
    }

    [data-theme='dark'] #chatMessagesArea.cute-v2-style .chat-message-group.character .chat-message-bubble::before {
      border-bottom-color: #2C2C2E;
    }

    [data-theme='dark'] #chatMessagesArea.cute-v2-style .chat-message-group.user .chat-message-bubble {
      background: #E9A8D0 !important;
      color: #FFFFFF !important;
    }

    [data-theme='dark'] #chatMessagesArea.cute-v2-style .chat-message-group.user .chat-message-bubble::before {
      border-bottom-color: #E9A8D0;
    }

    /* ==================== Discord æ ·å¼ï¼ˆç´§å‡‘é—´è·ï¼‰ ==================== */
    #chatMessagesArea.discord-style .chat-message-group {
      margin-bottom: 2px !important;  /* ç´§å‡‘é—´è· */
      gap: 2px !important;  /* å†…éƒ¨å…ƒç´ é—´è·ä¹Ÿç¼©å° */
    }

    #chatMessagesArea.discord-style .chat-message-bubble {
      border-radius: 20px !important;
      box-shadow: 0 1px 3px rgba(0,0,0,0.2) !important;
    }

    #chatMessagesArea.discord-style .chat-message-group.character .chat-message-bubble {
      border-radius: 20px !important;
    }

    #chatMessagesArea.discord-style .chat-message-group.user .chat-message-bubble {
      border-radius: 20px !important;
    }

    /* Timestamp */
    .chat-message-timestamp {
      font-size: 10px;
      color: var(--text-tertiary);
      margin-top: 4px;
      font-family: 'JetBrains Mono', monospace;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .chat-message-group.user .chat-message-timestamp {
      justify-content: flex-end;
    }

    .chat-message-group.character .chat-message-timestamp {
      justify-content: flex-start;
    }

    /* Read Status */
    .chat-read-status {
      width: 12px;
      height: 12px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .chat-read-status svg {
      width: 100%;
      height: 100%;
      stroke: var(--text-tertiary);
      fill: none;
      stroke-width: 2;
    }

    .chat-read-status.read svg {
      stroke: var(--accent-color);
    }

    /* System Message */
    .chat-message-system {
      align-self: center;
      padding: 6px 12px;
      background: var(--bg-tertiary);
      color: var(--text-secondary);
      border-radius: 12px;
      font-size: 11px;
      text-align: center;
      max-width: 80%;
      line-height: 1.4;
      border: 1px solid var(--border-color);
    }

    /* ========== Reply Preview (å¼•ç”¨é¢„è§ˆ) ========== */
    .chat-reply-preview {
      display: none;
      padding: 10px 12px;
      background: var(--bg-secondary);
      border-top: 1px solid var(--border-color);
      align-items: center;
      gap: 10px;
      /* ğŸ”¥ ä¿®å¤ï¼šæ”¹ä¸º fixed å®šä½ï¼Œå›ºå®šåœ¨è¾“å…¥æ¡†ä¸Šæ–¹ */
      position: fixed !important;
      left: 0 !important;
      right: 0 !important;
      bottom: calc(68px + env(safe-area-inset-bottom, 0)) !important; /* è¾“å…¥æ¡†é«˜åº¦çº¦68px + å®‰å…¨åŒºåŸŸ */
      z-index: 999 !important; /* ä½äºè¾“å…¥æ¡†ï¼ˆ1000ï¼‰ï¼Œé«˜äºæ¶ˆæ¯åŒºåŸŸ */
      max-width: 430px;
      margin: 0 auto;
      animation: replyPreviewSlideIn 0.2s ease;
    }

    .chat-reply-preview.active {
      display: flex;
    }

    @keyframes replyPreviewSlideIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .reply-preview-bar {
      width: 3px;
      height: 36px;
      background: var(--accent-color);
      border-radius: 2px;
      flex-shrink: 0;
    }

    .reply-preview-content {
      flex: 1;
      min-width: 0;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .reply-preview-name {
      font-size: 12px;
      font-weight: 600;
      color: var(--accent-color);
      line-height: 1.2;
    }

    .reply-preview-text {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.3;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .reply-preview-close {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      flex-shrink: 0;
      transition: all 0.2s ease;
    }

    .reply-preview-close:hover {
      background: var(--hover-bg);
      transform: scale(1.1);
    }

    .reply-preview-close svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-secondary);
      stroke-width: 2;
      fill: none;
    }

    /* ========== Message Quote Bubble (æ°”æ³¡å†…å¼•ç”¨æ˜¾ç¤º) ========== */
    .chat-message-quote {
      background: var(--bg-tertiary);
      border-left: 3px solid var(--accent-color);
      border-radius: 0 8px 8px 0;
      padding: 8px 10px;
      margin-bottom: 6px;
      cursor: pointer;
      transition: background 0.2s ease;
    }

    .chat-message-quote:hover {
      background: var(--hover-bg);
    }

    .chat-message-quote-name {
      font-size: 11px;
      font-weight: 600;
      color: inherit;
      opacity: 0.9;
      margin-bottom: 2px;
      line-height: 1.2;
    }

    .chat-message-quote-text {
      font-size: 12px;
      color: inherit;
      opacity: 0.7;
      line-height: 1.3;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    /* ç”¨æˆ·æ¶ˆæ¯å†…çš„å¼•ç”¨æ ·å¼ - åè½¬é¢œè‰² */
    .chat-message-group.user .chat-message-quote {
      background: rgba(255, 255, 255, 0.15);
      border-left-color: rgba(255, 255, 255, 0.6);
    }

    .chat-message-group.user .chat-message-quote-name {
      color: inherit;
      opacity: 0.9;
    }

    .chat-message-group.user .chat-message-quote-text {
      color: inherit;
      opacity: 0.7;
    }

    /* ğŸ”¥ å›¾ç‰‡æ¶ˆæ¯å‰çš„å¼•ç”¨æ°”æ³¡ç‹¬ç«‹æ ·å¼ */
    .chat-message-group > .chat-message-quote {
      max-width: 85%;
      border-radius: 8px;
      background: var(--bg-secondary);
    }

    /* ç”¨æˆ·å›¾ç‰‡æ¶ˆæ¯å‰çš„å¼•ç”¨ - å³å¯¹é½ */
    .chat-message-group.user > .chat-message-quote {
      margin-left: auto;
      background: rgba(0, 122, 255, 0.1);
      border-left-color: rgba(0, 122, 255, 0.6);
    }

    .chat-message-group.user > .chat-message-quote .chat-message-quote-name {
      color: inherit;
      opacity: 0.9;
    }

    .chat-message-group.user > .chat-message-quote .chat-message-quote-text {
      color: inherit;
      opacity: 0.7;
    }

    /* è§’è‰²å¼•ç”¨ç”¨æˆ·æ¶ˆæ¯ï¼šç…§æŠ„ç”¨æˆ·å¼•ç”¨æ ·å¼ï¼ˆéšä¸»é¢˜/å¤œé—´æ¨¡å¼è‡ªç„¶é€‚é…ï¼‰ */
    .chat-message-group.character .chat-message-quote.quote-user,
    .chat-message-group.character > .chat-message-quote.quote-user {
      background: rgba(255, 255, 255, 0.15);
      border-left-color: rgba(255, 255, 255, 0.6);
    }

    /* ğŸ”¥ å¼•ç”¨æ¶ˆæ¯é«˜äº®åŠ¨ç”»ï¼ˆç‚¹å‡»å¼•ç”¨æ°”æ³¡æ»šåŠ¨åˆ°åŸæ¶ˆæ¯æ—¶ï¼‰ */
    .chat-message-group.highlight-quoted {
      animation: highlightQuoted 2s ease-out;
    }

    @keyframes highlightQuoted {
      0%, 20% {
        background-color: rgba(0, 122, 255, 0.2);
        border-radius: 12px;
      }
      100% {
        background-color: transparent;
      }
    }

    /* æš—è‰²æ¨¡å¼é«˜äº® */
    [data-theme="dark"] .chat-message-group.highlight-quoted {
      animation: highlightQuotedDark 2s ease-out;
    }

    @keyframes highlightQuotedDark {
      0%, 20% {
        background-color: rgba(10, 132, 255, 0.3);
        border-radius: 12px;
      }
      100% {
        background-color: transparent;
      }
    }

    /* Chat Input Area - æ·»åŠ åº•éƒ¨å®‰å…¨åŒºåŸŸæ”¯æŒ */
    .chat-input-area {
      /* ğŸ”¥ åº•éƒ¨å›ºå®šå®šä½ï¼Œä¸å†å—å†…å®¹æµå½±å“ */
      position: fixed !important; /* ä½¿ç”¨ fixed å®šä½ */
      bottom: 0 !important;
      left: 0 !important;
      right: 0 !important;
      z-index: 1000 !important; /* ç¡®ä¿åœ¨æœ€ä¸Šå±‚ */
      /* ä¿æŒåŸæœ‰èƒŒæ™¯å’Œè¾¹æ¡† */
      padding: 12px 16px;
      padding-bottom: calc(20px + env(safe-area-inset-bottom, 0)); /* ç»§ç»­æ”¯æŒåº•éƒ¨å®‰å…¨åŒºåŸŸ */
      background: var(--bg-primary);
      border-top: 1px solid var(--border-color);
      /* å†…éƒ¨å…ƒç´ ä»ç„¶ä½¿ç”¨ flex å¸ƒå±€ */
      display: flex;
      align-items: flex-end;
      gap: 10px;
      /* ç§»é™¤ position: relative; å’Œ flex-shrink; */
      /* position: relative; å¯èƒ½ä¼šå½±å“ fixed å…ƒç´ çš„ z-index */
      /* flex-shrink: 0; å¯¹äº fixed å…ƒç´ æ— æ„ä¹‰ */
    }

    /* é”®ç›˜å¼¹èµ·æ—¶çš„å›ºå®šå®šä½æ¨¡å¼ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰ */
    .chat-input-area.keyboard-visible {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 9999;
      max-width: 430px;
      margin: 0 auto;
    }

    /* Attachment Button */
    .chat-attach-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      flex-shrink: 0;
      position: relative;
      z-index: 10;
    }

    .chat-attach-btn:hover {
      background: var(--hover-bg);
      transform: scale(1.05);
    }

    .chat-attach-btn.active {
      background: var(--accent-color);
      transform: rotate(45deg);
    }

    .chat-attach-btn.active svg {
      stroke: var(--bg-primary);
    }

    .chat-attach-btn svg {
      width: 18px;
      height: 18px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
      transition: all 0.3s ease;
    }

    /* Attachment Menu */
    .chat-attachment-menu {
      position: absolute;
      bottom: 70px;
      left: 16px;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 8px;
      box-shadow: var(--shadow-lg);
      display: none;
      flex-direction: column;
      gap: 4px;
      animation: menuSlideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 9999999;
    }

    .chat-attachment-menu.active {
      display: flex;
    }

    @keyframes menuSlideUp {
      from {
        opacity: 0;
        transform: translateY(10px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .chat-menu-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      min-width: 150px;
    }

    .chat-menu-item:hover {
      background: var(--bg-tertiary);
    }

    .chat-menu-item.reverse-active {
      background: var(--bg-tertiary);
      box-shadow: inset 0 0 0 1px var(--accent-color);
    }

    .chat-menu-item.reverse-active .chat-menu-item-icon {
      background: var(--accent-color);
      border-color: var(--accent-color);
    }

    .chat-menu-item.reverse-active .chat-menu-item-icon svg {
      stroke: #ffffff;
    }

    .chat-menu-item-icon {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .chat-menu-item-icon svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    .chat-menu-item-label {
      font-size: 13px;
      font-weight: 500;
      color: var(--text-primary);
    }

    .chat-input-wrapper {
      flex: 1;
      display: flex;
      align-items: flex-end;
      gap: 8px;
    }

    .chat-message-input {
      flex: 1;
      min-height: 36px;
      max-height: 120px;
      padding: 8px 12px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 18px;
      font-size: 14px;
      font-family: inherit;
      color: var(--text-primary);
      resize: none;
      outline: none;
      transition: all 0.2s ease;
      overflow-y: auto;
      scrollbar-width: thin;
    }

    .chat-message-input:focus {
      border-color: var(--accent-color);
      background: var(--bg-secondary);
    }

    .chat-message-input::placeholder {
      color: var(--text-tertiary);
    }

    .chat-send-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--accent-color);
      border: 1px solid var(--accent-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .chat-send-btn:hover {
      transform: scale(1.05);
      box-shadow: var(--shadow-md);
    }

    .chat-send-btn:active {
      transform: scale(0.95);
    }

    .chat-send-btn svg {
      width: 18px;
      height: 18px;
      stroke: var(--bg-primary);
      fill: none;
      stroke-width: 2;
    }

    [data-theme='dark'] .chat-send-btn {
      background: var(--bg-primary);
      border-color: var(--bg-primary);
    }

    [data-theme='dark'] .chat-send-btn svg {
      stroke: var(--accent-color);
    }

    /* Chat Message Image Styles - èŠå¤©æ¶ˆæ¯ä¸­çš„å›¾ç‰‡æ ·å¼ */
    .chat-message-image {
      max-width: 200px;
      max-height: 200px;
      border-radius: 12px;
      overflow: hidden;
      margin-top: 4px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .chat-message-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .chat-message-image:hover {
      transform: scale(1.02);
      box-shadow: var(--shadow-md);
    }

    /* Chat Message Sticker Styles - èŠå¤©æ¶ˆæ¯ä¸­çš„è¡¨æƒ…åŒ…æ ·å¼ */
    .chat-message-sticker {
      max-width: 120px;
      max-height: 120px;
      border-radius: 8px;
      overflow: hidden;
      margin-top: 4px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .chat-message-sticker img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
    }

    .chat-message-sticker:hover {
      transform: scale(1.05);
    }

    /* Sticker Picker - è¡¨æƒ…åŒ…é€‰æ‹©æ¡† */
    .sticker-picker-overlay {
      position: absolute;
      inset: 0;
      /* é«˜äºèŠå¤©é¡¶æ /åº•æ ï¼ˆå®ƒä»¬æ˜¯ 1000ï¼‰é¿å…è¢«é®æŒ¡ */
      z-index: 1200;
      display: flex;
      align-items: flex-end;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .sticker-picker-overlay.active {
      opacity: 1;
      pointer-events: all;
    }

    .sticker-picker-sheet {
      width: 100%;
      height: 360px;
      background: var(--bg-primary);
      border-radius: 20px 20px 0 0;
      transform: translateY(100%);
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      flex-direction: column;
      box-shadow: 0 -8px 32px rgba(0, 0, 0, 0.15);
    }

    .sticker-picker-overlay.active .sticker-picker-sheet {
      transform: translateY(0);
    }

    .sticker-picker-handle {
      width: 36px;
      height: 4px;
      background: var(--text-tertiary);
      border-radius: 2px;
      margin: 12px auto 0;
      opacity: 0.5;
    }

    /* Sticker Picker Header */
    .sticker-picker-header {
      padding: 12px 20px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-shrink: 0;
    }

    .sticker-picker-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .sticker-picker-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .sticker-picker-action {
      width: 32px;
      height: 32px;
      border-radius: 10px;
      background: var(--bg-secondary);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .sticker-picker-action:active {
      transform: scale(0.95);
      background: var(--border-color);
    }

    .sticker-picker-action svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-secondary);
      fill: none;
      stroke-width: 2;
    }

    /* Sticker Category Bar - è¡¨æƒ…åŒ…åˆ†ç±»æ  */
    .sticker-category-bar {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      overflow-x: auto;
      overflow-y: hidden;
      border-bottom: 1px solid var(--border-color);
      scrollbar-width: none;  /* Firefoxéšè—æ»šåŠ¨æ¡ */
    }

    .sticker-category-bar::-webkit-scrollbar {
      display: none;  /* Chrome/Safariéšè—æ»šåŠ¨æ¡ */
    }

    .sticker-category-item {
      flex-shrink: 0;
      padding: 6px 14px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      font-size: 13px;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s ease;
      white-space: nowrap;
    }

    .sticker-category-item:hover {
      background: var(--hover-bg);
    }

    .sticker-category-item.active {
      background: var(--accent-color);
      color: var(--bg-primary);
      border-color: var(--accent-color);
    }

    .sticker-category-manage {
      flex-shrink: 0;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .sticker-category-manage:hover {
      background: var(--hover-bg);
      transform: scale(1.05);
    }

    .sticker-category-manage svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    /* Category Management Modal - åˆ†ç±»ç®¡ç†å¼¹çª— */
    .category-management-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(4px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10001;
    }

    .category-management-modal.active {
      display: flex;
    }

    .category-management-content {
      width: 90%;
      max-width: 360px;
      max-height: 70vh;
      background: var(--bg-primary);
      border-radius: 16px;
      display: flex;
      flex-direction: column;
      box-shadow: var(--shadow-xl);
      overflow: hidden;
    }

    .category-management-header {
      padding: 16px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .category-management-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .category-management-close {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .category-management-close:hover {
      background: var(--hover-bg);
    }

    .category-management-close svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    .category-management-list {
      flex: 1;
      overflow-y: auto;
      padding: 12px;
    }

    .category-list-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px;
      background: var(--bg-secondary);
      border-radius: 8px;
      margin-bottom: 8px;
      border: 1px solid var(--border-color);
    }

    .category-list-item-name {
      font-size: 14px;
      color: var(--text-primary);
      flex: 1;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .category-list-item-shared-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      background: var(--accent-color);
      color: var(--bg-primary);
      border-radius: 4px;
      font-size: 11px;
      font-weight: 500;
    }

    .category-list-item-shared-badge svg {
      width: 12px;
      height: 12px;
      stroke: var(--bg-primary);
      fill: none;
      stroke-width: 2;
    }

    .category-list-item-delete {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .category-list-item-delete:hover {
      background: #ff4444;
      border-color: #ff4444;
    }

    .category-list-item-delete:hover svg {
      stroke: white;
    }

    .category-list-item-delete svg {
      width: 12px;
      height: 12px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    .category-add-section {
      padding: 12px;
      border-top: 1px solid var(--border-color);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .category-add-checkbox-group {
      display: flex;
      align-items: center;
      padding: 0 4px;
    }

    .category-add-checkbox-label {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      font-size: 13px;
      color: var(--text-secondary);
      user-select: none;
    }

    .category-add-checkbox-label:hover {
      color: var(--text-primary);
    }

    .category-add-checkbox {
      width: 18px;
      height: 18px;
      cursor: pointer;
      accent-color: var(--accent-color);
    }

    .category-add-input {
      flex: 1;
      padding: 10px 12px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 14px;
      color: var(--text-primary);
      outline: none;
      transition: all 0.2s ease;
    }

    .category-add-input:focus {
      border-color: var(--accent-color);
      background: var(--bg-primary);
    }

    .category-add-button {
      padding: 10px 20px;
      background: var(--accent-color);
      color: var(--bg-primary);
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .category-add-button:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    .category-add-button:active {
      transform: translateY(0);
    }

    /* Sticker Batch Management Modal - æ‰¹é‡ç®¡ç†è¡¨æƒ…åŒ…å¼¹çª— */
    .sticker-batch-management-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(4px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10002;
    }

    .sticker-batch-management-modal.active {
      display: flex;
    }

    .sticker-batch-management-content {
      width: 90%;
      max-width: 400px;
      max-height: 80vh;
      background: var(--bg-primary);
      border-radius: 16px;
      display: flex;
      flex-direction: column;
      box-shadow: var(--shadow-xl);
      overflow: hidden;
    }

    .sticker-batch-management-header {
      padding: 16px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .sticker-batch-management-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .sticker-batch-management-close {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .sticker-batch-management-close:hover {
      background: var(--hover-bg);
    }

    .sticker-batch-management-close svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    .sticker-batch-management-toolbar {
      padding: 12px 16px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .sticker-batch-management-btn {
      flex: 1;
      min-width: 100px;
      padding: 8px 12px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 13px;
      font-weight: 500;
      color: var(--text-primary);
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
    }

    .sticker-batch-management-btn:hover {
      background: var(--hover-bg);
      transform: translateY(-1px);
    }

    .sticker-batch-management-btn.danger {
      background: #ff4444;
      border-color: #ff4444;
      color: white;
    }

    .sticker-batch-management-btn.danger:hover {
      background: #ff2222;
    }

    .sticker-batch-management-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .sticker-batch-management-list {
      flex: 1;
      overflow-y: auto;
      padding: 12px;
    }

    .sticker-batch-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      background: var(--bg-secondary);
      border-radius: 8px;
      margin-bottom: 8px;
      border: 1px solid var(--border-color);
      transition: all 0.2s ease;
    }

    .sticker-batch-item.selected {
      background: var(--bg-tertiary);
      border-color: var(--accent-color);
    }

    .sticker-batch-item-checkbox {
      width: 20px;
      height: 20px;
      cursor: pointer;
      accent-color: var(--accent-color);
    }

    .sticker-batch-item-preview {
      width: 50px;
      height: 50px;
      border-radius: 6px;
      overflow: hidden;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    .sticker-batch-item-preview img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .sticker-batch-item-info {
      flex: 1;
      min-width: 0;
    }

    .sticker-batch-item-desc {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 4px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .sticker-batch-item-category {
      font-size: 12px;
      color: var(--text-secondary);
      display: inline-block;
      padding: 2px 8px;
      background: var(--bg-tertiary);
      border-radius: 4px;
    }

    .sticker-batch-item-edit {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .sticker-batch-item-edit:hover {
      background: var(--hover-bg);
      transform: scale(1.05);
    }

    .sticker-batch-item-edit svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    /* Sticker Edit Modal - ç¼–è¾‘è¡¨æƒ…åŒ…å¼¹çª— */
    .sticker-edit-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(4px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10003;
      padding: 20px;
    }

    .sticker-edit-modal.active {
      display: flex;
    }

    .sticker-edit-content {
      width: 100%;
      max-width: 360px;
      background: var(--bg-primary);
      border-radius: 16px;
      display: flex;
      flex-direction: column;
      box-shadow: var(--shadow-xl);
      overflow: hidden;
    }

    .sticker-edit-header {
      padding: 16px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .sticker-edit-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .sticker-edit-close {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .sticker-edit-close:hover {
      background: var(--hover-bg);
    }

    .sticker-edit-close svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    .sticker-edit-body {
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .sticker-edit-preview {
      width: 120px;
      height: 120px;
      margin: 0 auto;
      border-radius: 12px;
      overflow: hidden;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
    }

    .sticker-edit-preview img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .sticker-edit-form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .sticker-edit-label {
      font-size: 13px;
      font-weight: 500;
      color: var(--text-secondary);
    }

    .sticker-edit-input {
      width: 100%;
      padding: 10px 12px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 14px;
      color: var(--text-primary);
      outline: none;
      transition: all 0.2s ease;
    }

    .sticker-edit-input:focus {
      border-color: var(--accent-color);
      background: var(--bg-primary);
    }

    .sticker-edit-footer {
      padding: 16px;
      border-top: 1px solid var(--border-color);
      display: flex;
      gap: 8px;
    }

    .sticker-edit-save-btn {
      flex: 1;
      padding: 10px 16px;
      background: var(--accent-color);
      color: var(--bg-primary);
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .sticker-edit-save-btn:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    .sticker-edit-save-btn:active {
      transform: translateY(0);
    }

    .sticker-edit-cancel-btn {
      flex: 1;
      padding: 10px 16px;
      background: var(--bg-secondary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .sticker-edit-cancel-btn:hover {
      background: var(--hover-bg);
    }

    /* ==================== Text Image Drawer - æ–‡å­—å›¾ç‰‡æŠ½å±‰ ==================== */
    .text-image-overlay {
      position: absolute;
      inset: 0;
      /* é«˜äºèŠå¤©é¡¶æ /åº•æ ï¼ˆå®ƒä»¬æ˜¯ 1000ï¼‰é¿å…è¢«é®æŒ¡ */
      z-index: 1200;
      display: flex;
      align-items: flex-end;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .text-image-overlay.active {
      opacity: 1;
      pointer-events: all;
    }

    .text-image-sheet {
      width: 100%;
      background: var(--bg-primary);
      border-radius: 20px 20px 0 0;
      transform: translateY(100%);
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      flex-direction: column;
      box-shadow: 0 -8px 32px rgba(0, 0, 0, 0.15);
    }

    .text-image-overlay.active .text-image-sheet {
      transform: translateY(0);
    }

    .text-image-handle {
      width: 36px;
      height: 4px;
      background: var(--text-tertiary);
      border-radius: 2px;
      margin: 12px auto 0;
      opacity: 0.5;
    }

    .text-image-header {
      padding: 12px 20px 16px;
      text-align: center;
      flex-shrink: 0;
    }

    .text-image-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 2px;
    }

    .text-image-subtitle {
      font-size: 12px;
      color: var(--text-tertiary);
    }

    .text-image-body {
      padding: 0 16px;
      flex-shrink: 0;
    }

    .text-image-textarea {
      width: 100%;
      height: 100px;
      padding: 14px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 14px;
      font-size: 15px;
      color: var(--text-primary);
      outline: none;
      resize: none;
      font-family: inherit;
      line-height: 1.5;
      transition: border-color 0.2s ease;
    }

    .text-image-textarea::placeholder {
      color: var(--text-tertiary);
    }

    .text-image-textarea:focus {
      border-color: var(--text-secondary);
    }

    .text-image-footer {
      padding: 16px;
      flex-shrink: 0;
    }

    .text-image-send-btn {
      width: 100%;
      padding: 14px;
      background: var(--text-primary);
      color: var(--bg-primary);
      border: none;
      border-radius: 14px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .text-image-send-btn:active {
      transform: scale(0.98);
      opacity: 0.9;
    }

    /* Sticker Picker Manage Button - ç®¡ç†æŒ‰é’® */
    .sticker-picker-manage {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .sticker-picker-manage:hover {
      transform: scale(1.05);
      background: var(--hover-bg);
    }

    .sticker-picker-manage:active {
      transform: scale(0.95);
    }

    .sticker-picker-manage svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    /* Batch Import Modal */
    .batch-import-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(4px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      padding: 20px;
      animation: modalFadeIn 0.3s ease;
    }

    .batch-import-modal.active {
      display: flex;
    }

    @keyframes modalFadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    .batch-import-content {
      width: 100%;
      max-width: 400px;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      box-shadow: var(--shadow-xl);
      display: flex;
      flex-direction: column;
      max-height: 80vh;
      animation: modalSlideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @keyframes modalSlideUp {
      from {
        opacity: 0;
        transform: translateY(20px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .batch-import-header {
      padding: 16px 20px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-shrink: 0;
    }

    .batch-import-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .batch-import-close {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .batch-import-close:hover {
      background: var(--hover-bg);
      transform: scale(1.05);
    }

    .batch-import-close svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    .batch-import-body {
      padding: 20px;
      flex: 1;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .batch-import-hint {
      font-size: 13px;
      line-height: 1.6;
      color: var(--text-secondary);
      background: var(--bg-secondary);
      padding: 12px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }

    .batch-import-form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .batch-import-label {
      font-size: 13px;
      font-weight: 500;
      color: var(--text-secondary);
    }

    .batch-import-select {
      width: 100%;
      padding: 10px 12px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 14px;
      color: var(--text-primary);
      outline: none;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .batch-import-select:focus {
      border-color: var(--accent-color);
      background-color: var(--bg-primary);
    }

    .batch-import-textarea {
      width: 100%;
      min-height: 200px;
      padding: 12px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 13px;
      font-family: 'JetBrains Mono', monospace;
      color: var(--text-primary);
      resize: vertical;
      outline: none;
      transition: all 0.2s ease;
      line-height: 1.5;
    }

    .batch-import-textarea:focus {
      border-color: var(--accent-color);
      background: var(--bg-primary);
      box-shadow: 0 0 0 3px rgba(var(--accent-color-rgb), 0.1);
    }

    .batch-import-textarea::placeholder {
      color: var(--text-tertiary);
      opacity: 0.6;
    }

    .batch-import-footer {
      padding: 16px 20px;
      border-top: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    .batch-import-btn {
      width: 100%;
      padding: 12px 16px;
      background: var(--accent-color);
      border: 1px solid var(--accent-color);
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      color: white;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
    }

    .batch-import-btn:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    .batch-import-btn:active {
      transform: translateY(0);
    }

    /* Sticker Import Area */
    .sticker-import-area {
      padding: 12px 16px;
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    .sticker-import-input-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .sticker-import-input {
      width: 100%;
      padding: 8px 12px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 13px;
      color: var(--text-primary);
      outline: none;
      transition: all 0.2s ease;
    }

    .sticker-import-input:focus {
      border-color: var(--accent-color);
      background: var(--bg-primary);
    }

    .sticker-import-input::placeholder {
      color: var(--text-tertiary);
    }

    .sticker-import-btn {
      padding: 8px 16px;
      background: var(--accent-color);
      border: 1px solid var(--accent-color);
      border-radius: 8px;
      font-size: 13px;
      font-weight: 600;
      color: white;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
    }

    .sticker-import-btn:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    .sticker-import-btn:active {
      transform: translateY(0);
    }

    /* Sticker Grid - 4åˆ—å›ºå®šå°ºå¯¸ï¼Œæ”¾å¤§è¡¨æƒ…åŒ… */
    .sticker-grid {
      flex: 1;
      overflow-y: auto;
      padding: 12px;
      display: grid;
      grid-template-columns: repeat(4, 85px);  /* æ¯åˆ—85pxï¼Œæ›´æ¸…æ™° */
      grid-auto-rows: 85px;  /* æ¯è¡Œ85pxï¼Œå¼ºåˆ¶æ­£æ–¹å½¢ */
      gap: 10px;  /* é—´è·10px */
      justify-content: center;  /* å±…ä¸­æ’åˆ— */
      align-content: start;  /* ä»ä¸Šå¼€å§‹æ’åˆ— */
      scrollbar-width: thin;
      contain: layout;  /* ä¼˜åŒ–å¸ƒå±€æ€§èƒ½ */
    }

    .sticker-grid::-webkit-scrollbar {
      width: 4px;
    }

    .sticker-grid::-webkit-scrollbar-track {
      background: transparent;
    }

    .sticker-grid::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 2px;
    }

    .sticker-item {
      width: 85px;  /* å›ºå®šå®½åº¦85px */
      height: 85px;  /* å›ºå®šé«˜åº¦85px */
      border-radius: 8px;
      overflow: hidden;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
      position: relative;
      animation: stickerItemIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @keyframes stickerItemIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    .sticker-item:hover {
      transform: scale(1.05);
      border-color: var(--accent-color);
      box-shadow: var(--shadow-md);
    }

    .sticker-item:active {
      transform: scale(0.95);
    }

    .sticker-item img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
    }

    .sticker-item-delete {
      position: absolute;
      top: 2px;
      right: 2px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.2);
      display: none;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 2;
    }

    .sticker-item:hover .sticker-item-delete {
      display: flex;
    }

    .sticker-item-delete svg {
      width: 10px;
      height: 10px;
      stroke: white;
      fill: none;
      stroke-width: 2;
    }

    .sticker-grid-empty {
      grid-column: 1 / -1;
      text-align: center;
      padding: 40px 20px;
      color: var(--text-tertiary);
      font-size: 13px;
    }

    /* ==========================================
       User Profile Screen Styles - ç”¨æˆ·èµ„æ–™é¡µæ ·å¼
       ========================================== */

    /* User Profile Main Container */
    .user-profile-main-screen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg-primary);
      z-index: 999;
      display: none;
      flex-direction: column;
      opacity: 0;
      transform: translateX(100%);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .user-profile-main-screen.active {
      display: flex;
      opacity: 1;
      transform: translateX(0);
    }

    /* Profile Content Scroll */
    .user-profile-content {
      width: 100%;
      height: 100%;
      overflow-y: auto;
      scrollbar-width: none;
      padding-bottom: 80px;
    }

    .user-profile-content::-webkit-scrollbar {
      display: none;
    }

    /* Decorative Top Lace Border */
    .profile-lace-top {
      position: sticky;
      top: 0;
      z-index: 10;
      height: 44px;
      background: var(--bg-primary);
      border-bottom: 1px solid var(--border-color);
    }

    .lace-pattern-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 12px;
      background-image: repeating-linear-gradient(
        90deg,
        transparent 0px,
        transparent 8px,
        var(--border-color) 8px,
        var(--border-color) 9px
      );
    }

    .lace-pattern-bar::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 6px;
      background-image: radial-gradient(circle at 8px 0px, transparent 5px, var(--bg-primary) 5px);
      background-size: 16px 16px;
      background-repeat: repeat-x;
    }

    /* Decorative Stars */
    .profile-star-deco {
      position: absolute;
      width: 8px;
      height: 8px;
      opacity: 0.3;
      pointer-events: none;
    }

    .profile-star-deco::before,
    .profile-star-deco::after {
      content: '';
      position: absolute;
      background: var(--text-tertiary);
    }

    .profile-star-deco::before {
      width: 100%;
      height: 2px;
      top: 50%;
      transform: translateY(-50%);
    }

    .profile-star-deco::after {
      width: 2px;
      height: 100%;
      left: 50%;
      transform: translateX(-50%);
    }

    .profile-star-deco.star-1 { top: 80px; left: 30px; animation: starTwinkle 3s ease-in-out infinite; }
    .profile-star-deco.star-2 { top: 120px; right: 40px; animation: starTwinkle 3s ease-in-out 1s infinite; }
    .profile-star-deco.star-3 { top: 200px; left: 50px; animation: starTwinkle 3s ease-in-out 2s infinite; }

    /* Main Profile Card */
    .user-profile-main-card {
      margin: 20px 16px;
      background: var(--bg-secondary);
      border: 2px solid var(--border-color);
      border-radius: 20px;
      overflow: hidden;
      position: relative;
      box-shadow: var(--shadow-md);
      animation: fadeIn 0.4s ease 0.1s backwards;
    }

    /* Irregular Border Decoration */
    .user-profile-main-card::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      height: 28px;
      background: repeating-linear-gradient(
        90deg,
        var(--border-color) 0px,
        var(--border-color) 8px,
        transparent 8px,
        transparent 16px
      );
      pointer-events: none;
    }

    .user-profile-main-card::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: -2px;
      right: -2px;
      height: 28px;
      background: repeating-linear-gradient(
        90deg,
        var(--border-color) 0px,
        var(--border-color) 8px,
        transparent 8px,
        transparent 16px
      );
      pointer-events: none;
    }

    /* Pixel Corner Decorations */
    .profile-pixel-corner {
      position: absolute;
      width: 8px;
      height: 8px;
      background: var(--border-color);
      opacity: 0.3;
    }

    .profile-pixel-corner.top-left { top: 8px; left: 8px; }
    .profile-pixel-corner.top-right { top: 8px; right: 8px; }
    .profile-pixel-corner.bottom-left { bottom: 8px; left: 8px; }
    .profile-pixel-corner.bottom-right { bottom: 8px; right: 8px; }

    /* Card Background Image Layer */
    .user-card-background {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      opacity: 0.35;
      z-index: 0;
      border-radius: 20px;
      pointer-events: none;
    }

    /* Avatar Section */
    .user-profile-avatar-section {
      /* ğŸ”¥ ä½¿ç”¨å…¨å±€App Header paddingå˜é‡ */
      padding: var(--app-header-total-padding) 24px 24px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      position: relative;
    }

    .user-avatar-wrapper {
      position: relative;
      margin-bottom: 16px;
    }

    .user-avatar-large {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      border: 3px solid var(--border-color);
      overflow: hidden;
      background: var(--bg-tertiary);
      position: relative;
      box-shadow: var(--shadow-md);
    }

    .user-avatar-large img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .user-avatar-large svg {
      width: 50%;
      height: 50%;
      stroke: var(--text-tertiary);
      fill: none;
      stroke-width: 1.5;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    /* Pixel Heart Badge */
    .user-pixel-heart {
      position: absolute;
      top: -8px;
      right: -8px;
      width: 24px;
      height: 24px;
      background: var(--accent-color);
      clip-path: polygon(
        50% 20%,
        60% 10%,
        70% 10%,
        80% 20%,
        80% 30%,
        50% 60%,
        20% 30%,
        20% 20%,
        30% 10%,
        40% 10%
      );
      animation: heartBeat 1.5s ease-in-out infinite;
    }

    @keyframes heartBeat {
      0%, 100% { transform: scale(1); }
      25% { transform: scale(1.1); }
      50% { transform: scale(1); }
    }

    .user-display-name {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 6px;
      letter-spacing: -0.02em;
      font-family: 'Noto Sans JP', sans-serif;
    }

    .user-display-username {
      font-size: 13px;
      color: var(--text-secondary);
      font-family: 'JetBrains Mono', monospace;
      margin-bottom: 4px;
    }

    .user-display-pronouns {
      display: inline-block;
      font-size: 11px;
      color: var(--text-tertiary);
      background: var(--bg-tertiary);
      padding: 4px 10px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      font-family: 'JetBrains Mono', monospace;
      margin-bottom: 16px;
    }

    .user-display-bio {
      font-size: 14px;
      line-height: 1.6;
      color: var(--text-secondary);
      max-width: 280px;
      margin: 0 auto 20px;
      white-space: pre-wrap;
    }

    /* Stats Row */
    .user-profile-stats-row {
      display: flex;
      gap: 16px;
      justify-content: center;
      padding: 16px 0;
      border-top: 1px solid var(--border-color);
    }

    .user-stat-box {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
    }

    .user-stat-value {
      font-size: 18px;
      font-weight: 600;
      font-family: 'JetBrains Mono', monospace;
    }

    .user-stat-label {
      font-size: 11px;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* Profile Section Container */
    .user-profile-section-box {
      margin: 16px 16px 0;
      background: var(--bg-secondary);
      border: 2px solid var(--border-color);
      border-radius: 16px;
      padding: 20px;
      position: relative;
      box-shadow: var(--shadow-sm);
      animation: fadeIn 0.4s ease backwards;
    }

    .user-profile-section-box:nth-child(2) { animation-delay: 0.2s; }
    .user-profile-section-box:nth-child(3) { animation-delay: 0.3s; }
    .user-profile-section-box:nth-child(4) { animation-delay: 0.4s; }

    .user-section-header-title {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-secondary);
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-family: 'JetBrains Mono', monospace;
    }

    .user-section-header-title::before {
      content: '';
      width: 16px;
      height: 2px;
      background: var(--accent-color);
      opacity: 0.3;
    }

    /* About Me Text */
    .user-about-text {
      font-size: 13px;
      line-height: 1.7;
      color: var(--text-secondary);
      white-space: pre-wrap;
    }

    /* Tags Display */
    .user-tags-container {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .user-tag-badge {
      padding: 6px 12px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 12px;
      color: var(--text-primary);
      transition: all 0.2s ease;
      cursor: pointer;
    }

    .user-tag-badge:hover {
      background: var(--hover-bg);
      transform: translateY(-2px);
      box-shadow: var(--shadow-sm);
    }

    .user-tag-badge.tag-positive {
      border-color: var(--accent-color);
      font-weight: 500;
    }

    .user-tag-badge.tag-negative {
      opacity: 0.6;
      text-decoration: line-through;
    }

    /* List Display */
    .user-list-group {
      margin-bottom: 16px;
    }

    .user-list-group:last-child {
      margin-bottom: 0;
    }

    .user-list-group-title {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--text-tertiary);
      margin-bottom: 8px;
      font-family: 'JetBrains Mono', monospace;
    }

    .user-list-group-content {
      font-size: 13px;
      line-height: 1.8;
      color: var(--text-secondary);
    }

    /* Profile Action Buttons */
    .profile-action-btn {
      width: 46px;
      height: 46px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .profile-action-btn:hover {
      background: var(--hover-bg);
      transform: scale(1.05);
    }

    .profile-action-btn:active {
      transform: scale(0.95);
    }

    .profile-action-btn svg {
      width: 20px;
      height: 20px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    /* Floating Action Buttons at Bottom */
    .profile-floating-actions {
      position: fixed;
      bottom: 105px;
      right: 20px;
      display: flex;
      gap: 12px;
      z-index: 200;
    }

    /* Profile Edit Modal Styles */
    .profile-edit-modal-content {
      max-height: 70vh;
      overflow-y: auto;
      scrollbar-width: none;
    }

    .profile-edit-modal-content::-webkit-scrollbar {
      display: none;
    }

    .profile-upload-area {
      width: 100%;
      padding: 20px;
      background: var(--bg-tertiary);
      border: 2px dashed var(--border-color);
      border-radius: 12px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
      position: relative;
      overflow: hidden;
    }

    .profile-upload-area:hover {
      border-color: var(--accent-color);
      background: var(--hover-bg);
    }

    .profile-upload-area.has-image {
      padding: 0;
      border-style: solid;
      aspect-ratio: 1;
    }

    .profile-upload-preview {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 10px;
    }

    .profile-upload-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      display: none;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 12px;
      font-weight: 500;
    }

    .profile-upload-area:hover .profile-upload-overlay {
      display: flex;
    }

    .profile-tags-editor {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
    }

    .profile-tag-editable {
      padding: 6px 12px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 12px;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s ease;
    }

    .profile-tag-editable:hover {
      background: var(--hover-bg);
    }

    .profile-tag-remove {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: var(--text-tertiary);
      color: var(--bg-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 12px;
      line-height: 1;
      transition: all 0.2s ease;
    }

    .profile-tag-remove:hover {
      background: var(--accent-color);
      transform: scale(1.1);
    }

    .profile-tag-add-btn {
      padding: 6px 12px;
      background: var(--bg-primary);
      border: 1px dashed var(--border-color);
      border-radius: 8px;
      font-size: 12px;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .profile-tag-add-btn:hover {
      border-color: var(--accent-color);
      color: var(--accent-color);
    }

    /* Profile Management Styles */
    .profile-mgmt-new-btn {
      width: 100%;
      padding: 14px;
      background: var(--bg-tertiary);
      border: 2px dashed var(--border-color);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      color: var(--text-secondary);
      font-size: 14px;
      font-weight: 500;
    }

    .profile-mgmt-new-btn:hover {
      border-color: var(--accent-color);
      color: var(--accent-color);
      background: var(--hover-bg);
    }

    .profile-mgmt-card {
      padding: 16px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      display: flex;
      gap: 12px;
      align-items: center;
      position: relative;
      transition: all 0.2s ease;
    }

    .profile-mgmt-card:hover {
      background: var(--hover-bg);
      border-color: var(--accent-color);
    }

    .profile-mgmt-card.active {
      border-color: var(--accent-color);
      background: var(--hover-bg);
    }

    .profile-mgmt-card.active::before {
      content: 'â—';
      position: absolute;
      top: 8px;
      right: 8px;
      color: var(--accent-color);
      font-size: 18px;
      animation: pulse 2s infinite;
    }

    .profile-mgmt-avatar {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      border: 2px solid var(--border-color);
      overflow: hidden;
      background: var(--bg-primary);
      flex-shrink: 0;
    }

    .profile-mgmt-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .profile-mgmt-avatar svg {
      width: 100%;
      height: 100%;
      padding: 10px;
      stroke: var(--text-tertiary);
      fill: none;
      stroke-width: 1.5;
    }

    .profile-mgmt-info {
      flex: 1;
      min-width: 0;
    }

    .profile-mgmt-name {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 2px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .profile-mgmt-username {
      font-size: 12px;
      color: var(--text-secondary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .profile-mgmt-stats {
      font-size: 11px;
      color: var(--text-tertiary);
      margin-top: 4px;
    }

    .profile-mgmt-actions {
      display: flex;
      gap: 4px;
      flex-shrink: 0;
    }

    .profile-mgmt-btn {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .profile-mgmt-btn:hover {
      background: var(--hover-bg);
      border-color: var(--accent-color);
    }

    .profile-mgmt-btn svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    .profile-mgmt-btn.delete:hover {
      background: #ff4444;
      border-color: #ff4444;
    }

    .profile-mgmt-btn.delete:hover svg {
      stroke: white;
    }

    @keyframes pulse {
      0%, 100% {
        opacity: 1;
      }
      50% {
        opacity: 0.5;
      }
    }

    /* Typing Indicator */
    .chat-typing-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 14px;
      background: var(--bg-tertiary);
      border-radius: 18px;
      border-bottom-left-radius: 4px;
      max-width: 75%;
    }

    .chat-typing-dots {
      display: flex;
      gap: 4px;
    }

    .chat-typing-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--text-secondary);
      animation: typingBounce 1.4s infinite ease-in-out;
    }

    .chat-typing-dot:nth-child(1) {
      animation-delay: 0s;
    }

    .chat-typing-dot:nth-child(2) {
      animation-delay: 0.2s;
    }

    .chat-typing-dot:nth-child(3) {
      animation-delay: 0.4s;
    }

    @keyframes typingBounce {
      0%, 60%, 100% {
        transform: translateY(0);
      }
      30% {
        transform: translateY(-8px);
      }
    }

    /* Empty Chat State */
    .chat-empty-messages {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 12px;
      padding: 40px 20px;
      opacity: 0.5;
    }

    .chat-empty-messages svg {
      width: 64px;
      height: 64px;
      stroke: var(--text-tertiary);
      fill: none;
      stroke-width: 1.5;
    }

    .chat-empty-messages-text {
      font-size: 14px;
      color: var(--text-secondary);
      text-align: center;
    }

    .chat-empty-messages-subtext {
      font-size: 12px;
      color: var(--text-tertiary);
      text-align: center;
    }

    /* ==================== Chat Settings Screen ==================== */
    .chat-settings-screen {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--bg-primary);
      z-index: 8500;
      display: none;
      opacity: 0;
      transform: translateX(100%);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      overflow-y: auto;
      overflow-x: hidden;
      -webkit-overflow-scrolling: touch;
    }

    .chat-settings-screen.active {
      display: block;
      opacity: 1;
      transform: translateX(0);
    }

    .chat-settings-screen .app-content {
      min-height: 100vh;
      min-height: 100dvh; /* åŠ¨æ€è§†å£é«˜åº¦ */
      padding-bottom: 60px;
    }

    .chat-settings-avatar {
      width: 80px;
      height: 80px;
      border-radius: 20px;
      margin: 0 auto 12px;
      overflow: hidden;
      border: 2px solid var(--border-color);
      background: var(--bg-tertiary);
    }

    .chat-settings-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .chat-settings-original-name {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
      margin-top: 8px;
    }

    /* ========================================
       å¤´åƒç®¡ç†æ¨¡å— - Avatar Manager
       ======================================== */
    .avatar-manager {
      position: relative;
      padding: 16px 12px 20px;
      background: var(--bg-secondary);
      border-radius: 16px;
      border: 1px solid var(--border-color);
      overflow: hidden;
    }

    /* èƒŒæ™¯è£…é¥°å±‚ */
    .avatar-deco-layer {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      overflow: hidden;
    }

    /* æ‰‹ç»˜æ˜Ÿæ˜Ÿ */
    .avatar-manager .deco-star {
      position: absolute;
      opacity: 0.15;
      animation: avatarTwinkle 3s ease-in-out infinite;
    }

    .avatar-manager .deco-star svg {
      width: 100%;
      height: 100%;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 1.5;
    }

    .avatar-manager .deco-star:nth-child(1) {
      top: 12%;
      left: 8%;
      width: 10px;
      height: 10px;
      animation-delay: 0s;
    }

    .avatar-manager .deco-star:nth-child(2) {
      top: 18%;
      right: 10%;
      width: 8px;
      height: 8px;
      animation-delay: 0.8s;
    }

    @keyframes avatarTwinkle {
      0%, 100% { opacity: 0.1; transform: scale(1); }
      50% { opacity: 0.25; transform: scale(1.1); }
    }

    /* å¤´åƒå¯¹å®¹å™¨ */
    .avatar-pair-container {
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 8px 0 12px;
    }

    /* å•ä¸ªå¤´åƒåŒ…è£… */
    .avatar-wrapper {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .avatar-wrapper:active {
      transform: scale(0.95);
    }

    /* å¤´åƒå¤–æ¡† */
    .avatar-frame {
      position: relative;
      width: 72px;
      height: 72px;
    }

    /* å¤´åƒå›¾ç‰‡å®¹å™¨ */
    .avatar-img-container {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      overflow: hidden;
      border: 2px solid var(--border-color);
      background: var(--bg-tertiary);
      position: relative;
      z-index: 2;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }

    .avatar-wrapper:hover .avatar-img-container {
      border-color: var(--text-tertiary);
      box-shadow: 0 4px 16px rgba(0,0,0,0.2);
    }

    .avatar-img-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* å¤´åƒå ä½ç¬¦ */
    .avatar-placeholder {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-tertiary);
    }

    .avatar-placeholder svg {
      width: 32px;
      height: 32px;
      stroke: var(--text-tertiary);
      fill: none;
      stroke-width: 1.5;
    }

    /* å¤´åƒæ ‡ç­¾ */
    .avatar-label {
      margin-top: 8px;
      font-size: 11px;
      font-weight: 500;
      color: var(--text-secondary);
      letter-spacing: 0.02em;
    }

    /* æ›´æ¢æç¤º */
    .avatar-hint {
      font-size: 9px;
      color: var(--text-tertiary);
      margin-top: 2px;
      font-family: 'Caveat', cursive;
      letter-spacing: 0.05em;
    }

    /* å¿ƒå½¢è€³æœºçº¿è¿æ¥ */
    .connection-area {
      position: relative;
      width: 80px;
      height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 -8px;
      z-index: 3;
    }

    /* å¿ƒå½¢SVG */
    .heart-connector {
      position: absolute;
      width: 28px;
      height: 26px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      animation: avatarHeartbeat 2s ease-in-out infinite;
    }

    .heart-connector svg {
      width: 100%;
      height: 100%;
      fill: none;
      stroke: var(--text-primary);
      stroke-width: 1.5;
      opacity: 0.4;
    }

    @keyframes avatarHeartbeat {
      0%, 100% { transform: translate(-50%, -50%) scale(1); }
      50% { transform: translate(-50%, -50%) scale(1.08); }
    }

    /* è€³æœºçº¿ */
    .headphone-line-left,
    .headphone-line-right {
      position: absolute;
      top: 50%;
      width: 50px;
      height: 40px;
      transform: translateY(-50%);
    }

    .headphone-line-left {
      left: -10px;
    }

    .headphone-line-right {
      right: -10px;
      transform: translateY(-50%) scaleX(-1);
    }

    .headphone-line-left svg,
    .headphone-line-right svg {
      width: 100%;
      height: 100%;
      fill: none;
      stroke: var(--text-primary);
      stroke-width: 1.5;
      opacity: 0.25;
    }

    /* ç»Ÿè®¡ä¿¡æ¯åŒºåŸŸ */
    .stats-area {
      text-align: center;
      margin-top: 4px;
      padding: 0 16px;
    }

    .stats-text {
      font-size: 11px;
      color: var(--text-tertiary);
      font-family: 'Noto Sans JP', 'Inter', sans-serif;
      letter-spacing: 0.08em;
      line-height: 1.6;
    }

    .stats-highlight {
      color: var(--text-secondary);
      font-weight: 500;
    }

    /* åº•éƒ¨æ“ä½œæç¤º */
    .action-hint {
      text-align: center;
      padding: 8px 16px 4px;
      border-top: 1px dashed var(--border-color);
      margin-top: 8px;
    }

    .action-hint-text {
      font-size: 10px;
      color: var(--text-tertiary);
      font-family: 'Caveat', cursive;
      letter-spacing: 0.1em;
    }

    /* å“åº”å¼é€‚é… */
    @media (max-width: 360px) {
      .avatar-frame {
        width: 64px;
        height: 64px;
      }

      .connection-area {
        width: 60px;
        height: 60px;
      }
    }

    .chat-background-preview {
      width: 100%;
      height: 160px;
      border-radius: 12px;
      border: 2px dashed var(--border-color);
      background: var(--bg-tertiary);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      overflow: hidden;
      position: relative;
    }

    .chat-background-preview:hover {
      border-color: var(--accent-color);
      background: var(--hover-bg);
    }

    .chat-background-preview.has-image {
      border-style: solid;
    }

    .chat-background-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .background-preview-placeholder {
      text-align: center;
      padding: 20px;
    }

    .background-preview-placeholder svg {
      width: 48px;
      height: 48px;
      opacity: 0.3;
    }

    /* ==================== å‰§æƒ…ç‚¹ç³»ç»Ÿæ ·å¼ ==================== */

    /* å‰§æƒ…ç‚¹å®¹å™¨å¡ç‰‡ - ç™½è‰²èƒŒæ™¯ */
    .plot-points-card {
      background: var(--bg-primary) !important;
    }

    /* æ ‡é¢˜è£…é¥°æ˜Ÿæ˜Ÿ */
    .plot-point-header-stars {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      margin-left: 8px;
      vertical-align: middle;
    }

    .plot-point-mini-star {
      width: 4px;
      height: 4px;
      background: var(--text-primary);
      clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
      animation: plot-star-twinkle 3s ease-in-out infinite;
      opacity: 0.4;
    }

    .plot-point-mini-star:nth-child(2) {
      animation-delay: 1s;
    }

    .plot-point-mini-star:nth-child(3) {
      animation-delay: 2s;
    }

    @keyframes plot-star-twinkle {
      0%, 100% { opacity: 0.3; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.3); }
    }

    /* å‰§æƒ…ç‚¹è¯´æ˜æ–‡å­— */
    .plot-point-description {
      font-size: 12px;
      color: var(--text-secondary);
      margin-bottom: 16px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border-color);
      line-height: 1.5;
      letter-spacing: 0.3px;
    }

    /* å‰§æƒ…ç‚¹åˆ—è¡¨å®¹å™¨ */
    .plot-points-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 16px;
    }

    /* ç©ºçŠ¶æ€ */
    .plot-points-empty {
      text-align: center;
      padding: 32px 16px;
      color: var(--text-tertiary);
    }

    .plot-points-empty svg {
      width: 48px;
      height: 48px;
      stroke: var(--text-tertiary);
      fill: none;
      stroke-width: 1.5;
      margin-bottom: 12px;
      opacity: 0.5;
    }

    .plot-points-empty .empty-text {
      font-size: 13px;
      margin-bottom: 4px;
      color: var(--text-secondary);
      font-weight: 500;
    }

    .plot-points-empty .empty-subtext {
      font-size: 11px;
      color: var(--text-tertiary);
    }

    /* å‰§æƒ…ç‚¹å¡ç‰‡ - å¼‚å½¢è®¾è®¡ */
    .plot-point-item {
      position: relative;
      background: var(--bg-primary);
      border: 1.5px solid var(--border-color);
      border-radius: 20px;
      padding: 20px;
      transition: all 0.3s ease;
      overflow: hidden;
      clip-path: polygon(
        0 12px, 12px 0, calc(100% - 12px) 0, 100% 12px,
        100% calc(100% - 12px), calc(100% - 12px) 100%, 12px 100%, 0 calc(100% - 12px)
      );
    }

    .plot-point-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, var(--bg-secondary) 0%, transparent 50%);
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }

    .plot-point-item:hover::before {
      opacity: 1;
    }

    .plot-point-item:hover {
      border-color: var(--text-tertiary);
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    /* å‰§æƒ…ç‚¹è£…é¥°æ˜Ÿæ˜Ÿ */
    .plot-point-item-stars {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      gap: 4px;
      opacity: 0.3;
    }

    .plot-point-item-star {
      width: 4px;
      height: 4px;
      background: var(--text-primary);
      clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
      animation: plot-star-twinkle 3s ease-in-out infinite;
    }

    .plot-point-item-star:nth-child(2) {
      animation-delay: 1s;
    }

    .plot-point-item-star:nth-child(3) {
      animation-delay: 2s;
    }

    /* å‰§æƒ…ç‚¹å¤´éƒ¨ï¼šæ—¥æœŸ+åœ°ç‚¹ */
    .plot-point-item-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 12px;
    }

    .plot-point-item-date,
    .plot-point-item-location {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: var(--bg-tertiary);
      border-radius: 12px;
      font-size: 12px;
      font-family: 'JetBrains Mono', monospace;
      color: var(--text-secondary);
      border: 1px solid var(--border-color);
    }

    .plot-point-item-location {
      background: var(--bg-secondary);
      border-style: dashed;
    }

    .plot-point-item-date svg,
    .plot-point-item-location svg {
      width: 14px;
      height: 14px;
      stroke: currentColor;
      fill: none;
      stroke-width: 2;
    }

    /* å‰§æƒ…ç‚¹å†…å®¹ */
    .plot-point-item-content {
      position: relative;
      padding: 16px;
      background: var(--bg-secondary);
      border-radius: 12px;
      margin-top: 12px;
      font-size: 14px;
      line-height: 1.6;
      color: var(--text-primary);
      font-family: 'Noto Sans JP', sans-serif;
      border-left: 3px solid var(--text-tertiary);
      border-image: repeating-linear-gradient(
        0deg,
        var(--text-tertiary) 0px,
        var(--text-tertiary) 4px,
        transparent 4px,
        transparent 8px
      ) 1;
      /* é•¿æ–‡æœ¬å¤„ç† */
      word-wrap: break-word;
      word-break: break-word;
      overflow-wrap: break-word;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 4;
      -webkit-box-orient: vertical;
      text-overflow: ellipsis;
      max-height: calc(1.6em * 4 + 32px);
    }

    .plot-point-item-content::before {
      content: '"';
      position: absolute;
      top: 8px;
      left: 8px;
      font-size: 32px;
      font-family: 'Caveat', cursive;
      color: var(--text-tertiary);
      opacity: 0.5;
      line-height: 1;
    }

    /* å‰§æƒ…ç‚¹æ“ä½œæŒ‰é’® */
    .plot-point-item-actions {
      display: flex;
      gap: 8px;
      margin-top: 12px;
      justify-content: flex-end;
    }

    .plot-point-item-btn {
      padding: 8px 14px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      font-size: 12px;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 6px;
      font-family: 'Inter', sans-serif;
      font-weight: 500;
    }

    .plot-point-item-btn:hover {
      background: var(--text-primary);
      color: var(--bg-primary);
      transform: translateY(-1px);
    }

    .plot-point-item-btn.danger:hover {
      background: #d32f2f;
      border-color: #d32f2f;
      color: #ffffff;
    }

    .plot-point-item-btn svg {
      width: 14px;
      height: 14px;
      stroke: currentColor;
      fill: none;
      stroke-width: 2;
    }

    /* æ·»åŠ å‰§æƒ…ç‚¹æŒ‰é’® */
    .add-plot-point-btn-main {
      width: 100%;
      padding: 16px;
      background: var(--bg-secondary);
      border: 2px dashed var(--border-color);
      border-radius: 16px;
      color: var(--text-secondary);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-family: 'Inter', sans-serif;
    }

    .add-plot-point-btn-main:hover {
      background: var(--bg-tertiary);
      border-color: var(--text-tertiary);
      color: var(--text-primary);
      transform: translateY(-2px);
    }

    .add-plot-point-btn-main svg {
      width: 18px;
      height: 18px;
      stroke: currentColor;
      fill: none;
      stroke-width: 2;
      transition: transform 0.3s ease;
    }

    .add-plot-point-btn-main:hover svg {
      animation: plot-btn-pulse 1.5s ease-in-out infinite;
    }

    @keyframes plot-btn-pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }

    /* ========== å‰§æƒ…ç‚¹æ¨¡æ€æ¡† ========== */
    .plot-point-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(8px);
      z-index: 10000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .plot-point-modal.active {
      display: flex;
      opacity: 1;
    }

    .plot-point-modal-content {
      background: var(--bg-primary);
      border-radius: 20px;
      width: 100%;
      max-width: 420px;
      max-height: 90vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      box-shadow: var(--shadow-xl);
      clip-path: polygon(
        0 12px, 12px 0, calc(100% - 12px) 0, 100% 12px,
        100% calc(100% - 12px), calc(100% - 12px) 100%, 12px 100%, 0 calc(100% - 12px)
      );
      border: 2px solid var(--border-color);
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .plot-point-modal.active .plot-point-modal-content {
      transform: scale(1);
    }

    .plot-point-modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 24px;
      border-bottom: 1px solid var(--border-color);
      background: var(--bg-secondary);
    }

    .plot-point-modal-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .plot-point-modal-close {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .plot-point-modal-close:hover {
      background: var(--text-primary);
      transform: rotate(90deg);
    }

    .plot-point-modal-close svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-secondary);
      fill: none;
      stroke-width: 2;
    }

    .plot-point-modal-close:hover svg {
      stroke: var(--bg-primary);
    }

    .plot-point-modal-body {
      padding: 24px;
      overflow-y: auto;
      flex: 1;
    }

    .plot-point-form-group {
      margin-bottom: 20px;
    }

    .plot-point-label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 10px;
    }

    .plot-point-label svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-secondary);
      fill: none;
      stroke-width: 2;
    }

    .plot-point-input,
    .plot-point-textarea {
      width: 100%;
      padding: 12px 14px;
      background: var(--bg-secondary);
      border: 1.5px solid var(--border-color);
      border-radius: 10px;
      font-size: 13px;
      color: var(--text-primary);
      font-family: inherit;
      transition: all 0.2s ease;
      outline: none;
    }

    .plot-point-input:focus,
    .plot-point-textarea:focus {
      border-color: var(--accent-color);
      background: var(--bg-primary);
      box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.05);
    }

    [data-theme='dark'] .plot-point-input:focus,
    [data-theme='dark'] .plot-point-textarea:focus {
      box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.05);
    }

    /* æ—¥æœŸé€‰æ‹©å™¨æ—¥å†å›¾æ ‡é¢œè‰²ä¿®å¤ï¼ˆæš—è‰²æ¨¡å¼ï¼‰ */
    [data-theme='dark'] .plot-point-input[type="date"] {
      color-scheme: dark;
    }

    [data-theme='dark'] .plot-point-input[type="date"]::-webkit-calendar-picker-indicator {
      filter: invert(1);
      opacity: 1;
      cursor: pointer;
    }

    /* äº®è‰²æ¨¡å¼ä¿æŒåŸæ · */
    .plot-point-input[type="date"]::-webkit-calendar-picker-indicator {
      cursor: pointer;
      opacity: 0.7;
    }

    .plot-point-input[type="date"]::-webkit-calendar-picker-indicator:hover {
      opacity: 1;
    }

    .plot-point-textarea {
      resize: vertical;
      min-height: 120px;
      line-height: 1.6;
      font-family: inherit;
    }

    .plot-point-char-count {
      text-align: right;
      font-size: 11px;
      color: var(--text-tertiary);
      margin-top: 6px;
      font-family: 'JetBrains Mono', monospace;
    }

    .plot-point-char-count span {
      color: var(--text-secondary);
      font-weight: 600;
    }

    .plot-point-modal-footer {
      display: flex;
      gap: 10px;
      padding: 16px 24px;
      border-top: 1px solid var(--border-color);
      background: var(--bg-secondary);
    }

    .plot-point-modal-btn {
      flex: 1;
      padding: 12px;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      border: 1.5px solid var(--border-color);
      font-family: 'Inter', sans-serif;
    }

    .plot-point-modal-btn.secondary {
      background: var(--bg-tertiary);
      color: var(--text-secondary);
    }

    .plot-point-modal-btn.secondary:hover {
      background: var(--text-primary);
      color: var(--bg-primary);
      border-color: var(--text-primary);
    }

    .plot-point-modal-btn.primary {
      background: var(--accent-color);
      color: var(--bg-primary);
      border-color: var(--accent-color);
    }

    .plot-point-modal-btn.primary:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    [data-theme='dark'] .plot-point-modal-btn.primary {
      background: var(--bg-primary);
      color: var(--text-primary);
      border-color: var(--text-primary);
    }

    /* ==================== æ¸©åº¦è®¾ç½®æ ·å¼å¼€å§‹ ==================== */

    /* æ˜Ÿæ˜Ÿè£…é¥° */
    .temp-header-stars {
      display: flex;
      gap: 6px;
      align-items: center;
    }

    .temp-mini-star {
      width: 4px;
      height: 4px;
      background: #000;
      clip-path: polygon(
        50% 0%,
        61% 35%,
        98% 35%,
        68% 57%,
        79% 91%,
        50% 70%,
        21% 91%,
        32% 57%,
        2% 35%,
        39% 35%
      );
      animation: temp-star-twinkle 3s ease-in-out infinite;
    }

    [data-theme='dark'] .temp-mini-star {
      background: #fff;
    }

    .temp-mini-star:nth-child(1) {
      animation-delay: 0s;
    }

    .temp-mini-star:nth-child(2) {
      animation-delay: 0.5s;
    }

    .temp-mini-star:nth-child(3) {
      animation-delay: 1s;
    }

    @keyframes temp-star-twinkle {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.3; transform: scale(0.8); }
    }

    /* æ¸©åº¦å¡ç‰‡ */
    .temp-card {
      background: #fafafa;
      border: 1px solid #e0e0e0;
      padding: 24px 20px;
      position: relative;
      clip-path: polygon(
        0 12px,
        12px 0,
        calc(100% - 12px) 0,
        100% 12px,
        100% calc(100% - 12px),
        calc(100% - 12px) 100%,
        12px 100%,
        0 calc(100% - 12px)
      );
      transition: all 0.3s ease;
    }

    [data-theme='dark'] .temp-card {
      background: #0f0f0f;
      border-color: #2a2a2a;
    }

    /* æ¸©åº¦æ˜¾ç¤º */
    .temp-display {
      text-align: center;
      margin-bottom: 24px;
    }

    .temp-label {
      font-size: 11px;
      font-weight: 500;
      color: #666;
      letter-spacing: 1px;
      text-transform: uppercase;
      margin-bottom: 8px;
      font-family: 'Monaco', 'Menlo', 'Consolas', 'Courier New', monospace;
    }

    [data-theme='dark'] .temp-label {
      color: #888;
    }

    .temp-value {
      font-size: 48px;
      font-weight: 700;
      color: #000;
      font-family: 'Monaco', 'Menlo', 'Consolas', 'Courier New', monospace;
      letter-spacing: -2px;
      line-height: 1;
    }

    [data-theme='dark'] .temp-value {
      color: #fff;
    }

    .temp-description {
      font-size: 12px;
      color: #888;
      margin-top: 8px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      letter-spacing: 0.3px;
    }

    [data-theme='dark'] .temp-description {
      color: #666;
    }

    /* æ»‘åŠ¨æ¡å®¹å™¨ */
    .temp-slider-container {
      padding: 0 4px;
    }

    /* æ»‘åŠ¨æ¡è½¨é“ */
    .temp-slider {
      -webkit-appearance: none;
      appearance: none;
      width: 100%;
      height: 8px;
      background: #e0e0e0;
      outline: none;
      border-radius: 0;
      position: relative;
      cursor: pointer;
      clip-path: polygon(
        0 2px,
        2px 0,
        calc(100% - 2px) 0,
        100% 2px,
        100% calc(100% - 2px),
        calc(100% - 2px) 100%,
        2px 100%,
        0 calc(100% - 2px)
      );
    }

    [data-theme='dark'] .temp-slider {
      background: #1a1a1a;
    }

    /* æ»‘å— - WebKit */
    .temp-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 24px;
      height: 24px;
      background: #000;
      cursor: pointer;
      clip-path: polygon(
        0 6px,
        6px 0,
        calc(100% - 6px) 0,
        100% 6px,
        100% calc(100% - 6px),
        calc(100% - 6px) 100%,
        6px 100%,
        0 calc(100% - 6px)
      );
      transition: all 0.2s ease;
    }

    [data-theme='dark'] .temp-slider::-webkit-slider-thumb {
      background: #fff;
    }

    .temp-slider::-webkit-slider-thumb:hover {
      transform: scale(1.15);
    }

    .temp-slider::-webkit-slider-thumb:active {
      transform: scale(1.05);
    }

    /* æ»‘å— - Firefox */
    .temp-slider::-moz-range-thumb {
      width: 24px;
      height: 24px;
      background: #000;
      cursor: pointer;
      border: none;
      clip-path: polygon(
        0 6px,
        6px 0,
        calc(100% - 6px) 0,
        100% 6px,
        100% calc(100% - 6px),
        calc(100% - 6px) 100%,
        6px 100%,
        0 calc(100% - 6px)
      );
      transition: all 0.2s ease;
    }

    [data-theme='dark'] .temp-slider::-moz-range-thumb {
      background: #fff;
    }

    .temp-slider::-moz-range-thumb:hover {
      transform: scale(1.15);
    }

    /* èŒƒå›´æ ‡ç­¾ */
    .temp-range-labels {
      display: flex;
      justify-content: space-between;
      margin-top: 12px;
      padding: 0 4px;
    }

    .temp-range-label {
      font-size: 10px;
      color: #999;
      font-family: 'Monaco', 'Menlo', 'Consolas', 'Courier New', monospace;
      letter-spacing: 0.5px;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    [data-theme='dark'] .temp-range-label {
      color: #555;
    }

    .temp-range-label::before {
      content: '';
      width: 2px;
      height: 2px;
      background: currentColor;
      display: block;
    }

    /* é¢„è®¾æŒ‰é’® */
    .temp-presets {
      display: flex;
      gap: 8px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    .temp-preset-btn {
      flex: 1;
      min-width: 0;
      background: #fff;
      border: 1px solid #e0e0e0;
      padding: 10px 12px;
      font-size: 11px;
      font-weight: 500;
      color: #666;
      cursor: pointer;
      font-family: 'Monaco', 'Menlo', 'Consolas', 'Courier New', monospace;
      letter-spacing: 0.3px;
      transition: all 0.2s ease;
      clip-path: polygon(
        0 4px,
        4px 0,
        calc(100% - 4px) 0,
        100% 4px,
        100% calc(100% - 4px),
        calc(100% - 4px) 100%,
        4px 100%,
        0 calc(100% - 4px)
      );
    }

    [data-theme='dark'] .temp-preset-btn {
      background: #0f0f0f;
      border-color: #2a2a2a;
      color: #888;
    }

    .temp-preset-btn:hover {
      background: #000;
      color: #fff;
      border-color: #000;
      transform: translateY(-1px);
    }

    [data-theme='dark'] .temp-preset-btn:hover {
      background: #fff;
      color: #000;
      border-color: #fff;
    }

    .temp-preset-btn:active {
      transform: translateY(0);
    }

    .temp-preset-btn.active {
      background: #000;
      color: #fff;
      border-color: #000;
    }

    [data-theme='dark'] .temp-preset-btn.active {
      background: #fff;
      color: #000;
      border-color: #fff;
    }

    /* è¯´æ˜ä¿¡æ¯ */
    .temp-info {
      margin-top: 20px;
      padding: 16px;
      background: #f5f5f5;
      border-left: 3px solid #000;
      font-size: 12px;
      color: #666;
      line-height: 1.6;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }

    [data-theme='dark'] .temp-info {
      background: #0a0a0a;
      border-left-color: #fff;
      color: #888;
    }

    .temp-info-title {
      font-weight: 600;
      color: #000;
      margin-bottom: 6px;
      font-size: 11px;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      font-family: 'Monaco', 'Menlo', 'Consolas', 'Courier New', monospace;
    }

    [data-theme='dark'] .temp-info-title {
      color: #fff;
    }

    /* ==================== èŠå¤©ä¸»é¢˜æ ·å¼å¼€å§‹ ==================== */

    /* ä¸»é¢˜å¡ç‰‡ - å¼‚å½¢è®¾è®¡ */
    .chat-theme-card {
      position: relative;
      clip-path: polygon(
        0 8px, 8px 0, calc(100% - 8px) 0, 100% 8px,
        100% calc(100% - 8px), calc(100% - 8px) 100%, 8px 100%, 0 calc(100% - 8px)
      );
      border: none !important;
      overflow: visible;
    }

    .chat-theme-card::before {
      background: linear-gradient(135deg, transparent 30%, var(--accent-color));
      opacity: 0.03;
    }

    .chat-theme-card::after {
      content: '';
      position: absolute;
      top: -1px;
      left: -1px;
      right: -1px;
      bottom: -1px;
      background: linear-gradient(135deg, var(--border-color), transparent, var(--accent-color));
      clip-path: polygon(
        0 8px, 8px 0, calc(100% - 8px) 0, 100% 8px,
        100% calc(100% - 8px), calc(100% - 8px) 100%, 8px 100%, 0 calc(100% - 8px)
      );
      z-index: -1;
      opacity: 0.3;
    }

    /* æ˜Ÿæ˜Ÿå›¾æ ‡åŠ¨ç”» */
    .theme-star-icon {
      animation: theme-star-pulse 2s ease-in-out infinite;
      color: var(--accent-color);
      opacity: 0.6;
    }

    @keyframes theme-star-pulse {
      0%, 100% {
        transform: scale(1) rotate(0deg);
        opacity: 0.6;
      }
      50% {
        transform: scale(1.2) rotate(180deg);
        opacity: 1;
      }
    }

    /* é¢„è§ˆå®¹å™¨ */
    .theme-preview-container {
      margin-bottom: 16px;
      padding-bottom: 16px;
      border-bottom: 1px dashed var(--border-color);
    }

    .theme-preview-label {
      font-size: 10px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 10px;
      text-align: center;
      font-family: 'Inter', sans-serif;
    }

    .theme-preview-bubbles {
      display: flex;
      flex-direction: column;
      gap: 8px;
      background: var(--bg-primary);
      border-radius: 10px;
      padding: 12px;
      border: 1px solid var(--border-color);
    }

    .theme-preview-message {
      display: flex;
    }

    .theme-preview-message.character {
      justify-content: flex-start;
    }

    .theme-preview-message.user {
      justify-content: flex-end;
    }

    .theme-preview-bubble {
      padding: 10px 14px;
      border-radius: 16px;
      font-size: 13px;
      line-height: 1.5;
      max-width: 75%;
      border: 1px solid #e0e0e0;
      transition: all 0.3s ease;
      font-family: 'Noto Sans JP', sans-serif;
    }

    .theme-preview-message.character .theme-preview-bubble {
      background: #fafafa;
      color: #000000;
      border-top-left-radius: 4px;
    }

    .theme-preview-message.user .theme-preview-bubble {
      background: #ffffff;
      color: #000000;
      border-top-right-radius: 4px;
    }

    [data-theme='dark'] .theme-preview-bubbles {
      background: rgba(255,255,255,0.02);
    }

    [data-theme='dark'] .theme-preview-message.character .theme-preview-bubble {
      background: #2a2a2a;
      color: #e0e0e0;
    }

    [data-theme='dark'] .theme-preview-message.user .theme-preview-bubble {
      background: #3a3a3a;
      color: #ffffff;
    }

    /* é¢„è§ˆæ¡†iMessageæ ·å¼ */
    .theme-preview-bubbles.imessage-style .theme-preview-bubble {
      border-radius: 18px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.1);
      border: none;
      position: relative;
      --preview-character-tail-color: #E5E5EA;
      --preview-user-tail-color: #0051D5;
    }

    .theme-preview-bubbles.imessage-style .theme-preview-message.character .theme-preview-bubble {
      border-top-left-radius: 2px;
    }

    .theme-preview-bubbles.imessage-style .theme-preview-message.character .theme-preview-bubble::before {
      content: '';
      position: absolute;
      left: -8px;
      top: 0;
      width: 20px;
      height: 20px;
      background: var(--preview-character-tail-color);
      border-radius: 0 0 16px 0;
      clip-path: polygon(0 0, 100% 0, 100% 100%);
    }

    .theme-preview-bubbles.imessage-style .theme-preview-message.user .theme-preview-bubble {
      border-top-right-radius: 2px;
    }

    .theme-preview-bubbles.imessage-style .theme-preview-message.user .theme-preview-bubble::before {
      content: '';
      position: absolute;
      right: -8px;
      top: 0;
      width: 20px;
      height: 20px;
      background: var(--preview-user-tail-color);
      border-radius: 0 0 0 16px;
      clip-path: polygon(0 0, 100% 0, 0 100%);
    }

    [data-theme='dark'] .theme-preview-bubbles.imessage-style .theme-preview-message.character .theme-preview-bubble {
      --preview-character-tail-color: #3a3a3c;
    }

    /* ğŸ’œ Discordæ ·å¼é¢„è§ˆæ°”æ³¡ */
    .theme-preview-bubbles.discord-style .theme-preview-bubble {
      border-radius: 20px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.2);
      border: none;
    }

    .theme-preview-bubbles.discord-style .theme-preview-message.character .theme-preview-bubble {
      border-radius: 20px;
    }

    .theme-preview-bubbles.discord-style .theme-preview-message.user .theme-preview-bubble {
      border-radius: 20px;
    }

    /* ğŸ€ Cute Chat v1æ ·å¼é¢„è§ˆæ°”æ³¡ */
    .theme-preview-bubbles.cute-v1-style .theme-preview-bubble {
      border-radius: 16px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      border: none;
      position: relative;
    }

    .theme-preview-bubbles.cute-v1-style .theme-preview-message.character .theme-preview-bubble {
      border-top-left-radius: 4px;
    }

    .theme-preview-bubbles.cute-v1-style .theme-preview-message.character .theme-preview-bubble::before {
      content: '';
      position: absolute;
      left: -6px;
      top: 0;
      width: 12px;
      height: 12px;
      background: var(--preview-character-bg);
      clip-path: polygon(100% 0, 0 0, 100% 100%);
    }

    .theme-preview-bubbles.cute-v1-style .theme-preview-message.user .theme-preview-bubble {
      border-top-right-radius: 4px;
    }

    .theme-preview-bubbles.cute-v1-style .theme-preview-message.user .theme-preview-bubble::before {
      content: '';
      position: absolute;
      right: -6px;
      top: 0;
      width: 12px;
      height: 12px;
      background: var(--preview-user-bg);
      clip-path: polygon(0 0, 100% 0, 0 100%);
    }

    /* ğŸ€ Cute Chat v2æ ·å¼é¢„è§ˆæ°”æ³¡ï¼ˆä¸Šæ–¹ä¸‰è§’ï¼‰ */
    .theme-preview-bubbles.cute-v2-style .theme-preview-bubble {
      border-radius: 12px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      border: none;
      position: relative;
    }

    .theme-preview-bubbles.cute-v2-style .theme-preview-message.character .theme-preview-bubble::before {
      content: '';
      position: absolute;
      top: -6px;
      left: 12px;
      width: 0;
      height: 0;
      border-left: 4px solid transparent;
      border-right: 4px solid transparent;
      border-bottom: 8px solid var(--preview-character-bg);
    }

    .theme-preview-bubbles.cute-v2-style .theme-preview-message.user .theme-preview-bubble::before {
      content: '';
      position: absolute;
      top: -6px;
      right: 12px;
      width: 0;
      height: 0;
      border-left: 4px solid transparent;
      border-right: 4px solid transparent;
      border-bottom: 8px solid var(--preview-user-bg);
    }

    /* æ§åˆ¶ç»„ */
    .theme-control-group {
      margin-bottom: 16px;
      padding-bottom: 16px;
      border-bottom: 1px dashed var(--border-color);
      position: relative;
    }

    .theme-control-group:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }

    /* æ ·å¼é€‰æ‹©å™¨ - æ¨ªå‘æ»‘åŠ¨ */
    .theme-style-selector {
      display: flex;
      gap: 12px;
      margin-top: 10px;
      overflow-x: auto;
      overflow-y: hidden;
      padding-bottom: 8px;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: thin;
      scrollbar-color: var(--border-color) transparent;
    }

    .theme-style-selector::-webkit-scrollbar {
      height: 4px;
    }

    .theme-style-selector::-webkit-scrollbar-track {
      background: transparent;
    }

    .theme-style-selector::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 4px;
    }

    .theme-style-option {
      min-width: 120px;
      flex-shrink: 0;
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      border-radius: 12px;
      padding: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .theme-style-option:hover {
      border-color: var(--accent-color);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .theme-style-option.active {
      border-color: var(--accent-color);
      background: rgba(0,122,255,0.05);
    }

    .theme-style-radio {
      width: 18px;
      height: 18px;
      border: 2px solid var(--border-color);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .theme-style-option.active .theme-style-radio {
      border-color: var(--accent-color);
    }

    .theme-style-radio-dot {
      width: 10px;
      height: 10px;
      background: var(--accent-color);
      border-radius: 50%;
      transform: scale(0);
      transition: transform 0.3s ease;
    }

    .theme-style-option.active .theme-style-radio-dot {
      transform: scale(1);
    }

    .theme-style-info {
      flex: 1;
    }

    .theme-style-name {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 2px;
      font-family: 'Noto Sans JP', sans-serif;
    }

    .theme-style-desc {
      font-size: 10px;
      color: var(--text-tertiary);
      font-family: 'Inter', sans-serif;
    }

    .theme-style-preview {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 30px;
    }

    .style-preview-bubble {
      width: 60px;
      height: 24px;
      position: relative;
    }

    .style-preview-bubble.default {
      background: var(--accent-color);
      border-radius: 12px;
      border-top-right-radius: 3px;
    }

    .style-preview-bubble.imessage {
      background: linear-gradient(135deg, #007AFF 0%, #0051D5 100%);
      border-radius: 12px;
      border-top-right-radius: 2px;
    }

    .style-preview-bubble.imessage::before {
      content: '';
      position: absolute;
      right: -5px;
      top: 0;
      width: 12px;
      height: 12px;
      background: #0051D5;
      border-radius: 0 0 0 10px;
      clip-path: polygon(0 0, 100% 0, 0 100%);
    }

    .style-preview-bubble.discord {
      background: linear-gradient(135deg, #A855F7 0%, #7C3AED 100%);
      border-radius: 14px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.15);
    }

    .style-preview-bubble.cute-v1 {
      background: #E9A8D0;
      border-radius: 12px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.15);
      position: relative;
    }

    .style-preview-bubble.cute-v1::before {
      content: '';
      position: absolute;
      right: -4px;
      top: 0;
      width: 8px;
      height: 8px;
      background: #E9A8D0;
      clip-path: polygon(0 0, 100% 0, 0 100%);
    }

    .style-preview-bubble.cute-v2 {
      background: #E9A8D0;
      border-radius: 10px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.15);
      position: relative;
    }

    .style-preview-bubble.cute-v2::before {
      content: '';
      position: absolute;
      top: -5px;
      right: 15px;
      width: 0;
      height: 0;
      border-left: 4px solid transparent;
      border-right: 4px solid transparent;
      border-bottom: 6px solid #E9A8D0;
    }

    .style-preview-bubble.tooltip {
      background: #ffffff;
      border-radius: 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      position: relative;
      border: none;
    }

    .style-preview-bubble.tooltip::after {
      content: '';
      position: absolute;
      bottom: -6px;
      left: 12px;
      width: 0;
      height: 0;
      border-left: 4px solid transparent;
      border-right: 4px solid transparent;
      border-top: 7px solid #ffffff;
    }

    [data-theme='dark'] .style-preview-bubble.tooltip {
      background: #2a2a2a;
    }

    [data-theme='dark'] .style-preview-bubble.tooltip::after {
      border-top-color: #2a2a2a;
    }

    [data-theme='dark'] .theme-style-option {
      background: rgba(255,255,255,0.03);
    }

    [data-theme='dark'] .theme-style-option.active {
      background: rgba(0,122,255,0.15);
    }

    /* æ ‡ç­¾æ ·å¼ */
    .theme-label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      font-family: 'Noto Sans JP', sans-serif;
    }

    .theme-label-text {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
      letter-spacing: 0.02em;
    }

    .theme-label-value {
      font-size: 14px;
      font-weight: 700;
      color: var(--accent-color);
      font-family: 'Courier New', monospace;
      background: var(--bg-primary);
      padding: 2px 10px;
      border-radius: 8px;
      min-width: 40px;
      text-align: center;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    }

    /* æ»‘å—å®¹å™¨ */
    .theme-slider-container {
      position: relative;
      padding: 8px 0 28px 0;
    }

    /* æ»‘å—æ ·å¼ */
    .theme-slider {
      width: 100%;
      height: 6px;
      -webkit-appearance: none;
      appearance: none;
      background: linear-gradient(to right, var(--border-color), var(--accent-color), var(--border-color));
      border-radius: 10px;
      outline: none;
      cursor: pointer;
      position: relative;
      z-index: 2;
      transition: all 0.3s ease;
    }

    .theme-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      background: var(--accent-color);
      border: 3px solid var(--bg-tertiary);
      border-radius: 50%;
      cursor: grab;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      transition: all 0.2s ease;
      position: relative;
    }

    .theme-slider::-webkit-slider-thumb:hover {
      transform: scale(1.2);
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    .theme-slider::-webkit-slider-thumb:active {
      cursor: grabbing;
      transform: scale(1.1);
    }

    .theme-slider::-moz-range-thumb {
      width: 20px;
      height: 20px;
      background: var(--accent-color);
      border: 3px solid var(--bg-tertiary);
      border-radius: 50%;
      cursor: grab;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      transition: all 0.2s ease;
    }

    .theme-slider::-moz-range-thumb:hover {
      transform: scale(1.2);
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    .theme-slider::-moz-range-thumb:active {
      cursor: grabbing;
      transform: scale(1.1);
    }

    /* æ»‘å—æ ‡ç­¾ */
    .theme-slider-labels {
      display: flex;
      justify-content: space-between;
      margin-top: 8px;
      padding: 0 2px;
    }

    .theme-slider-labels span {
      font-size: 10px;
      color: var(--text-tertiary);
      font-family: 'Noto Sans JP', sans-serif;
      letter-spacing: 0.05em;
      opacity: 0.7;
      transition: all 0.2s ease;
    }

    .theme-slider-labels span:hover {
      opacity: 1;
      color: var(--accent-color);
    }

    /* åˆ†ç»„æ ‡é¢˜ */
    .theme-group-header {
      display: flex;
      align-items: center;
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: 10px;
      font-family: 'Noto Sans JP', sans-serif;
      letter-spacing: 0.03em;
      position: relative;
      padding-left: 4px;
    }

    .theme-group-header::before {
      content: '';
      position: absolute;
      left: -8px;
      top: 50%;
      transform: translateY(-50%);
      width: 3px;
      height: 12px;
      background: var(--accent-color);
      border-radius: 2px;
    }

    .theme-group-header svg {
      opacity: 0.6;
    }

    /* é¢œè‰²é€‰æ‹©å™¨ç½‘æ ¼ */
    .theme-color-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }

    .theme-color-item {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .theme-color-label {
      font-size: 11px;
      font-weight: 500;
      color: var(--text-tertiary);
      text-align: center;
      font-family: 'Inter', sans-serif;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }

    /* é¢œè‰²è¾“å…¥å®¹å™¨ */
    .theme-color-input-wrapper {
      position: relative;
      width: 100%;
      aspect-ratio: 1;
      border-radius: 12px;
      overflow: hidden;
      border: 2px solid var(--border-color);
      transition: all 0.3s ease;
      cursor: pointer;
      background: var(--bg-primary);
    }

    .theme-color-input-wrapper:hover {
      border-color: var(--accent-color);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    /* é¢œè‰²è¾“å…¥ */
    .theme-color-input {
      position: absolute;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
      z-index: 2;
    }

    /* é¢œè‰²é¢„è§ˆ */
    .theme-color-preview {
      position: absolute;
      width: 100%;
      height: 100%;
      pointer-events: none;
      background: var(--input-value);
      transition: all 0.3s ease;
    }

    .theme-color-input-wrapper:hover .theme-color-preview {
      transform: scale(0.9);
      border-radius: 8px;
    }

    /* é‡ç½®æŒ‰é’® */
    .theme-reset-btn {
      width: 100%;
      padding: 12px;
      background: var(--bg-primary);
      border: 1px dashed var(--border-color);
      border-radius: 10px;
      font-size: 13px;
      font-weight: 500;
      color: var(--text-secondary);
      font-family: 'Noto Sans JP', sans-serif;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .theme-reset-btn:hover {
      background: var(--hover-bg);
      border-color: var(--accent-color);
      border-style: solid;
      color: var(--accent-color);
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .theme-reset-btn:active {
      transform: translateY(0);
      box-shadow: none;
    }

    /* æš—è‰²æ¨¡å¼é€‚é… */
    [data-theme='dark'] .theme-label-value {
      background: rgba(255,255,255,0.05);
      box-shadow: inset 0 1px 3px rgba(255,255,255,0.1);
    }

    [data-theme='dark'] .theme-slider {
      background: linear-gradient(to right, #333, var(--accent-color), #333);
    }

    [data-theme='dark'] .theme-color-input-wrapper {
      background: rgba(255,255,255,0.03);
    }

    [data-theme='dark'] .theme-reset-btn {
      background: rgba(255,255,255,0.03);
    }

    [data-theme='dark'] .theme-reset-btn:hover {
      background: rgba(255,255,255,0.08);
    }

    /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
    @media (max-width: 480px) {
      .theme-color-grid {
        gap: 10px;
      }

      .theme-slider::-webkit-slider-thumb,
      .theme-slider::-moz-range-thumb {
        width: 24px;
        height: 24px;
      }
    }

    /* ==================== èŠå¤©ä¸»é¢˜æ ·å¼ç»“æŸ ==================== */

    /* èŠå¤©æ¡†å¡ç‰‡æ ·å¼ */
    .chat-session-card {
      padding: 12px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .chat-session-card:hover {
      background: var(--hover-bg);
      border-color: var(--accent-color);
    }

    .chat-session-card.active {
      background: var(--accent-color);
      border-color: var(--accent-color);
    }

    .chat-session-card.active * {
      color: white !important;
    }

    .chat-session-icon {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--bg-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .chat-session-icon svg {
      width: 18px;
      height: 18px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    .chat-session-info {
      flex: 1;
      min-width: 0;
    }

    .chat-session-name {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-primary);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .chat-session-meta {
      font-size: 11px;
      color: var(--text-tertiary);
      margin-top: 2px;
    }

    .chat-session-actions {
      display: flex;
      gap: 4px;
      flex-shrink: 0;
    }

    .chat-session-action-btn {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .chat-session-action-btn:hover {
      background: var(--hover-bg);
      transform: scale(1.05);
    }

    .chat-session-action-btn svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-primary);
      fill: none;
      stroke-width: 2;
    }

    .chat-session-action-btn.delete:hover {
      background: #ef4444;
      border-color: #ef4444;
    }

    .chat-session-action-btn.delete:hover svg {
      stroke: white;
    }

    /* ==================== Message Selection Mode ==================== */
    .message-selection-mode .chat-message-group {
      padding-left: 40px;
      position: relative;
    }

    .message-checkbox-wrapper {
      position: absolute;
      left: 8px;
      top: 50%;
      transform: translateY(-50%);
      display: none;
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .message-selection-mode .message-checkbox-wrapper {
      display: block;
      opacity: 1;
    }

    .message-checkbox {
      width: 20px;
      height: 20px;
      border: 2px solid var(--border-color);
      border-radius: 6px;
      background: var(--bg-primary);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }

    .message-checkbox:hover {
      border-color: var(--accent-color);
      transform: scale(1.1);
    }

    .message-checkbox.checked {
      background: var(--accent-color);
      border-color: var(--accent-color);
    }

    .message-checkbox.checked svg {
      display: block;
    }

    .message-checkbox svg {
      width: 12px;
      height: 12px;
      stroke: white;
      stroke-width: 3;
      fill: none;
      display: none;
    }

    /* Message selection toolbar */
    .message-selection-toolbar {
      position: fixed;
      bottom: 12px; /* ä»åº•éƒ¨æŠ¬èµ·ä¸€ç‚¹ */
      left: 50%; /* æ°´å¹³å±…ä¸­ */
      transform: translateX(-50%) translateY(100%); /* å±…ä¸­ + éšè—åŠ¨ç”» */
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 16px; /* åœ†è§’èƒ¶å›Šè®¾è®¡ */
      padding: 10px 16px;
      display: none;
      align-items: center;
      gap: 12px; /* ä¿¡æ¯å’ŒæŒ‰é’®ä¹‹é—´çš„é—´è· */
      z-index: 9000000;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      max-width: 90%; /* é™åˆ¶æœ€å¤§å®½åº¦ */
      width: auto; /* è‡ªé€‚åº”å†…å®¹å®½åº¦ */
    }

    .message-selection-toolbar.active {
      display: flex;
      transform: translateX(-50%) translateY(0); /* æ˜¾ç¤ºæ—¶åªä¿ç•™å±…ä¸­ï¼Œä¸åç§»Y */
    }

    .selection-toolbar-info {
      font-size: 13px;
      color: var(--text-secondary);
      font-weight: 500;
      white-space: nowrap; /* é˜²æ­¢æ¢è¡Œ */
    }

    .selection-toolbar-actions {
      display: flex;
      gap: 6px; /* æŒ‰é’®ä¹‹é—´æ›´ç´§å‡‘ */
    }

    .selection-toolbar-btn {
      padding: 6px 14px; /* æ›´ç´§å‡‘çš„å†…è¾¹è· */
      border-radius: 12px; /* åœ†è§’èƒ¶å›Š */
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      border: 1px solid var(--border-color);
      background: var(--bg-primary);
      color: var(--text-primary);
      white-space: nowrap; /* é˜²æ­¢æ¢è¡Œ */
    }

    .selection-toolbar-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    .selection-toolbar-btn:active {
      transform: translateY(0);
    }

    .selection-toolbar-btn.danger {
      background: #ef4444;
      border-color: #ef4444;
      color: white;
    }

    .selection-toolbar-btn.danger:hover {
      background: #dc2626;
    }

    .selection-toolbar-btn.primary {
      background: var(--accent-color);
      border-color: var(--accent-color);
      color: white;
    }

    .message-selection-mode .chat-input-area {
      display: none;
    }

    /* é€‰æ‹©æ¨¡å¼ä¸‹ï¼Œç»™æ¶ˆæ¯åŒºåŸŸåº•éƒ¨ç•™å‡ºç©ºé—´ï¼Œé˜²æ­¢æœ€åº•ä¸‹çš„æ¶ˆæ¯è¢«å·¥å…·æ é®æŒ¡ */
    .message-selection-mode .chat-messages-area {
      padding-bottom: 80px; /* ä¸ºå·¥å…·æ ç•™å‡ºè¶³å¤Ÿçš„ç©ºé—´ */
    }

    /* ========== æ–‡å­—å›¾ç‰‡å¡ç‰‡æ ·å¼ï¼ˆç¼©å°ç‰ˆæœ¬ï¼‰ ========== */
    /* æ–‡å­—å›¾ç‰‡å®¹å™¨ - ä¸­ç­‰å¤§å° */
    .text-image-container {
      position: relative;
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      border-radius: 14px;
      overflow: hidden;
      box-shadow: var(--shadow-lg);
      height: 220px;
      width: 100%;
      max-width: 280px;
      margin: 8px 0;
    }

    [data-theme='dark'] .text-image-container {
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.7);
    }

    /* å†…å®¹åŒºåŸŸ - å¯æ»šåŠ¨ */
    .text-image-content {
      height: 100%;
      padding: 16px;
      overflow-y: auto;
      overflow-x: hidden;
      position: relative;
      z-index: 1;
    }

    /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
    .text-image-content::-webkit-scrollbar {
      width: 6px;
    }

    .text-image-content::-webkit-scrollbar-track {
      background: var(--bg-secondary);
      border-radius: 3px;
    }

    .text-image-content::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 3px;
    }

    .text-image-content::-webkit-scrollbar-thumb:hover {
      background: var(--text-tertiary);
    }

    /* æ¨¡ç³Šæ•ˆæœ - v3ç‰ˆæœ¬æ ¸å¿ƒç‰¹æ€§ */
    .text-image-container.blurred .text-image-content {
      filter: blur(30px);
      -webkit-filter: blur(30px);
    }

    .text-image-container.revealed .text-image-content {
      filter: none;
      -webkit-filter: none;
      transition: filter 0.6s ease;
    }

    /* æ–‡å­—æ ·å¼ - v3ç‰ˆæœ¬ */
    .text-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 12px;
      letter-spacing: -0.01em;
      line-height: 1.4;
      font-family: 'Noto Sans JP', sans-serif;
    }

    .text-body {
      font-size: 13px;
      line-height: 1.7;
      color: var(--text-secondary);
      font-family: 'Noto Serif JP', serif;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    .text-meta {
      font-size: 11px;
      color: var(--text-tertiary);
      margin-bottom: 10px;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border-color);
    }

    /* ========== æ•æ„Ÿå†…å®¹é®ç½© - ç¼©å°ç‰ˆæœ¬ ========== */
    .sensitive-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 10;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
      background: radial-gradient(
        ellipse at center,
        rgba(0, 0, 0, 0.4) 0%,
        rgba(0, 0, 0, 0.8) 100%
      );
      backdrop-filter: blur(40px);
      -webkit-backdrop-filter: blur(40px);
      transition: opacity 0.4s ease, visibility 0.4s ease;
    }

    [data-theme='dark'] .sensitive-overlay {
      background: radial-gradient(
        ellipse at center,
        rgba(0, 0, 0, 0.6) 0%,
        rgba(0, 0, 0, 0.95) 100%
      );
    }

    .sensitive-overlay.hidden {
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }

    /* é®ç½©å›¾æ ‡ */
    .overlay-icon {
      width: 44px;
      height: 44px;
      margin-bottom: 14px;
      opacity: 0.9;
    }

    .overlay-icon svg {
      width: 100%;
      height: 100%;
      stroke: #ffffff;
      fill: none;
      stroke-width: 1.5;
    }

    /* é®ç½©æ ‡é¢˜ */
    .overlay-title {
      font-size: 17px;
      font-weight: 600;
      color: #ffffff;
      margin-bottom: 8px;
      letter-spacing: -0.01em;
      text-align: center;
    }

    /* é®ç½©æè¿° */
    .overlay-description {
      font-size: 12px;
      color: rgba(255, 255, 255, 0.7);
      margin-bottom: 18px;
      text-align: center;
      line-height: 1.5;
      max-width: 200px;
    }

    /* æŸ¥çœ‹æŒ‰é’® */
    .reveal-button {
      padding: 8px 22px;
      background: rgba(255, 255, 255, 0.15);
      border: 1.5px solid rgba(255, 255, 255, 0.3);
      border-radius: 8px;
      color: #ffffff;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      letter-spacing: -0.01em;
    }

    .reveal-button:hover {
      background: rgba(255, 255, 255, 0.25);
      border-color: rgba(255, 255, 255, 0.5);
      transform: translateY(-2px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
    }

    .reveal-button:active {
      transform: translateY(0);
    }

    /* å…³é—­æŒ‰é’® */
    .text-image-close {
      position: absolute;
      top: 12px;
      right: 12px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      z-index: 100;
    }

    .text-image-close:hover {
      background: var(--bg-tertiary);
      transform: scale(1.05);
    }

    .text-image-close svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-primary);
      stroke-width: 2;
    }

    /* ==========================================
     * å¤–è§‚è®¾ç½®é¡µé¢æ ·å¼ - Appearance Screen Styles
     * ========================================== */

    /* Profile Card - ä¸»é¢˜ç»Ÿè®¡å¡ç‰‡ */
    .appearance-profile-card {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 24px;
      padding: 24px;
      margin-bottom: 20px;
      position: relative;
      overflow: hidden;
      animation: fadeIn 0.6s ease 0.1s both;
    }

    .appearance-profile-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 80px;
      background: linear-gradient(135deg, var(--accent-color) 0%, transparent 100%);
      opacity: 0.03;
    }

    .appearance-profile-header {
      display: flex;
      gap: 16px;
      margin-bottom: 16px;
    }

    .appearance-profile-avatar {
      width: 64px;
      height: 64px;
      border-radius: 16px;
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      font-weight: 600;
      flex-shrink: 0;
      position: relative;
      overflow: hidden;
    }

    .appearance-profile-avatar svg {
      width: 32px;
      height: 32px;
      stroke: var(--text-primary);
    }

    .appearance-profile-avatar::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      animation: shine 3s infinite;
    }

    @keyframes shine {
      0% {
        transform: translateX(-100%) translateY(-100%) rotate(45deg);
      }
      100% {
        transform: translateX(100%) translateY(100%) rotate(45deg);
      }
    }

    .appearance-profile-info {
      flex: 1;
    }

    .appearance-profile-name {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 4px;
      letter-spacing: -0.02em;
      color: var(--text-primary);
    }

    .appearance-profile-bio {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.4;
      font-family: 'JetBrains Mono', monospace;
    }

    .appearance-feature-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 8px;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      font-size: 10px;
      font-weight: 500;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .appearance-feature-badge::before {
      content: '';
      width: 4px;
      height: 4px;
      background: var(--accent-color);
      border-radius: 50%;
    }

    .appearance-profile-stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 16px;
    }

    .appearance-stat-item {
      text-align: center;
      padding: 12px;
      background: var(--bg-primary);
      border-radius: 12px;
      border: 1px solid var(--border-color);
      transition: all 0.2s ease;
      cursor: pointer;
    }

    .appearance-stat-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04);
    }

    .appearance-stat-value {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 2px;
      color: var(--text-primary);
    }

    .appearance-stat-label {
      font-size: 11px;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* Settings Grid - è®¾ç½®ç½‘æ ¼ */
    .appearance-settings-grid {
      display: grid;
      gap: 12px;
      animation: fadeIn 0.6s ease 0.2s both;
    }

    .appearance-setting-card {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      padding: 20px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .appearance-setting-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, transparent 0%, var(--accent-color) 100%);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .appearance-setting-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    .appearance-setting-card:hover::before {
      opacity: 0.02;
    }

    .appearance-setting-card:active {
      transform: translateY(-2px);
    }

    .appearance-setting-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
      position: relative;
      z-index: 1;
    }

    .appearance-setting-title {
      font-size: 15px;
      font-weight: 600;
      letter-spacing: -0.01em;
      color: var(--text-primary);
    }

    .appearance-setting-icon {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
    }

    .appearance-setting-icon svg {
      width: 16px;
      height: 16px;
      stroke: var(--text-primary);
    }

    .appearance-setting-desc {
      font-size: 12px;
      color: var(--text-secondary);
      line-height: 1.5;
      position: relative;
      z-index: 1;
    }

    .appearance-code-text {
      font-family: 'JetBrains Mono', monospace;
      font-size: 11px;
      color: var(--text-tertiary);
      background: var(--bg-primary);
      padding: 2px 6px;
      border-radius: 4px;
      border: 1px solid var(--border-color);
    }

    /* Section Divider - åˆ†éš”çº¿ */
    .appearance-section-divider {
      height: 1px;
      background: var(--border-color);
      margin: 24px 0;
      position: relative;
    }

    .appearance-section-divider::before {
      content: '';
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 4px;
      height: 4px;
      background: var(--accent-color);
      border-radius: 50%;
    }

    /* Action Buttons - æ“ä½œæŒ‰é’® */
    .appearance-action-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 20px;
      animation: fadeIn 0.6s ease 0.3s both;
    }

    .appearance-action-btn {
      padding: 16px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      text-align: center;
      position: relative;
      overflow: hidden;
      color: var(--text-primary);
    }

    .appearance-action-btn.primary {
      background: var(--accent-color);
      color: var(--bg-primary);
      border-color: var(--accent-color);
    }

    .appearance-action-btn::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      transform: translate(-50%, -50%);
      transition: width 0.5s ease, height 0.5s ease;
    }

    .appearance-action-btn:hover::after {
      width: 300px;
      height: 300px;
    }

    .appearance-action-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04);
    }

    .appearance-action-btn:active {
      transform: translateY(0);
    }

    /* Animations - åŠ¨ç”» */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Mobile Responsive - ç§»åŠ¨ç«¯å“åº”å¼ */
    @media (max-width: 430px) {
      .appearance-profile-card {
        padding: 20px;
      }

      .appearance-profile-avatar {
        width: 56px;
        height: 56px;
      }

      .appearance-profile-avatar svg {
        width: 28px;
        height: 28px;
      }

      .appearance-profile-name {
        font-size: 18px;
      }

      .appearance-setting-card {
        padding: 16px;
      }

      .appearance-action-btn {
        padding: 14px;
      }
    }

    /* ==========================================
     * å£çº¸ç®¡ç†Modalæ ·å¼ - Wallpaper Management V2
     * ç²¾è‡´INSé£æ ¼ + ç§»åŠ¨ç«¯ä¼˜å…ˆ + ä¸å¯¹ç§°ç½‘æ ¼
     * ========================================== */

    .wallpaper-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.75);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      padding: 20px 0;
      animation: fadeInModal 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      overflow-y: auto;
    }

    .wallpaper-modal.active {
      display: flex;
    }

    .wallpaper-container {
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      /* å¼‚å½¢åœ†è§’ - æ›´ç²¾è‡´ */
      border-radius: 24px 4px 24px 4px;
      width: min(420px, 100vw);
      max-height: 92vh;
      position: relative;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      animation: slideUpBounceModal 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
      margin: auto;
      overflow-y: auto;
      scrollbar-width: none;
    }

    .wallpaper-container::-webkit-scrollbar {
      display: none;
    }

    @media (min-width: 768px) {
      .wallpaper-modal {
        padding: 40px 20px;
        align-items: center;
      }

      .wallpaper-container {
        max-height: 85vh;
      }
    }

    @keyframes fadeInModal {
      from {
        opacity: 0;
        backdrop-filter: blur(0px);
      }
      to {
        opacity: 1;
        backdrop-filter: blur(20px);
      }
    }

    @keyframes slideUpBounceModal {
      0% {
        opacity: 0;
        transform: translateY(40px) scale(0.92);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    /* è£…é¥°æ€§æ˜Ÿæ˜Ÿå…ƒç´  - æ›´ç²¾è‡´ */
    .wallpaper-deco-pixels {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
      overflow: hidden;
    }

    .deco-pixel-dot {
      position: absolute;
      width: 2px;
      height: 2px;
      background: var(--text-tertiary);
      border-radius: 50%;
      opacity: 0.2;
      animation: floatPixel 4s ease-in-out infinite;
    }

    .deco-star-small {
      position: absolute;
      width: 3px;
      height: 3px;
      background: var(--text-tertiary);
      border-radius: 50%;
      opacity: 0.3;
      animation: twinkle 3s ease-in-out infinite;
      box-shadow: 0 0 4px var(--text-tertiary);
    }

    @keyframes floatPixel {
      0%, 100% {
        transform: translateY(0) scale(1);
        opacity: 0.2;
      }
      50% {
        transform: translateY(-10px) scale(1.2);
        opacity: 0.4;
      }
    }

    @keyframes twinkle {
      0%, 100% {
        opacity: 0.2;
        transform: scale(1);
      }
      50% {
        opacity: 0.6;
        transform: scale(1.5);
      }
    }

    /* Header - ç²¾ç®€è®¾è®¡ */
    .wallpaper-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px;
      border-bottom: 1px solid var(--border-color);
      position: sticky;
      top: 0;
      background: var(--bg-primary);
      backdrop-filter: blur(10px);
      z-index: 10;
    }

    .wallpaper-title-area {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .wallpaper-icon {
      width: 24px;
      height: 24px;
      stroke: var(--text-primary);
      flex-shrink: 0;
      opacity: 0.8;
    }

    .wallpaper-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
      letter-spacing: -0.01em;
      font-family: 'Inter', sans-serif;
    }

    .wallpaper-subtitle {
      font-size: 10px;
      font-family: 'JetBrains Mono', monospace;
      color: var(--text-tertiary);
      margin-top: 1px;
      letter-spacing: 0.02em;
    }

    .wallpaper-close {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      flex-shrink: 0;
    }

    .wallpaper-close:hover {
      background: var(--text-primary);
      border-color: var(--text-primary);
      transform: scale(1.05);
    }

    .wallpaper-close:hover svg {
      stroke: var(--bg-primary);
    }

    .wallpaper-close:active {
      transform: scale(0.95);
    }

    .wallpaper-close svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-primary);
      stroke-width: 2.5;
      fill: none;
      transition: stroke 0.25s ease;
    }

    /* å½“å‰å£çº¸é¢„è§ˆåŒº - ç´§å‡‘ç²¾è‡´è®¾è®¡ */
    .wallpaper-preview-section {
      padding: 16px;
      position: relative;
      z-index: 2;
    }

    .wallpaper-dual-preview-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .wallpaper-preview-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 16px 4px 16px 4px;
      padding: 10px;
      position: relative;
      overflow: hidden;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .wallpaper-preview-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      border-color: var(--text-tertiary);
    }

    .preview-label {
      font-size: 9px;
      font-weight: 600;
      color: var(--text-secondary);
      display: flex;
      align-items: center;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-family: 'Inter', sans-serif;
    }

    .preview-label svg {
      stroke: var(--text-secondary);
      margin-right: 4px;
    }

    .wallpaper-preview-frame {
      aspect-ratio: 9 / 19.5;
      background: linear-gradient(135deg, #141414 0%, #2a2a2a 100%);
      border: 1.5px solid var(--border-color);
      border-radius: 12px;
      position: relative;
      overflow: hidden;
      background-size: cover;
      background-position: center;
      transition: all 0.3s ease;
    }

    .wallpaper-preview-card:hover .wallpaper-preview-frame {
      border-color: var(--text-secondary);
    }

    .preview-screen {
      position: absolute;
      bottom: 12px;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      text-shadow: 0 2px 12px rgba(0, 0, 0, 0.9);
      opacity: 0.9;
    }

    .preview-time {
      font-size: 20px;
      font-weight: 500;
      color: #ffffff;
      font-family: 'Inter', sans-serif;
      letter-spacing: -0.02em;
    }

    .preview-date {
      font-size: 9px;
      color: #ffffff;
      opacity: 0.85;
      margin-top: 2px;
      font-family: 'Inter', sans-serif;
    }

    /* å¼€æœºåŠ¨ç”»é¢„è§ˆ - ç²¾è‡´ä¼˜åŒ– */
    .boot-animation-preview {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
    }

    /* é¢„è§ˆä¸“ç”¨æ ·å¼ - ç™½è‰²å›ºå®šé¢œè‰² */
    .boot-animation-preview .boot-dot {
      background: #ffffff;
      box-shadow: 0 0 8px rgba(255, 255, 255, 0.5);
    }

    .boot-animation-preview .boot-text {
      color: #ffffff;
      text-shadow: 0 2px 12px rgba(0, 0, 0, 0.9);
    }

    /* åˆ†ç±»ç­›é€‰åŒºåŸŸ */
    .wallpaper-category-section {
      padding: 0 16px 16px;
      position: relative;
      z-index: 2;
    }

    .category-filter-scroll {
      display: flex;
      gap: 8px;
      overflow-x: auto;
      scrollbar-width: none;
      -webkit-overflow-scrolling: touch;
      padding-bottom: 4px;
    }

    .category-filter-scroll::-webkit-scrollbar {
      display: none;
    }

    .category-filter-btn {
      padding: 8px 16px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      font-size: 11px;
      font-weight: 500;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      white-space: nowrap;
      flex-shrink: 0;
      font-family: 'Inter', sans-serif;
      letter-spacing: -0.01em;
    }

    .category-filter-btn:hover {
      background: var(--bg-tertiary);
      border-color: var(--text-tertiary);
      transform: scale(1.05);
    }

    .category-filter-btn.active {
      background: var(--text-primary);
      border-color: var(--text-primary);
      color: var(--bg-primary);
      font-weight: 600;
    }

    .category-filter-btn:active {
      transform: scale(0.95);
    }

    /* é¢„è®¾å£çº¸ç½‘æ ¼ - ä¸å¯¹ç§°å¸ƒå±€ */
    .wallpaper-gallery-section {
      padding: 0 16px 16px;
      position: relative;
      z-index: 2;
    }

    .wallpaper-section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
      font-size: 12px;
      font-weight: 600;
      color: var(--text-primary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-family: 'Inter', sans-serif;
    }

    .wallpaper-section-header svg {
      stroke: var(--text-secondary);
    }

    .wallpaper-gallery-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 8px;
      animation: fadeInUp 0.4s ease;
    }

    .wallpaper-item {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      aspect-ratio: 1 / 1;
    }

    .wallpaper-item:hover {
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      border-color: var(--text-secondary);
      z-index: 5;
    }

    .wallpaper-item:active {
      transform: translateY(0) scale(1);
    }

    .wallpaper-item-overlay {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 6px;
      background: linear-gradient(to top, rgba(0, 0, 0, 0.85) 0%, transparent 100%);
      opacity: 0;
      transition: opacity 0.25s ease;
    }

    .wallpaper-item:hover .wallpaper-item-overlay {
      opacity: 1;
    }

    .wallpaper-item-title {
      font-size: 8px;
      font-weight: 600;
      color: #ffffff;
      margin-bottom: 1px;
      font-family: 'Inter', sans-serif;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.9);
      line-height: 1.2;
    }

    .wallpaper-item-category {
      font-size: 6px;
      color: #ffffff;
      opacity: 0.75;
      font-family: 'JetBrains Mono', monospace;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.9);
    }

    /* å£çº¸ç”Ÿæˆå™¨åŒºåŸŸ */
    .wallpaper-generator-section {
      padding: 0 16px 16px;
      position: relative;
      z-index: 2;
      animation: fadeIn 0.3s ease;
    }

    /* é¢œè‰²é€‰æ‹©ç½‘æ ¼ - çº¯è‰² */
    .color-palette-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 8px;
      margin-bottom: 12px;
    }

    .color-option {
      aspect-ratio: 1 / 1;
      border-radius: 8px;
      border: 2px solid var(--border-color);
      cursor: pointer;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
    }

    .color-option:hover {
      transform: scale(1.1);
      border-color: var(--text-primary);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      z-index: 2;
    }

    .color-option:active {
      transform: scale(1.05);
    }

    /* è‡ªå®šä¹‰é¢œè‰²è¾“å…¥ */
    .generator-custom-input {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .generator-custom-input input[type="color"] {
      width: 50px;
      height: 40px;
      border: 2px solid var(--border-color);
      border-radius: 8px;
      cursor: pointer;
      background: transparent;
      transition: all 0.25s ease;
    }

    .generator-custom-input input[type="color"]:hover {
      border-color: var(--text-secondary);
      transform: scale(1.05);
    }

    /* ç”Ÿæˆå™¨é¢„è§ˆ */
    .generator-preview {
      width: 100%;
      aspect-ratio: 16 / 9;
      border-radius: 12px;
      border: 2px solid var(--border-color);
      margin-bottom: 12px;
      background-size: cover;
      background-position: center;
      transition: all 0.3s ease;
    }

    /* ç”Ÿæˆå™¨æ§åˆ¶ */
    .generator-controls {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 12px;
    }

    .control-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .control-group label {
      font-size: 11px;
      font-weight: 600;
      color: var(--text-secondary);
      display: flex;
      justify-content: space-between;
      align-items: center;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-family: 'Inter', sans-serif;
    }

    .control-group label span {
      font-family: 'JetBrains Mono', monospace;
      color: var(--text-primary);
      font-weight: 500;
      text-transform: none;
      letter-spacing: 0;
    }

    .control-group input[type="color"] {
      width: 100%;
      height: 40px;
      border: 2px solid var(--border-color);
      border-radius: 8px;
      cursor: pointer;
      background: transparent;
      transition: all 0.25s ease;
    }

    .control-group input[type="color"]:hover {
      border-color: var(--text-secondary);
    }

    .control-group input[type="range"] {
      width: 100%;
      height: 6px;
      -webkit-appearance: none;
      appearance: none;
      background: var(--bg-tertiary);
      border-radius: 3px;
      outline: none;
      transition: all 0.25s ease;
    }

    .control-group input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      background: var(--text-primary);
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.25s ease;
    }

    .control-group input[type="range"]::-webkit-slider-thumb:hover {
      transform: scale(1.2);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    .control-group input[type="range"]::-moz-range-thumb {
      width: 16px;
      height: 16px;
      background: var(--text-primary);
      border-radius: 50%;
      cursor: pointer;
      border: none;
      transition: all 0.25s ease;
    }

    .control-group input[type="range"]::-moz-range-thumb:hover {
      transform: scale(1.2);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    .control-group select {
      width: 100%;
      padding: 10px 12px;
      background: var(--bg-secondary);
      border: 1.5px solid var(--border-color);
      border-radius: 8px;
      font-size: 12px;
      font-family: inherit;
      color: var(--text-primary);
      cursor: pointer;
      transition: all 0.25s ease;
    }

    .control-group select:hover {
      border-color: var(--text-secondary);
      background: var(--bg-tertiary);
    }

    .control-group select:focus {
      outline: none;
      border-color: var(--text-primary);
    }

    /* åº”ç”¨æŒ‰é’® */
    .generator-apply-btn {
      width: 100%;
      padding: 12px;
      background: var(--text-primary);
      color: var(--bg-primary);
      border: none;
      border-radius: 10px;
      font-size: 12px;
      font-weight: 600;
      font-family: 'Inter', sans-serif;
      cursor: pointer;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .generator-apply-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }

    .generator-apply-btn:active {
      transform: translateY(0);
    }

    /* ä¸Šä¼ åŒºåŸŸ - ç²¾ç®€è®¾è®¡ */
    .wallpaper-upload-section {
      padding: 0 16px 20px;
      position: relative;
      z-index: 2;
    }

    .wallpaper-upload-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }

    .wallpaper-upload-card {
      background: var(--bg-secondary);
      border: 1.5px dashed var(--border-color);
      border-radius: 12px;
      padding: 20px 12px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .wallpaper-upload-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, transparent 0%, var(--text-primary) 100%);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .wallpaper-upload-card:hover {
      border-color: var(--text-primary);
      border-style: solid;
      transform: translateY(-3px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
    }

    .wallpaper-upload-card:hover::before {
      opacity: 0.05;
    }

    .wallpaper-upload-card:active {
      transform: translateY(-1px);
    }

    .upload-card-icon {
      width: 36px;
      height: 36px;
      margin: 0 auto 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      z-index: 1;
    }

    .upload-card-icon svg {
      width: 20px;
      height: 20px;
      stroke: var(--text-primary);
      stroke-width: 2;
    }

    .upload-card-title {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 3px;
      position: relative;
      z-index: 1;
      font-family: 'Inter', sans-serif;
    }

    .upload-card-desc {
      font-size: 9px;
      color: var(--text-tertiary);
      position: relative;
      z-index: 1;
      font-family: 'JetBrains Mono', monospace;
      letter-spacing: 0.02em;
    }

    /* å¼€æœºåŠ¨ç”»é€‰æ‹©å™¨ */
    .boot-animation-selector-section {
      padding: 0 16px 20px;
      position: relative;
      z-index: 2;
    }

    .boot-animation-scroll {
      display: flex;
      gap: 12px;
      overflow-x: auto;
      scrollbar-width: none;
      -webkit-overflow-scrolling: touch;
      padding: 4px 0;
    }

    .boot-animation-scroll::-webkit-scrollbar {
      display: none;
    }

    .boot-animation-option {
      flex-shrink: 0;
      width: 140px;
      aspect-ratio: 9/12;
      background: var(--bg-secondary);
      border: 2px solid var(--border-color);
      border-radius: 16px 4px 16px 4px;
      padding: 12px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .boot-animation-option:hover {
      border-color: var(--text-primary);
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }

    .boot-animation-option.active {
      border-color: var(--text-primary);
      border-width: 2.5px;
      background: var(--bg-tertiary);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    }

    .boot-animation-option.active::after {
      content: '';
      position: absolute;
      top: 8px;
      right: 8px;
      width: 16px;
      height: 16px;
      background: var(--text-primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .boot-animation-option.active::before {
      content: 'âœ“';
      position: absolute;
      top: 8px;
      right: 8px;
      width: 16px;
      height: 16px;
      color: var(--bg-primary);
      font-size: 10px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2;
    }

    .boot-animation-preview-mini {
      flex: 1;
      background: #fafafa;
      border-radius: 12px 2px 12px 2px;
      position: relative;
      overflow: hidden;
      margin-bottom: 8px;
    }

    @media (prefers-color-scheme: dark) {
      .boot-animation-preview-mini {
        background: #0f0f0f;
      }
    }

    .boot-animation-name {
      font-size: 11px;
      font-weight: 600;
      color: var(--text-primary);
      text-align: center;
      font-family: 'Inter', sans-serif;
    }

    /* è¿·ä½ é¢„è§ˆ - DefaultåŠ¨ç”» */
    .mini-default {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
    }

    .mini-default-dots {
      display: flex;
      gap: 4px;
    }

    .mini-default-dot {
      width: 4px;
      height: 4px;
      background: #666;
      border-radius: 50%;
      animation: miniDefaultPulse 1.4s ease-in-out infinite;
    }

    @media (prefers-color-scheme: dark) {
      .mini-default-dot {
        background: #999;
      }
    }

    .mini-default-dot:nth-child(1) {
      animation-delay: 0s;
    }

    .mini-default-dot:nth-child(2) {
      animation-delay: 0.2s;
    }

    .mini-default-dot:nth-child(3) {
      animation-delay: 0.4s;
    }

    @keyframes miniDefaultPulse {
      0%, 80%, 100% {
        transform: scale(0.5);
        opacity: 0.3;
      }
      40% {
        transform: scale(1.2);
        opacity: 1;
      }
    }

    /* è¿·ä½ é¢„è§ˆ - BlogåŠ¨ç”» */
    .mini-blog {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%);
      position: relative;
    }

    @media (prefers-color-scheme: dark) {
      .mini-blog {
        background: linear-gradient(135deg, #141414 0%, #0a0a0a 100%);
      }
    }

    .mini-blog-card {
      width: 80%;
      background: white;
      border-radius: 12px 2px 12px 2px;
      padding: 12px 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      animation: miniBlogIn 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @media (prefers-color-scheme: dark) {
      .mini-blog-card {
        background: #141414;
      }
    }

    @keyframes miniBlogIn {
      from {
        opacity: 0;
        transform: scale(0.9);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .mini-blog-line {
      height: 2px;
      background: #e5e5e5;
      margin-bottom: 4px;
      border-radius: 1px;
      animation: miniLineGrow 0.4s ease-out both;
    }

    @media (prefers-color-scheme: dark) {
      .mini-blog-line {
        background: #3a3a3a;
      }
    }

    .mini-blog-line:nth-child(1) {
      width: 60%;
      animation-delay: 0.3s;
    }

    .mini-blog-line:nth-child(2) {
      width: 80%;
      animation-delay: 0.5s;
    }

    .mini-blog-line:nth-child(3) {
      width: 50%;
      animation-delay: 0.7s;
    }

    @keyframes miniLineGrow {
      from {
        transform: scaleX(0);
        transform-origin: left;
      }
      to {
        transform: scaleX(1);
      }
    }

    /* è¿·ä½ é¢„è§ˆ - RingåŠ¨ç”» */
    .mini-ring {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #fafafa;
    }

    @media (prefers-color-scheme: dark) {
      .mini-ring {
        background: #0f0f0f;
      }
    }

    .mini-ring-circle {
      position: relative;
      width: 50px;
      height: 50px;
    }

    .mini-ring-bg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 2px solid #e5e5e5;
      border-radius: 50%;
    }

    @media (prefers-color-scheme: dark) {
      .mini-ring-bg {
        border-color: #2a2a2a;
      }
    }

    .mini-ring-progress {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 2px solid #000000;
      border-radius: 50%;
      border-right-color: transparent;
      border-bottom-color: transparent;
      animation: miniRingRotate 1.5s linear infinite;
    }

    @media (prefers-color-scheme: dark) {
      .mini-ring-progress {
        border-color: #e5e5e5;
        border-right-color: transparent;
        border-bottom-color: transparent;
      }
    }

    @keyframes miniRingRotate {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }

    /* è¿·ä½ é¢„è§ˆ - PulseåŠ¨ç”» */
    .mini-pulse {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #ffffff 0%, #f0f0f0 100%);
      position: relative;
    }

    @media (prefers-color-scheme: dark) {
      .mini-pulse {
        background: linear-gradient(135deg, #141414 0%, #0f0f0f 100%);
      }
    }

    .mini-pulse-squares {
      position: relative;
      width: 50px;
      height: 50px;
    }

    .mini-pulse-square {
      position: absolute;
      top: 50%;
      left: 50%;
      border: 2px solid #000000;
      border-radius: 8px 2px 8px 2px;
      animation: miniSquarePulse 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;
    }

    @media (prefers-color-scheme: dark) {
      .mini-pulse-square {
        border-color: #e5e5e5;
      }
    }

    @keyframes miniSquarePulse {
      0%, 100% {
        transform: translate(-50%, -50%) scale(1) rotate(0deg);
        opacity: 1;
      }
      50% {
        transform: translate(-50%, -50%) scale(1.3) rotate(90deg);
        opacity: 0.6;
      }
    }

    .mini-pulse-square:nth-child(1) {
      width: 30px;
      height: 30px;
      animation-delay: 0s;
    }

    .mini-pulse-square:nth-child(2) {
      width: 22px;
      height: 22px;
      animation-delay: 0.3s;
      border-radius: 6px 2px 6px 2px;
    }

    .mini-pulse-square:nth-child(3) {
      width: 14px;
      height: 14px;
      animation-delay: 0.6s;
      border-radius: 4px 1px 4px 1px;
    }

    /* URLè¾“å…¥åŒºåŸŸ */
    .wallpaper-url-input-section {
      padding: 0 24px 20px;
      position: relative;
      z-index: 2;
    }

    .wallpaper-url-input-card {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 16px;
    }

    .wallpaper-url-input {
      width: 100%;
      padding: 12px 16px;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      font-size: 13px;
      font-family: 'JetBrains Mono', monospace;
      color: var(--text-primary);
      outline: none;
      transition: all 0.2s ease;
      margin-bottom: 12px;
    }

    .wallpaper-url-input:focus {
      border-color: var(--accent-color);
      box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.05);
    }

    .wallpaper-url-actions {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }

    .wallpaper-url-btn {
      padding: 10px 16px;
      border-radius: 10px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
      outline: none;
    }

    .wallpaper-url-btn.cancel {
      background: var(--bg-primary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }

    .wallpaper-url-btn.cancel:hover {
      background: var(--hover-bg);
    }

    .wallpaper-url-btn.primary {
      background: var(--accent-color);
      color: var(--bg-primary);
      border: 1px solid var(--accent-color);
    }

    .wallpaper-url-btn.primary:hover {
      opacity: 0.9;
      transform: translateY(-1px);
    }

    /* åº”ç”¨æŒ‰é’® */
    .wallpaper-apply-section {
      padding: 0 24px 24px;
      position: relative;
      z-index: 2;
    }

    .wallpaper-apply-btn {
      width: 100%;
      padding: 16px 24px;
      background: var(--accent-color);
      color: var(--bg-primary);
      border: none;
      border-radius: 20px 6px 20px 6px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .wallpaper-apply-btn svg {
      width: 18px;
      height: 18px;
      stroke: var(--bg-primary);
    }

    .wallpaper-apply-btn::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      transform: translate(-50%, -50%);
      transition: width 0.6s ease, height 0.6s ease;
    }

    .wallpaper-apply-btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .wallpaper-apply-btn:hover::after {
      width: 400px;
      height: 400px;
    }

    .wallpaper-apply-btn:active {
      transform: translateY(0);
    }

    /* ç§»åŠ¨ç«¯å“åº”å¼ */
    @media (max-width: 430px) {
      .wallpaper-container {
        border-radius: 24px 8px 24px 8px;
      }

      .wallpaper-header {
        padding: 20px;
      }

      .wallpaper-preview-section,
      .wallpaper-category-switch,
      .wallpaper-upload-section,
      .wallpaper-url-input-section,
      .wallpaper-apply-section {
        padding-left: 20px;
        padding-right: 20px;
      }

      /* ã€è€ç‹åˆ é™¤ã€‘wallpaper-grid responsiveæ ·å¼å·²åˆ é™¤ */

      .category-switch-btn {
        font-size: 12px;
        padding: 10px 12px;
      }

      .preview-time {
        font-size: 24px;
      }
    }

    /* ==========================================
     * CHAT APP STYLE SWITCHER - èŠå¤©æ ·å¼åˆ‡æ¢å™¨
     * ========================================== */

    /* æ ·å¼åˆ‡æ¢å¼¹çª— */
    /* Chat Style Popup - ä»å¤´åƒå†’å‡ºçš„å°å¯¹è¯æ¡† */
    .chat-style-modal {
      position: fixed;
      bottom: 90px;
      left: 50%;
      transform: translateX(-50%) translateY(20px);
      z-index: 10000;
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .chat-style-modal.active {
      opacity: 1;
      visibility: visible;
      pointer-events: auto;
      transform: translateX(-50%) translateY(0);
    }

    .chat-style-container {
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      border-radius: 16px 4px 16px 4px;
      padding: 12px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
      position: relative;
      max-height: 70vh;
      max-width: 85vw;
      overflow: visible;
    }

    /* å†…éƒ¨æ»šåŠ¨å®¹å™¨ */
    .chat-style-inner-scroll {
      max-height: 65vh;
      overflow-y: auto;
      overflow-x: hidden;
      scrollbar-width: none;
      margin: -12px;
      padding: 12px;
    }

    .chat-style-inner-scroll::-webkit-scrollbar {
      display: none;
    }

    /* å°ä¸‰è§’æŒ‡ç¤ºå™¨ */
    .chat-style-container::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 10px solid transparent;
      border-right: 10px solid transparent;
      border-top: 10px solid var(--border-color);
    }

    .chat-style-container::before {
      content: '';
      position: absolute;
      bottom: -7px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 9px solid transparent;
      border-right: 9px solid transparent;
      border-top: 9px solid var(--bg-primary);
      z-index: 1;
    }

    /* æ¨ªå‘æ’åˆ—æ ·å¼é€‰æ‹© */
    .style-cards-scroll {
      display: flex;
      gap: 10px;
      align-items: center;
      overflow-x: auto;
      overflow-y: hidden;
      scrollbar-width: none;
      padding-bottom: 8px;
    }

    .style-cards-scroll::-webkit-scrollbar {
      display: none;
    }

    /* æ ·å¼é€‰é¡¹å¡ç‰‡ - å°å·§ç²¾è‡´ */
    .style-preview-card {
      flex: 0 0 auto;
      width: 110px;
      background: var(--bg-secondary);
      border: 2px solid var(--border-color);
      border-radius: 10px 3px 10px 3px;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
    }

    .style-preview-card:hover {
      border-color: var(--text-tertiary);
      transform: scale(1.05);
    }

    .style-preview-card.active {
      border-color: var(--accent-color);
      border-width: 3px;
    }

    /* å®æ—¶æ ·å¼é¢„è§ˆæ¡† - ç¼©å°å°ºå¯¸ */
    .style-preview-frame {
      width: 100%;
      height: 130px;
      background: var(--bg-primary);
      position: relative;
      overflow: hidden;
      border-radius: 8px 2px 0 0;
    }

    .style-preview-content {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      pointer-events: none;
    }

    .style-preview-content > div {
      width: 100%;
    }

    .style-card-info {
      padding: 8px;
      border-top: 1px solid var(--border-color);
      position: relative;
      text-align: center;
    }

    .style-card-name {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 2px;
    }

    .style-card-desc {
      font-size: 10px;
      color: var(--text-secondary);
      line-height: 1.3;
    }

    .style-card-checkmark {
      position: absolute;
      top: 4px;
      right: 4px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: var(--accent-color);
      display: none;
      align-items: center;
      justify-content: center;
    }

    .style-preview-card.active .style-card-checkmark {
      display: flex;
    }

    .style-card-checkmark svg {
      width: 11px;
      height: 11px;
      stroke: var(--bg-primary);
      stroke-width: 3;
    }

    /* æ ·å¼è®¾ç½®åŒºåŸŸ - èƒŒæ™¯è®¾ç½®ç­‰ */
    .style-settings-section {
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid var(--border-color);
    }

    .style-settings-title {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .style-settings-title svg {
      width: 14px;
      height: 14px;
      stroke: var(--text-secondary);
    }

    /* èƒŒæ™¯ç±»å‹é€‰æ‹©æŒ‰é’®ç»„ - æ¨ªå‘æ’åˆ—å¯æ»šåŠ¨ */
    .bg-type-buttons {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
      overflow-x: auto;
      overflow-y: hidden;
      scrollbar-width: none;
      padding-bottom: 4px;
    }

    .bg-type-buttons::-webkit-scrollbar {
      display: none;
    }

    .bg-type-btn {
      flex: 0 0 auto;
      min-width: 80px;
      padding: 10px 16px;
      background: var(--bg-secondary);
      border: 2px solid var(--border-color);
      border-radius: 10px 3px 10px 3px;
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
      white-space: nowrap;
    }

    .bg-type-btn:hover {
      background: var(--bg-tertiary);
      border-color: var(--text-tertiary);
    }

    .bg-type-btn.active {
      background: var(--accent-color);
      color: var(--bg-primary);
      border-color: var(--accent-color);
    }

    /* èƒŒæ™¯è®¾ç½®å®¹å™¨ */
    .bg-setting-container {
      display: none;
      animation: fadeInUp 0.3s ease;
    }

    .bg-setting-container.active {
      display: block;
    }

    /* ä¸Šä¼ å›¾ç‰‡åŒºåŸŸ */
    .bg-upload-area {
      padding: 12px;
      background: var(--bg-secondary);
      border: 2px dashed var(--border-color);
      border-radius: 10px 3px 10px 3px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .bg-upload-area:hover {
      border-color: var(--text-tertiary);
      background: var(--bg-tertiary);
    }

    .bg-upload-area svg {
      width: 24px;
      height: 24px;
      stroke: var(--text-tertiary);
      margin-bottom: 6px;
    }

    .bg-upload-text {
      font-size: 11px;
      color: var(--text-secondary);
    }

    /* é¢œè‰²é€‰æ‹©å™¨ */
    .bg-color-picker {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .bg-color-input {
      flex: 1;
      height: 40px;
      border: 2px solid var(--border-color);
      border-radius: 8px 2px 8px 2px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .bg-color-input:hover {
      border-color: var(--text-tertiary);
    }

    .bg-color-label {
      font-size: 11px;
      color: var(--text-secondary);
      min-width: 60px;
    }

    /* æ¸å˜é¢œè‰²é€‰æ‹© */
    .bg-gradient-colors {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .bg-gradient-preview {
      height: 50px;
      border: 2px solid var(--border-color);
      border-radius: 10px 3px 10px 3px;
      margin-bottom: 8px;
    }

    /* ==========================================
     * MINIMAL GRAY CHAT STYLE - æç®€ç°è‰²é£æ ¼
     * ä¸€æ¯”ä¸€å¤åˆ»whatsapp-pink-theme-preview.html
     * ========================================== */

    /* æ•´ä½“å¸ƒå±€ - å¡«å……æ»¡å±å¹• */
    .chat-style-minimal-gray .app-content {
      padding: 0 !important;
      height: 100%;
      overflow-y: auto;
      scrollbar-width: none;
    }

    .chat-style-minimal-gray .app-content::-webkit-scrollbar {
      display: none;
    }

    /* é¡¶éƒ¨æ¨ªå¹… - å±…ä¸­å¸ƒå±€ */
    .chat-style-minimal-gray .chat-app-header {
      background: linear-gradient(180deg, var(--bg-secondary) 0%, transparent 100%);
      /* ğŸ”¥ ä½¿ç”¨å…¨å±€App Header paddingå˜é‡ */
      padding: var(--app-header-total-padding) 20px 30px;
      border: none !important;
    }

    .chat-style-minimal-gray .chat-header-top {
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 0;
    }

    .chat-style-minimal-gray .chat-user-info {
      flex-direction: column;
      align-items: center;
      gap: 0;
    }

    .chat-style-minimal-gray .chat-user-avatar-mini {
      width: 80px;
      height: 80px;
      border: 3px solid var(--border-color);
      box-shadow: 0 4px 12px var(--shadow);
      margin-bottom: 12px;
      background: var(--bg-tertiary);
      transition: all 0.3s ease;
    }

    .chat-style-minimal-gray .chat-user-text-mini {
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .chat-style-minimal-gray .chat-user-name-mini {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .chat-style-minimal-gray .chat-user-status-mini {
      font-size: 13px;
      font-style: italic;
      font-weight: 300;
      color: var(--text-secondary);
    }

    .chat-style-minimal-gray .chat-header-actions-mini {
      position: absolute;
      top: 50px;
      right: 20px;
    }

    /* æœç´¢æ å®Œå…¨éšè— */
    .chat-style-minimal-gray .chat-search-bar-mini {
      display: none !important;
    }

    /* Chatsæ ‡é¢˜åŒº */
    .chat-style-minimal-gray .chat-list-header-mini {
      /* ğŸ”¥ ä½¿ç”¨å…¨å±€App Header paddingå˜é‡ */
      padding: var(--app-header-total-padding) 20px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border: none !important;
    }

    .chat-style-minimal-gray .chat-list-title-mini {
      font-family: 'Caveat', cursive !important;
      font-size: 42px !important;
      font-weight: 700 !important;
      letter-spacing: 1px;
      color: var(--text-primary);
    }

    .chat-style-minimal-gray .chat-list-count-mini {
      display: none !important;
    }

    /* Storiesæ ·å¼ */
    .chat-style-minimal-gray .chat-stories-section {
      padding: 0 20px 20px;
      border: none !important;
    }

    .chat-style-minimal-gray .chat-stories-inner-scroll {
      gap: 16px;
    }

    .chat-style-minimal-gray .story-item-mini {
      gap: 6px;
    }

    .chat-style-minimal-gray .story-avatar-mini {
      width: 60px;
      height: 60px;
      border: 2px solid var(--border-color);
      background: var(--bg-tertiary);
      padding: 3px;
      transition: all 0.3s ease;
    }

    .chat-style-minimal-gray .story-avatar-mini:hover {
      transform: scale(1.05);
      border-color: var(--accent-color);
    }

    .chat-style-minimal-gray .story-name-mini {
      font-size: 11px;
      color: var(--text-secondary);
      font-weight: 500;
    }

    /* å®Œå…¨éšè—Chat RequestsåŒºå— */
    .chat-style-minimal-gray .chat-requests-mini {
      display: none !important;
    }

    /* èŠå¤©åˆ—è¡¨å®¹å™¨ */
    .chat-style-minimal-gray .chat-list-container {
      padding: 0;
      border: none !important;
      background: transparent !important;
    }

    .chat-style-minimal-gray .chat-list-items {
      padding: 0 20px 100px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    /* èŠå¤©åˆ—è¡¨é¡¹ - ç§»é™¤æ‰€æœ‰åˆ†å‰²çº¿ */
    .chat-style-minimal-gray .chat-item-mini {
      background: var(--bg-secondary);
      backdrop-filter: blur(10px);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 12px 16px;
      transition: all 0.3s ease;
      position: relative;
      margin: 0;
    }

    .chat-style-minimal-gray .chat-item-mini::after {
      display: none !important;
    }

    .chat-style-minimal-gray .chat-item-mini:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px var(--shadow);
      border-color: var(--text-tertiary);
      background: var(--hover-bg);
    }

    .chat-style-minimal-gray .chat-item-avatar-mini {
      width: 50px;
      height: 50px;
      background: var(--bg-tertiary);
      border: 2px solid var(--border-color);
      flex-shrink: 0;
    }

    .chat-style-minimal-gray .chat-item-name-mini {
      font-size: 15px;
      font-weight: 600;
    }

    .chat-style-minimal-gray .chat-item-time-mini {
      font-size: 11px;
      color: var(--text-tertiary);
      font-style: italic;
    }

    .chat-style-minimal-gray .chat-item-preview-mini {
      font-size: 13px;
      color: var(--text-secondary);
    }

    /* åº•éƒ¨å¯¼èˆªæ  - ä¿æŒé»˜è®¤æ ·å¼ï¼Œä¸åšä»»ä½•ä¿®æ”¹ */

    /* ç©ºçŠ¶æ€æ ·å¼ */
    .chat-style-minimal-gray .chat-empty-state {
      padding: 60px 20px;
      text-align: center;
      color: var(--text-secondary);
    }

    .chat-style-minimal-gray .empty-text {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
      margin-top: 16px;
    }

    .chat-style-minimal-gray .empty-subtext {
      font-size: 13px;
      color: var(--text-tertiary);
      margin-top: 8px;
    }

    /* ==================== æ”»ç•¥æ¨¡å¼æ ·å¼ ==================== */

    /* æ˜Ÿæ˜Ÿå›¾æ ‡è„‰å†²åŠ¨ç”» - å‚è€ƒèŠå¤©ä¸»é¢˜æ¨¡å— */
    .affection-star-icon {
      animation: affection-star-pulse 2s ease-in-out infinite;
      color: var(--accent-color, var(--text-primary));
      opacity: 0.6;
    }

    @keyframes affection-star-pulse {
      0%, 100% {
        transform: scale(1) rotate(0deg);
        opacity: 0.6;
      }
      50% {
        transform: scale(1.2) rotate(180deg);
        opacity: 1;
      }
    }

    /* Toggleå¼€å…³æ ·å¼ - iOSé£æ ¼æ ‡å‡†å°ºå¯¸ */
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 48px;
      height: 28px;
      flex-shrink: 0;
    }

    .toggle-switch input[type="checkbox"] {
      opacity: 0;
      width: 0;
      height: 0;
      position: absolute;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--bg-tertiary);
      border: 2px solid var(--border-color);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border-radius: 28px;
    }

    .toggle-slider::before {
      content: '';
      position: absolute;
      height: 20px;
      width: 20px;
      left: 2px;
      bottom: 2px;
      background: var(--text-primary);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border-radius: 50%;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .toggle-switch input:checked + .toggle-slider {
      background: var(--text-primary);
      border-color: var(--text-primary);
    }

    .toggle-switch input:checked + .toggle-slider::before {
      transform: translateX(20px);
      background: var(--bg-primary);
    }

    .toggle-switch:hover .toggle-slider {
      border-color: var(--text-primary);
    }

    .toggle-switch input:focus + .toggle-slider {
      box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
    }

    .toggle-switch input:disabled + .toggle-slider {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Toggleå¼€å…³å°å°ºå¯¸å˜ä½“ - ç”¨äºè¡Œå†…æ˜¾ç¤º */
    .toggle-switch-small {
      width: 36px;
      height: 20px;
    }

    .toggle-switch-small .toggle-slider::before {
      height: 14px;
      width: 14px;
      left: 1px;
      bottom: 1px;
    }

    .toggle-switch-small input:checked + .toggle-slider::before {
      transform: translateX(16px);
    }

    /* ==================== æ”»ç•¥æ¨¡å¼ V2 - INSé£æ ¼é‡è®¾è®¡ ==================== */

    /* ä¸»å®¹å™¨ - å¼‚å½¢å¤–æ¡†è®¾è®¡ */
    .affection-container-v2 {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 24px;
      padding: 0;
      margin-bottom: 16px;
      overflow: hidden;
      position: relative;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    [data-theme='dark'] .affection-container-v2 {
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    /* é¡¶éƒ¨æ§åˆ¶é¢æ¿ */
    .affection-top-panel {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 24px;
      background: var(--bg-primary);
      border-bottom: 1px solid var(--border-color);
      position: relative;
    }

    /* çŠ¶æ€æŒ‡ç¤ºæ¡ */
    .affection-status-bar {
      display: flex;
      align-items: center;
      gap: 10px;
      flex: 1;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      background: var(--text-tertiary);
      border-radius: 50%;
      animation: statusPulse 2s ease-in-out infinite;
    }

    @keyframes statusPulse {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 1; }
    }

    .status-text {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
      font-family: 'JetBrains Mono', monospace;
      letter-spacing: 0.5px;
      text-transform: uppercase;
    }

    /* ç°ä»£å¼€å…³ */
    .affection-toggle-modern {
      position: relative;
      width: 44px;
      height: 24px;
      cursor: pointer;
      flex-shrink: 0;
    }

    .affection-toggle-modern input {
      position: absolute;
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-track {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--bg-tertiary);
      border: 1.5px solid var(--border-color);
      border-radius: 12px;
      transition: all 0.3s ease;
    }

    .toggle-thumb {
      position: absolute;
      top: 3px;
      left: 3px;
      width: 16px;
      height: 16px;
      background: var(--text-primary);
      border-radius: 50%;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .affection-toggle-modern input:checked + .toggle-track {
      background: var(--text-primary);
      border-color: var(--text-primary);
    }

    .affection-toggle-modern input:checked + .toggle-track + .toggle-thumb {
      transform: translateX(20px);
      background: var(--bg-primary);
    }

    /* å†…å®¹åŒºåŸŸ */
    .affection-content-v2 {
      overflow: hidden;
      max-height: 0;
      opacity: 0;
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .affection-content-v2.show {
      max-height: 3000px;
      opacity: 1;
    }

    /* ç½‘æ ¼å®¹å™¨ */
    .affection-grid-container {
      padding: 24px;
    }

    .affection-grid-label {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--border-color);
    }

    .affection-grid-label span:first-child {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
      font-family: 'Inter', sans-serif;
      letter-spacing: 0.3px;
    }

    .grid-count {
      font-size: 11px;
      color: var(--text-tertiary);
      font-family: 'JetBrains Mono', monospace;
    }

    /* æ ·å¼ç½‘æ ¼ - æ¨ªå‘æ»šåŠ¨å¸ƒå±€ */
    .affection-styles-grid {
      display: flex;
      gap: 12px;
      overflow-x: auto;
      overflow-y: hidden;
      padding-bottom: 8px;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: thin;
      scrollbar-color: var(--border-color) transparent;
    }

    .affection-styles-grid::-webkit-scrollbar {
      height: 4px;
    }

    .affection-styles-grid::-webkit-scrollbar-track {
      background: transparent;
    }

    .affection-styles-grid::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 4px;
    }

    /* å¡ç‰‡V2 - INSé£æ ¼ */
    .style-card-v2 {
      width: 160px;
      flex-shrink: 0;
      background: var(--bg-primary);
      border: 1.5px solid var(--border-color);
      border-radius: 16px;
      padding: 12px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .style-card-v2:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      border-color: var(--text-primary);
    }

    [data-theme='dark'] .style-card-v2:hover {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    .style-card-v2.active {
      border-color: var(--text-primary);
      background: var(--bg-secondary);
    }

    .style-card-v2.active::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--text-primary);
    }

    /* å¡ç‰‡å¤´éƒ¨ */
    .card-header-v2 {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
      height: 20px;
    }

    .card-icon-v2 {
      width: 20px;
      height: 20px;
      color: var(--text-secondary);
      flex-shrink: 0;
    }

    .card-icon-v2 svg {
      width: 100%;
      height: 100%;
    }

    /* å‹¾é€‰æ ‡è®° */
    .card-check-v2 {
      width: 16px;
      height: 16px;
      border: 1.5px solid var(--border-color);
      border-radius: 50%;
      position: relative;
      transition: all 0.3s ease;
      flex-shrink: 0;
    }

    .style-card-v2.active .card-check-v2 {
      background: var(--text-primary);
      border-color: var(--text-primary);
    }

    .style-card-v2.active .card-check-v2::after {
      content: '';
      position: absolute;
      top: 3px;
      left: 6px;
      width: 3px;
      height: 7px;
      border: solid var(--bg-primary);
      border-width: 0 1.5px 1.5px 0;
      transform: rotate(45deg);
    }

    /* å¡ç‰‡é¢„è§ˆåŒº */
    .card-preview-v2 {
      min-height: 140px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px 12px;
      background: var(--bg-secondary);
      border-radius: 12px;
      margin-bottom: 10px;
      flex: 1;
    }

    /* å¡ç‰‡åº•éƒ¨ä¿¡æ¯ */
    .card-footer-v2 {
      display: flex;
      flex-direction: column;
      gap: 2px;
      height: 36px;
    }

    .card-name {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-primary);
      font-family: 'Inter', sans-serif;
      line-height: 1.2;
    }

    .card-desc {
      font-size: 10px;
      color: var(--text-tertiary);
      line-height: 1.3;
    }

    /* ==================== æ ·å¼1ï¼šä¿¡çº¸é‚®ä»¶é£æ ¼ ==================== */
    .indicator-letter {
      position: relative;
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      clip-path: polygon(
        0 8px, 8px 0, calc(100% - 8px) 0, 100% 8px,
        100% calc(100% - 8px), calc(100% - 8px) 100%, 8px 100%, 0 calc(100% - 8px)
      );
      padding: 16px 20px;
      width: 100%;
      max-width: 280px;
      box-shadow: 0 4px 12px var(--shadow);
    }

    .letter-lines {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: repeating-linear-gradient(
        transparent,
        transparent 23px,
        var(--border-color) 23px,
        var(--border-color) 24px
      );
      opacity: 0.3;
      pointer-events: none;
    }

    .letter-stamp {
      position: absolute;
      top: 12px;
      right: 12px;
      width: 32px;
      height: 32px;
      border: 2px dashed var(--border-color);
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      font-weight: 600;
      color: var(--text-tertiary);
      transform: rotate(12deg);
    }

    .letter-content {
      position: relative;
      z-index: 1;
      font-family: 'Courier New', monospace;
      font-size: 15px;
      font-weight: 500;
      color: var(--text-primary);
      line-height: 24px;
    }

    .letter-value {
      font-weight: 700;
      font-size: 18px;
    }

    /* ==================== æ ·å¼2ï¼šåšå®¢å¡ç‰‡é£æ ¼ ==================== */
    .indicator-blog {
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-left: 4px solid var(--text-primary);
      padding: 16px 20px;
      width: 100%;
      max-width: 280px;
      position: relative;
      box-shadow: 0 2px 8px var(--shadow);
      clip-path: polygon(
        0 0, calc(100% - 12px) 0, 100% 12px,
        100% 100%, 0 100%
      );
    }

    .blog-date {
      font-size: 10px;
      font-weight: 600;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 1.2px;
      margin-bottom: 8px;
    }

    .blog-title {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: 4px;
      letter-spacing: 0.3px;
    }

    .blog-value {
      font-size: 28px;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -1px;
      line-height: 1;
    }

    .blog-meta {
      margin-top: 8px;
      font-size: 10px;
      color: var(--text-tertiary);
      display: flex;
      gap: 8px;
    }

    .blog-meta span {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .blog-meta span::before {
      content: 'â€¢';
    }

    /* ==================== æ ·å¼3ï¼šå¾½ç« æ ‡ç­¾é£æ ¼ ==================== */
    .indicator-badge {
      display: inline-flex;
      height: 32px;
      overflow: hidden;
      box-shadow: 0 2px 8px var(--shadow);
    }

    .badge-left {
      background: var(--text-primary);
      color: var(--bg-primary);
      padding: 0 12px;
      display: flex;
      align-items: center;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      clip-path: polygon(0 0, calc(100% - 6px) 0, 100% 50%, calc(100% - 6px) 100%, 0 100%);
    }

    .badge-right {
      background: var(--bg-primary);
      border: 1px solid var(--text-primary);
      border-left: none;
      color: var(--text-primary);
      padding: 0 16px 0 12px;
      display: flex;
      align-items: center;
      font-size: 14px;
      font-weight: 700;
      font-family: 'Courier New', monospace;
      letter-spacing: 1px;
    }

    .badge-right::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 1px;
      background: var(--border-color);
    }

    /* ==================== æ ·å¼5ï¼šæ˜Ÿè½¨ç¯ç»•é£æ ¼ ==================== */
    .indicator-stars {
      position: relative;
      width: 140px;
      height: 140px;
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      box-shadow: 0 4px 12px var(--shadow);
    }

    .stars-orbit {
      position: absolute;
      width: 100%;
      height: 100%;
      border: 1px dashed var(--border-color);
      border-radius: 50%;
      animation: rotate 10s linear infinite;
    }

    .star {
      position: absolute;
      width: 8px;
      height: 8px;
      background: var(--text-primary);
      clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
      animation: twinkle 2s ease-in-out infinite;
    }

    .star:nth-child(1) {
      top: 10%;
      left: 50%;
      transform: translateX(-50%);
      animation-delay: 0s;
    }

    .star:nth-child(2) {
      top: 50%;
      right: 10%;
      transform: translateY(-50%);
      animation-delay: 0.5s;
    }

    .star:nth-child(3) {
      bottom: 10%;
      left: 50%;
      transform: translateX(-50%);
      animation-delay: 1s;
    }

    .star:nth-child(4) {
      top: 50%;
      left: 10%;
      transform: translateY(-50%);
      animation-delay: 1.5s;
    }

    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.3; transform: scale(0.8); }
      50% { opacity: 1; transform: scale(1.2); }
    }

    .stars-content {
      position: relative;
      z-index: 2;
      text-align: center;
      font-weight: 700;
      color: var(--text-primary);
    }

    .stars-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 4px;
    }

    .stars-value {
      font-size: 32px;
      letter-spacing: -1px;
    }

    /* ==================== å“åº”å¼ ==================== */
    @media (max-width: 480px) {
      .style-demo-card {
        padding: 20px 16px;
      }

      .indicator-preview-area {
        padding: 24px 12px;
      }
    }

    /* ==================== å¥½æ„Ÿåº¦æ ‡è¯† Header ç‰ˆæœ¬ï¼ˆèŠå¤©é¡¶æ ä¸“ç”¨ï¼Œ42pxé«˜åº¦ï¼‰==================== */

    /* å®¹å™¨æ ·å¼ */
    .chat-affection-indicator {
      flex-shrink: 0;
    }

    /* ========== æ ·å¼1ï¼šä¿¡çº¸é‚®ä»¶é£æ ¼ Header ç‰ˆæœ¬ ========== */
    .indicator-letter-header {
      position: relative;
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      clip-path: polygon(
        0 6px, 6px 0, calc(100% - 6px) 0, 100% 6px,
        100% calc(100% - 6px), calc(100% - 6px) 100%, 6px 100%, 0 calc(100% - 6px)
      );
      padding: 8px 12px;
      height: 42px;
      min-width: 90px;
      box-shadow: 0 2px 6px var(--shadow);
      display: flex;
      align-items: center;
    }

    .letter-lines-header {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: repeating-linear-gradient(
        transparent,
        transparent 12px,
        var(--border-color) 12px,
        var(--border-color) 13px
      );
      opacity: 0.3;
      pointer-events: none;
    }

    .letter-stamp-header {
      position: absolute;
      top: 4px;
      right: 6px;
      width: 16px;
      height: 16px;
      border: 1px dashed var(--border-color);
      border-radius: 2px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 8px;
      font-weight: 600;
      color: var(--text-tertiary);
      transform: rotate(12deg);
    }

    .letter-content-header {
      position: relative;
      z-index: 1;
      font-family: 'Courier New', monospace;
      font-size: 9px;
      font-weight: 500;
      color: var(--text-primary);
      line-height: 1.3;
    }

    .letter-value-header {
      font-weight: 700;
      font-size: 11px;
    }

    /* ========== æ ·å¼2ï¼šåšå®¢å¡ç‰‡é£æ ¼ Header ç‰ˆæœ¬ ========== */
    .indicator-blog-header {
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-left: 3px solid var(--text-primary);
      padding: 4px 8px;
      height: 42px;
      min-width: 100px;
      position: relative;
      box-shadow: 0 2px 6px var(--shadow);
      clip-path: polygon(
        0 0, calc(100% - 8px) 0, 100% 8px,
        100% 100%, 0 100%
      );
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .blog-date-header {
      font-size: 6px;
      font-weight: 600;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.3px;
      margin-bottom: 1px;
      line-height: 1;
    }

    .blog-title-header {
      font-size: 7px;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: 1px;
      letter-spacing: 0.2px;
      line-height: 1;
    }

    .blog-value-header {
      font-size: 12px;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.5px;
      line-height: 1;
    }

    .blog-meta-header {
      margin-top: 2px;
      font-size: 5px;
      color: var(--text-tertiary);
      display: flex;
      gap: 3px;
      line-height: 1;
    }

    .blog-meta-header span {
      display: flex;
      align-items: center;
      gap: 2px;
    }

    .blog-meta-header span::before {
      content: 'â€¢';
    }

    /* ========== æ ·å¼3ï¼šå¾½ç« æ ‡ç­¾é£æ ¼ Header ç‰ˆæœ¬ ========== */
    .indicator-badge-header {
      display: inline-flex;
      height: 42px;
      overflow: hidden;
      box-shadow: 0 2px 6px var(--shadow);
    }

    .badge-left-header {
      background: var(--text-primary);
      color: var(--bg-primary);
      padding: 0 10px;
      display: flex;
      align-items: center;
      font-size: 9px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      clip-path: polygon(0 0, calc(100% - 5px) 0, 100% 50%, calc(100% - 5px) 100%, 0 100%);
    }

    .badge-right-header {
      background: var(--bg-primary);
      border: 1px solid var(--text-primary);
      border-left: none;
      color: var(--text-primary);
      padding: 0 12px 0 10px;
      display: flex;
      align-items: center;
      font-size: 12px;
      font-weight: 700;
      font-family: 'Courier New', monospace;
    }

    /* ========== æ ·å¼4ï¼šæ˜Ÿè½¨ç¯ç»•é£æ ¼ Header ç‰ˆæœ¬ ========== */
    .indicator-stars-header {
      position: relative;
      width: 42px;
      height: 42px;
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      box-shadow: 0 2px 6px var(--shadow);
      flex-shrink: 0;
    }

    .stars-orbit-header {
      position: absolute;
      width: 100%;
      height: 100%;
      border: 1px dashed var(--border-color);
      border-radius: 50%;
      animation: rotate 10s linear infinite;
    }

    .star-header {
      position: absolute;
      width: 5px;
      height: 5px;
      background: var(--text-primary);
      clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
      animation: twinkle 2s ease-in-out infinite;
    }

    .star-header:nth-child(1) {
      top: 2px;
      left: 50%;
      transform: translateX(-50%);
      animation-delay: 0s;
    }

    .star-header:nth-child(2) {
      bottom: 2px;
      left: 50%;
      transform: translateX(-50%);
      animation-delay: 0.5s;
    }

    .star-header:nth-child(3) {
      left: 2px;
      top: 50%;
      transform: translateY(-50%);
      animation-delay: 1s;
    }

    .star-header:nth-child(4) {
      right: 2px;
      top: 50%;
      transform: translateY(-50%);
      animation-delay: 1.5s;
    }

    .stars-content-header {
      position: relative;
      z-index: 2;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0px;
    }

    .stars-label-header {
      font-size: 6px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .stars-value-header {
      font-size: 14px;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.5px;
      line-height: 1;
    }

    /* ==================== è‡ªå®šä¹‰å¥½æ„Ÿåº¦æ ‡è¯†æ ·å¼ ==================== */

    /* æ ·å¼é€‰æ‹©å¡ç‰‡ - Custom */
    .indicator-custom {
      position: relative;
      width: 80px;
      height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-secondary);
      border: 2px dashed var(--border-color);
      border-radius: 12px;
      transition: all 0.3s ease;
    }

    .indicator-custom img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      border-radius: 10px;
    }

    .indicator-custom:hover {
      border-color: var(--accent-color);
      background: var(--bg-tertiary);
    }

    /* ä¸Šä¼ åŒºåŸŸæ ·å¼ */
    .custom-upload-section {
      margin-top: 20px;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .custom-upload-card {
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 20px;
      box-shadow: var(--shadow-md);
    }

    .upload-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 16px;
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .upload-header svg {
      width: 18px;
      height: 18px;
      stroke: var(--text-secondary);
      fill: none;
    }

    .upload-preview {
      width: 100%;
      aspect-ratio: 1;
      max-height: 200px;
      border-radius: 12px;
      overflow: hidden;
      margin-bottom: 16px;
      position: relative;
    }

    .upload-placeholder {
      width: 100%;
      height: 100%;
      background: var(--bg-secondary);
      border: 2px dashed var(--border-color);
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .upload-placeholder:hover {
      border-color: var(--accent-color);
      background: var(--bg-tertiary);
    }

    .upload-placeholder:active {
      transform: scale(0.98);
    }

    .upload-placeholder svg {
      width: 32px;
      height: 32px;
      stroke: var(--text-tertiary);
      fill: none;
      margin-bottom: 12px;
      transition: all 0.3s ease;
    }

    .upload-placeholder:hover svg {
      stroke: var(--text-primary);
      transform: translateY(-2px);
    }

    .placeholder-text {
      font-size: 13px;
      font-weight: 500;
      color: var(--text-secondary);
      margin-bottom: 4px;
    }

    .placeholder-hint {
      font-size: 11px;
      color: var(--text-tertiary);
      font-family: 'JetBrains Mono', monospace;
      letter-spacing: 0.3px;
    }

    .upload-preview img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      background: var(--bg-secondary);
      border-radius: 12px;
    }

    .upload-actions {
      display: flex;
      gap: 10px;
    }

    .upload-action-btn {
      flex: 1;
      padding: 10px 14px;
      border: 1px solid var(--border-color);
      border-radius: 10px;
      background: var(--bg-secondary);
      color: var(--text-primary);
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      font-family: 'Inter', sans-serif;
    }

    .upload-action-btn svg {
      width: 14px;
      height: 14px;
      stroke: currentColor;
      fill: none;
    }

    .upload-action-btn:hover {
      background: var(--bg-tertiary);
      transform: translateY(-1px);
      box-shadow: var(--shadow-sm);
    }

    .upload-action-btn:active {
      transform: translateY(0);
    }

    .upload-action-btn.primary {
      background: var(--accent-color);
      color: var(--bg-primary);
      border-color: var(--accent-color);
    }

    .upload-action-btn.primary:hover {
      background: var(--text-primary);
      border-color: var(--text-primary);
    }

    .upload-action-btn.secondary {
      background: transparent;
      color: var(--text-secondary);
    }

    .upload-action-btn.secondary:hover {
      background: var(--bg-secondary);
      color: var(--text-primary);
    }

    /* ========== èŠå¤©é¡¶æ è‡ªå®šä¹‰æ ‡è¯† Header ç‰ˆæœ¬ ========== */
    .indicator-custom-header {
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      position: relative;
      transition: all 0.2s ease;
      flex-shrink: 0;
      border-radius: 6px;
      overflow: hidden;
    }

    .indicator-custom-header:hover {
      transform: scale(1.05);
    }

    .indicator-custom-header:active {
      transform: scale(0.95);
    }

    .indicator-custom-header img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
    }

    /* ========== è‡ªå®šä¹‰å¥½æ„Ÿåº¦ Tooltip ========== */
    .custom-affection-tooltip {
      position: absolute;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 12px 16px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
      z-index: 10000;
      transform: translateX(-50%);
      min-width: 140px;
      width: max-content;
      max-width: 145px;
    }

    [data-theme='dark'] .custom-affection-tooltip {
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.6);
    }

    .custom-affection-tooltip.active {
      opacity: 1;
      pointer-events: auto;
    }

    /* å°ä¸‰è§’ - å›ºå®šåœ¨tooltipæ­£ä¸­é—´ */
    .custom-affection-tooltip::before {
      content: '';
      position: absolute;
      top: -5px;
      left: 50%;
      transform: translateX(-50%) rotate(45deg);
      width: 10px;
      height: 10px;
      background: var(--bg-primary);
      border-left: 1px solid var(--border-color);
      border-top: 1px solid var(--border-color);
    }

    .custom-tooltip-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
    }

    /* å•æ æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰ */
    .custom-tooltip-single {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      width: 100%;
    }

    .custom-tooltip-label {
      font-size: 9px;
      color: var(--text-tertiary);
      letter-spacing: 0.8px;
      text-transform: uppercase;
      font-weight: 600;
      font-family: 'JetBrains Mono', monospace;
    }

    .custom-tooltip-value {
      font-size: 24px;
      font-weight: 700;
      color: var(--text-primary);
      font-family: 'JetBrains Mono', monospace;
      line-height: 1;
      letter-spacing: -0.5px;
    }

    .custom-tooltip-bar {
      width: 100%;
      height: 4px;
      background: var(--bg-tertiary);
      border-radius: 2px;
      overflow: hidden;
      margin-top: 2px;
    }

    .custom-tooltip-bar-fill {
      height: 100%;
      background: var(--accent-color);
      border-radius: 2px;
      transition: width 0.5s ease;
    }

    /* åŒæ æ¨¡å¼æ ·å¼ï¼ˆé€†æ”»ç•¥ï¼Œç´§å‡‘æ’åˆ—ï¼‰ */
    .custom-tooltip-dual {
      display: flex;
      align-items: center;
      gap: 8px;
      width: 100%;
    }

    .dual-column {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 3px;
    }

    .dual-divider {
      display: none;
    }

    .dual-label {
      font-size: 7px;
      color: var(--text-tertiary);
      letter-spacing: 0.3px;
      font-weight: 600;
      font-family: 'JetBrains Mono', monospace;
      text-transform: uppercase;
    }

    .dual-value {
      font-size: 18px;
      font-weight: 700;
      color: var(--text-primary);
      font-family: 'JetBrains Mono', monospace;
      line-height: 1;
      letter-spacing: -0.5px;
    }

    .dual-bar {
      width: 100%;
      height: 3px;
      background: var(--bg-tertiary);
      border-radius: 2px;
      overflow: hidden;
      margin-top: 1px;
    }

    .dual-bar-fill {
      height: 100%;
      background: var(--accent-color);
      border-radius: 2px;
      transition: width 0.5s ease;
    }

    /* å“åº”å¼ */
    @media (max-width: 480px) {
      .custom-upload-card {
        padding: 16px;
      }

      .upload-preview {
        max-height: 180px;
      }

      .upload-action-btn {
        padding: 9px 12px;
        font-size: 11px;
      }
    }

    /* æ‚„æ‚„è¯å’ŒåŸå› æ ·å¼ - ä¼˜åŒ–ç‰ˆ */
    .custom-tooltip-whisper {
      margin-top: 12px;
      padding: 10px 12px;
      background: var(--bg-secondary);
      border-radius: 10px;
      border: 1px solid var(--border-color);
      display: flex;
      align-items: flex-start;
      gap: 8px;
      animation: whisperFadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    }

    [data-theme='dark'] .custom-tooltip-whisper {
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }

    @keyframes whisperFadeIn {
      from {
        opacity: 0;
        transform: translateY(-5px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .whisper-icon {
      width: 14px;
      height: 14px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 2px;
    }

    /* åƒç´ æ˜Ÿæ˜Ÿ */
    .pixel-star {
      width: 12px;
      height: 12px;
      position: relative;
      background: var(--text-primary);
      clip-path: polygon(
        50% 0%,
        61% 35%,
        98% 35%,
        68% 57%,
        79% 91%,
        50% 70%,
        21% 91%,
        32% 57%,
        2% 35%,
        39% 35%
      );
      animation: starTwinkle 2s ease-in-out infinite;
      opacity: 0.8;
    }

    @keyframes starTwinkle {
      0%, 100% {
        opacity: 0.6;
        transform: scale(0.9);
      }
      50% {
        opacity: 1;
        transform: scale(1.1);
      }
    }

    .whisper-text {
      flex: 1;
      font-size: 10px;
      line-height: 1.5;
      color: var(--text-primary);
      font-family: 'Inter', sans-serif;
      letter-spacing: 0.2px;
    }

    .custom-tooltip-reason {
      margin-top: 10px;
      padding: 8px 0 0 0;
      border-top: 1px dashed var(--border-color);
      animation: reasonFadeIn 0.4s ease;
    }

    @keyframes reasonFadeIn {
      from {
        opacity: 0;
        transform: translateY(-3px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .reason-text {
      font-size: 9px;
      line-height: 1.4;
      color: var(--text-tertiary);
      text-align: center;
      font-family: 'JetBrains Mono', monospace;
      letter-spacing: 0.3px;
    }

    /* æ‰€æœ‰å¥½æ„Ÿåº¦æ ‡è¯†çš„é€šç”¨ç‚¹å‡»æ•ˆæœ */
    .indicator-letter-header,
    .indicator-blog-header,
    .indicator-badge-header,
    .indicator-stars-header,
    .indicator-note-header {
      transition: all 0.2s ease;
    }

    .indicator-letter-header:hover,
    .indicator-blog-header:hover,
    .indicator-badge-header:hover,
    .indicator-stars-header:hover,
    .indicator-note-header:hover {
      transform: scale(1.05);
      filter: brightness(1.1);
    }

    .indicator-letter-header:active,
    .indicator-blog-header:active,
    .indicator-badge-header:active,
    .indicator-stars-header:active,
    .indicator-note-header:active {
      transform: scale(0.95);
    }

    /* ==================== å¥½æ„Ÿåº¦æé†’æ ·å¼ ==================== */
    /* å¥½æ„Ÿåº¦æé†’å®¹å™¨ */
    .affection-reminder-container {
      display: flex;
      justify-content: flex-start;
      padding: 2px 0 8px 0;
      margin-top: -4px;
      margin-left: 0;
    }

    .affection-reminder {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-left: 0;
      padding: 4px 10px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      animation: affectionReminderFadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      vertical-align: middle;
      cursor: pointer;
      max-width: 200px;
    }

    .affection-reminder:hover {
      background: var(--bg-tertiary);
      transform: translateY(-1px);
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);
    }

    [data-theme='dark'] .affection-reminder:hover {
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
    }

    /* å±•å¼€çŠ¶æ€ */
    .affection-reminder.expanded {
      max-width: 90%;
      padding: 6px 12px;
    }

    .affection-reminder.expanded .affection-reminder-text {
      max-width: none;
      white-space: normal;
      overflow: visible;
      text-overflow: clip;
      word-break: break-word;
      line-height: 1.5;
    }

    @keyframes affectionReminderFadeIn {
      from {
        opacity: 0;
        transform: translateX(-5px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateX(0) scale(1);
      }
    }

    /* åƒç´ çˆ±å¿ƒ */
    .affection-reminder-heart {
      width: 10px;
      height: 10px;
      position: relative;
      flex-shrink: 0;
    }

    .pixel-heart {
      width: 10px;
      height: 10px;
      background: var(--text-primary);
      clip-path: polygon(
        50% 100%,
        0% 35%,
        0% 15%,
        15% 0%,
        35% 0%,
        50% 15%,
        65% 0%,
        85% 0%,
        100% 15%,
        100% 35%
      );
      animation: heartBeat 1.5s ease-in-out infinite;
      opacity: 0.85;
    }

    @keyframes heartBeat {
      0%, 100% {
        transform: scale(1);
        opacity: 0.85;
      }
      10% {
        transform: scale(1.15);
        opacity: 1;
      }
      20% {
        transform: scale(1);
        opacity: 0.85;
      }
    }

    /* æé†’æ–‡å­— */
    .affection-reminder-text {
      font-size: 10px;
      line-height: 1.3;
      color: var(--text-secondary);
      font-family: 'Inter', sans-serif;
      letter-spacing: 0.2px;
      max-width: 150px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      transition: all 0.25s ease;
    }

    /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
    @media (max-width: 480px) {
      .affection-reminder {
        padding: 2px 6px;
        gap: 3px;
      }

      .affection-reminder-heart {
        width: 9px;
        height: 9px;
      }

      .pixel-heart {
        width: 9px;
        height: 9px;
      }

      .affection-reminder-text {
        font-size: 8px;
        max-width: 100px;
      }
    }

    /* ==========================================
       HTMLå¡ç‰‡ç³»ç»Ÿ - AIè‡ªç”±åˆ›ä½œçš„å¯Œåª’ä½“å†…å®¹
       ========================================== */

    .html-card-container {
      width: 100%;
      display: flex;
      justify-content: flex-start;
      margin: 8px 0;
    }

    .chat-message-group.user .html-card-container {
      justify-content: flex-end;
    }

    .html-card-container > * {
      max-width: 280px;
    }

    .html-card-container img {
      max-width: 100%;
      height: auto;
      display: block;
    }

/* ==================== è§’è‰²åŠŸèƒ½å¡ç‰‡ - éŸ³ä¹æ’­æ”¾å™¨é£æ ¼ ==================== */

/* èƒŒæ™¯é®ç½© - iOSçµåŠ¨å²›åŒæ­¥åŠ¨ç”» */
.char-profile-backdrop {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.3);
  z-index: 1999;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.45s cubic-bezier(0.28, 0.84, 0.42, 1);
}

.char-profile-backdrop.active {
  opacity: 1;
  pointer-events: auto;
}

/* å¡ç‰‡å®¹å™¨ - iOSçµåŠ¨å²›åŸç”ŸspringåŠ¨ç”» */
.char-profile-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 60%;
  z-index: 2000;
  overflow: hidden;
  border-radius: 0 0 32px 32px;
  transform: translateY(-100%) scale(0.95);
  opacity: 0;
  pointer-events: none;
  /* iOSåŸç”ŸspringåŠ¨ç”»ï¼šå¿«é€Ÿå¯åŠ¨ + æµç•…å‡é€Ÿ + ç²¾å‡†åœæ­¢ */
  transition: transform 0.45s cubic-bezier(0.28, 0.84, 0.42, 1),
              opacity 0.45s cubic-bezier(0.28, 0.84, 0.42, 1);
  will-change: transform, opacity;
  transform-origin: top center;
}

.char-profile-overlay.active {
  transform: translateY(0) scale(1);
  opacity: 1;
  pointer-events: auto;
}

/* Playlistæ¨¡å¼ä¸‹å¢åŠ é«˜åº¦ */
.char-profile-overlay.show-playlist {
  height: 75%;
}

/* ==================== éŸ³ä¹æ’­æ”¾å™¨CSS - 100%å¤åˆ¶ ==================== */

/* ===== è§†å›¾åˆ‡æ¢ - iOS Dynamic Island åŠ¨ç”» ===== */
.music-player-view,
.playlist-view {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 100%;
  overflow-y: auto;
  overflow-x: hidden;
  opacity: 0;
  pointer-events: none;
  transition: transform 0.5s cubic-bezier(0.28, 0.84, 0.42, 1),
              opacity 0.5s cubic-bezier(0.28, 0.84, 0.42, 1);
  will-change: transform, opacity;
}

/* Music Playeré»˜è®¤æ˜¾ç¤º */
.music-player-view {
  transform: translateY(0) scale(1);
  opacity: 1;
  pointer-events: auto;
}

/* Music Playeråˆ‡æ¢åˆ°Playlistæ—¶éšè— */
.char-profile-overlay.show-playlist .music-player-view {
  transform: translateY(-15%) scale(0.92);
  opacity: 0;
  pointer-events: none;
}

/* Playlisté»˜è®¤éšè— */
.playlist-view {
  transform: translateY(15%) scale(0.92);
}

/* Playlistæ¿€æ´»æ˜¾ç¤º */
.char-profile-overlay.show-playlist .playlist-view {
  transform: translateY(0) scale(1);
  opacity: 1;
  pointer-events: auto;
}

    /* ===== Now Playing Widget - Horizontal layout like the image ===== */
    .now-playing-widget {
      background: linear-gradient(145deg, #ffffff 0%, #f5f5f7 100%);
      border-radius: 24px;
      padding: 40px 20px 20px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }

    /* Dark mode styles */
    [data-theme='dark'] .now-playing-widget {
      background: linear-gradient(145deg, #2a2a2c 0%, #1a1a1c 100%);
      box-shadow: none;
    }

    /* Blur background effect */
    .now-playing-widget::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle at 30% 50%, rgba(200, 200, 220, 0.2) 0%, transparent 50%);
      pointer-events: none;
    }

    [data-theme='dark'] .now-playing-widget::before {
      background: radial-gradient(circle at 30% 50%, rgba(100, 100, 120, 0.15) 0%, transparent 50%);
    }

    /* ===== Main player layout - horizontal symmetric ===== */
    .player-layout {
      display: flex;
      gap: 16px;
      position: relative;
      z-index: 1;
    }

    /* Album Cover - left side */
    .album-section {
      flex-shrink: 0;
    }

    .album-cover {
      width: 130px;
      height: 170px;
      border-radius: 10px;
      overflow: hidden;
      position: relative;
      background: #000;
      box-shadow: 0 8px 32px rgba(0,0,0,0.15);
    }

    [data-theme='dark'] .album-cover {
      box-shadow: 0 8px 32px rgba(0,0,0,0.4);
    }

    .album-cover img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* Player controls section - right side */
    .player-controls-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      min-width: 0;
    }

    /* Device indicator - headphone icon + Heavenly */
    .device-indicator {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      color: var(--text-secondary);
      margin-bottom: 2px;
    }

    .device-indicator svg {
      width: 12px;
      height: 12px;
      fill: currentColor;
    }

    /* Song title - Cigarettes After Sex â€” Heavenly */
    .song-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-primary);
      line-height: 1.2;
      margin-bottom: 6px;
    }

    /* Progress bar section */
    .progress-section {
      margin-bottom: 4px;
    }

    .progress-bar-wrap {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .progress-time {
      font-size: 10px;
      color: var(--text-tertiary);
      min-width: 26px;
      font-variant-numeric: tabular-nums;
    }

    .progress-time.end {
      text-align: right;
    }

    .progress-track {
      flex: 1;
      height: 3px;
      background: var(--progress-bg);
      border-radius: 2px;
      position: relative;
      cursor: pointer;
    }

    .progress-filled {
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 20%;
      background: var(--progress-fill);
      border-radius: 2px;
    }

    /* Current lyric line - scrolling marquee */
    .current-lyric-line {
      font-size: 10px;
      color: var(--text-secondary);
      margin-top: 4px;
      font-style: italic;
      white-space: nowrap;
      overflow: hidden;
      position: relative;
    }

    .current-lyric-line .lyric-text {
      display: inline-block;
      animation: scrollLyric 8s linear infinite;
      padding-right: 50px;
    }

    @keyframes scrollLyric {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }

    /* Playback control buttons - smaller, inside right section */
    .playback-buttons {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-top: 6px;
    }

    .ctrl-btn {
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: none;
      border: none;
      cursor: pointer;
      color: var(--text-primary);
      opacity: 0.9;
      transition: transform 0.15s ease, opacity 0.15s ease;
    }

    .ctrl-btn:active {
      transform: scale(0.85);
      opacity: 0.6;
    }

    .ctrl-btn svg {
      width: 22px;
      height: 22px;
      fill: currentColor;
    }

    .ctrl-btn.play-btn svg {
      width: 28px;
      height: 28px;
    }

    .ctrl-btn.small-btn svg {
      width: 18px;
      height: 18px;
    }

    /* Extended lyrics section - iOS style with smooth scroll */
    .extended-lyrics {
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid rgba(0,0,0,0.08);
      height: 78px;
      overflow: hidden;
      position: relative;
    }

    [data-theme='dark'] .extended-lyrics {
      border-top: 1px solid rgba(255,255,255,0.08);
    }

    .lyrics-container {
      display: flex;
      flex-direction: column;
      gap: 8px;
      transform: translateY(0);
      transition: transform 0.8s cubic-bezier(0.25, 0.1, 0.25, 1);
      will-change: transform;
      backface-visibility: hidden;
      -webkit-backface-visibility: hidden;
      perspective: 1000px;
    }

    .lyrics-line {
      font-size: 12px;
      color: var(--text-tertiary);
      line-height: 18px;
      height: 18px;
      text-align: right;
      opacity: 0.4;
      flex-shrink: 0;
      transition: all 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
      transform: scale(1);
      transform-origin: right center;
    }

    .lyrics-line.active {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
      opacity: 1;
      text-shadow: 0 0 15px rgba(0, 0, 0, 0.12);
      transform: scale(1.02);
    }

    [data-theme='dark'] .lyrics-line.active {
      text-shadow: 0 0 20px rgba(255, 255, 255, 0.35);
    }

    /* Volume slider */
    .volume-slider {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 16px;
      padding-top: 12px;
    }

    .vol-icon {
      width: 16px;
      height: 16px;
      color: var(--text-tertiary);
    }

    .vol-icon svg {
      width: 100%;
      height: 100%;
      fill: currentColor;
    }

    .vol-track {
      flex: 1;
      height: 4px;
      background: var(--progress-bg);
      border-radius: 2px;
      position: relative;
    }

    .vol-filled {
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 50%;
      background: var(--progress-fill);
      border-radius: 2px;
    }

/* ===== Playlist Section - ä¼˜åŒ–åçš„è®¾è®¡ ===== */
.playlist-section {
  margin: 20px;
  background: var(--bg-card, rgba(255, 255, 255, 0.5));
  border-radius: 24px;
  padding: 20px;
  box-shadow: 0 2px 16px rgba(0, 0, 0, 0.08);
  transition: background 0.8s cubic-bezier(0.4, 0, 0.2, 1),
              box-shadow 0.3s ease;
  position: relative;
  overflow: hidden;
}

/* é»˜è®¤æ·±è‰²ä¸»é¢˜èƒŒæ™¯ - ä¼šè¢«åŠ¨æ€é¢œè‰²è¦†ç›– */
[data-theme='dark'] .playlist-section {
  background: rgba(42, 42, 44, 0.6);
  box-shadow: 0 2px 16px rgba(0, 0, 0, 0.3);
}

/* æ·»åŠ å¾®å¦™çš„å…‰æ™•æ•ˆæœ */
.playlist-section::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle at 30% 40%, rgba(255, 255, 255, 0.08) 0%, transparent 50%);
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.8s ease;
  z-index: 0;
}

.playlist-section:hover::before {
  opacity: 1;
}

/* ç¡®ä¿å†…å®¹åœ¨å…‰æ™•ä¹‹ä¸Š */
.playlist-section > * {
  position: relative;
  z-index: 1;
}

.playlist-header {
  display: flex;
  align-items: center;
  gap: 14px;
  margin-bottom: 18px;
  padding-bottom: 14px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.06);
}

[data-theme='dark'] .playlist-header {
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
}

.playlist-thumb {
  width: 52px;
  height: 52px;
  border-radius: 10px;
  overflow: hidden;
  background: #000;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  flex-shrink: 0;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.playlist-thumb:hover {
  transform: scale(1.05);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
}

.playlist-thumb:active {
  transform: scale(0.95);
}

.playlist-thumb img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.2s ease;
}

.playlist-thumb:hover img {
  transform: scale(1.1);
}

.playlist-info {
  flex: 1;
  min-width: 0;
}

.playlist-name {
  font-size: 16px;
  font-weight: 700;
  color: var(--text-primary, #000);
  margin-bottom: 3px;
  letter-spacing: -0.2px;
}

.playlist-meta {
  font-size: 13px;
  color: var(--text-secondary, #666);
  font-weight: 500;
}

.playlist-play-btn {
  width: 40px;
  height: 40px;
  background: var(--text-primary, #000);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  flex-shrink: 0;
}

.playlist-play-btn:hover {
  transform: scale(1.05);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
}

.playlist-play-btn:active {
  transform: scale(0.95);
}

.playlist-play-btn svg {
  width: 18px;
  height: 18px;
  fill: var(--bg-primary, #fff);
  margin-left: 2px;
}

/* Album grid - 4 columns */
.album-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
}

.album-thumb {
  aspect-ratio: 1;
  border-radius: 10px;
  overflow: hidden;
  position: relative;
  cursor: pointer;
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
}

.album-thumb:hover {
  transform: translateY(-2px) scale(1.02);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.18);
}

.album-thumb:active {
  transform: scale(0.96);
}

.album-thumb img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.3s ease;
}

.album-thumb:hover img {
  transform: scale(1.05);
}

.album-thumb-label {
  position: absolute;
  bottom: 6px;
  left: 6px;
  right: 6px;
  font-size: 8px;
  font-weight: 700;
  color: #ffffff;
  text-transform: uppercase;
  letter-spacing: 0.6px;
  text-shadow: 0 1px 4px rgba(0, 0, 0, 0.95), 0 2px 8px rgba(0, 0, 0, 0.6);
  line-height: 1.2;
}

/* ==================== ä¸“è¾‘ç¼–è¾‘æŒ‰é’® - æ•´åˆåˆ°Playlistå†… ==================== */

/* ç¼–è¾‘æŒ‰é’®åŒºåŸŸ - å¯æŠ˜å  */
.album-edit-actions {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 8px;
  margin-top: 12px;
  max-height: 0;
  overflow: hidden;
  opacity: 0;
  transition: max-height 0.4s cubic-bezier(0.28, 0.84, 0.42, 1),
              opacity 0.4s cubic-bezier(0.28, 0.84, 0.42, 1),
              margin-top 0.4s cubic-bezier(0.28, 0.84, 0.42, 1);
}

/* å±•å¼€çŠ¶æ€ */
.album-edit-actions.active {
  max-height: 80px;
  opacity: 1;
  margin-top: 16px;
}

/* å•ä¸ªç¼–è¾‘é¡¹ */
.edit-action-item {
  display: flex;
  gap: 4px;
  justify-content: center;
}

/* ç¼–è¾‘æŒ‰é’® */
.edit-action-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  padding: 0;
  background: var(--text-primary, #000);
  color: var(--bg-primary, #fff);
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.edit-action-btn:hover {
  transform: scale(1.08);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.edit-action-btn:active {
  transform: scale(0.92);
}

.edit-action-btn svg {
  width: 14px;
  height: 14px;
}

[data-theme='dark'] .edit-action-btn {
  background: rgba(255, 255, 255, 0.9);
  color: #000;
}

/* ==================== End ä¸“è¾‘ç¼–è¾‘æŒ‰é’® ==================== */


/* ==================== End è§’è‰²åŠŸèƒ½å¡ç‰‡ ==================== */

/* ==================== æ—¥è®°æœ¬ç³»ç»Ÿ - ç¿»é¡µç•Œé¢ ==================== */

/* æ—¥è®°æœ¬Overlayå®¹å™¨ */
.diary-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--bg-secondary, #fafafa);
  z-index: 2100;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px;
  padding-top: calc(16px + env(safe-area-inset-top, 0px));
  padding-bottom: calc(16px + env(safe-area-inset-bottom, 0px));
  padding-top: max(
    calc(16px + env(safe-area-inset-top, 0px)),
    calc(16px + env(safe-area-inset-top, 0px) + var(--custom-top-offset))
  );
  overflow: hidden;
  /* åŠ¨ç”»ï¼šåˆå§‹éšè— */
  opacity: 0;
  transform: scale(0.9);
  pointer-events: none;
  transition: opacity 0.3s ease, transform 0.3s ease;
}

.diary-overlay.active {
  opacity: 1;
  transform: scale(1);
  pointer-events: auto;
}

/* æ—¥è®°æœ¬å®¹å™¨ */
.diary-wrap {
  width: 100%;
  max-width: 100%;
  height: 100%;
  max-height: 100%;
  position: relative;
  perspective: 2000px;
}

.diary-book {
  width: 100%;
  height: 100%;
  position: relative;
  transform-style: preserve-3d;
}

/* é¡µé¢åŸºç¡€ */
.diary-page {
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  transform-style: preserve-3d;
  transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
  transform-origin: left center;
}

.diary-page.flipped {
  transform: rotateY(-180deg);
}

/* ğŸ”¥ æ‡’åŠ è½½å ä½ç¬¦æ ·å¼ */
.diary-page.diary-lazy {
  background: var(--diary-bg, #f5f1e8);
  display: flex;
  align-items: center;
  justify-content: center;
}

.diary-page.diary-lazy::after {
  content: 'åŠ è½½ä¸­...';
  font-size: 14px;
  color: var(--text-secondary, #999);
  opacity: 0.5;
}

.diary-page-face {
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  overflow: hidden;
}

/* ä¹¦è„Š */
.diary-spine {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 18px;
  background: linear-gradient(90deg, rgba(0,0,0,0.12) 0%, rgba(0,0,0,0.04) 50%, rgba(255,255,255,0.2) 100%);
  z-index: 10;
  pointer-events: none;
}

.diary-spine::after {
  content: '';
  position: absolute;
  right: 3px;
  top: 16px;
  bottom: 16px;
  width: 1px;
  background: var(--border-color, rgba(0,0,0,0.08));
}

.diary-spine-inner {
  background: linear-gradient(90deg, rgba(0,0,0,0.06) 0%, transparent 50%, rgba(255,255,255,0.08) 100%);
  border-right: 1px solid var(--border-color, rgba(0,0,0,0.05));
}

/* è£…è®¢å­” */
.diary-holes {
  position: absolute;
  left: 5px;
  top: 50%;
  transform: translateY(-50%);
  display: flex;
  flex-direction: column;
  gap: 45px;
  z-index: 11;
}

.diary-hole {
  width: 5px;
  height: 5px;
  border-radius: 50%;
  background: var(--bg-secondary, #fafafa);
  border: 1px solid var(--border-color, #e0e0e0);
  box-shadow: inset 0 1px 2px rgba(0,0,0,0.12);
}

/* å°é¢ */
.diary-cover .diary-page-face {
  background: var(--diary-cover);
  border-radius: 6px 20px 20px 6px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.12);
}

.diary-cover-inner {
  padding: 18px 18px 18px 32px;
  height: 100%;
  display: flex;
  flex-direction: column;
  position: relative;
}

/* å°é¢è£…é¥° */
.diary-cover-deco {
  position: absolute;
  inset: 0;
  pointer-events: none;
  overflow: hidden;
}

.diary-star-deco {
  position: absolute;
  background: var(--diary-cover-star);
  clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
  animation: diary-twinkle 2.5s ease-in-out infinite;
}

.diary-star-deco:nth-child(1) { width: 5px; height: 5px; top: 10%; left: 12%; }
.diary-star-deco:nth-child(2) { width: 4px; height: 4px; top: 18%; right: 10%; animation-delay: 0.6s; }
.diary-star-deco:nth-child(3) { width: 3px; height: 3px; top: 50%; left: 10%; animation-delay: 1.2s; }
.diary-star-deco:nth-child(4) { width: 4px; height: 4px; top: 62%; right: 14%; animation-delay: 0.3s; }
.diary-star-deco:nth-child(5) { width: 3px; height: 3px; top: 78%; left: 18%; animation-delay: 0.9s; }

@keyframes diary-twinkle {
  0%, 100% { opacity: 0.25; transform: scale(1); }
  50% { opacity: 0.8; transform: scale(1.2); }
}

/* å°é¢è¾¹æ¡† */
.diary-cover-frame {
  position: absolute;
  top: 6px;
  right: 6px;
  bottom: 6px;
  left: 26px;
  border: 1px solid var(--diary-cover-border);
  border-radius: 3px 14px 14px 3px;
  pointer-events: none;
}

/* è¿”å›æŒ‰é’® */
.diary-back-btn {
  position: absolute;
  top: 14px;
  left: 32px;
  width: 28px;
  height: 28px;
  background: var(--diary-cover-accent);
  border: 1px solid var(--diary-cover-border);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.25s ease;
  z-index: 100;
}

.diary-back-btn:hover {
  background: var(--diary-cover-text);
  transform: scale(1.08);
}

.diary-back-btn:hover svg {
  stroke: var(--diary-cover);
}

.diary-back-btn svg {
  width: 14px;
  height: 14px;
  stroke: var(--diary-cover-text);
  fill: none;
  stroke-width: 2;
}

/* æµè§ˆå™¨é£æ ¼å¤´éƒ¨ */
.diary-browser-bar {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 10px;
  margin-top: 36px;
}

.diary-browser-dots {
  display: flex;
  gap: 3px;
}

.diary-browser-dots i {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: var(--diary-cover-accent);
  border: 1px solid var(--diary-cover-border);
}

.diary-browser-url {
  flex: 1;
  height: 18px;
  background: var(--diary-cover-accent);
  border-radius: 9px;
  border: 1px solid var(--diary-cover-border);
  display: flex;
  align-items: center;
  padding: 0 8px;
  font-size: 8px;
  color: var(--diary-cover-text-sub);
  font-family: 'JetBrains Mono', monospace;
}

/* å¤´åƒåŒº */
.diary-avatar-area {
  display: flex;
  justify-content: center;
  margin: 12px 0;
}

.diary-avatar-wrap {
  width: 80px;
  height: 80px;
  position: relative;
}

.diary-avatar-frame {
  position: absolute;
  inset: -3px;
  border: 2px solid var(--diary-cover-text-sub);
  clip-path: polygon(0 6px, 6px 6px, 6px 0, calc(100% - 6px) 0, calc(100% - 6px) 6px, 100% 6px, 100% calc(100% - 6px), calc(100% - 6px) calc(100% - 6px), calc(100% - 6px) 100%, 6px 100%, 6px calc(100% - 6px), 0 calc(100% - 6px));
}

.diary-avatar-img {
  width: 100%;
  height: 100%;
  background: var(--diary-cover-accent);
  border: 1px solid var(--diary-cover-border);
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 28px;
  color: var(--diary-cover-text-sub);
  overflow: hidden;
}

.diary-avatar-img img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* è§’è‰²å */
.diary-char-name {
  text-align: center;
  margin: 8px 0;
}

.diary-char-name h2 {
  font-family: 'Caveat', cursive;
  font-size: 24px;
  font-weight: 700;
  color: var(--diary-cover-text);
}

.diary-char-name span {
  font-size: 8px;
  color: var(--diary-cover-text-sub);
  font-family: 'JetBrains Mono', monospace;
  letter-spacing: 2px;
}

/* ç»Ÿè®¡ */
.diary-stats-row {
  display: flex;
  justify-content: center;
  gap: 8px;
  margin: 12px 0;
}

.diary-stat-box {
  background: var(--diary-cover-accent);
  border: 1px solid var(--diary-cover-border);
  padding: 8px 12px;
  text-align: center;
}

.diary-stat-box:nth-child(odd) { border-radius: 10px 3px 10px 3px; }
.diary-stat-box:nth-child(even) { border-radius: 3px 10px 3px 10px; }

.diary-stat-box strong {
  display: block;
  font-size: 16px;
  font-weight: 600;
  color: var(--diary-cover-text);
  font-family: 'JetBrains Mono', monospace;
}

.diary-stat-box small {
  font-size: 7px;
  color: var(--diary-cover-text-sub);
  text-transform: uppercase;
  letter-spacing: 1px;
}

/* ç®€ä»‹æ¡† */
.diary-bio-box {
  background: var(--diary-cover-accent);
  border: 1px solid var(--diary-cover-border);
  border-radius: 6px;
  padding: 8px;
  flex: 1;
  margin: 8px 0;
  position: relative;
  overflow: hidden;
}

.diary-bio-head {
  display: flex;
  align-items: center;
  gap: 5px;
  padding-bottom: 5px;
  border-bottom: 1px dashed var(--diary-cover-border);
  margin-bottom: 5px;
}

.diary-bio-head svg {
  width: 12px;
  height: 12px;
  stroke: var(--diary-cover-text-sub);
  fill: none;
  stroke-width: 2;
}

.diary-bio-head span {
  font-size: 8px;
  color: var(--diary-cover-text-sub);
  font-family: 'JetBrains Mono', monospace;
  letter-spacing: 1px;
}

.diary-bio-text {
  font-size: 9px;
  color: var(--diary-cover-text);
  line-height: 1.5;
  font-family: 'Noto Serif JP', serif;
  opacity: 0.8;
}

/* å°é¢åº•éƒ¨ */
.diary-cover-foot {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: 8px;
  border-top: 1px dashed var(--diary-cover-border);
  margin-top: auto;
}

.diary-cover-foot time {
  font-size: 7px;
  color: var(--diary-cover-text-sub);
  font-family: 'JetBrains Mono', monospace;
}

/* ç¿»é¡µæŒ‰é’® */
.diary-flip-btn {
  position: absolute;
  bottom: 14px;
  width: 32px;
  height: 32px;
  background: var(--diary-cover-accent);
  border: 1px solid var(--diary-cover-border);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.25s ease;
  z-index: 100;
}

.diary-flip-btn:hover {
  background: var(--diary-cover-text);
  transform: scale(1.08);
}

.diary-flip-btn:hover svg {
  stroke: var(--diary-cover);
}

.diary-flip-btn svg {
  width: 14px;
  height: 14px;
  stroke: var(--diary-cover-text);
  fill: none;
  stroke-width: 2;
}

.diary-flip-btn.next { right: 14px; }
.diary-flip-btn.prev { left: 32px; }

/* å†…é¡µç¿»é¡µæŒ‰é’® */
.diary-page-btn {
  position: absolute;
  bottom: 12px;
  width: 28px;
  height: 28px;
  background: var(--bg-tertiary, #f5f5f5);
  border: 1px solid var(--border-color, #e0e0e0);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.25s ease;
  z-index: 100;
}

.diary-page-btn:hover {
  background: var(--text-primary, #2a2a2a);
  transform: scale(1.08);
}

.diary-page-btn:hover svg {
  stroke: var(--bg-primary, #fff);
}

.diary-page-btn svg {
  width: 12px;
  height: 12px;
  stroke: var(--text-primary, #000000);
  fill: none;
  stroke-width: 2;
}

.diary-page-btn.next { right: 12px; }
.diary-page-btn.prev { left: 24px; }

/* å†…é¡µé€šç”¨ */
.diary-inner .diary-page-face {
  background: var(--diary-page);
  border-radius: 3px 18px 18px 3px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

.diary-page-inner {
  padding: 14px 14px 14px 26px;
  height: 100%;
  display: flex;
  flex-direction: column;
  position: relative;
  overflow: hidden;
}

/* æ¨ªçº¿èƒŒæ™¯ */
.diary-page-inner::before {
  content: '';
  position: absolute;
  inset: 0;
  background: repeating-linear-gradient(to bottom, transparent 0px, transparent 22px, rgba(0,0,0,0.05) 22px, rgba(0,0,0,0.05) 23px);
  pointer-events: none;
}

[data-theme="dark"] .diary-page-inner::before {
  background: repeating-linear-gradient(to bottom, transparent 0px, transparent 22px, rgba(255,255,255,0.04) 22px, rgba(255,255,255,0.04) 23px);
}

/* ç›®å½•é¡µ */
.diary-idx-head {
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 2px solid var(--text-primary, #2a2a2a);
}

.diary-idx-head h3 {
  font-family: 'Caveat', cursive;
  font-size: 24px;
  font-weight: 700;
  color: var(--text-primary, #2a2a2a);
  display: flex;
  align-items: center;
  gap: 6px;
}

.diary-idx-head h3 svg {
  width: 20px;
  height: 20px;
  stroke: var(--text-primary, #2a2a2a);
  fill: none;
  stroke-width: 2;
}

.diary-idx-head small {
  font-size: 8px;
  color: var(--text-tertiary, #999);
  font-family: 'JetBrains Mono', monospace;
  letter-spacing: 1px;
}

/* ç›®å½•é¡µå³ä¸Šè§’ï¼šç¬”è®°å»é‡ï¼ˆç®€çº¦é»‘ç™½ç°å°çº¸æ¡ï¼‰ */
.diary-idx-action-btn {
  position: absolute;
  top: 8px;
  right: 8px;
  padding: 6px 10px 8px 10px;
  background: rgba(255, 255, 255, 0.95);
  border: 1px solid rgba(0, 0, 0, 0.08);
  border-radius: 3px;
  box-shadow:
    0 2px 6px rgba(0, 0, 0, 0.06),
    0 1px 2px rgba(0, 0, 0, 0.04),
    0 0 0 1px rgba(255, 255, 255, 0.8) inset;
  cursor: pointer;
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 110;
  transform: rotate(-1.5deg);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 3px;
  min-width: 64px;
  backdrop-filter: blur(8px);
}

/* å°çº¸æ¡é¡¶éƒ¨çš„åŠé€æ˜èƒ¶å¸¦ */
.diary-idx-action-btn::before {
  content: '';
  position: absolute;
  top: -3px;
  left: 50%;
  transform: translateX(-50%);
  width: 18px;
  height: 6px;
  background: rgba(0, 0, 0, 0.12);
  border-radius: 1px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);
}

.diary-idx-action-btn:hover {
  transform: rotate(0deg) translateY(-1px);
  box-shadow:
    0 4px 12px rgba(0, 0, 0, 0.1),
    0 2px 4px rgba(0, 0, 0, 0.06),
    0 0 0 1px rgba(255, 255, 255, 0.9) inset;
  border-color: rgba(0, 0, 0, 0.12);
}

.diary-idx-action-btn.armed {
  border: 1.5px solid rgba(0, 0, 0, 0.25);
  box-shadow:
    0 0 0 3px rgba(0, 0, 0, 0.06),
    0 2px 6px rgba(0, 0, 0, 0.12),
    0 0 0 1px rgba(255, 255, 255, 0.8) inset;
  animation: diary-note-pulse 1s ease-in-out infinite;
}

@keyframes diary-note-pulse {
  0%, 100% {
    transform: rotate(-1.5deg) scale(1);
    box-shadow:
      0 0 0 3px rgba(0, 0, 0, 0.06),
      0 2px 6px rgba(0, 0, 0, 0.12),
      0 0 0 1px rgba(255, 255, 255, 0.8) inset;
  }
  50% {
    transform: rotate(-1.5deg) scale(1.04);
    box-shadow:
      0 0 0 4px rgba(0, 0, 0, 0.08),
      0 3px 8px rgba(0, 0, 0, 0.14),
      0 0 0 1px rgba(255, 255, 255, 0.9) inset;
  }
}

.diary-idx-action-btn:active {
  transform: rotate(-1.5deg) scale(0.96);
}

.diary-note-heart {
  font-size: 16px;
  line-height: 1;
  color: rgba(0, 0, 0, 0.65);
  transition: all 0.25s ease;
  user-select: none;
}

.diary-idx-action-btn:hover .diary-note-heart {
  color: rgba(0, 0, 0, 0.85);
  transform: scale(1.08);
}

.diary-idx-action-btn.armed .diary-note-heart {
  color: rgba(0, 0, 0, 0.75);
}

/* æ‰‹å†™å­—ä½“æ–‡å­— */
.diary-idx-action-btn .diary-note-text {
  font-family: 'Caveat', cursive;
  font-size: 10px;
  font-weight: 600;
  color: rgba(0, 0, 0, 0.75);
  line-height: 1;
  text-align: center;
  white-space: nowrap;
  letter-spacing: 0.2px;
}

.diary-idx-action-btn:hover .diary-note-text {
  color: rgba(0, 0, 0, 0.9);
}

.diary-idx-action-btn.armed .diary-note-text {
  color: rgba(0, 0, 0, 0.85);
  font-weight: 700;
}

/* æš—é»‘æ¨¡å¼é€‚é… */
[data-theme="dark"] .diary-idx-action-btn {
  background: rgba(30, 30, 30, 0.9);
  border-color: rgba(255, 255, 255, 0.12);
  box-shadow:
    0 2px 6px rgba(0, 0, 0, 0.3),
    0 1px 2px rgba(0, 0, 0, 0.2),
    0 0 0 1px rgba(255, 255, 255, 0.05) inset;
}

[data-theme="dark"] .diary-idx-action-btn::before {
  background: rgba(255, 255, 255, 0.15);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

[data-theme="dark"] .diary-idx-action-btn:hover {
  border-color: rgba(255, 255, 255, 0.18);
  box-shadow:
    0 4px 12px rgba(0, 0, 0, 0.4),
    0 2px 4px rgba(0, 0, 0, 0.25),
    0 0 0 1px rgba(255, 255, 255, 0.08) inset;
}

[data-theme="dark"] .diary-idx-action-btn.armed {
  border: 1.5px solid rgba(255, 255, 255, 0.3);
  box-shadow:
    0 0 0 3px rgba(255, 255, 255, 0.08),
    0 2px 6px rgba(0, 0, 0, 0.4),
    0 0 0 1px rgba(255, 255, 255, 0.06) inset;
}

[data-theme="dark"] .diary-idx-action-btn .diary-note-text {
  color: rgba(255, 255, 255, 0.8);
}

[data-theme="dark"] .diary-idx-action-btn:hover .diary-note-text {
  color: rgba(255, 255, 255, 0.95);
}

[data-theme="dark"] .diary-idx-action-btn.armed .diary-note-text {
  color: rgba(255, 255, 255, 0.9);
  font-weight: 700;
}

[data-theme="dark"] .diary-note-heart {
  color: rgba(255, 255, 255, 0.7);
}

[data-theme="dark"] .diary-idx-action-btn:hover .diary-note-heart {
  color: rgba(255, 255, 255, 0.9);
}

[data-theme="dark"] .diary-idx-action-btn.armed .diary-note-heart {
  color: rgba(255, 255, 255, 0.85);
}

/* ç›®å½•åˆ—è¡¨ */
.diary-idx-list {
  flex: 1;
  overflow-y: auto;
  scrollbar-width: none;
}

.diary-idx-list::-webkit-scrollbar { display: none; }

.diary-idx-item {
  display: flex;
  align-items: center;
  padding: 8px 0;
  border-bottom: 1px dashed rgba(0,0,0,0.05);
  cursor: pointer;
  transition: all 0.2s ease;
}

[data-theme="dark"] .diary-idx-item {
  border-bottom-color: rgba(255,255,255,0.04);
}

.diary-idx-item:hover {
  padding-left: 4px;
  background: var(--bg-tertiary, #f5f5f5);
  margin: 0 -4px;
  padding-right: 4px;
  border-radius: 4px;
}

.diary-idx-date {
  width: 42px;
  font-size: 8px;
  color: var(--text-tertiary, #999);
  font-family: 'JetBrains Mono', monospace;
}

.diary-idx-title {
  flex: 1;
  font-size: 10px;
  color: var(--text-primary, #2a2a2a);
  font-family: 'Noto Serif JP', serif;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.diary-idx-count {
  font-size: 7px;
  padding: 2px 5px;
  border-radius: 3px;
  font-family: 'JetBrains Mono', monospace;
  background: rgba(255,250,205,0.92);
  color: var(--text-primary, #2a2a2a);
  margin-left: 6px;
}

[data-theme="dark"] .diary-idx-count {
  background: rgba(80,75,40,0.92);
}

.diary-idx-pg {
  width: 18px;
  text-align: right;
  font-size: 8px;
  color: var(--text-tertiary, #999);
  font-family: 'JetBrains Mono', monospace;
}

/* ç©ºæ—¥è®°æç¤º */
.diary-empty-hint {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
  text-align: center;
}

.diary-empty-hint svg {
  width: 48px;
  height: 48px;
  stroke: var(--text-tertiary, #999);
  fill: none;
  stroke-width: 1.5;
  margin-bottom: 16px;
  opacity: 0.5;
}

.diary-empty-hint p {
  font-size: 14px;
  color: var(--text-secondary, #666);
  margin-bottom: 8px;
  font-family: 'Noto Serif JP', serif;
}

.diary-empty-hint span {
  font-size: 11px;
  color: var(--text-tertiary, #999);
}

/* é¡µè„š */
.diary-page-foot {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: 8px;
  margin-top: auto;
  border-top: 1px solid rgba(0,0,0,0.05);
}

[data-theme="dark"] .diary-page-foot {
  border-top-color: rgba(255,255,255,0.04);
}

.diary-page-num {
  font-size: 8px;
  color: var(--text-tertiary, #999);
  font-family: 'JetBrains Mono', monospace;
}

.diary-page-deco {
  display: flex;
  gap: 3px;
}

.diary-page-deco i {
  width: 3px;
  height: 3px;
  background: var(--text-tertiary, #999);
  opacity: 0.5;
}

.diary-page-deco i:nth-child(1) { border-radius: 50%; }
.diary-page-deco i:nth-child(2) { border-radius: 1px; }
.diary-page-deco i:nth-child(3) { clip-path: polygon(50% 0%, 100% 100%, 0% 100%); }

/* å“åº”å¼åœ†è§’ */
@media (min-width: 431px) {
  .diary-overlay {
    border-radius: 36px;
  }
}

/* éšè—åºŸå¼ƒçš„åŠ¨æ€é¡µé¢å®¹å™¨ï¼ˆä¸å†ä½¿ç”¨ï¼Œä½†HTMLé‡Œè¿˜æœ‰è¿™ä¸ªdivï¼‰ */
#diaryDynamicPages {
  display: none;
}

/* ==================== æ—¥è®°å†…å®¹é¡µé¢æ ·å¼ï¼ˆä»¿ diary-preview.htmlï¼‰ ==================== */

/* æ—¥è®°å†…å®¹é¡µé¢å®¹å™¨ - ä¿æŒä¸ç›®å½•é¡µä¸€è‡´çš„padding */
.diary-content-page {
  display: flex;
  flex-direction: column;
  height: 100%;
  position: relative;
  overflow: hidden;
}

/* æ—¥æœŸå¤´éƒ¨ - ä»¿ entry-head */
.diary-entry-head {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 8px;
  padding-bottom: 6px;
  border-bottom: 1px solid var(--diary-line, rgba(0,0,0,0.05));
  position: relative;
  z-index: 1;
}

[data-theme="dark"] .diary-entry-head {
  border-bottom-color: rgba(255,255,255,0.04);
}

.diary-entry-date {
  display: flex;
  flex-direction: column;
}

.diary-entry-date strong {
  font-family: 'JetBrains Mono', monospace;
  font-size: 9px;
  color: var(--text-secondary, #666);
  font-weight: 500;
}

.diary-entry-date small {
  font-size: 7px;
  color: var(--text-tertiary, #999);
}

.diary-entry-mood {
  display: flex;
  align-items: center;
  gap: 3px;
  padding: 3px 6px;
  background: var(--bg-tertiary, #f5f5f5);
  border: 1px solid var(--border-color, #e0e0e0);
  border-radius: 6px;
  font-size: 7px;
  color: var(--text-secondary, #666);
}

[data-theme="dark"] .diary-entry-mood {
  background: rgba(255,255,255,0.06);
  border-color: rgba(255,255,255,0.08);
}

/* æ—¥è®°æ ‡é¢˜ - ä»¿ entry-title */
.diary-entry-title {
  font-family: 'Caveat', 'Noto Serif JP', cursive;
  font-size: 18px;
  font-weight: 600;
  color: var(--diary-ink-1, #000000);
  margin-bottom: 8px;
  position: relative;
  display: inline-block;
  z-index: 1;
}

.diary-entry-title::after {
  content: '';
  position: absolute;
  bottom: -1px;
  left: 0;
  right: 0;
  height: 2px;
  background: var(--diary-ink-1, #000000);
  opacity: 0.2;
  transform: skewX(-5deg);
}

[data-theme="dark"] .diary-entry-title {
  color: var(--diary-ink-1, #e0e0e0);
}

/* æ—¥è®°æ­£æ–‡å®¹å™¨ - ä»¿ entry-body */
.diary-entry-body {
  flex: 1;
  overflow-y: auto;
  scrollbar-width: none;
  position: relative;
  z-index: 1;
}

.diary-entry-body::-webkit-scrollbar { display: none; }

/* æ—¥è®°å†…å®¹åŒºåŸŸ */
.diary-entry-content {
  font-family: 'Noto Serif JP', serif;
  font-size: 10px;
  line-height: 23px;
  color: var(--diary-ink-1, #000000);
}

[data-theme="dark"] .diary-entry-content {
  color: var(--diary-ink-1, #e0e0e0);
}

/* æ—¶é—´æ ‡è®° */
.diary-entry-content .time-mark {
  display: inline-block;
  font-size: 7px;
  color: var(--diary-ink-3, #7a7a7a);
  font-family: 'JetBrains Mono', monospace;
  margin: 8px 0 4px;
  padding: 1px 4px;
  background: var(--diary-line, rgba(0,0,0,0.05));
  border-radius: 2px;
}

/* ===== ä¾¿åˆ©è´´ç¬”è®° - ä»¿ diary-preview.html ===== */
.diary-sticky {
  position: absolute;
  padding: 8px;
  font-size: 8px;
  line-height: 1.35;
  box-shadow: 1px 2px 4px rgba(0,0,0,0.1);
  cursor: pointer;
  z-index: 50;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.diary-sticky:hover {
  transform: scale(1.04) !important;
  box-shadow: 2px 4px 8px rgba(0,0,0,0.15);
  z-index: 51;
}

/* ä¾¿ç­¾æ‹–åŠ¨çŠ¶æ€ */
.diary-sticky-dragging {
  opacity: 0.9;
  transform: scale(1.08) !important;
  box-shadow: 4px 8px 16px rgba(0,0,0,0.25) !important;
  z-index: 1000 !important;
  transition: none !important;
  cursor: grabbing !important;
}

/* å¯æ‹–åŠ¨ä¾¿ç­¾çš„å…‰æ ‡æç¤º */
.diary-sticky[data-note-id] {
  cursor: grab;
  user-select: none;
  -webkit-user-select: none;
  touch-action: none;
}

.diary-sticky.s1 {
  background: rgba(255,250,205,0.92);
  border-left: 2px solid #d4b800;
}

.diary-sticky.s2 {
  background: rgba(255,228,235,0.92);
  border-left: 2px solid #c44569;
}

.diary-sticky.s3 {
  background: rgba(230,240,255,0.92);
  border-left: 2px solid #5588cc;
}

.diary-sticky.s4 {
  background: rgba(220,252,231,0.92);
  border-left: 2px solid #22c55e;
}

.diary-sticky.s5 {
  background: rgba(243,232,255,0.92);
  border-left: 2px solid #a855f7;
}

.diary-sticky.s6 {
  background: rgba(255,237,213,0.92);
  border-left: 2px solid #f97316;
}

/* æš—è‰²ä¸»é¢˜ä¾¿ç­¾ */
[data-theme="dark"] .diary-sticky.s1 {
  background: rgba(80,75,40,0.92);
}
[data-theme="dark"] .diary-sticky.s2 {
  background: rgba(80,50,60,0.92);
}
[data-theme="dark"] .diary-sticky.s3 {
  background: rgba(45,55,75,0.92);
}
[data-theme="dark"] .diary-sticky.s4 {
  background: rgba(40,70,50,0.92);
}
[data-theme="dark"] .diary-sticky.s5 {
  background: rgba(60,45,70,0.92);
}
[data-theme="dark"] .diary-sticky.s6 {
  background: rgba(70,55,40,0.92);
}

.diary-sticky-head {
  font-size: 6px;
  color: var(--text-tertiary, #999);
  font-family: 'JetBrains Mono', monospace;
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 3px;
  opacity: 0.7;
  position: relative;
}

/* ä¾¿ç­¾å¤´éƒ¨å·¦ä¾§ä¿¡æ¯åŒºåŸŸ */
.diary-sticky-head-info {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex: 1;
  gap: 4px;
}

/* ä¾¿ç­¾åˆ é™¤æŒ‰é’® */
.diary-sticky-delete {
  position: absolute;
  top: -6px;
  right: -6px;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: rgba(0, 0, 0, 0.6);
  color: #ffffff;
  border: 1px solid rgba(255, 255, 255, 0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: 10px;
  line-height: 1;
  opacity: 0;
  transition: opacity 0.2s ease, transform 0.2s ease, background 0.2s ease;
  z-index: 10;
  font-family: Arial, sans-serif;
  font-weight: bold;
  padding: 0;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

/* æš—è‰²ä¸»é¢˜åˆ é™¤æŒ‰é’® */
[data-theme="dark"] .diary-sticky-delete {
  background: rgba(255, 255, 255, 0.8);
  color: #000000;
  border-color: rgba(0, 0, 0, 0.2);
}

/* é¼ æ ‡æ‚¬åœä¾¿ç­¾æ—¶æ˜¾ç¤ºåˆ é™¤æŒ‰é’® */
.diary-sticky:hover .diary-sticky-delete {
  opacity: 1;
}

/* åˆ é™¤æŒ‰é’®hoveræ•ˆæœ */
.diary-sticky-delete:hover {
  transform: scale(1.15);
  background: rgba(220, 38, 38, 0.9);
  border-color: rgba(255, 255, 255, 0.5);
  box-shadow: 0 2px 6px rgba(220, 38, 38, 0.4);
}

[data-theme="dark"] .diary-sticky-delete:hover {
  background: rgba(239, 68, 68, 0.9);
  color: #ffffff;
  border-color: rgba(255, 255, 255, 0.3);
}

/* ç‚¹å‡»åˆ é™¤æŒ‰é’®æ—¶é˜»æ­¢ä¾¿ç­¾æ‹–åŠ¨ */
.diary-sticky-delete:active {
  transform: scale(1.05);
}

.diary-sticky-body {
  font-family: 'Caveat', 'Noto Serif JP', cursive;
  font-size: 10px;
  color: var(--text-primary, #000000);
}

[data-theme="dark"] .diary-sticky-body {
  color: var(--text-primary, #ffffff);
}

/* ç¬”è®°åŒºåŸŸæ ‡é¢˜ */
.diary-notes-section {
  margin-top: 12px;
  padding-top: 8px;
  border-top: 1px dashed var(--diary-line, rgba(0,0,0,0.05));
  position: relative;
  z-index: 1;
}

[data-theme="dark"] .diary-notes-section {
  border-top-color: rgba(255,255,255,0.04);
}

.diary-notes-title {
  font-size: 7px;
  font-weight: 600;
  color: var(--text-tertiary, #999);
  margin-bottom: 6px;
  text-transform: uppercase;
  letter-spacing: 1px;
  font-family: 'JetBrains Mono', monospace;
  display: flex;
  align-items: center;
  gap: 4px;
}

.diary-notes-title::before {
  content: 'ğŸ“Œ';
  font-size: 8px;
}

/* ç›®å½•é¡¹æ ·å¼è¡¥å…… */
.diary-idx-mood {
  font-size: 12px;
  margin-left: 4px;
}

.diary-idx-page {
  width: 20px;
  text-align: right;
  font-size: 9px;
  color: var(--text-tertiary, #999);
  font-family: 'JetBrains Mono', monospace;
}

/* ==================== End æ—¥è®°æœ¬ç³»ç»Ÿ ==================== */

/* ==================== ç”¨æˆ·å¥½æ„Ÿåº¦è°ƒæ•´ç³»ç»Ÿ ==================== */

/* æ¨¡æ€æ¡†é®ç½© - ä¸æ¨¡ç³Š */
.user-affection-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
  z-index: 2000;
}

.user-affection-overlay.active {
  opacity: 1;
  pointer-events: auto;
}

/* æ¨¡æ€æ¡† - å¼‚å½¢ä¿¡å°è®¾è®¡ï¼ˆå±å¹•æ­£ä¸­é—´ï¼‰ */
.user-affection-modal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.9);
  width: 100%;
  max-width: 320px;
  background: var(--bg-primary, #fff);
  clip-path: polygon(
    0 16px, 16px 0,
    calc(100% - 16px) 0, 100% 16px,
    100% 100%, 0 100%
  );
  padding: 28px 20px 20px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
  opacity: 0;
  pointer-events: none;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 2001;
}

.user-affection-modal.active {
  transform: translate(-50%, -50%) scale(1);
  opacity: 1;
  pointer-events: auto;
}

/* è£…é¥°æ‹–åŠ¨æ¡ */
.user-affection-modal::before {
  content: '';
  position: absolute;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  width: 32px;
  height: 3px;
  background: var(--border-color, #ddd);
  border-radius: 2px;
}

/* æ¨¡æ€æ¡†å¤´éƒ¨ - ç²¾è‡´ç´§å‡‘ */
.user-affection-header {
  text-align: center;
  margin-bottom: 20px;
  padding-bottom: 16px;
  border-bottom: 1px dashed var(--border-color, #ddd);
  position: relative;
}

/* å¤´éƒ¨çˆ±å¿ƒè£…é¥° */
.user-affection-header::after {
  content: 'â™¡';
  position: absolute;
  bottom: -9px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--bg-primary, #fff);
  padding: 0 10px;
  font-size: 12px;
  color: var(--text-tertiary, #999);
}

.user-affection-header h3 {
  font-size: 13px;
  font-weight: 700;
  color: var(--text-primary, #000);
  margin: 0 0 4px;
  letter-spacing: 0.5px;
  text-transform: uppercase;
}

.user-affection-header p {
  font-size: 9px;
  color: var(--text-tertiary, #999);
  letter-spacing: 1.2px;
  text-transform: uppercase;
  margin: 0;
}

/* å…³é—­æŒ‰é’® - å¼‚å½¢ */
.user-affection-close {
  position: absolute;
  top: 24px;
  right: 20px;
  width: 28px;
  height: 28px;
  border: 1.5px solid var(--border-color, #ddd);
  background: var(--bg-secondary, #f5f5f5);
  clip-path: polygon(
    5px 0, calc(100% - 5px) 0,
    100% 5px, 100% calc(100% - 5px),
    calc(100% - 5px) 100%, 5px 100%,
    0 calc(100% - 5px), 0 5px
  );
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  z-index: 10;
}

.user-affection-close:hover {
  background: var(--text-primary, #000);
  border-color: var(--text-primary, #000);
}

.user-affection-close::before,
.user-affection-close::after {
  content: '';
  position: absolute;
  width: 12px;
  height: 2px;
  background: var(--text-secondary, #666);
  transition: background 0.3s ease;
}

.user-affection-close:hover::before,
.user-affection-close:hover::after {
  background: var(--bg-primary, #fff);
}

.user-affection-close::before {
  transform: rotate(45deg);
}

.user-affection-close::after {
  transform: rotate(-45deg);
}

/* æ¨¡æ€æ¡†ä¸»ä½“ */
.user-affection-body {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.user-affection-slider-container,
.user-affection-reason-container {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

/* å­—æ®µæ ‡ç­¾ - å¸¦è±å½¢è£…é¥° */
.user-affection-slider-container label,
.user-affection-reason-container label {
  font-size: 10px;
  font-weight: 600;
  color: var(--text-secondary, #666);
  letter-spacing: 0.5px;
  text-transform: uppercase;
  display: flex;
  align-items: center;
  gap: 6px;
}

.user-affection-slider-container label::before,
.user-affection-reason-container label::before {
  content: '';
  width: 5px;
  height: 5px;
  background: var(--text-primary, #000);
  clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
}

.user-affection-slider-container span {
  color: var(--text-primary, #000);
  font-size: 14px;
  font-weight: 700;
}

/* æ»‘å—æ ·å¼ - é»‘ç™½ç° */
#userAffectionSlider {
  width: 100%;
  height: 4px;
  background: var(--border-color, #ddd);
  outline: none;
  -webkit-appearance: none;
  appearance: none;
}

#userAffectionSlider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 16px;
  height: 16px;
  background: var(--text-primary, #000);
  clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
  cursor: pointer;
  transition: transform 0.2s ease;
}

#userAffectionSlider::-webkit-slider-thumb:hover {
  transform: scale(1.15);
}

#userAffectionSlider::-moz-range-thumb {
  width: 16px;
  height: 16px;
  background: var(--text-primary, #000);
  clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
  cursor: pointer;
  border: none;
  transition: transform 0.2s ease;
}

#userAffectionSlider::-moz-range-thumb:hover {
  transform: scale(1.15);
}

/* æ–‡æœ¬æ¡† - å¼‚å½¢ */
#userAffectionReason {
  width: 100%;
  padding: 10px 12px;
  border: 1.5px solid var(--border-color, #ddd);
  background: var(--bg-secondary, #f8f8f8);
  font-size: 12px;
  color: var(--text-primary, #000);
  font-family: inherit;
  line-height: 1.6;
  resize: vertical;
  min-height: 70px;
  transition: all 0.3s ease;
  clip-path: polygon(
    6px 0, calc(100% - 6px) 0,
    100% 6px, 100% calc(100% - 6px),
    calc(100% - 6px) 100%, 6px 100%,
    0 calc(100% - 6px), 0 6px
  );
}

#userAffectionReason:focus {
  outline: none;
  border-color: var(--text-primary, #000);
  background: var(--bg-primary, #fff);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

#userAffectionReason::placeholder {
  color: var(--text-tertiary, #999);
  font-size: 11px;
}

/* æ¨¡æ€æ¡†åº•éƒ¨ */
.user-affection-footer {
  display: flex;
  gap: 10px;
  margin-top: 16px;
}

/* æŒ‰é’® - å¼‚å½¢é»‘ç™½ç° */
.user-affection-cancel,
.user-affection-save {
  flex: 1;
  padding: 11px;
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 0.8px;
  text-transform: uppercase;
  cursor: pointer;
  transition: all 0.3s ease;
  clip-path: polygon(
    6px 0, calc(100% - 6px) 0,
    100% 6px, 100% calc(100% - 6px),
    calc(100% - 6px) 100%, 6px 100%,
    0 calc(100% - 6px), 0 6px
  );
}

.user-affection-cancel {
  background: var(--bg-secondary, #f5f5f5);
  border: 1.5px solid var(--border-color, #ddd);
  color: var(--text-secondary, #666);
}

.user-affection-cancel:hover {
  background: var(--border-color, #ddd);
}

.user-affection-save {
  background: var(--text-primary, #000);
  border: 1.5px solid var(--text-primary, #000);
  color: var(--bg-primary, #fff);
  position: relative;
  overflow: hidden;
}

.user-affection-save::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 50%;
  transform: translate(-50%, -50%);
  transition: width 0.6s ease, height 0.6s ease;
}

.user-affection-save:hover::before {
  width: 200px;
  height: 200px;
}

.user-affection-save:active,
.user-affection-cancel:active {
  transform: scale(0.98);
}

/* æš—è‰²æ¨¡å¼é€‚é… */
[data-theme="dark"] .user-affection-overlay {
  background: rgba(0, 0, 0, 0.7);
}

[data-theme="dark"] #userAffectionSlider {
  background: #333;
}

/* ==================== End ç”¨æˆ·å¥½æ„Ÿåº¦è°ƒæ•´ç³»ç»Ÿ ==================== */

/* ==================== Phone Dialer æ‹¨å·é¡µé¢ ==================== */

/* Dialer Screen Container */
/* ========== Phone Dialer App - æ–°è®¾è®¡ ========== */
.phone-dialer-main {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  position: relative;
  background: var(--bg-primary);
  overflow: hidden;
}

/* ========== Theme/Close Switch ========== */
.phone-theme-switch {
  position: absolute;
  top: max(12px, env(safe-area-inset-top, 12px));
  right: 16px;
  width: clamp(26px, 6.5vw, 28px);
  height: clamp(26px, 6.5vw, 28px);
  border-radius: 50%;
  background: var(--bg-tertiary);
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10;
  transition: transform 0.2s;
}

.phone-theme-switch:active {
  transform: scale(0.9);
}

.phone-theme-switch svg {
  width: clamp(13px, 3.2vw, 14px);
  height: clamp(13px, 3.2vw, 14px);
  fill: none;
  stroke: var(--text-secondary);
  stroke-width: 2;
}

/* ========== Main Content ========== */
.phone-main-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  /* ğŸ”¥ ä½¿ç”¨å…¨å±€App Header paddingå˜é‡ */
  padding: var(--app-header-total-padding) 20px 12px;
  min-height: 0;
}

/* ========== Number Display Area ========== */
.phone-display-area {
  text-align: center;
  padding: 16px 0 20px;
  position: relative;
  flex-shrink: 0;
}

/* Decorative pixel dots */
.phone-pixel-deco {
  position: absolute;
  width: 3px;
  height: 3px;
  background: var(--text-tertiary);
  opacity: 0.5;
}

.phone-pixel-deco:nth-child(1) { top: 10px; left: 20px; }
.phone-pixel-deco:nth-child(2) { top: 8px; left: 26px; }
.phone-pixel-deco:nth-child(3) { top: 14px; left: 23px; }
.phone-pixel-deco:nth-child(4) { top: 20px; right: 30px; }
.phone-pixel-deco:nth-child(5) { top: 16px; right: 24px; }

.phone-display-label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px;
  color: var(--text-tertiary);
  letter-spacing: 2px;
  text-transform: uppercase;
  margin-bottom: 12px;
}

.phone-display-number {
  font-family: 'Inter', sans-serif;
  font-size: 32px;
  font-weight: 300;
  color: var(--text-primary);
  letter-spacing: 2px;
  min-height: 40px;
  transition: all 0.15s ease;
}

.phone-display-number.empty {
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 14px;
  font-weight: 300;
  color: var(--text-tertiary);
  letter-spacing: 1px;
}

.phone-display-hint {
  font-family: 'JetBrains Mono', monospace;
  font-size: 9px;
  color: var(--text-tertiary);
  margin-top: 8px;
  opacity: 0;
  transition: opacity 0.3s;
}

.phone-display-hint.show {
  opacity: 1;
}

/* ========== Dialpad ========== */
.phone-dialpad {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  padding: 0 8px;
  min-height: 0;
  max-height: 400px;
}

.phone-key-row {
  display: flex;
  justify-content: center;
  gap: clamp(12px, 4vw, 20px);
  margin-bottom: clamp(10px, 2.5vh, 14px);
}

.phone-key-row:last-child {
  margin-bottom: 0;
}

.phone-key {
  width: clamp(60px, 18vw, 72px);
  height: clamp(60px, 18vw, 72px);
  border-radius: 50%;
  background: var(--bg-tertiary);
  border: none;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.1s ease;
  position: relative;
  overflow: hidden;
}

.phone-key:active {
  background: var(--border-color);
  transform: scale(0.95);
}

.phone-key-num {
  font-family: 'Inter', sans-serif;
  font-size: clamp(26px, 7vw, 30px);
  font-weight: 400;
  color: var(--text-primary);
  line-height: 1;
}

.phone-key-letters {
  font-family: 'JetBrains Mono', monospace;
  font-size: clamp(8px, 2vw, 9px);
  font-weight: 400;
  color: var(--text-secondary);
  letter-spacing: 1.5px;
  margin-top: 2px;
  text-transform: uppercase;
}

.phone-key.phone-symbol .phone-key-num {
  font-size: clamp(24px, 6vw, 28px);
  font-weight: 300;
}

/* ========== Action Row ========== */
.phone-action-row {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: clamp(24px, 6vw, 32px);
  padding: 16px 0 12px;
  flex-shrink: 0;
}

.phone-action-btn {
  width: clamp(40px, 10vw, 44px);
  height: clamp(40px, 10vw, 44px);
  border-radius: 50%;
  background: transparent;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.15s;
  opacity: 0.6;
}

.phone-action-btn:hover {
  opacity: 1;
}

.phone-action-btn svg {
  width: clamp(18px, 4.5vw, 20px);
  height: clamp(18px, 4.5vw, 20px);
  fill: none;
  stroke: var(--text-secondary);
  stroke-width: 1.5;
}

.phone-call-btn {
  width: clamp(56px, 14vw, 64px);
  height: clamp(56px, 14vw, 64px);
  border-radius: 50%;
  background: var(--accent-color);
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.15s;
}

.phone-call-btn:active {
  transform: scale(0.92);
}

.phone-call-btn svg {
  width: clamp(22px, 5.5vw, 26px);
  height: clamp(22px, 5.5vw, 26px);
  fill: none;
  stroke: var(--bg-primary);
  stroke-width: 2;
}

/* ========== Bottom Nav - ç¨å¾®æ”¾å¤§ç‰ˆï¼ˆé€‚ä¸­å¥½ç‚¹ï¼‰========== */
.phone-bottom-nav {
  background: var(--bg-secondary);
  border-top: 1px solid var(--border-color);
  display: flex;
  justify-content: space-around;
  padding: 8px 10px max(12px, calc(env(safe-area-inset-bottom, 8px) + 6px)); /* ç»§ç»­ç¼©çŸ­ä¸Šä¸‹padding */
  flex-shrink: 0;
  margin: 0 12px 16px 12px;
  border-radius: 14px;
  box-shadow: 0 -2px 12px rgba(0, 0, 0, 0.08);
}

.phone-nav-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  padding: 6px clamp(14px, 3.2vw, 18px); /* ç»§ç»­ç¼©çŸ­ä¸Šä¸‹padding */
  cursor: pointer;
  transition: all 0.2s;
  border-radius: 10px;
  min-height: 48px; /* ç»§ç»­ç¼©çŸ­æŒ‰é’®é«˜åº¦ */
}

.phone-nav-item:active {
  background: var(--bg-tertiary);
  transform: scale(0.95);
}

.phone-nav-item svg {
  width: clamp(18px, 4.5vw, 20px); /* ç»§ç»­ç¼©å°å›¾æ ‡ */
  height: clamp(18px, 4.5vw, 20px);
  fill: none;
  stroke: var(--text-tertiary);
  stroke-width: 1.5;
  transition: all 0.2s;
}

.phone-nav-item span {
  font-family: 'Noto Sans JP', sans-serif;
  font-size: clamp(10px, 2.5vw, 11px);
  color: var(--text-tertiary);
  transition: all 0.2s;
  font-weight: 500;
}

.phone-nav-item.active svg {
  stroke: var(--text-primary);
}

.phone-nav-item.active span {
  color: var(--text-primary);
}

.phone-nav-item.active {
  background: var(--bg-tertiary);
}

/* ========== Animations ========== */
@keyframes phoneNumBounce {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

.phone-display-number.bounce {
  animation: phoneNumBounce 0.12s ease;
}

/* Floating pixel animation */
@keyframes phonePixelFloat {
  0%, 100% { transform: translateY(0); opacity: 0.5; }
  50% { transform: translateY(-3px); opacity: 0.8; }
}

.phone-pixel-deco {
  animation: phonePixelFloat 3s ease-in-out infinite;
}

.phone-pixel-deco:nth-child(2) { animation-delay: 0.5s; }
.phone-pixel-deco:nth-child(3) { animation-delay: 1s; }
.phone-pixel-deco:nth-child(4) { animation-delay: 1.5s; }
.phone-pixel-deco:nth-child(5) { animation-delay: 2s; }

/* ========== Phoneé¡µé¢å†…éƒ¨å…ƒç´ åŠ¨ç”»ï¼ˆå‚è€ƒå¤–è§‚é¡µé¢ï¼‰========== */
.phone-display-area {
  animation: fadeIn 0.6s ease 0.1s both;
}

.phone-dialpad {
  animation: fadeIn 0.6s ease 0.2s both;
}

.phone-action-row {
  animation: fadeIn 0.6s ease 0.3s both;
}

.phone-bottom-nav {
  animation: fadeIn 0.6s ease 0.4s both;
}

/* ==================== Phone Recent Calls é€šè¯è®°å½• ==================== */

.phone-recent-content {
  flex: 1;
  display: none; /* Hidden by default, shown when Recent tab is clicked */
  flex-direction: column;
  padding: 20px 0 0;
  min-height: 0;
  overflow: hidden;
}

/* Toolbar */
.recent-toolbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 20px;
  flex-shrink: 0;
}

.recent-toolbar-btn {
  font-family: 'Noto Sans JP', 'Inter', sans-serif;
  font-size: 15px;
  font-weight: 400;
  color: var(--text-secondary);
  background: none;
  border: none;
  cursor: pointer;
  padding: 6px 0;
  transition: color 0.2s;
}

.recent-toolbar-btn:hover {
  color: var(--text-primary);
}

/* Filter Tabs */
.recent-filter-tabs {
  display: flex;
  background: var(--bg-tertiary);
  border-radius: 20px;
  padding: 3px;
}

.recent-filter-tab {
  font-family: 'Noto Sans JP', 'Inter', sans-serif;
  font-size: 13px;
  font-weight: 400;
  color: var(--text-secondary);
  background: none;
  border: none;
  padding: 6px 14px;
  cursor: pointer;
  border-radius: 17px;
  transition: all 0.2s;
}

.recent-filter-tab.active {
  color: var(--text-primary);
  background: var(--bg-primary);
  box-shadow: 0 1px 3px rgba(0,0,0,0.06);
}

/* Filter Icon */
.recent-filter-icon {
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  cursor: pointer;
}

.recent-filter-icon svg {
  width: 20px;
  height: 20px;
  stroke: var(--text-secondary);
  stroke-width: 1.5;
  fill: none;
}

.recent-badge {
  position: absolute;
  top: 0;
  right: 0;
  min-width: 18px;
  height: 18px;
  background: var(--text-primary);
  color: var(--bg-primary);
  font-family: 'Space Mono', monospace;
  font-size: 9px;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 5px;
  border-radius: 9px;
}

/* Title Section */
.recent-title-section {
  padding: 12px 24px 8px;
  flex-shrink: 0;
  position: relative;
}

.recent-pixel-deco {
  position: absolute;
  width: 3px;
  height: 3px;
  background: var(--text-tertiary);
  opacity: 0.5;
  animation: recentPixelFloat 3s ease-in-out infinite;
}

.recent-pixel-deco:nth-child(1) { top: 8px; right: 40px; animation-delay: 0s; }
.recent-pixel-deco:nth-child(2) { top: 12px; right: 34px; animation-delay: 0.5s; }
.recent-pixel-deco:nth-child(3) { top: 6px; right: 28px; animation-delay: 1s; }

@keyframes recentPixelFloat {
  0%, 100% { transform: translateY(0); opacity: 0.5; }
  50% { transform: translateY(-3px); opacity: 0.8; }
}

.recent-title {
  font-family: 'Noto Serif JP', serif;
  font-size: 26px;
  font-weight: 500;
  color: var(--text-primary);
  letter-spacing: 0.02em;
}

/* Search Bar */
.recent-search-container {
  padding: 0 20px;
  margin-bottom: 12px;
  flex-shrink: 0;
}

.recent-search-bar {
  display: flex;
  align-items: center;
  background: var(--bg-tertiary);
  border-radius: 12px;
  padding: 10px 14px;
  gap: 10px;
}

.recent-search-bar svg {
  width: 16px;
  height: 16px;
  stroke: var(--text-tertiary);
  stroke-width: 1.5;
  fill: none;
  flex-shrink: 0;
}

.recent-search-bar input {
  flex: 1;
  background: none;
  border: none;
  outline: none;
  font-family: inherit;
  font-size: 14px;
  color: var(--text-primary);
}

.recent-search-bar input::placeholder {
  color: var(--text-tertiary);
}

/* Voice Button */
.recent-voice-btn {
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--bg-primary);
  border-radius: 8px;
  cursor: pointer;
  transition: transform 0.2s;
  flex-shrink: 0;
}

.recent-voice-btn:active {
  transform: scale(0.95);
}

.recent-voice-btn svg {
  width: 14px;
  height: 14px;
  stroke: var(--text-secondary);
  stroke-width: 1.5;
  fill: none;
}

/* Content Scroll */
.recent-content-scroll {
  flex: 1;
  overflow-y: auto;
  padding: 0 16px;
  min-height: 0;
}

/* Promo Card */
.recent-promo-card {
  background: var(--bg-primary);
  border-radius: 16px;
  padding: 14px 16px;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid var(--border-color);
}

.recent-promo-card:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.04);
}

[data-theme="dark"] .recent-promo-card:hover {
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
}

.recent-promo-card:active {
  transform: scale(0.98);
}

.recent-promo-avatar {
  width: 44px;
  height: 44px;
  border-radius: 12px;
  background: var(--bg-tertiary);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  flex-shrink: 0;
}

.recent-promo-avatar svg {
  width: 22px;
  height: 22px;
  stroke: var(--text-secondary);
  stroke-width: 1.2;
  fill: none;
}

.recent-promo-avatar-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.recent-promo-info {
  flex: 1;
  min-width: 0;
}

.recent-promo-title {
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 15px;
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: 2px;
}

.recent-promo-subtitle {
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 12px;
  color: var(--text-tertiary);
}

.recent-promo-arrow {
  flex-shrink: 0;
}

.recent-promo-arrow svg {
  width: 16px;
  height: 16px;
  stroke: var(--text-tertiary);
  stroke-width: 1.5;
  fill: none;
}

/* Call List */
.recent-call-list {
  display: flex;
  flex-direction: column;
}

/* Call Item */
.recent-call-item {
  display: flex;
  align-items: center;
  padding: 12px 8px;
  gap: 12px;
  cursor: pointer;
  transition: background 0.15s;
  border-radius: 12px;
  margin-bottom: 2px;
  opacity: 0;
  transform: translateY(8px);
  animation: recentFadeInUp 0.3s ease forwards;
}

.recent-call-item:nth-child(1) { animation-delay: 0.05s; }
.recent-call-item:nth-child(2) { animation-delay: 0.1s; }
.recent-call-item:nth-child(3) { animation-delay: 0.15s; }
.recent-call-item:nth-child(4) { animation-delay: 0.2s; }
.recent-call-item:nth-child(5) { animation-delay: 0.25s; }
.recent-call-item:nth-child(6) { animation-delay: 0.3s; }
.recent-call-item:nth-child(7) { animation-delay: 0.35s; }
.recent-call-item:nth-child(8) { animation-delay: 0.4s; }
.recent-call-item:nth-child(9) { animation-delay: 0.45s; }
.recent-call-item:nth-child(10) { animation-delay: 0.5s; }

@keyframes recentFadeInUp {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ========== Recenté¡µé¢è¿›å…¥åŠ¨ç”»ï¼ˆä¸KeypadåŒæ­¥ï¼‰========== */
.phone-recent-content.animating .recent-toolbar {
  animation: fadeIn 0.6s ease 0.1s both;
}

.phone-recent-content.animating .recent-title-section {
  animation: fadeIn 0.6s ease 0.15s both;
}

.phone-recent-content.animating .recent-search-bar {
  animation: fadeIn 0.6s ease 0.2s both;
}

.phone-recent-content.animating .recent-promo-card {
  animation: fadeIn 0.6s ease 0.25s both;
}

.phone-recent-content.animating .recent-call-list {
  animation: fadeIn 0.6s ease 0.3s both;
}

.recent-call-item:hover {
  background: var(--bg-tertiary);
}

.recent-call-item:active {
  background: var(--border-color);
}

/* Call Avatar */
.recent-call-avatar {
  width: 46px;
  height: 46px;
  border-radius: 50%;
  background: var(--bg-tertiary);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  overflow: hidden;
}

.recent-call-avatar svg {
  width: 22px;
  height: 22px;
  stroke: var(--text-tertiary);
  stroke-width: 1.2;
  fill: none;
}

.recent-call-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.recent-call-avatar.has-image {
  background: linear-gradient(135deg, var(--text-tertiary), var(--text-secondary));
}

.recent-call-avatar span {
  color: var(--bg-primary);
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 16px;
  font-weight: 500;
}

/* Call Info */
.recent-call-info {
  flex: 1;
  min-width: 0;
}

.recent-call-number {
  font-family: 'Inter', sans-serif;
  font-size: 15px;
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: 3px;
  display: flex;
  align-items: center;
  gap: 6px;
}

.recent-call-number.missed {
  color: #8a6a5a;
}

[data-theme="dark"] .recent-call-number.missed {
  color: #9a7a6a;
}

/* Call Type Icon */
.recent-call-type {
  width: 12px;
  height: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.recent-call-type svg {
  width: 10px;
  height: 10px;
  stroke-width: 2;
  fill: none;
}

.recent-call-type.outgoing svg { stroke: #6a7a6a; }
.recent-call-type.missed svg { stroke: #8a6a5a; }
.recent-call-type.incoming svg { stroke: var(--text-secondary); }

[data-theme="dark"] .recent-call-type.outgoing svg { stroke: #7a8a7a; }
[data-theme="dark"] .recent-call-type.missed svg { stroke: #9a7a6a; }

/* Call Tag */
.recent-call-tag {
  display: flex;
  align-items: center;
  gap: 4px;
  font-family: 'Noto Sans JP', 'Inter', sans-serif;
  font-size: 11px;
  color: var(--text-tertiary);
}

.recent-call-tag svg {
  width: 12px;
  height: 12px;
  stroke: #6a7a6a;
  stroke-width: 1.5;
  fill: none;
}

/* Call Meta */
.recent-call-meta {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 6px;
}

.recent-call-time {
  font-family: 'Space Mono', monospace;
  font-size: 12px;
  color: var(--text-tertiary);
}

.recent-call-info-btn {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  border: 1px solid var(--border-color);
  background: transparent;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.15s;
}

.recent-call-info-btn:hover {
  background: var(--bg-tertiary);
  border-color: var(--text-secondary);
}

.recent-call-info-btn svg {
  width: 14px;
  height: 14px;
  stroke: var(--text-secondary);
  stroke-width: 1.5;
  fill: none;
}

/* Divider */
.recent-call-divider {
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--border-color), transparent);
  margin: 2px 8px;
}

/* Empty State */
.recent-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
  text-align: center;
}

.recent-empty-state svg {
  width: 48px;
  height: 48px;
  stroke: var(--text-tertiary);
  stroke-width: 1;
  fill: none;
  margin-bottom: 16px;
  opacity: 0.5;
}

.recent-empty-text {
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 14px;
  color: var(--text-tertiary);
  margin-bottom: 4px;
}

.recent-empty-subtext {
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 12px;
  color: var(--text-tertiary);
}

/* ==================== End Phone Recent Calls ==================== */

/* æ‹¨å·æŒ‰é”®ç‚¹å‡»åŠ¨ç”» - å¢å¼ºç‰ˆ */
.phone-key.pressing {
  animation: phoneKeyPressEffect 0.15s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

@keyframes phoneKeyPressEffect {
  0% {
    transform: scale(1);
    box-shadow: 0 0 0 0 rgba(var(--accent-rgb, 0, 0, 0), 0.4);
  }
  50% {
    transform: scale(0.92);
    box-shadow: 0 0 0 8px rgba(var(--accent-rgb, 0, 0, 0), 0);
  }
  100% {
    transform: scale(1);
    box-shadow: 0 0 0 0 rgba(var(--accent-rgb, 0, 0, 0), 0);
  }
}

/* æ‹¨å·å‘¼å«æŒ‰é’®åŠ¨ç”» - æ³¢çº¹æ•ˆæœ */
.phone-call-btn.calling {
  animation: phoneCallPulse 1.2s cubic-bezier(0.25, 0.46, 0.45, 0.94) infinite;
}

@keyframes phoneCallPulse {
  0% {
    box-shadow: 0 0 0 0 rgba(var(--accent-rgb, 0, 0, 0), 0.6);
  }
  50% {
    box-shadow: 0 0 0 12px rgba(var(--accent-rgb, 0, 0, 0), 0);
  }
  100% {
    box-shadow: 0 0 0 0 rgba(var(--accent-rgb, 0, 0, 0), 0);
  }
}

/* ========================================
   è”ç³»äººè¯¦æƒ…é¡µé¢ (Contact Detail View)
   ======================================== */

.phone-contact-detail {
  position: absolute;
  inset: 0;
  background: var(--bg-primary);
  z-index: 50;
  display: flex;
  flex-direction: column;
  transform: translateX(100%);
  transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
}

.phone-contact-detail.show {
  transform: translateX(0);
}

/* Contact Detail Header */
.contact-detail-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  /* ğŸ”¥ ä½¿ç”¨å…¨å±€App Header paddingå˜é‡ï¼ˆmaxä¿ç•™ä»¥ç¡®ä¿æœ€å°å€¼ï¼‰ */
  padding: max(var(--app-header-total-padding), 20px) 16px 12px;
  flex-shrink: 0;
}

.contact-back-btn,
.contact-more-btn {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: var(--bg-tertiary);
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s;
}

.contact-back-btn:hover,
.contact-more-btn:hover {
  background: var(--border-color);
}

.contact-back-btn:active,
.contact-more-btn:active {
  transform: scale(0.95);
}

.contact-back-btn svg,
.contact-more-btn svg {
  width: 20px;
  height: 20px;
  stroke: var(--text-primary);
  stroke-width: 1.5;
  fill: none;
}

/* Contact Detail Content */
.contact-detail-content {
  flex: 1;
  overflow-y: auto;
  padding-bottom: 100px;
}

.contact-detail-content::-webkit-scrollbar {
  display: none;
}

/* Contact Avatar Section */
.contact-avatar-section {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 40px 20px 32px;
}

.contact-avatar-large {
  position: relative;
  width: 120px;
  height: 120px;
  margin-bottom: 20px;
}

.contact-avatar-main {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  background: linear-gradient(145deg, var(--bg-tertiary), var(--border-color));
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
}

.contact-avatar-main::before {
  content: '';
  position: absolute;
  inset: 3px;
  border-radius: 50%;
  background: var(--bg-primary);
  z-index: 0;
}

.contact-avatar-main svg {
  width: 50px;
  height: 50px;
  stroke: var(--text-tertiary);
  stroke-width: 1;
  fill: none;
  position: relative;
  z-index: 1;
}

.contact-avatar-main span {
  font-family: 'Noto Serif JP', serif;
  font-size: 42px;
  font-weight: 500;
  color: var(--text-primary);
  position: relative;
  z-index: 1;
}

.contact-avatar-main img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%;
  position: relative;
  z-index: 1;
}

/* Contact Detail Info */
.contact-detail-info {
  text-align: center;
}

/* ç¬¬ä¸€è¡Œï¼šè”ç³»äººçŠ¶æ€ï¼ˆè”ç³»äºº/æœªçŸ¥ï¼‰ */
.contact-detail-status {
  font-family: 'Space Mono', monospace;
  font-size: 10px;
  color: var(--text-tertiary);
  letter-spacing: 0.05em;
  text-transform: uppercase;
  margin-bottom: 6px;
}

/* ç¬¬äºŒè¡Œï¼šåå­—ï¼ˆå¤‡æ³¨å/è§’è‰²åï¼‰ */
.contact-detail-label {
  font-family: 'Inter', sans-serif;
  font-size: 24px;
  font-weight: 600;
  color: var(--text-primary);
  letter-spacing: -0.02em;
  margin-bottom: 4px;
}

/* ç¬¬ä¸‰è¡Œï¼šç”µè¯å·ç  */
.contact-detail-number {
  font-family: 'JetBrains Mono', monospace;
  font-size: 14px;
  color: var(--text-secondary);
  letter-spacing: 0.02em;
}

/* Contact Action Buttons */
.contact-action-buttons {
  display: flex;
  justify-content: center;
  gap: 20px;
  padding: 0 20px 24px;
}

.contact-action-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  transition: transform 0.2s;
}

.contact-action-btn:active {
  transform: scale(0.95);
}

.contact-action-icon {
  width: 56px;
  height: 56px;
  border-radius: 50%;
  background: var(--bg-tertiary);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
}

.contact-action-btn:hover .contact-action-icon {
  background: var(--border-color);
  transform: translateY(-2px);
}

.contact-action-icon svg {
  width: 24px;
  height: 24px;
  stroke: var(--text-primary);
  stroke-width: 1.5;
  fill: none;
}

.contact-action-label {
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 11px;
  color: var(--text-secondary);
}

/* Contact Info Section */
.contact-info-section {
  padding: 0 16px;
}

/* Contact History Card - å¼‚å½¢è®¾è®¡ */
.contact-history-card {
  background: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 20px 4px 20px 4px;
  margin-bottom: 12px;
  overflow: hidden;
}

.contact-card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 16px;
  cursor: pointer;
  transition: background 0.15s;
}

.contact-card-header:hover {
  background: var(--bg-tertiary);
}

.contact-card-title {
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 14px;
  font-weight: 500;
  color: var(--text-primary);
  display: flex;
  align-items: center;
  gap: 8px;
}

.contact-card-title svg {
  width: 16px;
  height: 16px;
  stroke: var(--text-secondary);
  stroke-width: 1.5;
  fill: none;
}

.contact-card-badge {
  font-family: 'Space Mono', monospace;
  font-size: 10px;
  color: var(--text-tertiary);
  padding: 2px 8px;
  background: var(--bg-tertiary);
  border-radius: 10px;
}

.contact-card-arrow {
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform 0.3s;
}

.contact-card-arrow svg {
  width: 16px;
  height: 16px;
  stroke: var(--text-tertiary);
  stroke-width: 1.5;
  fill: none;
}

.contact-card-arrow.expanded {
  transform: rotate(180deg);
}

/* Contact Card Content */
.contact-card-content {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.4s cubic-bezier(0.32, 0.72, 0, 1);
}

.contact-card-content.expanded {
  max-height: 600px;
}

.contact-card-content-inner {
  padding: 0 16px 16px;
  border-top: 1px solid var(--border-color);
}

/* Contact History Item */
.contact-history-item {
  display: flex;
  align-items: flex-start;
  padding: 14px 0;
  gap: 12px;
  border-bottom: 1px solid var(--border-color);
  cursor: pointer;
  transition: background 0.15s;
}

.contact-history-item:last-child {
  border-bottom: none;
}

.contact-history-item:hover {
  background: var(--bg-tertiary);
  margin: 0 -16px;
  padding: 14px 16px;
}

.contact-history-type {
  width: 32px;
  height: 32px;
  border-radius: 8px 2px 8px 2px;
  background: var(--bg-tertiary);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.contact-history-type svg {
  width: 14px;
  height: 14px;
  stroke-width: 2;
  fill: none;
}

.contact-history-type.outgoing svg {
  stroke: #6a7a6a;
}

.contact-history-type.incoming svg {
  stroke: var(--text-secondary);
}

.contact-history-type.missed svg {
  stroke: #8a6a5a;
}

[data-theme='dark'] .contact-history-type.outgoing svg {
  stroke: #5a6a5a;
}

[data-theme='dark'] .contact-history-type.missed svg {
  stroke: #7a5a4a;
}

.contact-history-info {
  flex: 1;
}

.contact-history-label {
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 13px;
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: 2px;
}

.contact-history-label.missed {
  color: #8a6a5a;
}

[data-theme='dark'] .contact-history-label.missed {
  color: #7a5a4a;
}

.contact-history-time {
  font-family: 'Space Mono', monospace;
  font-size: 11px;
  color: var(--text-tertiary);
}

.contact-history-duration {
  font-family: 'Space Mono', monospace;
  font-size: 12px;
  color: var(--text-secondary);
  text-align: right;
}

/* Contact History Detail - é€šè¯è¯¦æƒ…å±•å¼€ */
.contact-history-detail {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease;
}

.contact-history-detail.expanded {
  max-height: 500px; /* ğŸ”¥ å¢åŠ é«˜åº¦ï¼Œç•™è¶³ç©ºé—´ */
}

.contact-history-detail-inner {
  padding: 12px;
  background: var(--bg-tertiary);
  border-radius: 12px 4px 12px 4px;
  margin-top: 10px;
  /* ğŸ”¥ æ·»åŠ æ»šåŠ¨åŠŸèƒ½ï¼Œé€šè¯è®°å½•å†é•¿ä¹Ÿèƒ½çœ‹å…¨ï¼ */
  max-height: 360px;
  overflow-y: auto;
  overflow-x: hidden;
}

/* ğŸ”¥ ç¾åŒ–æ»šåŠ¨æ¡ - ä¿æŒæ•´ä½“è®¾è®¡é£æ ¼ */
.contact-history-detail-inner::-webkit-scrollbar {
  width: 4px;
}

.contact-history-detail-inner::-webkit-scrollbar-track {
  background: transparent;
}

.contact-history-detail-inner::-webkit-scrollbar-thumb {
  background: var(--text-tertiary);
  border-radius: 2px;
  opacity: 0.3;
}

.contact-history-detail-inner::-webkit-scrollbar-thumb:hover {
  background: var(--text-secondary);
}

.contact-transcript-item {
  display: flex;
  gap: 10px;
  padding: 8px 0;
}

.contact-transcript-line {
  width: 2px;
  background: #6a7a6a;
  border-radius: 1px;
  flex-shrink: 0;
}

.contact-transcript-line.user {
  background: var(--text-secondary);
}

[data-theme='dark'] .contact-transcript-line {
  background: #5a6a5a;
}

.contact-transcript-content {
  flex: 1;
}

.contact-transcript-time {
  font-family: 'Space Mono', monospace;
  font-size: 9px;
  color: var(--text-tertiary);
  margin-bottom: 4px;
}

.contact-transcript-text {
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 13px;
  color: var(--text-primary);
  line-height: 1.5;
}

/* Contact Options Card - å¼‚å½¢è®¾è®¡ */
.contact-options-card {
  background: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 4px 20px 4px 20px;
  overflow: hidden;
}

.contact-option-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 16px;
  cursor: pointer;
  transition: background 0.15s;
  border-bottom: 1px solid var(--border-color);
}

.contact-option-item:last-child {
  border-bottom: none;
}

.contact-option-item:hover {
  background: var(--bg-tertiary);
}

.contact-option-item:active {
  background: var(--border-color);
}

.contact-option-item span {
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 14px;
  color: var(--text-primary);
}

.contact-option-item.danger span {
  color: #8a6a5a;
}

[data-theme='dark'] .contact-option-item.danger span {
  color: #7a5a4a;
}

.contact-option-item svg {
  width: 16px;
  height: 16px;
  stroke: var(--text-tertiary);
  stroke-width: 1.5;
  fill: none;
}

.contact-option-item.danger svg {
  stroke: #8a6a5a;
  opacity: 0.6;
}

[data-theme='dark'] .contact-option-item.danger svg {
  stroke: #7a5a4a;
}

/* Contact Detail Slide Animation */
.phone-contact-detail.animating {
  animation: contactSlideIn 0.4s cubic-bezier(0.32, 0.72, 0, 1) forwards;
}

@keyframes contactSlideIn {
  from {
    transform: translateX(100%);
  }
  to {
    transform: translateX(0);
  }
}

.phone-contact-detail.animating-out {
  animation: contactSlideOut 0.35s cubic-bezier(0.32, 0.72, 0, 1) forwards;
}

@keyframes contactSlideOut {
  from {
    transform: translateX(0);
  }
  to {
    transform: translateX(100%);
  }
}

/* ==================== Phone Contacts é€šè®¯å½• ==================== */

.phone-contacts-content {
  flex: 1;
  display: none;
  flex-direction: column;
  min-height: 0;
  overflow: hidden;
  position: relative;
}

/* Contacts Header */
.contacts-header {
  /* ğŸ”¥ ä½¿ç”¨å…¨å±€App Header paddingå˜é‡ */
  padding: var(--app-header-total-padding) 20px 12px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-shrink: 0;
}

.contacts-header-btn {
  width: 40px;
  height: 40px;
  background: var(--bg-tertiary);
  border: none;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.15s ease;
}

.contacts-header-btn:active {
  transform: scale(0.92);
  background: var(--border-color);
}

.contacts-header-btn svg {
  width: 18px;
  height: 18px;
  stroke: var(--text-primary);
  fill: none;
  stroke-width: 2;
  stroke-linecap: round;
  stroke-linejoin: round;
}

.contacts-title {
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 17px;
  font-weight: 500;
  color: var(--text-primary);
  letter-spacing: 0.5px;
}

/* Contacts Search Bar */
.contacts-search-section {
  padding: 0 20px 12px;
  flex-shrink: 0;
}

.contacts-search-bar {
  display: flex;
  align-items: center;
  gap: 10px;
  background: var(--bg-tertiary);
  border-radius: 14px;
  padding: 10px 14px;
  transition: all 0.2s ease;
}

.contacts-search-bar:focus-within {
  background: var(--border-color);
}

.contacts-search-icon {
  width: 16px;
  height: 16px;
  stroke: var(--text-tertiary);
  fill: none;
  stroke-width: 2;
  flex-shrink: 0;
}

.contacts-search-input {
  flex: 1;
  border: none;
  background: transparent;
  font-family: inherit;
  font-size: 14px;
  color: var(--text-primary);
  outline: none;
}

.contacts-search-input::placeholder {
  color: var(--text-tertiary);
  font-weight: 300;
}

.contacts-search-voice {
  width: 28px;
  height: 28px;
  background: var(--bg-primary);
  border: none;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.15s ease;
}

.contacts-search-voice:active {
  transform: scale(0.92);
}

.contacts-search-voice svg {
  width: 14px;
  height: 14px;
  stroke: var(--text-secondary);
  fill: none;
  stroke-width: 2;
}

/* Contacts My Card */
.contacts-mycard {
  margin: 0 20px 16px;
  padding: 14px;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 16px;
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
  transition: all 0.15s ease;
  flex-shrink: 0;
}

.contacts-mycard:active {
  transform: scale(0.98);
  background: var(--bg-tertiary);
}

.contacts-mycard-avatar {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  background: var(--bg-tertiary);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  flex-shrink: 0;
}

.contacts-mycard-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.contacts-mycard-avatar svg {
  width: 22px;
  height: 22px;
  stroke: var(--text-tertiary);
  fill: none;
  stroke-width: 1.5;
}

.contacts-mycard-info {
  flex: 1;
  min-width: 0;
}

.contacts-mycard-name {
  font-family: 'Inter', sans-serif;
  font-size: 15px;
  font-weight: 500;
  color: var(--text-primary);
}

.contacts-mycard-label {
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 11px;
  color: var(--text-tertiary);
  margin-top: 2px;
}

.contacts-mycard-arrow {
  width: 16px;
  height: 16px;
  stroke: var(--text-tertiary);
  fill: none;
  stroke-width: 1.5;
}

/* Contacts List Container */
.contacts-list-container {
  flex: 1;
  display: flex;
  position: relative;
  overflow: hidden;
  min-height: 0;
}

.contacts-list {
  flex: 1;
  overflow-y: auto;
  padding: 0 20px 100px 20px;
  scroll-behavior: smooth;
}

.contacts-list::-webkit-scrollbar {
  width: 0;
}

/* Contacts Letter Group */
.contacts-group {
  margin-bottom: 2px;
}

.contacts-group-letter {
  font-family: 'Caveat', cursive;
  font-size: 20px;
  font-weight: 600;
  color: var(--text-tertiary);
  padding: 10px 2px 6px;
  position: sticky;
  top: 0;
  background: var(--bg-primary);
  z-index: 5;
  display: flex;
  align-items: center;
  gap: 10px;
}

.contacts-group-letter::after {
  content: '';
  flex: 1;
  height: 1px;
  background: linear-gradient(90deg, var(--border-color), transparent);
}

/* Contacts Item */
.contacts-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 0;
  border-bottom: 1px solid var(--border-color);
  cursor: pointer;
  transition: all 0.12s ease;
  animation: contactsFadeInUp 0.25s ease forwards;
}

.contacts-item:last-child {
  border-bottom: none;
}

.contacts-item:active {
  background: rgba(128, 128, 128, 0.05);
  margin: 0 -6px;
  padding: 10px 6px;
  border-radius: 10px;
}

.contacts-item:nth-child(1) { animation-delay: 0.02s; }
.contacts-item:nth-child(2) { animation-delay: 0.04s; }
.contacts-item:nth-child(3) { animation-delay: 0.06s; }
.contacts-item:nth-child(4) { animation-delay: 0.08s; }
.contacts-item:nth-child(5) { animation-delay: 0.10s; }

@keyframes contactsFadeInUp {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.contacts-item-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: var(--bg-tertiary);
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 15px;
  font-weight: 500;
  color: var(--text-secondary);
  overflow: hidden;
  flex-shrink: 0;
}

.contacts-item-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.contacts-item-info {
  flex: 1;
  min-width: 0;
}

.contacts-item-name {
  font-family: 'Inter', sans-serif;
  font-size: 15px;
  font-weight: 400;
  color: var(--text-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.contacts-item-phone {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px;
  color: var(--text-tertiary);
  margin-top: 2px;
  letter-spacing: 0.5px;
}

/* Contacts Alphabet Index */
.contacts-alphabet-index {
  position: absolute;
  right: 2px;
  top: 50%;
  transform: translateY(-50%);
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 6px 2px;
  z-index: 20;
}

.contacts-index-letter {
  font-family: 'Caveat', cursive;
  font-size: 10px;
  font-weight: 600;
  color: var(--text-tertiary);
  width: 16px;
  height: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.1s ease;
  border-radius: 3px;
}

.contacts-index-letter:active,
.contacts-index-letter.active {
  color: var(--text-primary);
  background: rgba(128, 128, 128, 0.1);
  transform: scale(1.3);
}

/* Contacts Letter Indicator */
.contacts-letter-indicator {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0);
  width: 72px;
  height: 72px;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: 'Caveat', cursive;
  font-size: 38px;
  font-weight: 600;
  color: var(--text-primary);
  opacity: 0;
  transition: all 0.15s ease;
  z-index: 100;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
  pointer-events: none;
}

.contacts-letter-indicator.show {
  opacity: 1;
  transform: translate(-50%, -50%) scale(1);
}

/* Contacts Empty State */
.contacts-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
  text-align: center;
}

.contacts-empty-state svg {
  width: 64px;
  height: 64px;
  stroke: var(--text-tertiary);
  fill: none;
  stroke-width: 1;
  opacity: 0.5;
  margin-bottom: 16px;
}

.contacts-empty-text {
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 15px;
  color: var(--text-tertiary);
  margin-bottom: 8px;
}

.contacts-empty-subtext {
  font-family: 'Inter', sans-serif;
  font-size: 13px;
  color: var(--text-tertiary);
  opacity: 0.7;
}

/* ========== Contactsé¡µé¢è¿›å…¥åŠ¨ç”»ï¼ˆä¸RecentåŒæ­¥ï¼‰========== */
.phone-contacts-content.animating .contacts-header {
  animation: fadeIn 0.6s ease 0.1s both;
}

.phone-contacts-content.animating .contacts-search-section {
  animation: fadeIn 0.6s ease 0.15s both;
}

.phone-contacts-content.animating .contacts-mycard {
  animation: fadeIn 0.6s ease 0.2s both;
}

.phone-contacts-content.animating .contacts-list-container {
  animation: fadeIn 0.6s ease 0.25s both;
}

.phone-contacts-content.animating .contacts-alphabet-index {
  animation: alphabetIndexFadeIn 0.6s ease 0.3s both;
}

/* å­—æ¯ç´¢å¼•ä¸“ç”¨åŠ¨ç”»ï¼ˆä¿ç•™translateY(-50%)å‚ç›´å±…ä¸­å®šä½ï¼‰ */
@keyframes alphabetIndexFadeIn {
  from {
    opacity: 0;
    transform: translateY(-50%) translateX(10px);
  }
  to {
    opacity: 1;
    transform: translateY(-50%) translateX(0);
  }
}

/* ========================================
   é€šè¯ç•Œé¢æ ·å¼ (Call Screen Styles)
   ======================================== */

/* é€šè¯å±å¹•å®¹å™¨ */
.phone-call-screen {
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
  z-index: 8500; /* é«˜äºapp-screen(8000)ï¼Œç¡®ä¿é€šè¯ç•Œé¢å§‹ç»ˆåœ¨æœ€ä¸Šå±‚ */
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.phone-call-screen.hidden {
  display: none;
}

/* ç½‘æ ¼èƒŒæ™¯ */
.phone-call-screen::before {
  content: '';
  position: absolute;
  inset: 0;
  background-image:
    repeating-linear-gradient(0deg, transparent, transparent 19px, var(--border-primary) 19px, var(--border-primary) 20px),
    repeating-linear-gradient(90deg, transparent, transparent 19px, var(--border-primary) 19px, var(--border-primary) 20px);
  opacity: 0.4;
  pointer-events: none;
  z-index: 0;
}

/* è£…é¥°ç‚¹ */
.call-screen-deco {
  position: absolute;
  inset: 0;
  z-index: 0;
  pointer-events: none;
}

.call-deco-dot {
  position: absolute;
  width: 3px;
  height: 3px;
  background: var(--text-tertiary);
  border-radius: 50%;
  animation: callDotBlink 3s ease-in-out infinite;
}

.call-deco-dot:nth-child(1) { top: 140px; left: 48px; animation-delay: 0s; }
.call-deco-dot:nth-child(2) { top: 200px; right: 56px; animation-delay: 1s; }
.call-deco-dot:nth-child(3) { bottom: 260px; left: 64px; animation-delay: 2s; }
.call-deco-dot:nth-child(4) { bottom: 320px; right: 40px; animation-delay: 1.5s; }

@keyframes callDotBlink {
  0%, 100% { opacity: 0.2; }
  50% { opacity: 0.8; }
}

/* å†…å®¹å®¹å™¨ */
.call-content {
  position: relative;
  z-index: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding-top: 180px;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

/* åœ†å½¢å¤´åƒ + è½¨é“è£…é¥° */
.call-avatar-orbit {
  position: relative;
  width: 120px;
  height: 120px;
  margin-bottom: 40px;
}

/* å¤–åœˆè½¨é“ */
.call-orbit-ring {
  position: absolute;
  inset: 0;
  border: 1px solid var(--text-tertiary);
  border-radius: 50%;
  animation: callOrbitRotate 20s linear infinite;
}

.call-orbit-ring::before,
.call-orbit-ring::after {
  content: '';
  position: absolute;
  width: 6px;
  height: 6px;
  background: var(--text-secondary);
  border-radius: 50%;
  top: 50%;
  left: 50%;
}

.call-orbit-ring::before {
  transform: translate(-50%, -50%) translateY(-60px);
}

.call-orbit-ring::after {
  transform: translate(-50%, -50%) translateY(60px);
}

@keyframes callOrbitRotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* å¤´åƒåœ† */
.call-avatar-circle {
  position: absolute;
  inset: 12px;
  border-radius: 50%;
  background: var(--bg-primary);
  border: 2px solid var(--text-secondary);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

/* callingå’ŒincomingçŠ¶æ€çš„è„‰å†²åŠ¨ç”» */
.phone-call-screen.state-calling .call-avatar-circle,
.phone-call-screen.state-incoming .call-avatar-circle {
  animation: callAvatarPulse 2s ease-in-out infinite;
}

@keyframes callAvatarPulse {
  0%, 100% { transform: scale(1); opacity: 0.8; }
  50% { transform: scale(1.05); opacity: 1; }
}

.call-avatar-circle svg {
  width: 42px;
  height: 42px;
  stroke: var(--text-secondary);
  fill: none;
  stroke-width: 1.5;
}

/* å¤´åƒå›¾ç‰‡ */
.call-avatar-img {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  object-fit: cover;
}

/* åå­— */
.call-name {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  font-size: 36px;
  font-weight: 700;
  color: var(--text-primary);
  letter-spacing: -1.5px;
  margin-bottom: 8px;
  text-align: center;
}

/* çŠ¶æ€ */
.call-status {
  font-family: 'IBM Plex Mono', 'Courier Prime', monospace;
  font-size: 10px;
  color: var(--text-tertiary);
  letter-spacing: 2px;
  text-transform: uppercase;
  position: relative;
  padding: 0 16px;
  transition: all 0.3s ease;
}

.call-status::before,
.call-status::after {
  content: '';
  position: absolute;
  width: 8px;
  height: 1px;
  background: var(--text-tertiary);
  top: 50%;
}

.call-status::before { left: 0; }
.call-status::after { right: 0; }

/* é€šè¯æ—¶é•¿ */
.call-timer {
  font-family: 'IBM Plex Mono', 'Courier Prime', monospace;
  font-size: 28px;
  font-weight: 600;
  color: var(--text-primary);
  letter-spacing: 1px;
  margin-top: 20px;
  opacity: 0;
  transform: translateY(10px);
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.call-timer:not(.hidden) {
  opacity: 1;
  transform: translateY(0);
}

.call-timer.hidden {
  display: none;
}

/* æŒ‰é’®åŒºåŸŸ */
.call-actions {
  position: absolute;
  bottom: 48px;
  left: 32px;
  right: 32px;
  z-index: 1;
  transition: all 0.3s ease;
}

/* æŒ‰é’®å®¹å™¨ */
.call-btn-grid {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* connectedçŠ¶æ€çš„ç½‘æ ¼å¸ƒå±€ */
.phone-call-screen.state-connected .call-btn-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
}

/* èƒ¶å›ŠæŒ‰é’® */
.call-action-btn {
  height: 52px;
  background: var(--bg-primary);
  border: 1px solid var(--text-tertiary);
  border-radius: 26px;
  font-family: 'IBM Plex Mono', 'Courier Prime', monospace;
  font-size: 11px;
  font-weight: 600;
  color: var(--text-primary);
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  letter-spacing: 1px;
  text-transform: uppercase;
  position: relative;
  overflow: hidden;
  opacity: 0;
  transform: translateY(20px);
  animation: callBtnSlideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

.call-action-btn:nth-child(1) { animation-delay: 0.05s; }
.call-action-btn:nth-child(2) { animation-delay: 0.1s; }
.call-action-btn:nth-child(3) { animation-delay: 0.15s; }
.call-action-btn:nth-child(4) { animation-delay: 0.2s; }

@keyframes callBtnSlideUp {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* connectedçŠ¶æ€çš„åœ†å½¢æŒ‰é’® */
.phone-call-screen.state-connected .call-action-btn:not(.end) {
  aspect-ratio: 1;
  height: auto;
  border-radius: 50%;
  flex-direction: column;
  gap: 6px;
}

.phone-call-screen.state-connected .call-action-btn:not(.end) span {
  font-size: 9px;
  color: var(--text-tertiary);
}

/* EndæŒ‰é’®æ¨ªå‘å æ»¡ */
.call-action-btn.end {
  grid-column: 1 / -1;
}

.call-action-btn::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  padding: 1px;
  background: linear-gradient(135deg, var(--text-tertiary), transparent, var(--text-tertiary));
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  opacity: 0;
  transition: opacity 0.2s;
}

.call-action-btn:active {
  background: var(--bg-secondary);
  transform: scale(0.98);
}

.call-action-btn:active::before {
  opacity: 1;
}

.call-action-btn svg {
  width: 18px;
  height: 18px;
  stroke: var(--text-primary);
  fill: none;
  stroke-width: 1.5;
}

.phone-call-screen.state-connected .call-action-btn:not(.end) svg {
  width: 20px;
  height: 20px;
}

/* çŠ¶æ€åˆ‡æ¢æ—¶çš„æ·¡å…¥æ•ˆæœ */
@keyframes callFadeIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* ==================== å¯¹æ–¹å‘è¨€æ¡† + ç”¨æˆ·å›å¤ç³»ç»Ÿ ==================== */

/* å¤´åƒåŒ…è£…å™¨ */
.call-avatar-wrapper {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* å¯¹æ–¹å‘è¨€æ¡† - æ¶²æ€ç»ç’ƒæ•ˆæœ */
.call-speech-bubble {
  position: absolute;
  bottom: calc(100% + 16px);
  left: 50%;
  transform: translateX(-50%) translateY(20px) scale(0.9);
  width: max-content;
  min-width: 100px;
  max-width: min(320px, 85vw);
  padding: 12px 16px;
  /* æ¶²æ€ç»ç’ƒæ•ˆæœ */
  background: rgba(255, 255, 255, 0.15);
  backdrop-filter: blur(20px) saturate(150%);
  -webkit-backdrop-filter: blur(20px) saturate(150%);
  border: 1px solid rgba(255, 255, 255, 0.3);
  border-radius: 16px;
  cursor: pointer;
  z-index: 10;
  opacity: 0;
  pointer-events: none;
  transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
}

/* å°ä¸‰è§’ - æŒ‡å‘å¤´åƒ */
.call-speech-bubble::after {
  content: '';
  position: absolute;
  bottom: -8px;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-left: 8px solid transparent;
  border-right: 8px solid transparent;
  border-top: 8px solid rgba(255, 255, 255, 0.15);
  transition: opacity 0.3s ease;
}

/* éšè—çŠ¶æ€ */
.call-speech-bubble.hidden {
  opacity: 0;
  pointer-events: none;
  transform: translateX(-50%) translateY(20px) scale(0.9);
}

/* æ˜¾ç¤ºçŠ¶æ€ - å¼¹æ€§å¼¹å‡ºåŠ¨ç”» */
.call-speech-bubble.show {
  opacity: 1;
  pointer-events: auto;
  transform: translateX(-50%) translateY(0) scale(1);
}

/* åˆ‡æ¢åŠ¨ç”» - æ·¡å‡º */
.call-speech-bubble.switching-out {
  opacity: 0;
  pointer-events: none;
  transform: translateX(-50%) translateY(-10px) scale(0.95);
  transition: all 0.25s cubic-bezier(0.4, 0, 0.6, 1);
}

/* åˆ‡æ¢åŠ¨ç”» - æ·¡å…¥ */
.call-speech-bubble.switching-in {
  animation: bubbleSwitchIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

@keyframes bubbleSwitchIn {
  0% {
    opacity: 0;
    transform: translateX(-50%) translateY(15px) scale(0.92);
  }
  100% {
    opacity: 1;
    transform: translateX(-50%) translateY(0) scale(1);
  }
}

.call-speech-bubble:active {
  transform: translateX(-50%) translateY(0) scale(0.98);
  opacity: 0.9;
  transition: all 0.15s ease;
}

/* æš—è‰²æ¨¡å¼ */
[data-theme='dark'] .call-speech-bubble {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(255, 255, 255, 0.2);
}

[data-theme='dark'] .call-speech-bubble::after {
  border-top-color: rgba(255, 255, 255, 0.1);
}

/* äº®è‰²æ¨¡å¼ */
[data-theme='light'] .call-speech-bubble {
  background: rgba(255, 255, 255, 0.7);
  border-color: rgba(255, 255, 255, 0.8);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
}

[data-theme='light'] .call-speech-bubble::after {
  border-top-color: rgba(255, 255, 255, 0.7);
}

.call-speech-text {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  font-size: 14px;
  font-weight: 500;
  color: var(--text-primary);
  line-height: 1.5;
  margin-bottom: 4px;
}

.call-speech-indicator {
  font-family: 'IBM Plex Mono', 'Courier Prime', monospace;
  font-size: 9px;
  color: var(--text-tertiary);
  text-align: right;
  opacity: 0.6;
}

/* ç”¨æˆ·å›å¤åŒºåŸŸ - ç»å¯¹å®šä½åœ¨æ“ä½œæŒ‰é’®ä¸Šæ–¹ */
.call-user-replies {
  position: absolute;
  bottom: 220px;
  left: 32px;
  right: 32px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  align-items: center;
  z-index: 5;
  max-height: 270px;
  overflow-y: auto;
  transition: opacity 0.3s ease, transform 0.3s ease;
}

.call-user-replies.hidden {
  display: none;
}

/* å‘é€æ—¶çš„æ¶ˆå¤±åŠ¨ç”» */
.call-user-replies.sending {
  pointer-events: none;
}

/* çº¯æ–‡å­—å›å¤ - æ— èƒŒæ™¯æ¡† */
.call-user-reply-item {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  font-size: 15px;
  font-weight: 500;
  color: var(--text-primary);
  text-align: center;
  opacity: 0;
  transform: translateY(15px);
  animation: callReplyFloat 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
  transition: opacity 0.35s ease, transform 0.35s cubic-bezier(0.4, 0, 0.6, 1), filter 0.35s ease;
}

/* æœ€æ–°å›å¤ - å…‰æ™•æ•ˆæœåƒæ»šåŠ¨æ­Œè¯ */
.call-user-reply-item.latest {
  font-weight: 600;
  filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.6))
          drop-shadow(0 0 16px rgba(255, 255, 255, 0.4))
          drop-shadow(0 0 24px rgba(255, 255, 255, 0.2));
  animation: callReplyFloat 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards,
             callTextGlow 2s ease-in-out infinite;
}

/* å‘é€æ—¶çš„æ·¡å‡ºåŠ¨ç”» */
.call-user-reply-item.fade-out {
  opacity: 0 !important;
  transform: translateY(-20px) scale(0.9) !important;
  filter: drop-shadow(0 0 0 transparent) !important;
  animation: none !important;
}

@keyframes callReplyFloat {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes callTextGlow {
  0%, 100% {
    filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.6))
            drop-shadow(0 0 16px rgba(255, 255, 255, 0.4))
            drop-shadow(0 0 24px rgba(255, 255, 255, 0.2));
  }
  50% {
    filter: drop-shadow(0 0 12px rgba(255, 255, 255, 0.8))
            drop-shadow(0 0 24px rgba(255, 255, 255, 0.6))
            drop-shadow(0 0 36px rgba(255, 255, 255, 0.3));
  }
}

/* è¾“å…¥æ¡†å®¹å™¨ - è¦†ç›–åœ¨end callä½ç½® */
.phone-call-screen:not(.state-connected) .call-reply-input-container {
  display: none !important;
}

.call-reply-input-container {
  position: absolute;
  bottom: 48px;
  left: 32px;
  right: 32px;
  display: flex;
  gap: 8px;
  align-items: center;
  padding: 14px 16px;
  background: linear-gradient(
    135deg,
    rgba(var(--text-primary-rgb, 232, 232, 232), 0.15) 0%,
    rgba(var(--text-primary-rgb, 232, 232, 232), 0.05) 100%
  );
  backdrop-filter: blur(40px) saturate(180%);
  -webkit-backdrop-filter: blur(40px) saturate(180%);
  border: 1px solid rgba(255, 255, 255, 0.25);
  border-radius: 26px;
  z-index: 200;
  opacity: 0;
  transform: translateY(10px);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow:
    0 8px 32px rgba(0, 0, 0, 0.2),
    inset 0 1px 0 rgba(255, 255, 255, 0.2),
    inset 0 -1px 0 rgba(0, 0, 0, 0.1);
}

.call-reply-input-container:not(.hidden) {
  opacity: 1;
  transform: translateY(0);
}

.call-reply-input-container.hidden {
  display: none;
}

.call-reply-input {
  flex: 1;
  background: transparent;
  border: none;
  outline: none;
  font-family: inherit;
  font-size: 14px;
  color: var(--text-primary);
  padding: 4px 8px;
}

.call-reply-input::placeholder {
  color: var(--text-tertiary);
}

.call-reply-send-btn {
  width: 36px;
  height: 36px;
  flex-shrink: 0;
  background: linear-gradient(
    135deg,
    rgba(var(--text-primary-rgb, 232, 232, 232), 0.2) 0%,
    rgba(var(--text-primary-rgb, 232, 232, 232), 0.1) 100%
  );
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s;
  box-shadow:
    0 4px 16px rgba(0, 0, 0, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
}

.call-reply-send-btn:active {
  transform: scale(0.95);
  box-shadow:
    0 2px 8px rgba(0, 0, 0, 0.15),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
}

.call-reply-send-btn svg {
  width: 16px;
  height: 16px;
  stroke: var(--text-primary);
  fill: none;
  stroke-width: 2;
  stroke-linecap: round;
  stroke-linejoin: round;
  margin-left: 1px;
  margin-top: 1px;
}

/* RGBå˜é‡å®šä¹‰ - ç”¨äºèƒŒæ™¯æ¸å˜ */
:root {
  --text-primary-rgb: 0, 0, 0;
}

[data-theme='dark'] {
  --text-primary-rgb: 232, 232, 232;
}

[data-theme='light'] {
  --text-primary-rgb: 26, 26, 26;
}

/* ==================== End å¯¹è¯ç³»ç»Ÿæ ·å¼ ==================== */

.phone-call-screen.state-changing .call-content {
  animation: callFadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}


/* ==================== ç”¨æˆ·èµ„æ–™é€‰æ‹©å¼¹çª—ï¼ˆé€šè¯å‰ï¼‰ ==================== */

/* é®ç½©å±‚ */
.phone-profile-selector-overlay {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.6);
  z-index: 200;
  display: flex;
  align-items: flex-end;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.phone-profile-selector-overlay.active {
  opacity: 1;
  pointer-events: all;
}

/* åº•éƒ¨æŠ½å±‰ */
.phone-profile-selector-sheet {
  width: 100%;
  max-height: 70vh;
  background: var(--bg-primary);
  border-radius: 24px 24px 0 0;
  padding: 0;
  transform: translateY(100%);
  transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  display: flex;
  flex-direction: column;
  box-shadow: 0 -8px 32px rgba(0, 0, 0, 0.3);
}

.phone-profile-selector-overlay.active .phone-profile-selector-sheet {
  transform: translateY(0);
}

/* é¡¶éƒ¨æŠŠæ‰‹åŒºåŸŸ */
.phone-profile-selector-header {
  padding: 16px 20px 12px;
  border-bottom: 1px solid var(--border-color);
  flex-shrink: 0;
  text-align: center;
}

.phone-profile-selector-handle {
  width: 40px;
  height: 4px;
  background: var(--text-tertiary);
  border-radius: 2px;
  margin: 0 auto 16px;
  opacity: 0.6;
}

.phone-profile-selector-title {
  font-family: 'Inter', sans-serif;
  font-size: 18px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 4px;
}

.phone-profile-selector-subtitle {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px;
  color: var(--text-secondary);
  letter-spacing: 0.5px;
  text-transform: uppercase;
}

/* ç”¨æˆ·èµ„æ–™åˆ—è¡¨ */
.phone-profile-selector-list {
  padding: 12px 16px 24px;
  overflow-y: auto;
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

/* å•ä¸ªç”¨æˆ·èµ„æ–™é¡¹ */
.phone-profile-item {
  background: var(--bg-tertiary);
  border-radius: 16px;
  padding: 14px 16px;
  display: flex;
  align-items: center;
  gap: 14px;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  border: 1.5px solid transparent;
  position: relative;
  overflow: hidden;
}

.phone-profile-item:active {
  transform: scale(0.98);
  background: var(--border-color);
}

.phone-profile-item:hover {
  border-color: var(--text-tertiary);
}

/* ç”¨æˆ·å¤´åƒåœˆ */
.phone-profile-avatar {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--text-tertiary), var(--text-secondary));
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  font-family: 'Inter', sans-serif;
  font-size: 20px;
  font-weight: 600;
  color: var(--bg-primary);
  overflow: hidden;
  position: relative;
}

.phone-profile-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  position: absolute;
  inset: 0;
}

/* ç”¨æˆ·ä¿¡æ¯ */
.phone-profile-info {
  flex: 1;
  min-width: 0;
}

.phone-profile-name {
  font-family: 'Inter', sans-serif;
  font-size: 16px;
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: 4px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.phone-profile-number {
  font-family: 'JetBrains Mono', monospace;
  font-size: 13px;
  color: var(--text-secondary);
  letter-spacing: 0.5px;
}

/* æ— ç”µè¯å·ç æç¤º */
.phone-profile-no-number {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px;
  color: var(--text-tertiary);
  font-style: italic;
}

/* å³ä¾§ç®­å¤´ */
.phone-profile-arrow {
  width: 20px;
  height: 20px;
  flex-shrink: 0;
  opacity: 0.4;
  transition: opacity 0.2s, transform 0.2s;
}

.phone-profile-item:hover .phone-profile-arrow {
  opacity: 0.8;
  transform: translateX(2px);
}

.phone-profile-arrow svg {
  width: 100%;
  height: 100%;
  fill: none;
  stroke: var(--text-primary);
  stroke-width: 2;
  stroke-linecap: round;
  stroke-linejoin: round;
}

/* ç©ºçŠ¶æ€ */
.phone-profile-empty {
  text-align: center;
  padding: 40px 20px;
  color: var(--text-tertiary);
}

.phone-profile-empty-icon {
  width: 64px;
  height: 64px;
  margin: 0 auto 16px;
  opacity: 0.3;
}

.phone-profile-empty-icon svg {
  width: 100%;
  height: 100%;
  fill: none;
  stroke: currentColor;
  stroke-width: 1.5;
}

.phone-profile-empty-text {
  font-family: 'Inter', sans-serif;
  font-size: 14px;
  color: var(--text-secondary);
}

/* æ·±è‰²æ¨¡å¼ä¼˜åŒ– */
[data-theme="dark"] .phone-profile-selector-overlay {
  background: rgba(0, 0, 0, 0.8);
}

[data-theme="dark"] .phone-profile-item {
  background: rgba(255, 255, 255, 0.05);
}

[data-theme="dark"] .phone-profile-item:active {
  background: rgba(255, 255, 255, 0.1);
}

/* ==================== End ç”¨æˆ·èµ„æ–™é€‰æ‹©å¼¹çª— ==================== */

/* ==================== é€šè¯æ‚¬æµ®çƒ ==================== */

.call-floating-ball {
  position: fixed;
  right: 50px;
  bottom: 100px;
  width: 58px;
  height: 58px;
  cursor: pointer;
  z-index: 9999;
  opacity: 0;
  pointer-events: none;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  will-change: transform, opacity;
}

.call-floating-ball.hidden {
  opacity: 0;
  pointer-events: none;
  transform: scale(0.3) translateY(20px);
}

.call-floating-ball.show {
  opacity: 1;
  pointer-events: auto;
  transform: scale(1) translateY(0);
}

/* å¤´åƒå®¹å™¨ */
.call-floating-avatar {
  position: relative;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  background: var(--bg-primary);
  border: 3px solid var(--text-primary);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  z-index: 2;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
}

.call-floating-avatar svg {
  width: 32px;
  height: 32px;
  stroke: var(--text-secondary);
  fill: none;
  stroke-width: 1.5;
}

.call-floating-avatar img {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* è„‰å†²æ³¢çº¹ - é»˜è®¤éšè— */
.call-floating-pulse {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100%;
  height: 100%;
  border-radius: 50%;
  border: 2px solid var(--text-primary);
  opacity: 0;
  z-index: 1;
  animation: none;
  transition: opacity 0.3s ease;
}

/* åªæœ‰AIå›å¤æ—¶æ‰æ˜¾ç¤ºæ³¢çº¹æé†’ */
.call-floating-ball.has-reply .call-floating-pulse {
  opacity: 0.6;
  animation: floatingPulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

.call-floating-ball.has-reply .call-floating-pulse:nth-child(3) {
  animation-delay: 1s;
}

@keyframes floatingPulse {
  0% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 0.6;
  }
  100% {
    transform: translate(-50%, -50%) scale(1.6);
    opacity: 0;
  }
}

/* ç‚¹å‡»æ•ˆæœ */
.call-floating-ball:active .call-floating-avatar {
  transform: scale(0.9);
  transition: transform 0.15s ease;
}

/* æ”¶çº³åŠ¨ç”» - ä»å¤§åˆ°å° */
.phone-call-screen.minimizing {
  animation: callMinimize 0.35s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  will-change: transform, opacity;
}

@keyframes callMinimize {
  0% {
    opacity: 1;
    transform: scale(1);
  }
  100% {
    opacity: 0;
    transform: scale(0.5);
    pointer-events: none;
  }
}

/* å±•å¼€åŠ¨ç”» - ä»å°åˆ°å¤§ */
.phone-call-screen.expanding {
  animation: callExpand 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
  will-change: transform, opacity;
}

@keyframes callExpand {
  0% {
    opacity: 0;
    transform: scale(0.5);
  }
  70% {
    opacity: 1;
    transform: scale(1.03);
  }
  100% {
    opacity: 1;
    transform: scale(1);
    pointer-events: auto;
  }
}

/* å…³é—­åŠ¨ç”» - æ·¡å‡ºä¸‹æ»‘ï¼ˆç”¨äºç©ºå·/é€šè¯ä¸­ç­‰åœºæ™¯ï¼‰ */
.phone-call-screen.closing {
  animation: callClose 0.3s cubic-bezier(0.4, 0, 1, 1) forwards;
  will-change: transform, opacity;
}

@keyframes callClose {
  0% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  100% {
    opacity: 0;
    transform: translateY(20px) scale(0.95);
    pointer-events: none;
  }
}

/* ==================== End é€šè¯æ‚¬æµ®çƒ ==================== */

/* ========== End Phone Dialer App ========== */

/* ========== iMessage App ========== */

/* iMessage Screen */
.imessage-screen {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: var(--bg-primary);
  z-index: 150;
  display: none;
  flex-direction: column;
}

.imessage-screen.active {
  display: flex;
}

/* iMessage Navigation Bar */
.imessage-nav-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  /* ğŸ”¥ ä½¿ç”¨å…¨å±€App Header paddingå˜é‡ */
  padding: var(--app-header-total-padding) 16px 12px;
  background: var(--bg-primary);
  position: relative;
  z-index: 100;
  flex-shrink: 0;
}

.imessage-nav-left {
  font-size: 17px;
  font-weight: 400;
  color: var(--accent-color);
  cursor: pointer;
  transition: opacity 0.2s;
  min-width: 50px;
}

.imessage-nav-left:active {
  opacity: 0.5;
}

.imessage-nav-title {
  font-size: 17px;
  font-weight: 600;
  color: var(--text-primary);
  letter-spacing: -0.02em;
}

.imessage-nav-right {
  width: 24px;
  height: 24px;
  color: var(--accent-color);
  cursor: pointer;
  transition: opacity 0.2s;
  min-width: 50px;
  display: flex;
  justify-content: flex-end;
}

.imessage-nav-right:active {
  opacity: 0.5;
}

.imessage-nav-right svg {
  width: 24px;
  height: 24px;
  fill: none;
  stroke: currentColor;
  stroke-width: 1.5;
}

/* iMessage Search Bar */
.imessage-search-bar {
  margin: 8px 16px 16px;
  padding: 10px 12px;
  background: var(--bg-tertiary);
  border-radius: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
  transition: background 0.2s;
  flex-shrink: 0;
}

.imessage-search-bar:focus-within {
  background: var(--bg-secondary);
}

.imessage-search-icon {
  width: 18px;
  height: 18px;
  color: var(--text-tertiary);
  flex-shrink: 0;
}

.imessage-search-icon svg {
  width: 100%;
  height: 100%;
  fill: none;
  stroke: currentColor;
  stroke-width: 2;
}

.imessage-search-input {
  flex: 1;
  background: transparent;
  border: none;
  outline: none;
  font-size: 16px;
  color: var(--text-primary);
  font-family: inherit;
}

.imessage-search-input::placeholder {
  color: var(--text-tertiary);
}

.imessage-mic-icon {
  width: 18px;
  height: 18px;
  color: var(--text-tertiary);
  flex-shrink: 0;
  cursor: pointer;
  transition: color 0.2s;
}

.imessage-mic-icon:hover {
  color: var(--text-secondary);
}

.imessage-mic-icon svg {
  width: 100%;
  height: 100%;
  fill: none;
  stroke: currentColor;
  stroke-width: 2;
}

/* iMessage Scrollable Content */
.imessage-content {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
}

.imessage-content::-webkit-scrollbar {
  width: 0;
  display: none;
}

/* Pinned Contacts Section */
.imessage-pinned-section {
  padding: 12px 20px 24px;
}

.imessage-pinned-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px 16px;
  justify-items: center;
}

/* Pinned Contact Item */
.imessage-pinned-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  transition: transform 0.2s ease;
  width: 100%;
  max-width: 100px;
  animation: imessageFadeInUp 0.4s ease;
  animation-fill-mode: both;
}

.imessage-pinned-item:nth-child(1) { animation-delay: 0.1s; }
.imessage-pinned-item:nth-child(2) { animation-delay: 0.15s; }
.imessage-pinned-item:nth-child(3) { animation-delay: 0.2s; }
.imessage-pinned-item:nth-child(4) { animation-delay: 0.25s; }
.imessage-pinned-item:nth-child(5) { animation-delay: 0.3s; }
.imessage-pinned-item:nth-child(6) { animation-delay: 0.35s; }

.imessage-pinned-item:active {
  transform: scale(0.95);
}

/* Avatar Container with Bubble */
.imessage-avatar-container {
  position: relative;
  width: 76px;
  height: 76px;
  flex-shrink: 0;
}

.imessage-avatar {
  width: 76px;
  height: 76px;
  border-radius: 50%;
  object-fit: cover;
  background: linear-gradient(135deg, var(--bg-tertiary) 0%, var(--bg-secondary) 100%);
  border: 1px solid var(--border-color);
  transition: transform 0.2s, box-shadow 0.2s;
}

.imessage-pinned-item:hover .imessage-avatar {
  transform: scale(1.02);
  box-shadow: 0 4px 20px rgba(0,0,0,0.15);
}

/* Default Avatar (solid color) */
.imessage-avatar-default {
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 28px;
  font-weight: 500;
  color: var(--text-primary);
  text-transform: uppercase;
}

.imessage-avatar-pink {
  background: linear-gradient(135deg, #f8b4c4 0%, #e8a4b8 100%);
}

.imessage-avatar-blue {
  background: linear-gradient(135deg, #a8c8e8 0%, #8ab8dc 100%);
}

.imessage-avatar-gray {
  background: linear-gradient(135deg, #c8c8c8 0%, #a8a8a8 100%);
}

/* Message Bubble on Avatar */
.imessage-avatar-bubble {
  position: absolute;
  background: var(--bg-tertiary);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  padding: 5px 10px;
  border-radius: 14px;
  font-size: 11px;
  font-weight: 500;
  color: var(--text-primary);
  max-width: 90px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  box-shadow: 0 2px 10px rgba(0,0,0,0.2);
  animation: imessageBubbleFadeIn 0.3s ease;
  z-index: 10;
}

/* Top bubbles */
.imessage-avatar-bubble.top-left {
  top: -6px;
  left: 0px;
}

.imessage-avatar-bubble.top-center {
  top: -6px;
  left: 50%;
  transform: translateX(-50%);
}

.imessage-avatar-bubble.top-right {
  top: -6px;
  right: 0px;
}

/* Bottom bubbles */
.imessage-avatar-bubble.bottom-left {
  bottom: -6px;
  left: 0px;
}

.imessage-avatar-bubble.bottom-center {
  bottom: -6px;
  left: 50%;
  transform: translateX(-50%);
}

.imessage-avatar-bubble.bottom-right {
  bottom: -6px;
  right: 0px;
}

@keyframes imessageBubbleFadeIn {
  from {
    opacity: 0;
    transform: scale(0.8) translateY(4px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

/* Pinned Name with decorations */
.imessage-pinned-info {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
  font-size: 11px;
  color: var(--text-secondary);
  width: 100%;
  text-align: center;
}

.imessage-pinned-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #0A84FF;
  flex-shrink: 0;
}

.imessage-pinned-name {
  font-weight: 500;
  color: var(--text-primary);
  letter-spacing: -0.01em;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 70px;
}

.imessage-pinned-heart {
  font-size: 10px;
  opacity: 0.5;
  flex-shrink: 0;
}

/* Messages List */
.imessage-list {
  padding: 0;
}

/* Message Item */
.imessage-item {
  display: flex;
  align-items: center;
  padding: 10px 16px 10px 20px;
  gap: 12px;
  cursor: pointer;
  transition: background 0.15s ease;
  position: relative;
  min-height: 72px;
  animation: imessageFadeInUp 0.3s ease;
  animation-fill-mode: both;
}

.imessage-item:nth-child(1) { animation-delay: 0.05s; }
.imessage-item:nth-child(2) { animation-delay: 0.1s; }
.imessage-item:nth-child(3) { animation-delay: 0.15s; }
.imessage-item:nth-child(4) { animation-delay: 0.2s; }
.imessage-item:nth-child(5) { animation-delay: 0.25s; }
.imessage-item:nth-child(6) { animation-delay: 0.3s; }

.imessage-item:active {
  background: var(--bg-secondary);
}

/* =========== iMessage Edit Mode =========== */
/* ç¼–è¾‘æ¨¡å¼ä¸‹çš„itemé€‰ä¸­çŠ¶æ€ */
.imessage-item.imessage-selected {
  background: var(--bg-secondary);
}

/* å‹¾é€‰æ¡†æ ·å¼ */
.imessage-checkbox {
  width: 24px;
  height: 24px;
  min-width: 24px;
  border-radius: 50%;
  border: 2px solid var(--text-tertiary);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  flex-shrink: 0;
  margin-right: 4px;
}

.imessage-checkbox.checked {
  background: #0A84FF;
  border-color: #0A84FF;
}

.imessage-checkbox svg {
  width: 16px;
  height: 16px;
  fill: white;
  display: none;
}

.imessage-checkbox.checked svg {
  display: block;
}

/* åº•éƒ¨ç¼–è¾‘æ“ä½œæ  */
.imessage-edit-bar {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 60px;
  background: var(--bg-primary);
  border-top: 1px solid var(--border-color);
  display: none;
  align-items: center;
  justify-content: space-between;
  padding: 0 20px;
  z-index: 100;
  animation: imessageFadeInUp 0.2s ease;
}

.imessage-edit-bar.show {
  display: flex;
}

.imessage-edit-bar-left {
  display: flex;
  align-items: center;
  cursor: pointer;
  font-size: 16px;
  color: #0A84FF;
  font-weight: 500;
  padding: 8px 12px;
}

.imessage-edit-bar-left:active {
  opacity: 0.6;
}

.imessage-edit-bar-right {
  display: flex;
  align-items: center;
}

/* å…¨é€‰æŒ‰é’® */
.imessage-select-all-btn {
  font-size: 16px;
  color: #0A84FF;
  background: none;
  border: none;
  cursor: pointer;
  padding: 8px 12px;
  font-weight: 500;
  transition: opacity 0.2s ease;
}

.imessage-select-all-btn:active {
  opacity: 0.6;
}

/* åˆ é™¤æŒ‰é’® */
.imessage-delete-btn {
  font-size: 16px;
  color: #FF453A;
  background: none;
  border: none;
  cursor: pointer;
  padding: 8px 12px;
  font-weight: 500;
  transition: opacity 0.2s ease;
}

.imessage-delete-btn:disabled {
  color: var(--text-tertiary);
  cursor: not-allowed;
}

.imessage-delete-btn:active:not(:disabled) {
  opacity: 0.6;
}

/* ç¼–è¾‘æ¨¡å¼ä¸‹éšè—å³ä¸Šè§’ç¼–è¾‘æŒ‰é’®çš„+å·å›¾æ ‡ï¼Œæ”¹æ˜¾ç¤º"å®Œæˆ" */
.imessage-edit-mode #imessageEditBtn svg {
  display: none;
}

/* Unread Indicator */
.imessage-unread-indicator {
  position: absolute;
  left: 6px;
  top: 50%;
  transform: translateY(-50%);
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #0A84FF;
}

/* Message Avatar */
.imessage-msg-avatar {
  width: 52px;
  height: 52px;
  min-width: 52px;
  min-height: 52px;
  border-radius: 50%;
  flex-shrink: 0;
  object-fit: cover;
  background: linear-gradient(135deg, var(--bg-tertiary) 0%, var(--bg-secondary) 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  font-weight: 500;
  color: var(--text-primary);
  border: 1px solid var(--border-color);
}

/* Message Content */
.imessage-msg-content {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: 3px;
  justify-content: center;
}

.imessage-msg-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  width: 100%;
}

.imessage-msg-name {
  font-size: 16px;
  font-weight: 500;
  color: var(--text-primary);
  letter-spacing: -0.02em;
  display: flex;
  align-items: center;
  gap: 4px;
  flex-shrink: 1;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.imessage-msg-name .heart-icon {
  font-size: 12px;
  opacity: 0.5;
  flex-shrink: 0;
}

.imessage-msg-time {
  font-size: 14px;
  color: var(--text-tertiary);
  flex-shrink: 0;
  display: flex;
  align-items: center;
  gap: 6px;
  white-space: nowrap;
}

.imessage-msg-arrow {
  width: 7px;
  height: 12px;
  color: var(--text-tertiary);
  flex-shrink: 0;
}

.imessage-msg-arrow svg {
  width: 100%;
  height: 100%;
  fill: none;
  stroke: currentColor;
  stroke-width: 2.5;
}

.imessage-msg-preview {
  font-size: 14px;
  color: var(--text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  line-height: 1.4;
  padding-right: 24px;
}

/* Divider */
.imessage-divider {
  height: 0.5px;
  background: var(--border-color);
  margin-left: 84px;
}

/* Animation */
@keyframes imessageFadeInUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Empty State */
.imessage-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
  color: var(--text-tertiary);
  text-align: center;
}

.imessage-empty-state svg {
  width: 48px;
  height: 48px;
  margin-bottom: 16px;
  stroke: var(--text-tertiary);
  fill: none;
  stroke-width: 1.5;
}

.imessage-empty-state p {
  font-size: 14px;
  line-height: 1.5;
}

/* ========== iMessageé¡µé¢è¿›å…¥åŠ¨ç”»ï¼ˆä¸Phoneé¡µé¢åŒæ­¥ï¼‰========== */
.imessage-screen.animating .imessage-nav-bar {
  animation: fadeIn 0.6s ease 0.1s both;
}

.imessage-screen.animating .imessage-search-bar {
  animation: fadeIn 0.6s ease 0.15s both;
}

.imessage-screen.animating .imessage-pinned-section {
  animation: fadeIn 0.6s ease 0.2s both;
}

.imessage-screen.animating .imessage-list {
  animation: fadeIn 0.6s ease 0.25s both;
}

.imessage-screen.animating .imessage-empty-state {
  animation: fadeIn 0.6s ease 0.3s both;
}

/* ========== End iMessage App ========== */

/* ========================================== */
/* SMS Detail Page - çŸ­ä¿¡è¯¦æƒ…é¡µ iOS 6é£æ ¼ */
/* ========================================== */

/* SMS Screen Container */
.sms-detail-screen {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: none;
  flex-direction: column;
  background: var(--sms-bg-pattern);
  z-index: 200;
}

.sms-detail-screen.active {
  display: flex;
}

/* ========== Header - iOS 6 Style ========== */
.sms-header {
  background: var(--sms-header-bg);
  border-bottom: 1px solid var(--sms-header-border);
  /* ğŸ”¥ ä½¿ç”¨å…¨å±€App Header paddingå˜é‡ */
  padding: var(--app-header-total-padding) 12px 10px 12px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: relative;
  box-shadow: 0 1px 0 rgba(255,255,255,0.3) inset;
}

.sms-header::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 1px;
  background: rgba(255,255,255,0.5);
}

.sms-back-btn {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 6px 10px;
  background: var(--sms-send-bg);
  border: 1px solid var(--sms-header-border);
  border-radius: 6px;
  color: var(--sms-header-text);
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  box-shadow:
    0 1px 0 rgba(255,255,255,0.4) inset,
    0 1px 2px rgba(0,0,0,0.1);
  transition: all 0.15s ease;
}

.sms-back-btn:active {
  transform: scale(0.96);
  box-shadow: 0 1px 2px rgba(0,0,0,0.2) inset;
}

.sms-back-btn svg {
  width: 14px;
  height: 14px;
  stroke: currentColor;
  stroke-width: 2;
  fill: none;
}

.sms-contact-info {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
}

.sms-contact-name {
  font-size: 16px;
  font-weight: 600;
  color: var(--sms-header-text);
  letter-spacing: -0.3px;
}

.sms-contact-status {
  font-size: 10px;
  color: var(--sms-time-text);
  font-weight: 400;
  margin-top: 1px;
}

.sms-edit-btn {
  padding: 6px 12px;
  background: var(--sms-send-bg);
  border: 1px solid var(--sms-header-border);
  border-radius: 6px;
  color: var(--sms-header-text);
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  box-shadow:
    0 1px 0 rgba(255,255,255,0.4) inset,
    0 1px 2px rgba(0,0,0,0.1);
  transition: all 0.15s ease;
}

.sms-edit-btn:active {
  transform: scale(0.96);
}

/* ========== Action Bar - Call/FaceTime/Contact ========== */
.sms-action-bar {
  display: flex;
  gap: 8px;
  padding: 8px 12px;
  background: var(--sms-header-bg);
  border-bottom: 1px solid var(--sms-header-border);
}

.sms-action-item {
  flex: 1;
  padding: 8px;
  background: var(--sms-send-bg);
  border: 1px solid var(--sms-header-border);
  border-radius: 6px;
  text-align: center;
  font-size: 12px;
  font-weight: 500;
  color: var(--sms-header-text);
  cursor: pointer;
  box-shadow:
    0 1px 0 rgba(255,255,255,0.4) inset,
    0 1px 2px rgba(0,0,0,0.1);
  transition: all 0.15s ease;
}

.sms-action-item:active {
  transform: scale(0.97);
}

/* ========== Messages Area ========== */
.sms-messages {
  flex: 1;
  overflow-y: auto;
  padding: 12px;
  display: flex;
  flex-direction: column;
  gap: 6px;
}

/* Date Separator */
.sms-date-separator {
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 8px 0;
}

.sms-date-label {
  padding: 4px 12px;
  background: var(--sms-date-bg);
  border-radius: 12px;
  font-size: 11px;
  font-weight: 500;
  color: var(--sms-date-text);
  letter-spacing: 0.3px;
}

/* ========== Message Bubble - iOS 6 Style with Tail ========== */
.sms-message {
  display: flex;
  flex-direction: column;
  max-width: 75%;
  animation: smsMessageSlideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes smsMessageSlideIn {
  from {
    opacity: 0;
    transform: translateY(10px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.sms-message.user {
  align-self: flex-end;
}

.sms-message.other {
  align-self: flex-start;
}

/* Bubble with Tail */
.sms-bubble {
  position: relative;
  padding: 8px 12px;
  border-radius: 16px;
  font-size: 14px;
  line-height: 1.4;
  word-break: break-word;
  box-shadow: var(--sms-bubble-shadow);
}

/* User Bubble (Right side, tail pointing right) */
.sms-message.user .sms-bubble {
  background: var(--sms-bubble-user);
  color: var(--sms-bubble-user-text);
  border-radius: 16px 16px 4px 16px;
  margin-right: 8px;
}

.sms-message.user .sms-bubble::after {
  content: '';
  position: absolute;
  right: -6px;
  bottom: 4px;
  width: 0;
  height: 0;
  border: 8px solid transparent;
  border-left-color: #0a0a0a;
  border-right: 0;
  transform: rotate(10deg);
}

[data-theme="dark"] .sms-message.user .sms-bubble::after {
  border-left-color: #e8e8e8;
}

/* Other Bubble (Left side, tail pointing left) */
.sms-message.other .sms-bubble {
  background: var(--sms-bubble-other);
  color: var(--sms-bubble-other-text);
  border-radius: 16px 16px 16px 4px;
  margin-left: 8px;
}

.sms-message.other .sms-bubble::after {
  content: '';
  position: absolute;
  left: -6px;
  bottom: 4px;
  width: 0;
  height: 0;
  border: 8px solid transparent;
  border-right-color: #f5f5f5;
  border-left: 0;
  transform: rotate(-10deg);
}

[data-theme="dark"] .sms-message.other .sms-bubble::after {
  border-right-color: #1f1f1f;
}

/* Message Time */
.sms-message-time {
  font-size: 10px;
  color: var(--sms-time-text);
  margin-top: 3px;
  padding: 0 4px;
}

.sms-message.user .sms-message-time {
  text-align: right;
}

.sms-message.other .sms-message-time {
  text-align: left;
}

/* Delivered Status */
.sms-delivered {
  font-size: 10px;
  color: var(--sms-time-text);
  text-align: right;
  margin-top: 2px;
  font-style: italic;
}

/* ========== Typing Indicator ========== */
.sms-typing {
  display: none;
  align-items: center;
  gap: 4px;
  padding: 10px 14px;
  background: var(--sms-bubble-other);
  border-radius: 16px 16px 16px 4px;
  margin-left: 8px;
  width: fit-content;
  box-shadow: var(--sms-bubble-shadow);
  position: relative;
}

.sms-typing.active {
  display: flex;
}

.sms-typing::after {
  content: '';
  position: absolute;
  left: -7px;
  bottom: 4px;
  width: 0;
  height: 0;
  border: 8px solid transparent;
  border-right-color: #f5f5f5;
  border-left: 0;
  transform: rotate(-10deg);
}

[data-theme="dark"] .sms-typing::after {
  border-right-color: #1f1f1f;
}

.sms-typing .typing-dot {
  width: 6px;
  height: 6px;
  background: var(--sms-typing-dot);
  border-radius: 50%;
  animation: smsTypingPulse 1.4s ease-in-out infinite;
}

.sms-typing .typing-dot:nth-child(2) {
  animation-delay: 0.2s;
}

.sms-typing .typing-dot:nth-child(3) {
  animation-delay: 0.4s;
}

@keyframes smsTypingPulse {
  0%, 60%, 100% {
    transform: translateY(0);
    opacity: 0.4;
  }
  30% {
    transform: translateY(-4px);
    opacity: 1;
  }
}

/* ========== Input Area ========== */
.sms-input-area {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 12px;
  padding-bottom: calc(24px + env(safe-area-inset-bottom, 0));
  background: var(--sms-header-bg);
  border-top: 1px solid var(--sms-header-border);
  flex-shrink: 0;
  /* Androidé”®ç›˜é€‚é… */
  transition: transform 0.15s ease-out;
}

/* é”®ç›˜å¼¹èµ·æ—¶çš„å›ºå®šå®šä½æ¨¡å¼ */
.sms-input-area.keyboard-visible {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 9999;
  max-width: 430px;
  margin: 0 auto;
}

.sms-camera-btn {
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--sms-send-bg);
  border: 1px solid var(--sms-header-border);
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.15s ease;
}

.sms-camera-btn:active {
  transform: scale(0.92);
}

.sms-camera-btn svg {
  width: 16px;
  height: 16px;
  stroke: var(--sms-header-text);
  stroke-width: 2;
  fill: none;
}

.sms-input-wrapper {
  flex: 1;
  position: relative;
}

.sms-input {
  width: 100%;
  padding: 8px 14px;
  background: var(--sms-input-bg);
  border: 1px solid var(--sms-input-border);
  border-radius: 18px;
  font-size: 14px;
  color: var(--sms-header-text);
  outline: none;
  transition: all 0.2s ease;
  box-shadow: 0 1px 3px rgba(0,0,0,0.05) inset;
}

.sms-input::placeholder {
  color: var(--sms-time-text);
}

.sms-input:focus {
  border-color: var(--sms-header-text);
}

.sms-send-btn {
  padding: 8px 16px;
  background: var(--sms-send-bg);
  border: 1px solid var(--sms-header-border);
  border-radius: 18px;
  font-size: 13px;
  font-weight: 600;
  color: var(--sms-send-text);
  cursor: pointer;
  box-shadow:
    0 1px 0 rgba(255,255,255,0.4) inset,
    0 1px 2px rgba(0,0,0,0.1);
  transition: all 0.15s ease;
}

.sms-send-btn:active {
  transform: scale(0.95);
}

/* ========== SMS ç¼–è¾‘æ¨¡å¼å·¥å…·æ  ========== */
.sms-edit-toolbar {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 16px;
  background: var(--sms-header-bg);
  border-top: 1px solid var(--sms-header-border);
  box-shadow: 0 -2px 8px rgba(0,0,0,0.08);
}

.sms-edit-tool-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 14px;
  background: var(--sms-send-bg);
  border: 1px solid var(--sms-header-border);
  border-radius: 8px;
  color: var(--sms-header-text);
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s ease;
  box-shadow: 0 1px 0 rgba(255,255,255,0.4) inset, 0 1px 2px rgba(0,0,0,0.1);
}

.sms-edit-tool-btn:active {
  transform: scale(0.96);
}

.sms-edit-tool-btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.sms-edit-tool-btn.danger {
  color: var(--sms-header-text);
}

.sms-edit-tool-btn.danger:disabled {
  color: var(--sms-header-text);
}

.sms-edit-tool-btn svg {
  width: 16px;
  height: 16px;
  stroke: currentColor;
  stroke-width: 2;
  fill: none;
}

.sms-edit-toolbar-spacer {
  flex: 1;
}

/* ç¼–è¾‘æ¨¡å¼ä¸‹çš„æ¶ˆæ¯å¤é€‰æ¡† */
.sms-message-checkbox {
  display: none;
  width: 22px;
  height: 22px;
  border: 2px solid var(--sms-header-border);
  border-radius: 50%;
  background: var(--sms-send-bg);
  cursor: pointer;
  transition: all 0.2s ease;
  flex-shrink: 0;
  position: relative;
}

.sms-edit-mode .sms-message-checkbox {
  display: flex;
  align-items: center;
  justify-content: center;
}

.sms-message-checkbox.checked {
  background: #4a4a4a;
  border-color: #4a4a4a;
}

[data-theme="dark"] .sms-message-checkbox.checked {
  background: #d0d0d0;
  border-color: #d0d0d0;
}

.sms-message-checkbox.checked::after {
  content: '';
  width: 6px;
  height: 10px;
  border: solid #f5f5f5;
  border-width: 0 2px 2px 0;
  transform: rotate(45deg);
  margin-bottom: 2px;
}

[data-theme="dark"] .sms-message-checkbox.checked::after {
  border-color: #2a2a2a;
}

/* ç¼–è¾‘æ¨¡å¼ä¸‹çš„æ¶ˆæ¯å®¹å™¨ */
.sms-edit-mode .sms-message {
  flex-direction: row;
  align-items: flex-start;
  gap: 8px;
  max-width: 85%;
}

.sms-edit-mode .sms-message.user {
  flex-direction: row-reverse;
}

.sms-edit-mode .sms-message-content {
  flex: 1;
  display: flex;
  flex-direction: column;
}

/* ========== SMS Empty State ========== */
.sms-empty-state {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: var(--sms-time-text);
  padding: 40px 20px;
}

.sms-empty-state svg {
  width: 48px;
  height: 48px;
  stroke: var(--sms-time-text);
  stroke-width: 1.5;
  fill: none;
  margin-bottom: 12px;
  opacity: 0.5;
}

.sms-empty-text {
  font-size: 14px;
  font-weight: 500;
  margin-bottom: 4px;
}

.sms-empty-subtext {
  font-size: 12px;
  opacity: 0.7;
}

/* ========== End SMS Detail Page ========== */

/* ==========================================
   Message Action Menu - iOS iMessage Style
   ========================================== */

/* Overlay with blur effect - è½»å¾®æ¨¡ç³Š */
.message-action-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.25);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  z-index: 10000;
  display: none;
  opacity: 0;
  transition: opacity 0.25s ease;
  overflow: hidden;
}

.message-action-overlay.active {
  display: block;
}

.message-action-overlay.visible {
  opacity: 1;
}

/* é«˜äº®çš„æ¶ˆæ¯æ°”æ³¡ - åœ¨é®ç½©å±‚ä¸Šæ–¹æ˜¾ç¤º */
.message-action-highlight {
  position: relative;
  z-index: 10010 !important;
}

/* ğŸ”¥ è§£å†³å¤´åƒå’Œæ—¶é—´æˆ³é®æŒ¡èœå•çš„é—®é¢˜ */
/* å½“overlayå¯è§æ—¶ï¼Œå¼ºåˆ¶é™ä½z-indexåˆ°-1ï¼Œè®©å®ƒæ»šåˆ°æœ€åº•ä¸‹å» */
body.message-action-open #chatMessagesArea .chat-message-avatar,
body.message-action-open #chatMessagesArea .chat-message-timestamp,
body.message-action-open #chatMessagesArea .chat-message-group .chat-message-avatar,
body.message-action-open #chatMessagesArea .chat-message-group .chat-message-timestamp,
body.message-action-open .message-action-highlight .chat-message-avatar,
body.message-action-open .message-action-highlight .chat-message-timestamp {
  z-index: -1 !important;
  pointer-events: none !important;
  position: relative !important;
}

/* Quick Reaction Bar - iOSé£æ ¼ç£¨ç ‚ç»ç’ƒï¼Œå¤šè¡Œå‘ä¸Šæ‰©å±• */
.message-reaction-bar {
  position: absolute;
  display: flex;
  flex-wrap: wrap-reverse;
  align-content: flex-end;
  justify-content: center;
  /* ğŸ”¥ æ›´ç²¾è‡´ï¼šgap 4pxï¼Œpadding 8px */
  gap: 4px;
  padding: 8px;
  max-width: 300px;
  background: rgba(255, 255, 255, 0.85);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  /* ğŸ”¥ æ›´å°å·§ï¼šborder-radius 24px */
  border-radius: 24px;
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.12);
  border: 0.5px solid rgba(0, 0, 0, 0.06);
  z-index: 10020;
  opacity: 0;
  transform: translateY(8px) scale(0.96);
  transition: opacity 0.2s ease, transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.message-action-overlay.visible .message-reaction-bar {
  opacity: 1;
  transform: translateY(0) scale(1);
}

[data-theme='dark'] .message-reaction-bar {
  background: rgba(50, 50, 52, 0.85);
  border-color: rgba(255, 255, 255, 0.08);
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.4);
}

.reaction-item {
  /* ğŸ”¥ æ›´ç²¾è‡´ï¼š42px â†’ 38px */
  width: 38px;
  height: 38px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  cursor: pointer;
  transition: transform 0.15s ease, background 0.15s ease;
}

.reaction-item:hover {
  transform: scale(1.15);
  background: var(--hover-bg);
}

[data-theme='dark'] .reaction-item:hover {
  background: rgba(255, 255, 255, 0.1);
}

.reaction-item:active {
  transform: scale(0.95);
}

.reaction-item svg {
  width: 24px;
  height: 24px;
  fill: none;
  stroke: var(--text-secondary);
  stroke-width: 2;
}

.reaction-item:first-child svg {
  stroke: #8e8e93;
}

[data-theme='dark'] .reaction-item svg {
  stroke: #8e8e93;
}

/* Text-based reactions */
.reaction-haha span,
.reaction-exclaim span,
.reaction-question span {
  font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Rounded', sans-serif;
  font-weight: 800;
  font-size: 13px;
  color: var(--text-secondary);
  line-height: 1;
  text-align: center;
}

.reaction-haha span {
  font-size: 11px;
  letter-spacing: -0.5px;
}

.reaction-exclaim span {
  font-size: 16px;
}

.reaction-question span {
  font-size: 18px;
}

[data-theme='dark'] .reaction-haha span,
[data-theme='dark'] .reaction-exclaim span,
[data-theme='dark'] .reaction-question span {
  color: #8e8e93;
}

/* Action Menu - iOSé£æ ¼ç£¨ç ‚ç»ç’ƒ */
.message-action-menu {
  position: absolute;
  /* ğŸ”¥ æ›´ç²¾è‡´ï¼š260px â†’ 240px */
  width: 240px;
  background: rgba(255, 255, 255, 0.88);
  backdrop-filter: blur(40px) saturate(180%);
  -webkit-backdrop-filter: blur(40px) saturate(180%);
  /* ğŸ”¥ æ›´å°å·§ï¼š14px â†’ 12px */
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12), 0 0 0 0.5px rgba(0, 0, 0, 0.06);
  transform: translateY(10px) scale(0.96);
  opacity: 0;
  transition: transform 0.25s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.2s ease;
  transition-delay: 0.05s;
  z-index: 10022;
}

[data-theme='dark'] .message-action-menu {
  background: rgba(44, 44, 46, 0.92);
  box-shadow: 0 8px 40px rgba(0, 0, 0, 0.5), 0 0 0 0.5px rgba(255, 255, 255, 0.1);
}

.message-action-overlay.visible .message-action-menu {
  transform: translateY(0) scale(1);
  opacity: 1;
}

.action-menu-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  /* ğŸ”¥ æ›´ç´§å‡‘ï¼š13px 16px â†’ 11px 14px */
  padding: 11px 14px;
  cursor: pointer;
  transition: background 0.12s ease;
}

.action-menu-item:hover {
  background: rgba(0, 0, 0, 0.04);
}

[data-theme='dark'] .action-menu-item:hover {
  background: rgba(255, 255, 255, 0.06);
}

.action-menu-item:active {
  background: rgba(0, 0, 0, 0.08);
}

[data-theme='dark'] .action-menu-item:active {
  background: rgba(255, 255, 255, 0.1);
}

.action-menu-text {
  /* ğŸ”¥ æ›´ç²¾è‡´ï¼š17px â†’ 15px */
  font-size: 15px;
  font-weight: 400;
  color: var(--text-primary);
  letter-spacing: -0.2px;
}

[data-theme='dark'] .action-menu-text {
  color: #ffffff;
}

.action-menu-item svg {
  /* ğŸ”¥ æ›´ç²¾è‡´ï¼š22px â†’ 20px */
  width: 20px;
  height: 20px;
  fill: none;
  stroke: var(--text-secondary);
  stroke-width: 1.8;
  stroke-linecap: round;
  stroke-linejoin: round;
}

[data-theme='dark'] .action-menu-item svg {
  stroke: rgba(255, 255, 255, 0.7);
}

.action-menu-divider {
  height: 0.5px;
  background: rgba(0, 0, 0, 0.12);
  margin: 0;
}

[data-theme='dark'] .action-menu-divider {
  background: rgba(255, 255, 255, 0.1);
}

/* Animation for closing */
.message-action-overlay.closing {
  opacity: 0;
}

.message-action-overlay.closing .message-reaction-bar {
  transform: translateY(10px);
  opacity: 0;
}

.message-action-overlay.closing .message-action-menu {
  transform: translateY(10px);
  opacity: 0;
}

/* Prevent scroll on body when menu is open */
body.message-action-open {
  overflow: hidden;
}

/* ========== Message Reaction Bubble - æ¶ˆæ¯ååº”æ°”æ³¡ ========== */
.message-reaction-bubble,
.message-ai-reaction-bubble {
  position: absolute;
  display: flex;
  align-items: center;
  justify-content: center;
  /* ğŸ”¥ åŠ¨æ€å®½åº¦ï¼šçŸ­å†…å®¹=åœ†å½¢(28px)ï¼Œé•¿å†…å®¹=èƒ¶å›Šå½¢(auto width) */
  min-width: 28px;
  width: auto;
  max-width: 120px;
  height: 28px;
  padding: 0 6px;
  background: #ffffff;
  /* ğŸ”¥ å¤§åœ†è§’ï¼šè‡ªåŠ¨é€‚é…åœ†å½¢/èƒ¶å›Šå½¢ */
  border-radius: 14px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  border: 2px solid var(--bg-primary);
  z-index: 10;
  cursor: pointer;
  transition: transform 0.15s ease;
  /* ğŸ”¥ æ–‡å­—ä¸æ¢è¡Œï¼Œè¶…å‡ºæ˜¾ç¤ºçœç•¥å· */
  white-space: nowrap;
  overflow: hidden;
}

.message-reaction-bubble:hover,
.message-ai-reaction-bubble:hover {
  transform: scale(1.1);
}

.message-reaction-bubble:active,
.message-ai-reaction-bubble:active {
  transform: scale(0.95);
}

[data-theme='dark'] .message-reaction-bubble,
[data-theme='dark'] .message-ai-reaction-bubble {
  background: #3a3a3c;
  border-color: var(--bg-primary);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
}

/* ç”¨æˆ·æ¶ˆæ¯çš„ååº” - å·¦ä¸Šè§’ï¼ˆæ°”æ³¡é å³ï¼Œååº”åœ¨å·¦è¾¹ï¼‰ */
.message-reaction-bubble.user-side {
  top: -8px;
  left: -8px;
  right: auto;
}

/* è§’è‰²æ¶ˆæ¯çš„ååº” - å³ä¸Šè§’ï¼ˆæ°”æ³¡é å·¦ï¼Œååº”åœ¨å³è¾¹ï¼‰ */
.message-reaction-bubble.character-side {
  top: -8px;
  right: -8px;
  left: auto;
}

/* AIååº” - æ”¾åœ¨åº•éƒ¨ï¼Œé¿å…ä¸ç”¨æˆ·ååº”é‡å  */
.message-ai-reaction-bubble.user-side {
  bottom: -8px;
  left: -8px;
  right: auto;
  top: auto;
}

.message-ai-reaction-bubble.character-side {
  bottom: -8px;
  right: -8px;
  left: auto;
  top: auto;
}

/* ååº”å›¾æ ‡æ ·å¼ */
.message-reaction-bubble .reaction-icon,
.message-ai-reaction-bubble .reaction-icon {
  font-size: 14px;
  line-height: 1;
}

/* Emojiç±»å‹ååº” */
.message-reaction-bubble .reaction-icon.emoji,
.message-ai-reaction-bubble .reaction-icon.emoji {
  font-size: 14px;
}

/* æ–‡å­—ç±»å‹ååº” */
.message-reaction-bubble .reaction-icon.text,
.message-reaction-bubble .reaction-icon.custom,
.message-ai-reaction-bubble .reaction-icon.text,
.message-ai-reaction-bubble .reaction-icon.custom {
  /* ğŸ”¥ å¢å¤§å­—ä½“ï¼šä»10px â†’ 11pxï¼Œæ›´æ¸…æ™° */
  font-size: 11px;
  font-weight: 700;
  color: var(--text-secondary);
  /* ğŸ”¥ æ”¯æŒé•¿æ–‡å­—ï¼šæ˜¾ç¤ºçœç•¥å· */
  max-width: 100px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* çˆ±å¿ƒååº” - çº¢è‰² (å…¼å®¹æ—§ç‰ˆ) */
.message-reaction-bubble .reaction-icon.heart {
  color: #ff2d55;
}

/* ç‚¹èµååº” - ç°è‰² (å…¼å®¹æ—§ç‰ˆ) */
.message-reaction-bubble .reaction-icon.thumbsup,
.message-reaction-bubble .reaction-icon.thumbsdown {
  color: #8e8e93;
}

[data-theme='dark'] .message-reaction-bubble .reaction-icon.thumbsup,
[data-theme='dark'] .message-reaction-bubble .reaction-icon.thumbsdown {
  color: #aeaeb2;
}

/* æ–‡å­—ååº” - ç°è‰² */
.message-reaction-bubble .reaction-icon.haha,
.message-reaction-bubble .reaction-icon.exclaim,
.message-reaction-bubble .reaction-icon.question {
  font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Rounded', sans-serif;
  font-weight: 800;
  /* ğŸ”¥ å¢å¤§å­—ä½“ï¼šä»10px â†’ 11px */
  font-size: 11px;
  color: #8e8e93;
}

[data-theme='dark'] .message-reaction-bubble .reaction-icon.haha,
[data-theme='dark'] .message-reaction-bubble .reaction-icon.exclaim,
[data-theme='dark'] .message-reaction-bubble .reaction-icon.question {
  color: #aeaeb2;
}

/* ========== Custom Reaction Manager Modal ========== */
.custom-reaction-modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 10002;
  animation: fadeIn 0.2s ease;
}

.custom-reaction-modal.show {
  display: flex;
}

.custom-reaction-container {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(40px) saturate(180%);
  -webkit-backdrop-filter: blur(40px) saturate(180%);
  border-radius: 20px;
  width: 90%;
  max-width: 320px;
  max-height: 80vh;
  overflow: hidden;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  animation: slideUp 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

[data-theme='dark'] .custom-reaction-container {
  background: rgba(44, 44, 46, 0.95);
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(30px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.custom-reaction-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 20px;
  border-bottom: 0.5px solid rgba(0, 0, 0, 0.1);
}

[data-theme='dark'] .custom-reaction-header {
  border-bottom-color: rgba(255, 255, 255, 0.1);
}

.custom-reaction-title {
  font-size: 17px;
  font-weight: 600;
  color: var(--text-primary);
}

.custom-reaction-close {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background: rgba(0, 0, 0, 0.06);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
}

[data-theme='dark'] .custom-reaction-close {
  background: rgba(255, 255, 255, 0.1);
}

.custom-reaction-close:hover {
  background: rgba(0, 0, 0, 0.12);
}

.custom-reaction-close svg {
  width: 14px;
  height: 14px;
  stroke: var(--text-secondary);
  stroke-width: 2.5;
  fill: none;
}

.custom-reaction-content {
  padding: 16px 20px;
  overflow-y: auto;
  max-height: calc(80vh - 60px);
}

.custom-reaction-section {
  margin-bottom: 20px;
}

.custom-reaction-section:last-child {
  margin-bottom: 0;
}

.custom-reaction-section-title {
  font-size: 13px;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 12px;
}

/* Current Reaction Slots */
.custom-reaction-slots {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.reaction-slot {
  position: relative;
  width: 52px;
  height: 52px;
  border-radius: 14px;
  background: rgba(0, 0, 0, 0.04);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
  cursor: pointer;
  transition: all 0.2s ease;
  border: 2px solid transparent;
}

[data-theme='dark'] .reaction-slot {
  background: rgba(255, 255, 255, 0.08);
}

.reaction-slot:hover {
  background: rgba(0, 0, 0, 0.08);
  transform: scale(1.05);
}

.reaction-slot.empty {
  border: 2px dashed rgba(0, 0, 0, 0.15);
  background: transparent;
  color: var(--text-tertiary);
  font-size: 20px;
}

[data-theme='dark'] .reaction-slot.empty {
  border-color: rgba(255, 255, 255, 0.15);
}

.reaction-slot .slot-content {
  font-size: 24px;
  line-height: 1;
}

.reaction-slot .slot-content.text-reaction {
  font-size: 12px;
  font-weight: 700;
  color: var(--text-primary);
}

.reaction-slot .slot-delete {
  position: absolute;
  top: -6px;
  right: -6px;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: #ff3b30;
  display: none;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 2px 6px rgba(255, 59, 48, 0.4);
}

.reaction-slot:hover .slot-delete {
  display: flex;
}

.reaction-slot .slot-delete svg {
  width: 10px;
  height: 10px;
  stroke: #ffffff;
  stroke-width: 3;
  fill: none;
}

/* Add Reaction Input */
.custom-reaction-input-row {
  display: flex;
  /* ğŸ”¥ æ”¹æˆçºµå‘å¸ƒå±€ï¼šæŒ‰é’®åœ¨è¾“å…¥æ¡†ä¸‹æ–¹ */
  flex-direction: column;
  gap: 10px;
}

.custom-reaction-input {
  flex: 1;
  padding: 12px 16px;
  border-radius: 12px;
  border: 1px solid rgba(0, 0, 0, 0.1);
  background: rgba(0, 0, 0, 0.03);
  font-size: 16px;
  color: var(--text-primary);
  outline: none;
  transition: all 0.2s ease;
}

[data-theme='dark'] .custom-reaction-input {
  background: rgba(255, 255, 255, 0.06);
  border-color: rgba(255, 255, 255, 0.1);
}

.custom-reaction-input:focus {
  border-color: var(--accent-color);
  background: rgba(0, 0, 0, 0.02);
}

.custom-reaction-input::placeholder {
  color: var(--text-tertiary);
}

.custom-reaction-add-btn {
  padding: 12px 20px;
  border-radius: 12px;
  background: var(--accent-color);
  /* ğŸ”¥ Lightæ¨¡å¼ï¼šç™½è‰²æ–‡å­—ï¼ˆé»‘è‰²èƒŒæ™¯ï¼‰ */
  color: white;
  font-size: 15px;
  font-weight: 600;
  border: none;
  cursor: pointer;
  transition: all 0.2s ease;
  /* ğŸ”¥ çºµå‘å¸ƒå±€ä¸‹å æ»¡å®½åº¦ */
  width: 100%;
}

/* ğŸ”¥ Darkæ¨¡å¼ï¼šé»‘è‰²æ–‡å­—ï¼ˆç™½è‰²èƒŒæ™¯ï¼‰ */
[data-theme='dark'] .custom-reaction-add-btn {
  color: #000000;
}

.custom-reaction-add-btn:hover {
  opacity: 0.9;
  transform: scale(1.02);
}

.custom-reaction-add-btn:active {
  transform: scale(0.98);
}

/* Preset Emojis */
.custom-reaction-presets {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.preset-emoji {
  width: 44px;
  height: 44px;
  border-radius: 12px;
  background: rgba(0, 0, 0, 0.04);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  cursor: pointer;
  transition: all 0.2s ease;
}

[data-theme='dark'] .preset-emoji {
  background: rgba(255, 255, 255, 0.08);
}

.preset-emoji:hover {
  background: rgba(0, 0, 0, 0.08);
  transform: scale(1.1);
}

.preset-emoji:active {
  transform: scale(0.95);
}

/* Reset Button */
.custom-reaction-reset {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 14px;
  margin-top: 8px;
  border-radius: 12px;
  background: rgba(255, 59, 48, 0.08);
  color: #ff3b30;
  font-size: 15px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

.custom-reaction-reset:hover {
  background: rgba(255, 59, 48, 0.15);
}

.custom-reaction-reset svg {
  width: 18px;
  height: 18px;
  stroke: #ff3b30;
  stroke-width: 2;
  fill: none;
}

/* Reaction bar - customize button */
.reaction-item.customize-btn {
  background: rgba(0, 0, 0, 0.06);
  border-radius: 50%;
}

[data-theme='dark'] .reaction-item.customize-btn {
  background: rgba(255, 255, 255, 0.1);
}

.reaction-item.customize-btn svg {
  width: 18px;
  height: 18px;
  stroke: var(--text-secondary);
  stroke-width: 2;
  fill: none;
}

/* Dynamic reaction items in bar */
.reaction-item .reaction-emoji {
  font-size: 24px;
  line-height: 1;
}

.reaction-item .reaction-text {
  font-size: 11px;
  font-weight: 700;
  color: var(--text-secondary);
  text-align: center;
  line-height: 1.1;
  /* ğŸ”¥ é•¿æ–‡å­—æ˜¾ç¤ºä¼˜åŒ–ï¼šè¶…å‡ºæ˜¾ç¤ºçœç•¥å· */
  max-width: 38px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* ========== End Message Action Menu ========== */

/* ========== ğŸ­ è§’è‰²çŠ¶æ€ç³»ç»Ÿæ¶ˆæ¯ ========== */

.chat-system-status-message {
  display: flex;
  justify-content: center;
  padding: 10px 16px;
  margin: 6px 0;
}

.status-change-content {
  display: inline-flex;
  align-items: center;
  padding: 5px 16px;
  background: rgba(0, 0, 0, 0.03);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border-radius: 12px;
  font-size: 11px;
  color: var(--text-tertiary);
  border: 1px solid rgba(0, 0, 0, 0.06);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.02);
  animation: statusMsgFadeIn 0.4s ease;
}

[data-theme='dark'] .status-change-content {
  background: rgba(255, 255, 255, 0.04);
  border: 1px solid rgba(255, 255, 255, 0.08);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  color: var(--text-tertiary);
}

.status-text {
  font-weight: 400;
  letter-spacing: 0.2px;
}

@keyframes statusMsgFadeIn {
  from {
    opacity: 0;
    transform: translateY(-8px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* ========== End è§’è‰²çŠ¶æ€ç³»ç»Ÿæ¶ˆæ¯ ========== */

/* ========== æ‹ä¸€æ‹ç³»ç»Ÿæ¶ˆæ¯ ========== */
.chat-system-tickle-message {
  display: flex;
  justify-content: center;
  padding: 10px 16px;
  margin: 6px 0;
}

.tickle-content {
  display: inline-flex;
  align-items: center;
  padding: 5px 16px;
  background: rgba(0, 0, 0, 0.03);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border-radius: 12px;
  font-size: 11px;
  color: var(--text-tertiary);
  border: 1px solid rgba(0, 0, 0, 0.06);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.02);
  animation: tickleMsgFadeIn 0.4s ease;
}

[data-theme='dark'] .tickle-content {
  background: rgba(255, 255, 255, 0.04);
  border: 1px solid rgba(255, 255, 255, 0.08);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  color: var(--text-tertiary);
}

.tickle-text {
  font-weight: 400;
  letter-spacing: 0.2px;
}

@keyframes tickleMsgFadeIn {
  from {
    opacity: 0;
    transform: translateY(-8px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* ========== End æ‹ä¸€æ‹ç³»ç»Ÿæ¶ˆæ¯ ========== */

/* ==================== BaoBaoBook Category Drawer - ç™¾å®ä¹¦åˆ†ç±»ç®¡ç†æŠ½å±‰ ==================== */

/* é®ç½©å±‚ */
.baobaobook-category-drawer-overlay {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.6);
  z-index: 200;
  display: flex;
  align-items: flex-end;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.baobaobook-category-drawer-overlay.active {
  opacity: 1;
  pointer-events: all;
}

/* æŠ½å±‰æœ¬ä½“ */
.baobaobook-category-drawer-sheet {
  width: 100%;
  max-height: 75vh;
  background: var(--bg-primary);
  border-radius: 24px 24px 0 0;
  padding: 0;
  transform: translateY(100%);
  transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  display: flex;
  flex-direction: column;
  box-shadow: 0 -8px 32px rgba(0, 0, 0, 0.3);
  position: relative;
  overflow: hidden;
}

.baobaobook-category-drawer-overlay.active .baobaobook-category-drawer-sheet {
  transform: translateY(0);
}

/* ä¹¦æœ¬è£…é¥°å…ƒç´  */
.baobaobook-category-drawer-sheet::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg,
    transparent 0%,
    var(--accent-color) 10%,
    var(--accent-color) 90%,
    transparent 100%
  );
  opacity: 0.3;
}

/* HeaderåŒºåŸŸ */
.baobaobook-category-drawer-header {
  padding: 16px 24px 16px;
  border-bottom: 1px solid var(--border-color);
  flex-shrink: 0;
  background: var(--bg-secondary);
}

/* æ‹–æ‹½æ‰‹æŸ„ */
.baobaobook-category-drawer-handle {
  width: 40px;
  height: 4px;
  background: var(--text-tertiary);
  border-radius: 2px;
  margin: 0 auto 16px;
  opacity: 0.6;
}

/* æ ‡é¢˜ */
.baobaobook-category-drawer-title {
  font-family: 'Inter', sans-serif;
  font-size: 18px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.baobaobook-category-drawer-subtitle {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px;
  color: var(--text-secondary);
  letter-spacing: 0.5px;
  text-align: center;
  opacity: 0.7;
}

/* åˆ†ç±»åˆ—è¡¨ */
.baobaobook-category-drawer-list {
  padding: 16px 20px;
  overflow-y: auto;
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 10px;
  max-height: 40vh;
}

/* ç©ºçŠ¶æ€ */
.baobaobook-category-drawer-list .category-empty-state {
  text-align: center;
  padding: 32px 20px;
  color: var(--text-tertiary);
}

/* åˆ†ç±»é¡¹ */
.baobaobook-category-drawer-list .category-item {
  background: var(--bg-tertiary);
  border-radius: 14px;
  padding: 14px 16px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  border: 1.5px solid transparent;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.baobaobook-category-drawer-list .category-item::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 3px;
  background: var(--accent-color);
  opacity: 0;
  transition: opacity 0.2s;
}

.baobaobook-category-drawer-list .category-item:active {
  background: var(--bg-secondary);
  border-color: var(--border-color);
  transform: scale(0.98);
}

.baobaobook-category-drawer-list .category-item:active::before {
  opacity: 1;
}

/* åˆ†ç±»é¡¹ä¿¡æ¯ */
.category-item-info {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.category-item-name {
  font-family: 'Inter', sans-serif;
  font-size: 15px;
  font-weight: 500;
  color: var(--text-primary);
}

.category-item-meta {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px;
  color: var(--text-tertiary);
  letter-spacing: 0.3px;
}

/* åˆ†ç±»é¡¹æ“ä½œæŒ‰é’® */
.category-item-actions {
  display: flex;
  gap: 8px;
  flex-shrink: 0;
}

.category-item-btn {
  width: 36px;
  height: 36px;
  border-radius: 10px;
  background: var(--bg-primary);
  border: 1px solid var(--border-color);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.category-item-btn svg {
  width: 16px;
  height: 16px;
  stroke: var(--text-secondary);
  fill: none;
  stroke-width: 2;
  transition: stroke 0.2s;
}

.category-item-btn.edit:active {
  background: var(--accent-color);
  border-color: var(--accent-color);
  transform: scale(0.92);
}

.category-item-btn.edit:active svg {
  stroke: white;
}

.category-item-btn.delete:active {
  background: #ef4444;
  border-color: #ef4444;
  transform: scale(0.92);
}

.category-item-btn.delete:active svg {
  stroke: white;
}

/* æ·»åŠ æ–°åˆ†ç±»åŒºåŸŸ */
.baobaobook-category-drawer-add-section {
  padding: 40px 24px 24px;
  background: var(--bg-secondary);
  border-top: 1px solid var(--border-color);
  flex-shrink: 0;
}

.baobaobook-category-drawer-add-title {
  font-family: 'Inter', sans-serif;
  font-size: 13px;
  font-weight: 600;
  color: var(--text-secondary);
  margin-bottom: 12px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.baobaobook-category-drawer-add-form {
  display: flex;
  gap: 10px;
  align-items: center;
}

.baobaobook-category-drawer-input {
  flex: 1;
  height: 44px;
  padding: 0 16px;
  border-radius: 12px;
  border: 1.5px solid var(--border-color);
  background: var(--bg-primary);
  color: var(--text-primary);
  font-family: inherit;
  font-size: 14px;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.baobaobook-category-drawer-input:focus {
  outline: none;
  border-color: var(--accent-color);
  background: var(--bg-primary);
  box-shadow: 0 0 0 3px rgba(var(--accent-rgb), 0.1);
}

.baobaobook-category-drawer-input::placeholder {
  color: var(--text-tertiary);
  font-size: 13px;
}

.baobaobook-category-drawer-add-btn {
  height: 44px;
  padding: 0 20px;
  border-radius: 12px;
  background: var(--accent-color);
  color: white;
  border: none;
  font-family: 'Inter', sans-serif;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  flex-shrink: 0;
}

.baobaobook-category-drawer-add-btn:active {
  transform: scale(0.95);
  background: var(--accent-dark);
}

.baobaobook-category-drawer-add-btn svg {
  fill: none;
  stroke: currentColor;
}

/* Dark Mode */
[data-theme="dark"] .baobaobook-category-drawer-overlay {
  background: rgba(0, 0, 0, 0.8);
}

[data-theme="dark"] .baobaobook-category-drawer-list .category-item {
  background: rgba(255, 255, 255, 0.05);
}

[data-theme="dark"] .baobaobook-category-drawer-list .category-item:active {
  background: rgba(255, 255, 255, 0.08);
}

[data-theme="dark"] .category-item-btn {
  background: rgba(255, 255, 255, 0.05);
  border-color: rgba(255, 255, 255, 0.1);
}

/* ==================== End BaoBaoBook Category Drawer ==================== */

/* ==================== BaoBaoBook Entry Drawer ==================== */

.baobaobook-entry-drawer-overlay {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.6);
  z-index: 200;
  display: flex;
  align-items: flex-end;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.baobaobook-entry-drawer-overlay.active {
  opacity: 1;
  pointer-events: all;
}

/* æŠ½å±‰æœ¬ä½“ */
.baobaobook-entry-drawer-sheet {
  width: 100%;
  max-height: 80vh;
  background: var(--bg-primary);
  border-radius: 24px 24px 0 0;
  padding: 0;
  transform: translateY(100%);
  transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  display: flex;
  flex-direction: column;
  box-shadow: 0 -8px 32px rgba(0, 0, 0, 0.3);
  position: relative;
  overflow: hidden;
}

.baobaobook-entry-drawer-overlay.active .baobaobook-entry-drawer-sheet {
  transform: translateY(0);
}

/* è£…é¥°å…ƒç´  */
.baobaobook-entry-drawer-sheet::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg,
    transparent 0%,
    var(--accent-color) 10%,
    var(--accent-color) 90%,
    transparent 100%
  );
  opacity: 0.3;
}

/* HeaderåŒºåŸŸ */
.baobaobook-entry-drawer-header {
  padding: 16px 24px 16px;
  border-bottom: 1px solid var(--border-color);
  flex-shrink: 0;
  background: var(--bg-secondary);
}

/* æ‹–æ‹½æ‰‹æŸ„ */
.baobaobook-entry-drawer-handle {
  width: 40px;
  height: 4px;
  background: var(--text-tertiary);
  border-radius: 2px;
  margin: 0 auto 16px;
  opacity: 0.6;
}

/* æ ‡é¢˜ */
.baobaobook-entry-drawer-title {
  font-family: 'Inter', sans-serif;
  font-size: 18px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.baobaobook-entry-drawer-subtitle {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px;
  color: var(--text-secondary);
  letter-spacing: 0.5px;
  text-align: center;
  opacity: 0.7;
}

/* è¡¨å•åŒºåŸŸ */
.baobaobook-entry-drawer-form {
  padding: 20px 24px;
  overflow-y: auto;
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 18px;
}

/* è¡¨å•ç»„ */
.baobaobook-entry-form-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

/* æ ‡ç­¾ */
.baobaobook-entry-label {
  font-family: 'Inter', sans-serif;
  font-size: 13px;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.required-mark {
  color: #ef4444;
  margin-left: 2px;
}

.optional-mark {
  text-transform: none;
  font-weight: 400;
  color: var(--text-tertiary);
  font-size: 11px;
}

/* è¾“å…¥æ¡† */
.baobaobook-entry-input,
.baobaobook-entry-select {
  height: 44px;
  padding: 0 16px;
  border-radius: 12px;
  border: 1.5px solid var(--border-color);
  background: var(--bg-primary);
  color: var(--text-primary);
  font-family: inherit;
  font-size: 14px;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.baobaobook-entry-input:focus,
.baobaobook-entry-select:focus {
  outline: none;
  border-color: var(--accent-color);
  background: var(--bg-primary);
  box-shadow: 0 0 0 3px rgba(var(--accent-rgb), 0.1);
}

.baobaobook-entry-input::placeholder {
  color: var(--text-tertiary);
  font-size: 13px;
}

/* æ–‡æœ¬åŸŸ */
.baobaobook-entry-textarea {
  min-height: 160px;
  padding: 14px 16px;
  border-radius: 12px;
  border: 1.5px solid var(--border-color);
  background: var(--bg-primary);
  color: var(--text-primary);
  font-family: inherit;
  font-size: 14px;
  line-height: 1.6;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  resize: vertical;
}

.baobaobook-entry-textarea:focus {
  outline: none;
  border-color: var(--accent-color);
  background: var(--bg-primary);
  box-shadow: 0 0 0 3px rgba(var(--accent-rgb), 0.1);
}

.baobaobook-entry-textarea::placeholder {
  color: var(--text-tertiary);
  font-size: 13px;
}

/* æç¤ºæ–‡å­— */
.baobaobook-entry-hint {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px;
  color: var(--text-tertiary);
  letter-spacing: 0.3px;
  opacity: 0.8;
}

/* å­—ç¬¦è®¡æ•° */
.baobaobook-entry-char-count {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px;
  color: var(--text-tertiary);
  text-align: right;
  letter-spacing: 0.3px;
}

/* åº•éƒ¨æŒ‰é’®åŒº */
.baobaobook-entry-drawer-actions {
  padding: 40px 24px 24px;
  background: var(--bg-secondary);
  border-top: 1px solid var(--border-color);
  flex-shrink: 0;
  display: flex;
  gap: 12px;
}

/* å–æ¶ˆæŒ‰é’® */
.baobaobook-entry-btn-cancel {
  flex: 1;
  height: 44px;
  border-radius: 12px;
  background: var(--bg-tertiary);
  color: var(--text-secondary);
  border: 1.5px solid var(--border-color);
  font-family: 'Inter', sans-serif;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.baobaobook-entry-btn-cancel:active {
  transform: scale(0.95);
  background: var(--bg-secondary);
}

/* åˆ é™¤æŒ‰é’® */
.baobaobook-entry-btn-delete {
  flex: 1;
  height: 44px;
  border-radius: 12px;
  background: var(--bg-primary);
  color: var(--text-primary);
  border: 2px solid var(--border-color);
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.baobaobook-entry-btn-delete:active {
  transform: scale(0.95);
  background: var(--bg-secondary);
}

/* ä¿å­˜æŒ‰é’® */
.baobaobook-entry-btn-save {
  flex: 1;
  height: 44px;
  border-radius: 12px;
  background: var(--accent-color);
  color: white;
  border: none;
  font-family: 'Inter', sans-serif;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.baobaobook-entry-btn-save:active {
  transform: scale(0.95);
  background: var(--accent-dark);
}

.baobaobook-entry-btn-save svg {
  fill: none;
  stroke: currentColor;
}

/* Dark Mode */
[data-theme="dark"] .baobaobook-entry-drawer-overlay {
  background: rgba(0, 0, 0, 0.8);
}

[data-theme="dark"] .baobaobook-entry-btn-save {
  color: #000;
}

/* ==================== End BaoBaoBook Entry Drawer ==================== */

/* ==================== BaoBaoBook Entry List ==================== */
/* ç´§å‡‘åˆ—è¡¨å¼å¸ƒå±€ï¼Œå‘Šåˆ«æµªè´¹ç©ºé—´çš„å¡ç‰‡ */

.baobaobook-entry-container {
  padding: 16px;
}

/* åˆ›å»ºæ¡ç›®æŒ‰é’® - æ”¾åœ¨åˆ—è¡¨é¡¶éƒ¨ */
.baobaobook-create-entry-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  width: 100%;
  padding: 14px 20px;
  margin-bottom: 16px;
  background: var(--bg-tertiary);
  border: 2px dashed var(--border-color);
  border-radius: 12px;
  color: var(--text-secondary);
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

.baobaobook-create-entry-btn:hover {
  border-color: var(--accent-color);
  color: var(--accent-color);
  background: var(--bg-secondary);
}

.baobaobook-create-entry-btn:active {
  transform: scale(0.98);
}

.baobaobook-create-entry-btn svg {
  width: 18px;
  height: 18px;
  stroke: currentColor;
  stroke-width: 2;
  fill: none;
}

/* æ¡ç›®åˆ—è¡¨å®¹å™¨ */
.baobaobook-entry-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

/* å•ä¸ªæ¡ç›®é¡¹ - ç´§å‡‘çš„æ°´å¹³å¸ƒå±€ */
.baobaobook-entry-item {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.baobaobook-entry-item:hover {
  background: var(--bg-secondary);
  border-color: var(--accent-color);
  transform: translateX(2px);
}

.baobaobook-entry-item:active {
  transform: scale(0.99);
}

/* é¦–å­—æ¯å¤´åƒ */
.baobaobook-entry-avatar {
  width: 40px;
  height: 40px;
  min-width: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  font-size: 16px;
  font-weight: 600;
  color: var(--text-primary);
  text-transform: uppercase;
}

/* æ¡ç›®ä¿¡æ¯åŒºåŸŸ */
.baobaobook-entry-info {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

/* æ¡ç›®æ ‡é¢˜è¡Œ */
.baobaobook-entry-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}

.baobaobook-entry-name {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* åˆ†ç±»æ ‡ç­¾ */
.baobaobook-entry-category {
  flex-shrink: 0;
  padding: 2px 8px;
  background: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  font-size: 10px;
  color: var(--text-tertiary);
}

/* å…³é”®è¯è¡Œ */
.baobaobook-entry-keywords {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
}

.baobaobook-entry-keyword {
  padding: 1px 6px;
  background: var(--bg-secondary);
  border-radius: 3px;
  font-size: 11px;
  color: var(--text-secondary);
}

/* å†…å®¹é¢„è§ˆ */
.baobaobook-entry-preview {
  font-size: 12px;
  color: var(--text-tertiary);
  line-height: 1.4;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* ç©ºçŠ¶æ€ */
.baobaobook-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
  text-align: center;
}

.baobaobook-empty-icon {
  width: 48px;
  height: 48px;
  margin-bottom: 12px;
  color: var(--text-tertiary);
  opacity: 0.5;
}

.baobaobook-empty-icon svg {
  width: 100%;
  height: 100%;
  stroke: currentColor;
  stroke-width: 1.5;
  fill: none;
}

.baobaobook-empty-text {
  font-size: 14px;
  color: var(--text-tertiary);
}

/* ==================== End BaoBaoBook Entry List ==================== */

/* ==================== Chat Settings BaoBaoBook Binding - èŠå¤©è®¾ç½®ç™¾å®ä¹¦ç»‘å®š ==================== */

/* ä¸settings-selectä¿æŒä¸€è‡´çš„æ ·å¼ */
.chat-baobaobook-binding-container {
  width: 100%;
  background: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.2s ease;
}

.chat-baobaobook-binding-container:focus-within,
.chat-baobaobook-binding-container.active {
  border-color: var(--accent-color);
  box-shadow: 0 0 0 3px rgba(42, 42, 42, 0.05);
}

[data-theme="dark"] .chat-baobaobook-binding-container:focus-within,
[data-theme="dark"] .chat-baobaobook-binding-container.active {
  box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.05);
}

.chat-baobaobook-binding-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px;
  cursor: pointer;
  transition: background 0.2s ease;
}

.chat-baobaobook-binding-header:hover {
  background: var(--bg-tertiary);
}

.chat-baobaobook-binding-summary {
  font-size: 13px;
  color: var(--text-secondary);
  font-family: 'Inter', sans-serif;
}

.chat-baobaobook-binding-summary.has-selection {
  color: var(--text-primary);
  font-weight: 500;
}

.chat-baobaobook-binding-arrow {
  width: 16px;
  height: 16px;
  stroke: var(--text-tertiary);
  fill: none;
  stroke-width: 2;
  transition: transform 0.3s ease;
}

.chat-baobaobook-binding-container.expanded .chat-baobaobook-binding-arrow {
  transform: rotate(180deg);
}

.chat-baobaobook-binding-list {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease;
  border-top: 1px solid transparent;
  background: var(--bg-tertiary);
}

.chat-baobaobook-binding-container.expanded .chat-baobaobook-binding-list {
  max-height: 240px;
  overflow-y: auto;
  border-top-color: var(--border-color);
}

.chat-baobaobook-binding-empty {
  padding: 16px 12px;
  text-align: center;
  font-size: 12px;
  color: var(--text-tertiary);
}

.chat-baobaobook-binding-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 12px;
  cursor: pointer;
  transition: background 0.15s ease;
  border-bottom: 1px solid var(--border-color);
}

.chat-baobaobook-binding-item:last-child {
  border-bottom: none;
}

.chat-baobaobook-binding-item:hover {
  background: var(--bg-secondary);
}

.chat-baobaobook-binding-item.selected {
  background: var(--bg-secondary);
}

.chat-baobaobook-binding-checkbox {
  width: 16px;
  height: 16px;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  transition: all 0.2s ease;
  background: var(--bg-primary);
}

.chat-baobaobook-binding-item.selected .chat-baobaobook-binding-checkbox {
  background: var(--accent-color);
  border-color: var(--accent-color);
}

.chat-baobaobook-binding-checkbox svg {
  width: 10px;
  height: 10px;
  stroke: var(--bg-primary);
  fill: none;
  stroke-width: 2.5;
  opacity: 0;
  transform: scale(0.5);
  transition: all 0.2s ease;
}

.chat-baobaobook-binding-item.selected .chat-baobaobook-binding-checkbox svg {
  opacity: 1;
  transform: scale(1);
}

.chat-baobaobook-binding-info {
  flex: 1;
  min-width: 0;
}

.chat-baobaobook-binding-name {
  font-size: 13px;
  font-weight: 500;
  color: var(--text-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  display: flex;
  align-items: center;
  gap: 6px;
}

.chat-baobaobook-binding-category {
  font-size: 11px;
  color: var(--text-tertiary);
  margin-top: 2px;
}

/* å…³é”®è¯æ ‡ç­¾ - é»‘ç™½ç°é£æ ¼ */
.chat-baobaobook-keyword-badge {
  font-size: 10px;
  font-weight: 400;
  color: var(--text-tertiary);
  max-width: 100px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  flex-shrink: 0;
}

/* èŠå¤©è®¾ç½®ç™¾å®ä¹¦ç»‘å®š - åˆ†ç±»æ ‡ç­¾æ  */
.chat-baobaobook-binding-category-tabs {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  padding: 8px 12px;
  background: var(--bg-tertiary);
  border-bottom: 1px solid var(--border-color);
}

.chat-baobaobook-binding-cat-tab {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 6px 10px;
  font-size: 12px;
  font-weight: 500;
  color: var(--text-secondary);
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 16px;
  cursor: pointer;
  transition: all 0.15s ease;
  white-space: nowrap;
}

.chat-baobaobook-binding-cat-tab:hover {
  background: var(--bg-primary);
  border-color: var(--text-tertiary);
}

.chat-baobaobook-binding-cat-tab:active {
  transform: scale(0.96);
}

.chat-baobaobook-binding-cat-tab.all-selected {
  background: var(--text-primary);
  color: var(--bg-primary);
  border-color: var(--text-primary);
}

[data-theme="dark"] .chat-baobaobook-binding-cat-tab.all-selected {
  background: var(--text-primary);
  color: var(--bg-primary);
  border-color: var(--text-primary);
}

.chat-baobaobook-binding-cat-tab .cat-count {
  font-size: 10px;
  font-weight: 400;
  opacity: 0.7;
}

.chat-baobaobook-binding-cat-tab.all-selected .cat-count {
  opacity: 0.9;
}

/* èŠå¤©è®¾ç½®ç™¾å®ä¹¦ç»‘å®š - åˆ†ç»„æ ‡é¢˜ */
.chat-baobaobook-binding-group-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 14px 6px;
  background: var(--bg-tertiary);
  border-top: 1px solid var(--border-color);
  margin-top: 4px;
}

.chat-baobaobook-binding-group-header:first-of-type {
  margin-top: 0;
  border-top: none;
}

.chat-baobaobook-binding-group-header .group-name {
  font-size: 13px;
  font-weight: 600;
  color: var(--text-primary);
}

.chat-baobaobook-binding-group-header .group-count {
  font-size: 11px;
  color: var(--text-tertiary);
}

.chat-baobaobook-binding-group-header .group-count.all-selected {
  color: var(--text-secondary);
  font-weight: 500;
}

/* ==================== End Chat Settings BaoBaoBook Binding ==================== */

/* ==================== Mmpages (Threads Profile) ==================== */

/* Mmpages Overlay - è¦†ç›–æ•´ä¸ªæ‰‹æœºå±å¹• */
.mmpages-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 2100;
  background-color: var(--bg-primary);
  transform: translateX(100%);
  opacity: 0;
  pointer-events: none;
  transition: transform 0.35s cubic-bezier(0.28, 0.84, 0.42, 1),
              opacity 0.35s cubic-bezier(0.28, 0.84, 0.42, 1);
  will-change: transform, opacity;
  overflow: hidden;
  max-width: 100%;
  max-height: 100%;
  contain: layout style paint;
}

.mmpages-overlay.active {
  transform: translateX(0);
  opacity: 1;
  pointer-events: auto;
}

.mmpages-container {
  height: 100%;
  width: 100%;
  max-width: 430px;
  max-height: 100%;
  margin: 0 auto;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  position: relative;
}

/* Global SVG rounded style for mmpages */
#mmpagesScreen svg {
  stroke-linecap: round;
  stroke-linejoin: round;
}

/* ========== Top Navbar ========== */
.mmpages-top-navbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  height: 56px;
  /* ğŸ”¥ ä½¿ç”¨å…¨å±€App Header paddingå˜é‡ */
  padding: var(--app-header-total-padding) 16px 12px;
  position: sticky;
  top: 0;
  background-color: var(--bg-primary);
  z-index: 100;
  flex-shrink: 0;
}

.mmpages-nav-left {
  display: flex;
  align-items: center;
}

.mmpages-nav-right {
  display: flex;
  align-items: center;
  gap: 20px;
}

.mmpages-nav-icon {
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 26px;
  height: 26px;
}

.mmpages-nav-icon svg {
  width: 24px;
  height: 24px;
  stroke: var(--text-primary);
  stroke-width: 1.8;
  fill: none;
}

.mmpages-back-btn svg {
  width: 24px;
  height: 24px;
  stroke-width: 2.2;
}

/* ========== Profile Section ========== */
.mmpages-profile-section {
  padding: 16px 16px 16px;
  flex-shrink: 0;
}

.mmpages-profile-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 0;
}

.mmpages-profile-info {
  flex: 1;
  padding-top: 0;
}

.mmpages-display-name {
  font-size: 18px;
  font-weight: 700;
  margin-bottom: 12px;
  letter-spacing: -0.3px;
  color: var(--text-primary);
  line-height: 1.2;
}

.mmpages-username {
  font-size: 14px;
  color: var(--text-primary);
  margin-bottom: 12px;
  font-weight: 400;
}

.mmpages-bio {
  font-size: 14px;
  line-height: 1.35;
  margin-bottom: 4px;
  color: var(--text-primary);
  white-space: pre-wrap;
  word-break: break-word;
}

.mmpages-bio-note {
  font-size: 14px;
  color: var(--text-secondary);
  margin-bottom: 4px;
  line-height: 1.35;
}

.mmpages-followers-count {
  font-size: 13px;
  color: var(--text-tertiary);
  margin-bottom: 0;
}

.mmpages-profile-avatar {
  width: 64px;
  height: 64px;
  border-radius: 50%;
  overflow: hidden;
  flex-shrink: 0;
  background: linear-gradient(135deg, #f5e6d3 0%, #e5d5c5 100%);
}

.mmpages-profile-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* ========== Action Buttons ========== */
.mmpages-action-buttons {
  display: flex;
  gap: 8px;
  margin-top: 16px;
}

.mmpages-btn {
  flex: 1;
  padding: 8px 16px;
  border-radius: 12px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  text-align: center;
  border: none;
  font-family: inherit;
}

.mmpages-btn-primary {
  background-color: var(--text-primary);
  color: var(--bg-primary);
  border: 1.5px solid var(--text-primary);
}

.mmpages-btn-secondary {
  background-color: var(--bg-primary);
  color: var(--text-primary);
  border: 1.5px solid var(--border-color);
}

.mmpages-btn-primary:hover {
  opacity: 0.9;
}

.mmpages-btn-secondary:hover {
  background-color: var(--bg-secondary);
}

/* ========== Tabs ========== */
.mmpages-tabs-container {
  position: sticky;
  top: 56px;
  background-color: var(--bg-primary);
  z-index: 99;
  border-bottom: 0.5px solid var(--border-color);
  flex-shrink: 0;
  margin-top: 0;
}

.mmpages-tabs {
  display: flex;
}

.mmpages-tab {
  flex: 1;
  padding: 12px 0 11px;
  text-align: center;
  font-size: 14px;
  font-weight: 400;
  color: var(--text-tertiary);
  cursor: pointer;
  position: relative;
  transition: color 0.2s;
}

.mmpages-tab.active {
  color: var(--text-primary);
  font-weight: 600;
}

.mmpages-tab.active::after {
  content: '';
  position: absolute;
  bottom: -0.5px;
  left: 0;
  right: 0;
  height: 1.5px;
  background-color: var(--text-primary);
}

/* ========== Posts ========== */
.mmpages-posts-container {
  flex: 1;
  padding-bottom: 0;
  min-height: 200px;
}

.mmpages-post {
  padding: 12px 16px;
  border-bottom: 0.5px solid var(--post-separator);
}

.mmpages-post-header {
  display: flex;
  align-items: flex-start;
}

.mmpages-post-avatar-wrapper {
  position: relative;
  margin-right: 10px;
  flex-shrink: 0;
}

.mmpages-post-avatar {
  width: 38px;
  height: 38px;
  border-radius: 50%;
  overflow: hidden;
  background: linear-gradient(135deg, #f5e6d3 0%, #e5d5c5 100%);
}

.mmpages-post-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.mmpages-follow-badge {
  position: absolute;
  bottom: -2px;
  right: -2px;
  width: 18px;
  height: 18px;
  background-color: var(--text-primary);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 2px solid var(--bg-primary);
}

.mmpages-follow-badge svg {
  width: 10px;
  height: 10px;
  stroke: var(--bg-primary);
  stroke-width: 2.5;
  fill: none;
}

.mmpages-post-content {
  flex: 1;
  min-width: 0;
}

.mmpages-post-top-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 2px;
}

.mmpages-post-user-time {
  display: flex;
  align-items: center;
  gap: 4px;
}

.mmpages-post-username {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
}

.mmpages-post-time {
  font-size: 14px;
  color: var(--text-tertiary);
  font-weight: 400;
}

.mmpages-post-more {
  padding: 4px;
  cursor: pointer;
  display: flex;
  gap: 2.5px;
}

.mmpages-post-more span {
  width: 3.5px;
  height: 3.5px;
  background-color: var(--text-secondary);
  border-radius: 50%;
}

.mmpages-post-text {
  font-size: 14px;
  line-height: 1.4;
  margin-bottom: 10px;
  color: var(--text-primary);
  white-space: pre-wrap; /* ä¿ç•™æ¢è¡Œç¬¦å¹¶è‡ªåŠ¨æ¢è¡Œ */
  word-wrap: break-word; /* é•¿å•è¯è‡ªåŠ¨æ¢è¡Œ */
  overflow-wrap: break-word; /* æ›´å¥½çš„æ¢è¡Œå…¼å®¹æ€§ */
}

/* è¯é¢˜æ ‡ç­¾æ ·å¼ - é»‘ç™½ç°è®¾è®¡ */
.mmpages-hashtag,
.thread-hashtag {
  color: var(--text-secondary);
  font-weight: 500;
  text-decoration: none;
  cursor: pointer;
  transition: color 0.2s ease;
}

.mmpages-hashtag:hover,
.thread-hashtag:hover {
  color: var(--text-primary);
}

/* æåŠç”¨æˆ·æ ·å¼ - é»‘ç™½ç°è®¾è®¡ */
.mmpages-mention,
.thread-mention {
  color: var(--text-secondary);
  font-weight: 500;
  text-decoration: none;
  cursor: pointer;
  transition: color 0.2s ease;
}

.mmpages-mention:hover,
.thread-mention:hover {
  color: var(--text-primary);
}

/* Post images - horizontal scroll layout (å‚è€ƒthread-detail-preview) */
.mmpages-post-images {
  display: flex;
  gap: 8px;
  margin-bottom: 16px;
  overflow-x: auto; /* æ¨ªå‘æ»šåŠ¨ */
  padding-bottom: 4px;
  -webkit-overflow-scrolling: touch; /* iOS å¹³æ»‘æ»šåŠ¨ */
  scrollbar-width: none; /* Firefox éšè—æ»šåŠ¨æ¡ */
}

/* éšè—æ»šåŠ¨æ¡ï¼ˆWebkitæµè§ˆå™¨ï¼‰ */
.mmpages-post-images::-webkit-scrollbar {
  display: none;
}

.mmpages-post-image {
  flex-shrink: 0; /* é˜²æ­¢å‹ç¼© */
  /* ğŸ”¥ ã€è€ç‹ä¼˜åŒ–ã€‘è‡ªé€‚åº”å›¾ç‰‡æ¯”ä¾‹ - æ”¯æŒæ¨ªå›¾ã€ç«–å›¾ã€æ–¹å›¾ */
  max-width: 280px; /* æœ€å¤§å®½åº¦ï¼ˆæ¨ªå›¾é™åˆ¶ï¼‰ */
  max-height: 320px; /* æœ€å¤§é«˜åº¦ï¼ˆç«–å›¾é™åˆ¶ï¼‰ */
  min-width: 140px; /* æœ€å°å®½åº¦ï¼ˆé¿å…å¤ªå°ï¼‰ */
  height: auto; /* é«˜åº¦è‡ªé€‚åº” */
  border-radius: 12px;
  background: linear-gradient(135deg, #f0ebe6 0%, #e8e3de 100%);
  overflow: hidden;
  object-fit: contain; /* å®Œæ•´æ˜¾ç¤ºå›¾ç‰‡ï¼Œä¸è£å‰ª */
  display: block; /* ç¡®ä¿å›¾ç‰‡æ­£å¸¸æ˜¾ç¤º */
}

/* ç¬¬ä¸€å¼ å›¾ç‰‡å·¦å¯¹é½ */
.mmpages-post-image:first-child {
  margin-left: 0;
}

[data-theme='dark'] .mmpages-post-image {
  background: linear-gradient(135deg, #2a2520 0%, #1f1a16 100%);
}

.mmpages-post-image-christmas {
  background: linear-gradient(135deg, #3a2a1f 0%, #2a1f18 100%) !important;
}

/* æ–‡å­—æè¿°å›¾ç‰¹æ®Šæ ·å¼ */
.mmpages-image-desc {
  /* ğŸ”¥ æ–‡å­—å›¾ä¿æŒå›ºå®š3:4æ¯”ä¾‹ */
  width: 160px !important;
  height: 213px !important;
  max-width: 160px !important;
  max-height: 213px !important;
  min-width: 160px !important;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 14px;
}

.mmpages-image-desc-content {
  font-size: 12px;
  line-height: 1.5;
  color: var(--text-secondary);
  text-align: left;
  width: 100%;
  overflow-y: auto;
  word-wrap: break-word;
  white-space: pre-wrap;
}

.mmpages-post-actions {
  display: flex;
  align-items: center;
  gap: 0;
  margin-top: 2px;
}

.mmpages-action-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  cursor: pointer;
  padding: 8px 12px 8px 0;
}

.mmpages-action-btn svg {
  width: 21px;
  height: 21px;
  stroke: var(--text-primary);
  stroke-width: 1.6;
  fill: none;
}

.mmpages-action-btn.liked svg {
  fill: #ff3b5c;
  stroke: #ff3b5c;
}

.mmpages-action-btn span {
  font-size: 13px;
  color: var(--text-secondary);
  font-weight: 400;
}

/* Mmpages Empty State */
.mmpages-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 32px;
  text-align: center;
}

.mmpages-empty-state svg {
  width: 60px;
  height: 60px;
  stroke: var(--text-tertiary);
  stroke-width: 1.5;
  fill: none;
  margin-bottom: 16px;
  opacity: 0.4;
}

.mmpages-empty-state-title {
  font-size: 15px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 6px;
}

.mmpages-empty-state-desc {
  font-size: 13px;
  color: var(--text-secondary);
  line-height: 1.4;
}

/* ==================== Mmpages Edit Modal ==================== */
.mmpages-edit-overlay {
  position: fixed;
  inset: 0;
  background-color: rgba(0, 0, 0, 0.6);
  z-index: 10000;
  display: flex;
  align-items: flex-end;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.mmpages-edit-overlay.active {
  opacity: 1;
  pointer-events: auto;
}

.mmpages-edit-sheet {
  width: 100%;
  max-width: 430px;
  margin: 0 auto;
  background-color: var(--bg-primary);
  border-radius: 20px 20px 0 0;
  max-height: 50vh;
  display: flex;
  flex-direction: column;
  transform: translateY(100%);
  transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.mmpages-edit-overlay.active .mmpages-edit-sheet {
  transform: translateY(0);
}

.mmpages-edit-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 20px;
  border-bottom: 0.5px solid var(--border-color);
  flex-shrink: 0;
}

.mmpages-edit-title {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-primary);
}

.mmpages-edit-close {
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  border-radius: 50%;
  transition: background-color 0.2s;
}

.mmpages-edit-close:hover {
  background-color: var(--bg-tertiary);
}

.mmpages-edit-close svg {
  width: 18px;
  height: 18px;
  stroke: var(--text-primary);
  stroke-width: 2;
  fill: none;
}

.mmpages-edit-body {
  flex: 1;
  overflow-y: auto;
  padding: 0;
}

.mmpages-edit-row {
  padding: 9px 20px;
  position: relative;
}

.mmpages-edit-row::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 20px;
  right: 20px;
  height: 0.5px;
  background-color: var(--border-color);
}

.mmpages-edit-row:last-child::after {
  display: none;
}

.mmpages-edit-section {
  display: flex;
  flex-direction: column;
  gap: 5px;
}

.mmpages-edit-label {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
}

.mmpages-edit-input {
  width: 100%;
  padding: 6px 0;
  font-size: 15px;
  color: var(--text-primary);
  background: transparent;
  border: none;
  outline: none;
  font-family: inherit;
}

.mmpages-edit-input::placeholder {
  color: var(--text-tertiary);
}

.mmpages-edit-textarea {
  width: 100%;
  padding: 6px 0;
  font-size: 15px;
  color: var(--text-primary);
  background: transparent;
  border: none;
  outline: none;
  resize: none;
  font-family: inherit;
  line-height: 1.4;
}

.mmpages-edit-textarea::placeholder {
  color: var(--text-tertiary);
}

/* Name Row with Lock Icon & Avatar */
.mmpages-edit-name-row {
  display: flex;
  align-items: center;
  gap: 10px;
}

.mmpages-edit-lock-icon {
  flex-shrink: 0;
  width: 18px;
  height: 18px;
}

.mmpages-edit-lock-icon svg {
  width: 100%;
  height: 100%;
  stroke: var(--text-primary);
  stroke-width: 1.8;
  fill: none;
}

.mmpages-edit-name-row .mmpages-edit-input {
  flex: 1;
  padding: 4px 0;
}

.mmpages-edit-avatar-wrapper {
  flex-shrink: 0;
  width: 56px;
  height: 56px;
  border-radius: 50%;
  overflow: hidden;
  cursor: pointer;
  background: linear-gradient(135deg, #f5e6d3 0%, #e5d5c5 100%);
  transition: opacity 0.2s;
}

[data-theme='dark'] .mmpages-edit-avatar-wrapper {
  background: linear-gradient(135deg, #2a2520 0%, #1f1a16 100%);
}

.mmpages-edit-avatar-wrapper:hover {
  opacity: 0.8;
}

.mmpages-edit-avatar-wrapper img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* Followers Row */
.mmpages-edit-followers-row {
  display: flex;
  align-items: center;
  gap: 6px;
}

.mmpages-edit-followers-input {
  flex: 0 0 70px;
  padding: 4px 0;
  text-align: left;
}

.mmpages-edit-followers-unit {
  font-size: 15px;
  color: var(--text-primary);
  font-weight: 500;
}

.mmpages-edit-followers-text {
  font-size: 15px;
  color: var(--text-tertiary);
}

/* Footer */
.mmpages-edit-footer {
  display: flex;
  gap: 10px;
  padding: 12px 20px;
  padding-bottom: calc(12px + env(safe-area-inset-bottom, 0px));
  border-top: 0.5px solid var(--border-color);
  flex-shrink: 0;
}

.mmpages-edit-btn {
  flex: 1;
  padding: 11px 16px;
  border-radius: 10px;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  border: none;
  font-family: inherit;
}

.mmpages-edit-btn-cancel {
  background-color: var(--bg-tertiary);
  color: var(--text-primary);
}

.mmpages-edit-btn-cancel:hover {
  background-color: var(--bg-secondary);
}

.mmpages-edit-btn-save {
  background-color: var(--text-primary);
  color: var(--bg-primary);
}

.mmpages-edit-btn-save:hover {
  opacity: 0.9;
}

/* ==================== End Mmpages ==================== */

/* ==================== Image Gallery Drawer - åŠ¨æ€å›¾åº“æŠ½å±‰ ==================== */

/* é®ç½©å±‚ */
.image-gallery-drawer-overlay {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  z-index: 300;
  display: flex;
  align-items: flex-start;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s ease;
}

.image-gallery-drawer-overlay.active {
  opacity: 1;
  pointer-events: all;
}

/* æŠ½å±‰æœ¬ä½“ */
.image-gallery-drawer-sheet {
  width: 100%;
  max-height: 78vh;
  background: var(--bg-primary);
  border-radius: 0 0 16px 16px;
  transform: translateY(-100%);
  transition: transform 0.3s cubic-bezier(0.32, 0.72, 0, 1);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.image-gallery-drawer-overlay.active .image-gallery-drawer-sheet {
  transform: translateY(0);
}

/* Header */
.image-gallery-drawer-header {
  padding: 44px 16px 12px;
  border-bottom: 0.5px solid var(--border-color);
  flex-shrink: 0;
}

/* æ‹–æ‹½æ‰‹æŸ„ */
.image-gallery-drawer-handle {
  width: 32px;
  height: 4px;
  background: var(--border-color);
  border-radius: 2px;
  margin: 10px auto 0;
}

/* æ ‡é¢˜è¡Œ */
.image-gallery-drawer-title-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.image-gallery-drawer-title {
  font-size: 15px;
  font-weight: 600;
  color: var(--text-primary);
  letter-spacing: -0.2px;
}

.image-gallery-drawer-title svg {
  display: none;
}

.image-gallery-drawer-close {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background: transparent;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

.image-gallery-drawer-close:active {
  background: var(--bg-tertiary);
}

.image-gallery-drawer-close svg {
  width: 20px;
  height: 20px;
  stroke: var(--text-tertiary);
  stroke-width: 1.5;
  fill: none;
}

.image-gallery-drawer-subtitle {
  font-size: 12px;
  color: var(--text-tertiary);
  margin-top: 2px;
}

/* åˆ†ç±»åˆ—è¡¨å®¹å™¨ */
.image-gallery-category-list {
  padding: 8px 16px 12px;
  overflow-y: auto;
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 0;
  max-height: 40vh;
}

/* ç©ºçŠ¶æ€ */
.image-gallery-empty-state {
  text-align: center;
  padding: 40px 16px;
  color: var(--text-tertiary);
}

.image-gallery-empty-state svg {
  width: 36px;
  height: 36px;
  stroke: var(--border-color);
  stroke-width: 1;
  fill: none;
  margin-bottom: 10px;
}

.image-gallery-empty-state p {
  font-size: 13px;
  line-height: 1.4;
  margin: 0;
}

/* åˆ†ç±»é¡¹ */
.image-gallery-category-item {
  background: transparent;
  padding: 10px 0;
  display: flex;
  align-items: center;
  gap: 12px;
  border-bottom: 0.5px solid var(--border-color);
  cursor: pointer;
}

.image-gallery-category-item:last-child {
  border-bottom: none;
}

.image-gallery-category-item:active {
  opacity: 0.6;
  border-color: var(--border-color);
  transform: scale(0.98);
}

.image-gallery-category-item.disabled {
  opacity: 0.35;
}

/* åˆ†ç±»ç¼©ç•¥å›¾ */
.image-gallery-category-thumb {
  width: 44px;
  height: 44px;
  border-radius: 6px;
  background: var(--bg-tertiary);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  flex-shrink: 0;
}

.image-gallery-category-thumb img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.image-gallery-category-thumb svg {
  width: 18px;
  height: 18px;
  stroke: var(--text-tertiary);
  stroke-width: 1.5;
  fill: none;
}

/* åˆ†ç±»ä¿¡æ¯ */
.image-gallery-category-info {
  flex: 1;
  min-width: 0;
}

.image-gallery-category-name {
  font-size: 14px;
  font-weight: 400;
  color: var(--text-primary);
  margin-bottom: 2px;
  display: flex;
  align-items: center;
  gap: 6px;
}

.image-gallery-category-badge {
  font-size: 10px;
  padding: 1px 4px;
  border-radius: 2px;
  background: transparent;
  color: var(--text-tertiary);
  font-weight: 400;
  border: 0.5px solid var(--border-color);
}

.image-gallery-category-badge.universal {
  color: var(--text-tertiary);
}

.image-gallery-category-meta {
  font-size: 12px;
  color: var(--text-tertiary);
}

/* åˆ†ç±»æ“ä½œ */
.image-gallery-category-actions {
  display: flex;
  gap: 0;
  flex-shrink: 0;
}

.image-gallery-category-btn {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: transparent;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

.image-gallery-category-btn:active {
  background: var(--bg-tertiary);
}

.image-gallery-category-btn svg {
  width: 18px;
  height: 18px;
  stroke: var(--text-tertiary);
  stroke-width: 1.5;
  fill: none;
}

.image-gallery-category-btn.delete svg {
  stroke: var(--text-tertiary);
}

/* æ·»åŠ åˆ†ç±»åŒºåŸŸ */
.image-gallery-add-section {
  padding: 12px 16px 16px;
  border-top: 0.5px solid var(--border-color);
}

.image-gallery-add-title {
  font-size: 11px;
  font-weight: 500;
  color: var(--text-tertiary);
  margin-bottom: 8px;
  text-transform: uppercase;
  letter-spacing: 0.3px;
}

.image-gallery-add-title svg {
  display: none;
}

.image-gallery-add-form {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.image-gallery-add-row {
  display: flex;
  gap: 8px;
}

.image-gallery-input {
  flex: 1;
  height: 36px;
  padding: 0 12px;
  border: 0.5px solid var(--border-color);
  border-radius: 6px;
  background: var(--bg-secondary);
  color: var(--text-primary);
  font-size: 14px;
}

.image-gallery-input:focus {
  outline: none;
  border-color: var(--text-tertiary);
}

.image-gallery-input::placeholder {
  color: var(--text-tertiary);
}

.image-gallery-select {
  width: 110px;
  height: 36px;
  padding: 0 8px;
  border: 0.5px solid var(--border-color);
  border-radius: 6px;
  background: var(--bg-secondary);
  color: var(--text-primary);
  font-size: 13px;
  cursor: pointer;
}

.image-gallery-add-btn {
  height: 36px;
  padding: 0 14px;
  border: none;
  border-radius: 6px;
  background: var(--text-primary);
  color: var(--bg-primary);
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
}

.image-gallery-add-btn:active {
  opacity: 0.7;
}

.image-gallery-add-btn svg {
  display: none;
}

/* ========== å›¾ç‰‡ç®¡ç†é¢æ¿ ========== */

.image-gallery-images-panel {
  display: none;
}

.image-gallery-images-panel.active {
  display: flex;
  flex-direction: column;
}

/* é¢æ¿å¤´éƒ¨ */
.image-gallery-images-header {
  padding: 44px 16px 12px;
  border-bottom: 0.5px solid var(--border-color);
  display: flex;
  align-items: center;
  gap: 10px;
}

.image-gallery-images-back {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: transparent;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  flex-shrink: 0;
}

.image-gallery-images-back:active {
  background: var(--bg-tertiary);
}

.image-gallery-images-back svg {
  width: 20px;
  height: 20px;
  stroke: var(--text-primary);
  stroke-width: 1.5;
  fill: none;
}

.image-gallery-images-title-area {
  flex: 1;
  min-width: 0;
}

.image-gallery-images-title {
  font-size: 15px;
  font-weight: 600;
  color: var(--text-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.image-gallery-images-count {
  font-size: 12px;
  color: var(--text-tertiary);
  margin-top: 1px;
}

.image-gallery-toggle-wrap {
  display: flex;
  align-items: center;
  gap: 6px;
  flex-shrink: 0;
}

.image-gallery-toggle-label {
  font-size: 11px;
  color: var(--text-tertiary);
}

/* å›¾ç‰‡ç½‘æ ¼ */
.image-gallery-images-grid {
  padding: 2px;
  overflow-y: auto;
  flex: 1;
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 2px;
  max-height: 48vh;
}

/* å›¾ç‰‡é¡¹ */
.image-gallery-image-item {
  aspect-ratio: 1;
  background: var(--bg-tertiary);
  overflow: hidden;
  position: relative;
  cursor: pointer;
}

.image-gallery-image-item:active {
  opacity: 0.7;
}

.image-gallery-image-item img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.image-gallery-image-item .image-error {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-tertiary);
  font-size: 10px;
}

/* å›¾ç‰‡æè¿°æ ‡è®° */
.image-gallery-image-desc-badge {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 16px 6px 4px;
  background: linear-gradient(transparent, rgba(0, 0, 0, 0.6));
  font-size: 10px;
  color: #fff;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* åˆ é™¤æŒ‰é’® */
.image-gallery-image-delete {
  position: absolute;
  top: 4px;
  right: 4px;
  width: 22px;
  height: 22px;
  border-radius: 50%;
  background: rgba(0, 0, 0, 0.5);
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.15s;
}

.image-gallery-image-item:hover .image-gallery-image-delete,
.image-gallery-image-item:active .image-gallery-image-delete {
  opacity: 1;
}

.image-gallery-image-delete svg {
  width: 12px;
  height: 12px;
  stroke: #fff;
  stroke-width: 2;
  fill: none;
}

/* æ·»åŠ å›¾ç‰‡é¡¹ */
.image-gallery-add-image-item {
  aspect-ratio: 1;
  background: var(--bg-secondary);
  border: 1px dashed var(--border-color);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 4px;
  cursor: pointer;
}

.image-gallery-add-image-item:active {
  background: var(--bg-tertiary);
}

.image-gallery-add-image-item svg {
  width: 20px;
  height: 20px;
  stroke: var(--text-tertiary);
  stroke-width: 1.5;
  fill: none;
}

.image-gallery-add-image-item span {
  font-size: 10px;
  color: var(--text-tertiary);
}

/* ========== æ·»åŠ å›¾ç‰‡å¼¹çª— ========== */

.image-gallery-add-modal {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 310;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s;
}

.image-gallery-add-modal.active {
  opacity: 1;
  pointer-events: all;
}

.image-gallery-add-modal-content {
  width: 100%;
  max-width: 300px;
  background: var(--bg-primary);
  border-radius: 14px;
  padding: 20px;
  transform: scale(0.95);
  transition: transform 0.2s ease;
}

.image-gallery-add-modal.active .image-gallery-add-modal-content {
  transform: scale(1);
}

.image-gallery-add-modal-title {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 16px;
  text-align: center;
}

.image-gallery-add-modal-form {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.image-gallery-add-modal-label {
  font-size: 12px;
  font-weight: 500;
  color: var(--text-tertiary);
  margin-bottom: 4px;
  display: block;
}

.image-gallery-add-modal-input {
  width: 100%;
  height: 40px;
  padding: 0 12px;
  border: 0.5px solid var(--border-color);
  border-radius: 8px;
  background: var(--bg-secondary);
  color: var(--text-primary);
  font-size: 14px;
}

.image-gallery-add-modal-input:focus {
  outline: none;
  border-color: var(--text-tertiary);
}

.image-gallery-add-modal-textarea {
  width: 100%;
  height: 70px;
  padding: 10px 12px;
  border: 0.5px solid var(--border-color);
  border-radius: 8px;
  background: var(--bg-secondary);
  color: var(--text-primary);
  font-size: 14px;
  resize: none;
}

.image-gallery-add-modal-textarea:focus {
  outline: none;
  border-color: var(--text-tertiary);
}

/* é¢„è§ˆæ¡† */
.image-gallery-preview-box {
  width: 100%;
  height: 100px;
  border-radius: 8px;
  background: var(--bg-tertiary);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.image-gallery-preview-box img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
}

.image-gallery-preview-box .preview-placeholder {
  color: var(--text-tertiary);
  font-size: 11px;
  text-align: center;
}

.image-gallery-preview-box .preview-placeholder svg {
  width: 24px;
  height: 24px;
  stroke: var(--border-color);
  stroke-width: 1;
  fill: none;
  margin-bottom: 4px;
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.image-gallery-add-modal-btns {
  display: flex;
  gap: 8px;
  margin-top: 4px;
}

.image-gallery-add-modal-btn {
  flex: 1;
  height: 40px;
  border: none;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
}

.image-gallery-add-modal-btn.cancel {
  background: var(--bg-tertiary);
  color: var(--text-secondary);
}

.image-gallery-add-modal-btn.confirm {
  background: var(--text-primary);
  color: var(--bg-primary);
}

.image-gallery-add-modal-btn:active {
  opacity: 0.7;
}

/* ========== Toggleå¼€å…³æ ·å¼ ========== */

.image-gallery-toggle {
  width: 40px;
  height: 22px;
  border-radius: 11px;
  background: var(--bg-tertiary);
  border: 0.5px solid var(--border-color);
  position: relative;
  cursor: pointer;
  transition: background 0.2s;
}

.image-gallery-toggle.active {
  background: var(--text-primary);
  border-color: var(--text-primary);
}

.image-gallery-toggle::after {
  content: '';
  position: absolute;
  top: 2px;
  left: 2px;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: var(--text-tertiary);
  transition: left 0.2s, background 0.2s;
}

.image-gallery-toggle.active::after {
  left: 20px;
  background: var(--bg-primary);
}

/* ==================== End Image Gallery Drawer ==================== */

/* ==========================================
   Thread Detail Screen - è§’è‰²åŠ¨æ€è¯¦æƒ…é¡µ
   ========================================== */

/* Thread Detail ä¸“ç”¨æ»‘åŠ¨è¿‡æ¸¡åŠ¨ç”» */
#threadDetailScreen {
  /* è¦†ç›–é»˜è®¤çš„display:noneï¼Œæ”¹ç”¨transforméšè— */
  display: flex !important;
  opacity: 1;
  transform: translateX(100%);
  pointer-events: none;
  transition: transform 0.35s cubic-bezier(0.32, 0.72, 0, 1);
}

#threadDetailScreen.active {
  transform: translateX(0);
  pointer-events: auto;
}

/* é€€å‡ºåŠ¨ç”»ï¼šå‘å³æ»‘å‡º */
#threadDetailScreen.closing {
  transform: translateX(100%);
  pointer-events: none;
}

/* Thread Detail ç‹¬ç«‹é…è‰²å˜é‡ - å¤œé—´ä¸»é¢˜ */
.thread-detail-container {
  /* å¤œé—´ä¸»é¢˜å˜é‡ - ä¸æ˜¯çº¯é»‘ï¼Œç•¥å¸¦ç°è‰² */
  --thread-bg-primary: #0d0d0d;
  --thread-bg-secondary: #141414;
  --thread-bg-tertiary: #1c1c1c;
  --thread-bg-input: #262626;
  --thread-text-primary: #f5f5f5;
  --thread-text-secondary: #a8a8a8;
  --thread-text-tertiary: #737373;
  --thread-border-color: #2a2a2a;
  --thread-icon-color: #f5f5f5;
  --thread-icon-inactive: #737373;
  --thread-accent-blue: #1d9bf0;
  --thread-accent-blue-hover: #1a8cd8;
  --thread-author-bg: transparent;
  --thread-author-text: #a8a8a8;
  --thread-divider: #262626;
  --thread-reply-line: #3a3a3a;
  --thread-hover-bg: rgba(255, 255, 255, 0.03);
  /* follow badge - å¤œé—´ï¼šç™½è‰²å¡«å……ï¼Œé»‘è‰²è¾¹æ¡†ï¼Œé»‘è‰²åå­— */
  --thread-badge-bg: #f5f5f5;
  --thread-badge-border: #0d0d0d;
  --thread-badge-icon: #0d0d0d;

  width: 100%;
  background-color: var(--thread-bg-primary);
  color: var(--thread-text-primary);
  height: 100%;
  overflow-y: auto;
  position: relative;
}

/* Thread Detail æ—¥é—´ä¸»é¢˜é…è‰² */
[data-theme='light'] .thread-detail-container {
  /* æ—¥é—´ä¸»é¢˜å˜é‡ - æ¸…çˆ½çº¯å‡€çš„ç™½è‰²ç³» */
  --thread-bg-primary: #ffffff;
  --thread-bg-secondary: #ffffff;
  --thread-bg-tertiary: #f8f9fa;
  --thread-bg-input: #f0f2f5;
  --thread-text-primary: #0f1419;
  --thread-text-secondary: #536471;
  --thread-text-tertiary: #8899a6;
  --thread-border-color: #eff3f4;
  --thread-icon-color: #0f1419;
  --thread-icon-inactive: #536471;
  --thread-accent-blue: #1d9bf0;
  --thread-accent-blue-hover: #1a8cd8;
  --thread-author-bg: transparent;
  --thread-author-text: #536471;
  --thread-divider: #eff3f4;
  --thread-reply-line: #cfd9de;
  --thread-hover-bg: rgba(0, 0, 0, 0.03);
  /* follow badge - æ—¥é—´ï¼šé»‘è‰²å¡«å……ï¼Œç™½è‰²è¾¹æ¡†ï¼Œç™½è‰²åå­— */
  --thread-badge-bg: #0f1419;
  --thread-badge-border: #ffffff;
  --thread-badge-icon: #ffffff;
}

/* é¡¶éƒ¨å¯¼èˆªæ  */
.thread-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  /* ğŸ”¥ ä½¿ç”¨å…¨å±€App Header paddingå˜é‡ */
  padding: var(--app-header-total-padding) 14px 10px;
  position: sticky;
  top: 0;
  background-color: var(--thread-bg-primary);
  z-index: 100;
}

.thread-header-left {
  display: flex;
  align-items: center;
  gap: 16px;
}

.thread-back-btn {
  background: none;
  border: none;
  color: var(--thread-text-primary);
  cursor: pointer;
  padding: 8px;
  margin: -8px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.thread-back-btn svg {
  width: 18px;
  height: 18px;
}

.thread-header-title {
  display: flex;
  flex-direction: column;
}

.thread-header-title h1 {
  font-size: 16px;
  font-weight: 700;
  line-height: 1.2;
}

.thread-views {
  font-size: 12px;
  color: var(--thread-text-secondary);
  font-weight: 400;
}

.thread-header-right {
  display: flex;
  align-items: center;
  gap: 8px;
}

.thread-header-btn {
  background: none;
  border: none;
  color: var(--thread-text-primary);
  cursor: pointer;
  padding: 8px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background-color 0.2s;
}

.thread-header-btn:hover {
  background-color: var(--thread-hover-bg);
}

.thread-header-btn svg {
  width: 20px;
  height: 20px;
}

/* åŸå¸–åŒºåŸŸ */
.thread-original-post {
  padding: 14px;
  position: relative;
}

.thread-post-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 10px;
}

.thread-original-post::after {
  content: '';
  position: absolute;
  left: 14px;
  right: 14px;
  bottom: 0;
  height: 1px;
  background-color: var(--thread-divider);
}

.thread-post-author {
  display: flex;
  align-items: center;
  gap: 12px;
}

.thread-avatar-container {
  position: relative;
}

.thread-avatar {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  object-fit: cover;
  background-color: var(--thread-bg-tertiary);
}

.thread-author-info {
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 6px;
}

.thread-author-name {
  font-weight: 700;
  font-size: 13px;
  color: var(--thread-text-primary);
}

.thread-post-time {
  font-size: 12px;
  color: var(--thread-text-secondary);
}

.thread-follow-btn {
  background-color: var(--thread-text-primary);
  color: var(--thread-bg-primary);
  border: none;
  border-radius: 18px;
  padding: 6px 14px;
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
  transition: opacity 0.2s;
}

.thread-follow-btn:hover {
  opacity: 0.9;
}

.thread-post-content {
  font-size: 13px;
  line-height: 1.4;
  margin-top: 10px;
  margin-bottom: 10px;
  word-wrap: break-word;
  white-space: pre-wrap; /* ä¿ç•™æ¢è¡Œç¬¦å¹¶è‡ªåŠ¨æ¢è¡Œ */
  overflow-wrap: break-word; /* æ›´å¥½çš„æ¢è¡Œå…¼å®¹æ€§ */
}

/* å¸–å­é…å›¾åŒºåŸŸ */
.thread-post-images {
  display: flex;
  gap: 8px;
  margin-bottom: 16px;
  overflow-x: auto;
  padding-bottom: 4px;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: none;
}

.thread-post-images::-webkit-scrollbar {
  display: none;
}

.thread-post-image {
  flex-shrink: 0;
  /* ğŸ”¥ ã€è€ç‹ä¼˜åŒ–ã€‘è‡ªé€‚åº”å›¾ç‰‡æ¯”ä¾‹ - æ”¯æŒæ¨ªå›¾ã€ç«–å›¾ã€æ–¹å›¾ */
  max-width: 320px; /* æœ€å¤§å®½åº¦ï¼ˆæ¨ªå›¾é™åˆ¶ï¼‰ */
  max-height: 380px; /* æœ€å¤§é«˜åº¦ï¼ˆç«–å›¾é™åˆ¶ï¼‰ */
  min-width: 160px; /* æœ€å°å®½åº¦ï¼ˆé¿å…å¤ªå°ï¼‰ */
  height: auto; /* é«˜åº¦è‡ªé€‚åº” */
  border-radius: 12px;
  object-fit: contain; /* å®Œæ•´æ˜¾ç¤ºå›¾ç‰‡ï¼Œä¸è£å‰ª */
  background-color: var(--thread-bg-tertiary);
  display: block; /* ç¡®ä¿å›¾ç‰‡æ­£å¸¸æ˜¾ç¤º */
}

/* æ–‡å­—æè¿°å›¾ç‰¹æ®Šæ ·å¼ - Thread Detail */
.thread-image-desc {
  /* ğŸ”¥ æ–‡å­—å›¾ä¿æŒå›ºå®šæ¯”ä¾‹ */
  width: 200px !important;
  height: 280px !important;
  max-width: 200px !important;
  max-height: 280px !important;
  min-width: 200px !important;
  background: var(--thread-bg-secondary);
  border: 1px solid var(--thread-border-color);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 14px;
}

.thread-image-desc-content {
  font-size: 12px;
  line-height: 1.5;
  color: var(--thread-text-secondary);
  text-align: left;
  width: 100%;
  height: 100%;
  overflow-y: auto;
  white-space: pre-wrap; /* ä¿ç•™æ¢è¡Œç¬¦å¹¶è‡ªåŠ¨æ¢è¡Œ */
  word-wrap: break-word; /* é•¿å•è¯è‡ªåŠ¨æ¢è¡Œ */
  overflow-wrap: break-word; /* æ›´å¥½çš„æ¢è¡Œå…¼å®¹æ€§ */
}

/* äº’åŠ¨æ  */
.thread-post-actions {
  display: flex;
  align-items: center;
  gap: 4px;
}

.thread-action-item {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 12px 8px 0;
  cursor: pointer;
  transition: color 0.2s;
}

.thread-action-item:hover {
  color: #888;
}

.thread-action-item svg {
  width: 20px;
  height: 20px;
  color: var(--thread-icon-inactive);
}

.thread-action-item:hover svg {
  color: #888;
  stroke: #888;
}

.thread-action-item.thread-liked svg {
  fill: #888;
  stroke: #888;
}

.thread-action-count {
  font-size: 13px;
  color: var(--thread-text-secondary);
}

/* æ’åºåŒºåŸŸ */
.thread-sort-section {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 14px;
  position: relative;
}

.thread-sort-section::after {
  content: '';
  position: absolute;
  left: 14px;
  right: 14px;
  bottom: 0;
  height: 1px;
  background-color: var(--thread-divider);
}

.thread-sort-dropdown {
  display: flex;
  align-items: center;
  gap: 4px;
  cursor: pointer;
  font-size: 13px;
  font-weight: 700;
  color: var(--thread-text-primary);
}

.thread-sort-dropdown svg {
  width: 16px;
  height: 16px;
}

.thread-view-activity {
  display: flex;
  align-items: center;
  gap: 4px;
  cursor: pointer;
  font-size: 12px;
  color: var(--thread-text-secondary);
}

.thread-view-activity svg {
  width: 16px;
  height: 16px;
}

/* è¯„è®ºåˆ—è¡¨ */
.thread-comments-list {
  padding-bottom: 80px;
}

.thread-comment-item {
  padding: 10px 14px;
  position: relative;
  transition: background-color 0.2s;
}

.thread-comment-item::after {
  content: '';
  position: absolute;
  left: 14px;
  right: 14px;
  bottom: 0;
  height: 1px;
  background-color: var(--thread-divider);
}

/* å›å¤æ¥¼å±‚ - ä¸è¢«å›å¤æ¥¼ä¹‹é—´æ²¡æœ‰åˆ†å‰²çº¿ */
.thread-comment-item.is-reply {
  padding-top: 4px;
}

/* æ¥¼ä¸­æ¥¼å›å¤ä¹‹é—´æ²¡æœ‰åˆ†å‰²çº¿ï¼ˆé™¤äº†æœ€åä¸€æ¡ï¼‰ */
.thread-comment-item.is-reply:not(.is-last-reply)::after {
  display: none;
}

/* æœ‰å›å¤çš„è¯„è®º - ä¸å›å¤æ¥¼ä¹‹é—´æ²¡æœ‰åˆ†å‰²çº¿ */
.thread-comment-item.has-reply {
  padding-bottom: 4px;
}

.thread-comment-item.has-reply::after {
  display: none;
}

.thread-comment-item:hover {
  background-color: var(--thread-hover-bg);
}

.thread-comment-wrapper {
  display: flex;
  gap: 12px;
}

.thread-comment-avatar-section {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.thread-comment-avatar {
  position: relative;
}

.thread-comment-avatar img {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  object-fit: cover;
  background-color: var(--thread-bg-tertiary);
}

.thread-follow-badge {
  position: absolute;
  bottom: -2px;
  right: -2px;
  width: 18px;
  height: 18px;
  background-color: var(--thread-badge-bg);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 2px solid var(--thread-badge-border);
}

.thread-follow-badge svg {
  width: 10px;
  height: 10px;
  color: var(--thread-badge-icon);
}

.thread-reply-line {
  width: 2px;
  flex-grow: 1;
  background-color: var(--thread-reply-line);
  margin-top: 8px;
  border-radius: 1px;
}

.thread-comment-content {
  flex: 1;
  min-width: 0;
}

.thread-comment-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 4px;
}

.thread-comment-meta {
  display: flex;
  align-items: center;
  gap: 6px;
  flex-wrap: wrap;
}

.thread-comment-username {
  font-weight: 700;
  font-size: 13px;
  color: var(--thread-text-primary);
}

.thread-comment-time {
  font-size: 12px;
  color: var(--thread-text-secondary);
}

.thread-author-badge {
  font-size: 13px;
  color: var(--thread-text-secondary);
}

.thread-comment-more {
  background: none;
  border: none;
  color: var(--thread-text-secondary);
  cursor: pointer;
  padding: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.thread-comment-more svg {
  width: 18px;
  height: 18px;
}

.thread-comment-text {
  font-size: 13px;
  line-height: 1.35;
  margin-bottom: 6px;
  word-wrap: break-word;
  white-space: pre-wrap; /* ä¿ç•™æ¢è¡Œç¬¦å¹¶è‡ªåŠ¨æ¢è¡Œ */
  overflow-wrap: break-word; /* æ›´å¥½çš„æ¢è¡Œå…¼å®¹æ€§ */
}

.thread-comment-actions {
  display: flex;
  align-items: center;
  gap: 2px;
  margin-left: -8px;
}

.thread-comment-action {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 8px;
  cursor: pointer;
  color: var(--thread-icon-inactive);
  transition: color 0.2s;
}

.thread-comment-action:hover {
  color: #888;
}

.thread-comment-action:hover svg {
  stroke: #888;
}

.thread-comment-action.thread-liked svg {
  fill: #888;
  stroke: #888;
}

.thread-comment-action svg {
  width: 18px;
  height: 18px;
}

.thread-comment-action-count {
  font-size: 13px;
  color: var(--thread-text-secondary);
}

/* Show replies - ç¼©ç•¥å›¾åœ¨å¤´åƒåˆ—ï¼Œæ–‡å­—åœ¨å†…å®¹åˆ— */
.thread-show-replies-avatars {
  display: flex;
  align-items: center;
  margin-top: 8px;
}

.thread-show-replies-avatar {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  border: 2px solid var(--thread-bg-primary);
  margin-left: -6px;
  background-color: var(--thread-bg-tertiary);
  object-fit: cover;
}

.thread-show-replies-avatar:first-child {
  margin-left: 0;
}

.thread-show-replies-icon {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background-color: var(--thread-badge-bg);
  display: flex;
  align-items: center;
  justify-content: center;
  margin-left: -6px;
  border: 2px solid var(--thread-badge-border);
}

.thread-show-replies-icon svg {
  width: 10px;
  height: 10px;
  color: var(--thread-badge-icon);
}

.thread-show-replies-text {
  margin-top: 8px;
  cursor: pointer;
  color: var(--thread-text-secondary);
  font-size: 14px;
  display: flex;
  align-items: center;
  height: 24px;
}

/* åº•éƒ¨å›å¤æ¡† - æ— èƒŒæ™¯ï¼Œæ¤­åœ†ç›´æ¥æµ®åœ¨é¡µé¢ä¸Š */
.thread-reply-bar {
  position: fixed;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 100%;
  max-width: 400px;
  padding: 12px 16px;
  z-index: 100;
  pointer-events: none;
}

/* æ•´ä½“æ¤­åœ†è¾“å…¥æ¡†å®¹å™¨ */
.thread-reply-input-wrapper {
  display: flex;
  align-items: center;
  background-color: var(--thread-bg-input);
  border-radius: 24px;
  padding: 6px 12px 6px 6px;
  gap: 10px;
  pointer-events: auto;
}

.thread-reply-avatar {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  object-fit: cover;
  background-color: var(--thread-bg-tertiary);
  flex-shrink: 0;
  cursor: pointer;
  transition: transform 0.15s ease, box-shadow 0.15s ease;
}

.thread-reply-avatar:hover {
  transform: scale(1.05);
}

.thread-reply-avatar:active {
  transform: scale(0.95);
}

/* ğŸ”¥ ç”¨æˆ·èµ„æ–™é€‰æ‹©å™¨å®¹å™¨ */
.thread-profile-picker-container {
  position: relative;
  flex-shrink: 0;
}

/* ğŸ”¥ ç”¨æˆ·èµ„æ–™é€‰æ‹©å™¨å¼¹çª— - 3x3ç½‘æ ¼ */
.thread-profile-picker {
  position: absolute;
  bottom: calc(100% + 8px);
  left: -6px;  /* ä»å·¦ä¾§å¼€å§‹ï¼Œç•™å‡ºå°ç®­å¤´ç©ºé—´ */
  transform: scale(0.9);
  transform-origin: bottom left;  /* åŠ¨ç”»ä»å·¦ä¸‹è§’å±•å¼€ */
  background: var(--thread-bg-secondary);
  border: 1px solid var(--thread-border-color);
  border-radius: 12px;
  padding: 6px;
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 4px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
  opacity: 0;
  visibility: hidden;
  transition: all 0.2s cubic-bezier(0.32, 0.72, 0, 1);
  z-index: 200;
}

.thread-profile-picker.active {
  opacity: 1;
  visibility: visible;
  transform: scale(1);
}

/* å°ä¸‰è§’ç®­å¤´ - æŒ‡å‘å¤´åƒä½ç½® */
.thread-profile-picker::after {
  content: '';
  position: absolute;
  bottom: -6px;
  left: 16px;  /* ç®­å¤´æŒ‡å‘å¤´åƒä¸­å¿ƒ (6px padding + 18pxåŠå¾„) */
  transform: none;
  border-left: 6px solid transparent;
  border-right: 6px solid transparent;
  border-top: 6px solid var(--thread-bg-secondary);
}

/* å•ä¸ªå¤´åƒé€‰é¡¹ */
.thread-profile-option {
  position: relative;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  cursor: pointer;
  transition: transform 0.15s ease;
}

.thread-profile-option:hover {
  transform: scale(1.1);
}

.thread-profile-option:active {
  transform: scale(0.95);
}

.thread-profile-option img {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid transparent;
  transition: border-color 0.15s ease;
}

.thread-profile-option.selected img {
  border-color: var(--thread-accent-blue);
}

/* é€‰ä¸­æ ‡è®° */
.thread-profile-check {
  position: absolute;
  bottom: -2px;
  right: -2px;
  width: 14px;
  height: 14px;
  background: var(--thread-accent-blue);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 8px;
  color: white;
  font-weight: bold;
}

/* æ—¥é—´æ¨¡å¼é€‚é… */
[data-theme='light'] .thread-profile-picker {
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
}

.thread-reply-input {
  flex: 1;
  background: none;
  border: none;
  outline: none;
  color: var(--thread-text-primary);
  font-size: 15px;
  min-width: 0;
}

.thread-reply-input::placeholder {
  color: var(--thread-text-tertiary);
}

.thread-reply-actions {
  display: flex;
  align-items: center;
  gap: 4px;
  flex-shrink: 0;
}

.thread-reply-action-btn {
  background: none;
  border: none;
  color: var(--thread-text-secondary);
  cursor: pointer;
  padding: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.thread-reply-action-btn svg {
  width: 22px;
  height: 22px;
}

/* ==================== End Thread Detail ==================== */

/* ========================================
 * ğŸ“¸ å›¾ç‰‡ç»„ä»¶ Photo Widget
 * æ”¯æŒ 2x2 å’Œ 4x2 å°ºå¯¸
 * çº¯CSSè‡ªé€‚åº”ï¼Œæ— éœ€ç‰¹æ®Šå¤„ç†
 * ======================================== */

/* 4x2å›¾ç‰‡ç»„ä»¶ - å¼ºåˆ¶é™åˆ¶æº¢å‡º */
.desktop-widget.widget-photo {
  overflow: hidden !important;
}

/* å›¾ç‰‡ç»„ä»¶å®¹å™¨ - flex columnå¸ƒå±€ */
.photo-widget {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  gap: 4px;
  box-sizing: border-box;
  overflow: hidden;
  margin: 0;
  padding: 0;
  align-items: stretch;
}

/* å›¾ç‰‡å†…å®¹åŒºåŸŸ - flex: 1 è‡ªé€‚åº” */
.photo-widget-content {
  width: 100%;
  max-width: 100%;
  border-radius: 16px;
  overflow: hidden;
  position: relative;
  cursor: pointer;
  transition: transform 0.2s ease;
  flex: 1;
  min-width: 0;
  min-height: 0;
}

.photo-widget-content:hover {
  transform: scale(0.98);
}

/* å›¾ç‰‡å…ƒç´  - 100%å¡«å…… */
.photo-widget-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center;
  display: block;
}

/* é€æ˜åº•å›¾ç‰‡ - containæ¨¡å¼ */
.photo-widget-image.transparent-mode {
  object-fit: contain;
  background:
    linear-gradient(45deg, rgba(255,255,255,0.08) 25%, transparent 25%),
    linear-gradient(-45deg, rgba(255,255,255,0.08) 25%, transparent 25%),
    linear-gradient(45deg, transparent 75%, rgba(255,255,255,0.08) 75%),
    linear-gradient(-45deg, transparent 75%, rgba(255,255,255,0.08) 75%);
  background-size: 16px 16px;
  background-position: 0 0, 0 8px, 8px -8px, -8px 0px;
}

/* æ•ˆæœå±‚ - ä¼ªå…ƒç´  */
.photo-widget-content::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
}

/* æ— æ•ˆæœ */
.photo-widget-content.effect-none::after {
  display: none;
}

/* ç£¨ç ‚æ•ˆæœ */
.photo-widget-content.effect-frosted::after {
  backdrop-filter: blur(0.5px) brightness(1.02);
  background: linear-gradient(
    135deg,
    rgba(255, 255, 255, 0.06) 0%,
    rgba(255, 255, 255, 0.03) 100%
  );
}

/* ç»ç’ƒæ•ˆæœ */
.photo-widget-content.effect-glass::after {
  backdrop-filter: blur(1px) saturate(1.1);
  background: linear-gradient(
    135deg,
    rgba(255, 255, 255, 0.12) 0%,
    rgba(255, 255, 255, 0.06) 50%,
    rgba(255, 255, 255, 0.03) 100%
  );
  box-shadow: inset 0 1px 1px rgba(255, 255, 255, 0.2);
}

/* åº•éƒ¨æ–‡å­—æ ‡ç­¾ - åœ¨å›¾ç‰‡å¤–é¢ */
.photo-widget-label {
  font-size: 10px;
  color: var(--text-secondary);
  text-align: center;
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding: 0 4px;
  line-height: 1.2;
  flex-shrink: 0;
  height: 14px;
}

/* éšè—æ ‡ç­¾ */
.photo-widget-label.hidden {
  display: none;
}

/* å ä½ç¬¦ï¼ˆç©ºç»„ä»¶çŠ¶æ€ï¼‰ */
.photo-widget-placeholder {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 8px;
  color: var(--text-tertiary);
  font-size: 11px;
}

.photo-widget-placeholder svg {
  width: 28px;
  height: 28px;
  stroke: currentColor;
  fill: none;
  stroke-width: 2;
  opacity: 0.6;
}

/* ========== End Photo Widget ========== */

/* ========================================
 * ğŸ“¸ Polaroid Widget - 4x2
 * ä¸‰å¼ æ‹ç«‹å¾— + æ˜Ÿæ˜Ÿè£…é¥°ï¼ˆç‚¹å‡»ä¸Šä¼ ï¼‰
 * ======================================== */

.polaroid-widget {
  width: 100%;
  height: 100%;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px; /* Space between polaroids, adjusted to fit */
  padding: 23px 9px; /* Padding for stars to overlap, adjusted to fit 368x176 */
  box-sizing: border-box; /* é˜²æ­¢paddingå¯¼è‡´æº¢å‡º */
  overflow: hidden; /* é˜²æ­¢æ˜Ÿæ˜Ÿç­‰å…ƒç´ æº¢å‡ºå¯¼è‡´é¡µé¢æ‹‰å®½ */
  user-select: none;
  -webkit-user-select: none;
  -webkit-tap-highlight-color: transparent;
}

.polaroid-star {
  position: absolute;
  width: 50px; /* Adjusted star size to fit smaller cards */
  height: 50px; /* Adjusted star size */
  background-color: #555; /* Dark gray color, explicitly background-color */
  clip-path: polygon(
    50% 0%,
    61% 35%,
    98% 35%,
    68% 57%,
    79% 91%,
    50% 70%,
    21% 91%,
    32% 57%,
    2% 35%,
    39% 35%
  );
  z-index: 1; /* Keep it above polaroids */
}

.polaroid-star-1 {
  top: 0px;
  left: 0px;
  transform: rotate(-20deg);
  width: 70px; /* Adjusted size */
  height: 70px; /* Adjusted size */
}

.polaroid-star-2 {
  top: 10px;
  right: 100px; /* Changed from left to right for better spread */
  transform: rotate(30deg);
  width: 50px; /* Default star size */
  height: 50px; /* Default star size */
}

.polaroid-star-3 {
  bottom: 0px;
  right: 0px;
  transform: rotate(-10deg);
  width: 85px; /* Adjusted size */
  height: 85px; /* Adjusted size */
}

.polaroid-card {
  --polaroid-rot: 0deg; /* Keep the variable definition */
  flex: 1 1 0;
  min-width: 0;
  max-width: 29.89%; /* Adjusted to scale proportionally to 90px content width */
  height: 85%; /* å¢å¤§é«˜åº¦è®©ç…§ç‰‡åŒºåŸŸæ›´å¤§ */
  background: #fff;
  border-radius: 2px; /* Match preview's implied radius or small explicit one */
  padding: 5px 5px 16px 5px; /* å‡å°‘paddingè®©ç…§ç‰‡æ›´å¤§ */
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Stronger shadow, consistent with preview */
  box-sizing: border-box; /* æ”¹ä¸ºborder-boxé˜²æ­¢æº¢å‡º */
  display: flex;
  flex-direction: column;
  position: relative;
  cursor: pointer;
  z-index: 0;/* Keep it above stars as per current implementation, and preview's card default */
  transform: rotate(var(--polaroid-rot)) translateZ(0); /* Dynamic rotation, consistent variable */
  transition: transform 0.2s ease-in-out; /* Keep the transition */
}

.polaroid-card.p-1 { --polaroid-rot: -5deg; }
.polaroid-card.p-2 { --polaroid-rot: 5deg; }
.polaroid-card.p-3 { --polaroid-rot: -3deg; }

.polaroid-card:active {
  transform: rotate(var(--polaroid-rot)) scale(0.985) translateZ(0);
}

.polaroid-frame {
  width: 100%;
  height: 90px; /* Square image area, adjusted to fit */
  flex: 1; /* Keep flex property */
  overflow: hidden;
  background-color: #000; /* Dark background, explicitly background-color */
  position: relative;
}

.polaroid-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.polaroid-img.img-1 { object-position: 20% 20%; }
.polaroid-img.img-2 { object-position: 50% 50%; }
.polaroid-img.img-3 { object-position: 80% 80%; }

.polaroid-upload-hint {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0, 0, 0, 0.45);
  opacity: 0;
  transition: opacity 0.16s ease;
  color: rgba(255, 255, 255, 0.92);
}

.polaroid-upload-hint svg {
  width: 22px;
  height: 22px;
}

@media (hover: hover) {
  .polaroid-card:hover {
    box-shadow: 0 14px 28px rgba(0, 0, 0, 0.18);
  }
  .polaroid-card:hover .polaroid-upload-hint {
    opacity: 1;
  }
}

.polaroid-card.is-empty .polaroid-upload-hint {
  opacity: 1;
}

.polaroid-caption {
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.2px;
  text-align: center;
  color: rgba(0, 0, 0, 0.6);
  line-height: 1;
  height: 12px;
}

/* ========== End Polaroid Widget ========== */

/* ========================================
 * ğŸ’¿ Album Widget - å“åº”å¼å¸ƒå±€
 * å°å¥—å±…ä¸­ï¼Œå”±ç‰‡è´´å³è¾¹ç¼˜å¹¶å‘å³éœ²å‡ºä¸€åŠ
 * ======================================== */

.album-widget {
  width: 100%;
  height: 100%;
  position: relative;
  display: flex;
  justify-content: flex-start;
  align-items: center;
  overflow: visible;
  user-select: none;
  -webkit-user-select: none;
}

.album-widget-sleeve {
  position: relative;
  height: 100%;
  aspect-ratio: 1;
  z-index: 2;
  padding: 7.14%;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: flex-start;
  border-radius: 15px;
  overflow: hidden;
  box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
  border: 1px solid rgba(255, 255, 255, 0.4);
  backdrop-filter: blur(5px);
  -webkit-backdrop-filter: blur(5px);
}

.album-widget-sleeve-bg {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  z-index: -1;
  filter: blur(3px);
}

.album-widget-pause-icon {
  width: 11%;
  aspect-ratio: 1;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: relative;
  margin-bottom: 11%;
}

.album-widget-pause-icon::before,
.album-widget-pause-icon::after {
  content: '';
  width: 22%;
  height: 85%;
  background: white;
  border-radius: 2px;
}

.album-widget-lyrics {
  margin-top: auto;
  width: 100%;
  cursor: pointer;
}

.album-widget-lyrics p {
  color: white;
  font-size: clamp(16px, 10%, 28px);
  font-weight: 800;
  margin: 0;
  line-height: 1.1;
  text-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
  font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  text-align: left;
  padding-left: 2%;
}

.album-widget-lyrics p.last-line .faded-text {
  color: rgba(255, 255, 255, 0.5);
}

.album-widget-record {
  position: absolute;
  height: 89.3%;
  aspect-ratio: 1;
  background-color: #1a1a1a;
  border-radius: 50%;
  left: 40%;
  top: 50%;
  transform: translateY(-50%);
  z-index: 1;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
  background-image: radial-gradient(circle at 50% 50%, #333 0%, #333 1%, #1a1a1a 2%, #1a1a1a 3%, #333 4%, #333 5%, #1a1a1a 6%, #1a1a1a 7%, #333 8%, #333 9%, #1a1a1a 10%, #1a1a1a 11%, #333 12%, #333 13%, #1a1a1a 14%, #1a1a1a 15%, #333 16%, #333 17%, #1a1a1a 18%, #1a1a1a 19%, #333 20%, #333 21%, #1a1a1a 22%, #1a1a1a 23%, #333 24%, #333 25%, #1a1a1a 26%, #1a1a1a 27%, #333 28%, #333 29%, #1a1a1a 30%, #1a1a1a 31%, #333 32%, #333 33%, #1a1a1a 34%, #1a1a1a 35%, #333 36%, #333 37%, #1a1a1a 38%, #1a1a1a 39%, #333 40%, #333 41%, #1a1a1a 42%, #1a1a1a 43%, #333 44%, #333 45%, #1a1a1a 46%, #1a1a1a 47%, #333 48%, #333 49%, #1a1a1a 50%, transparent 51%);
}

.album-widget-record-label {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 32%;
  aspect-ratio: 1;
  border-radius: 50%;
  overflow: hidden;
  background: white;
  border: 2px solid #333;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2;
}

.album-widget-record-art {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transform: scale(2.2) translateY(-10%);
  filter: grayscale(100%) brightness(0.8) contrast(1.2);
}

/* æ­Œè¯ç¼–è¾‘å™¨ï¼ˆä»…ç”¨äºè¯¥ç»„ä»¶çš„ JS ç¼–è¾‘ï¼‰ */
.album-widget-lyrics-editor {
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  aspect-ratio: 1;
  z-index: 20;
  border-radius: 14px;
  background: rgba(15, 15, 15, 0.75);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.18);
  box-shadow: 0 10px 28px rgba(0, 0, 0, 0.35);
  padding: 10px;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.album-widget-lyrics-textarea {
  width: 100%;
  flex: 1;
  resize: none;
  border: none;
  outline: none;
  background: rgba(0, 0, 0, 0.28);
  color: rgba(255, 255, 255, 0.95);
  border-radius: 10px;
  padding: 10px 12px;
  font-size: 12px;
  line-height: 1.35;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', monospace;
}

.album-widget-lyrics-actions {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
}

.album-widget-lyrics-btn {
  border: 1px solid rgba(255, 255, 255, 0.18);
  background: rgba(255, 255, 255, 0.1);
  color: rgba(255, 255, 255, 0.9);
  padding: 8px 10px;
  border-radius: 10px;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
}

.album-widget-lyrics-btn.save {
  background: rgba(255, 255, 255, 0.92);
  color: rgba(0, 0, 0, 0.9);
}

/* ========== End Album Widget ========== */

/* ========================================
 * ğŸµ Sleeve Widget - 2x2 ç‹¬ç«‹å°å¥—ç»„ä»¶
 * ç›´æ¥å¤ç”¨ album-widget-sleeve æ ·å¼ï¼Œä¿è¯è´¨æ„Ÿä¸€è‡´
 * ======================================== */

.sleeve-widget-wrap {
  width: 100%;
  height: 100%;
}

.sleeve-widget-wrap .album-widget-sleeve {
  width: 100%;
  height: 100%;
  aspect-ratio: auto;
  border: none; /* å»æ‰borderï¼Œå¡«æ»¡176x176 */
  box-shadow: none; /* å»æ‰é˜´å½±é¿å…æº¢å‡º */
}

/* ========== End Sleeve Widget ========== */

/* ==========================================
 * ğŸ¨ Theme Editor V2 è¯¦æƒ…é¡µä¸»é¢˜ç¼–è¾‘å™¨
 * ========================================== */

/* ========== æ‚¬æµ®æŒ‰é’®ç»„ FAB ========== */
.theme-editor-fab {
  display: none;
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  flex-direction: column;
  gap: 8px;
  z-index: 9999;
  transition: opacity 0.25s ease, transform 0.25s cubic-bezier(0.4, 0, 0.2, 1);
}

.theme-editor-fab.active {
  display: flex;
}

/* é¢æ¿å±•å¼€æ—¶éšè—FABæŒ‰é’® */
.theme-editor-fab.panel-open {
  opacity: 0;
  pointer-events: none;
  transform: translateY(-50%) translateX(20px);
}

/* åŒå‡»é¡µé¢ï¼šéšè—/æ˜¾ç¤º FABï¼ˆé˜²é®æŒ¡ï¼‰ */
.theme-editor-fab.fab-hidden {
  opacity: 0;
  pointer-events: none;
  transform: translateY(-50%) translateX(20px);
}

/* FAB æŒ‰é’®åŸºç¡€æ ·å¼ */
.theme-fab-btn {
  width: 44px;
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 14px;
  cursor: pointer;
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  border: 1px solid var(--border-color);
  background: var(--bg-primary);
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.12);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}

.theme-fab-btn svg {
  width: 20px;
  height: 20px;
  stroke: var(--text-secondary);
  fill: none;
  stroke-width: 1.8;
}

.theme-fab-btn:active {
  transform: scale(0.92);
}

/* é¢æ¿æŒ‰é’® */
.theme-fab-btn.panel {
  background: var(--bg-secondary);
}

.theme-fab-btn.panel.expanded {
  background: var(--text-primary);
  border-color: var(--text-primary);
}

.theme-fab-btn.panel.expanded svg {
  stroke: var(--bg-primary);
}

/* å–æ¶ˆæŒ‰é’® */
.theme-fab-btn.cancel:hover {
  background: rgba(255, 59, 48, 0.1);
  border-color: rgba(255, 59, 48, 0.3);
}

.theme-fab-btn.cancel:hover svg {
  stroke: #ff3b30;
}

/* ä¿å­˜æŒ‰é’® */
.theme-fab-btn.save {
  background: var(--text-primary);
  border-color: var(--text-primary);
}

.theme-fab-btn.save svg {
  stroke: var(--bg-primary);
}

.theme-fab-btn.save:hover {
  opacity: 0.9;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
}

/* ========== é¢æ¿èƒŒæ™¯é®ç½© ========== */
.theme-editor-backdrop {
  display: none;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.3);
  z-index: 9997;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.theme-editor-backdrop.active {
  display: block;
  opacity: 1;
}

/* ========== åº•éƒ¨ç¼–è¾‘é¢æ¿å®¹å™¨ ========== */
.theme-editor-panel-container {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 9998;
  transform: translateY(100%);
  transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
  pointer-events: none;
}

.theme-editor-panel-container.expanded {
  transform: translateY(0);
  pointer-events: auto;
}

/* åº•éƒ¨ç¼–è¾‘é¢æ¿ */
.theme-editor-panel {
  display: flex;
  flex-direction: column;
  background: var(--bg-primary);
  border-radius: 24px 24px 0 0;
  overflow: hidden;
  box-shadow: 0 -4px 30px rgba(0, 0, 0, 0.15);
  max-height: 65vh;
}

/* é¢æ¿æ‹–æ‹½æ‰‹æŸ„ */
.theme-editor-panel::before {
  content: '';
  display: block;
  width: 36px;
  height: 4px;
  background: var(--text-tertiary);
  border-radius: 2px;
  margin: 10px auto 4px;
  opacity: 0.5;
}

/* æ ‡ç­¾é¡µ - èƒ¶å›ŠæŒ‰é’®æ ·å¼ */
.theme-editor-tabs {
  display: flex;
  padding: 8px 14px 12px;
  gap: 6px;
  flex-shrink: 0;
  border-bottom: 1px solid var(--border-color);
}

.theme-editor-tab {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 5px;
  padding: 8px 10px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 500;
  color: var(--text-tertiary);
  cursor: pointer;
  transition: all 0.2s ease;
  border: 1px solid transparent;
  background: transparent;
}

.theme-editor-tab svg {
  width: 14px;
  height: 14px;
  stroke: currentColor;
  fill: none;
  stroke-width: 1.5;
}

.theme-editor-tab svg rect {
  fill: currentColor;
  stroke: none;
}

.theme-editor-tab:hover {
  color: var(--text-secondary);
  background: var(--bg-secondary);
}

.theme-editor-tab.active {
  color: var(--text-primary);
  background: var(--bg-secondary);
  border-color: var(--border-color);
  font-weight: 600;
}

/* ç¼–è¾‘å†…å®¹åŒº */
.theme-editor-content {
  flex: 1;
  overflow-y: auto;
  padding: 14px 16px 20px;
  display: flex;
  flex-direction: column;
  gap: 14px;
}

.theme-editor-content::-webkit-scrollbar {
  width: 3px;
}

.theme-editor-content::-webkit-scrollbar-track {
  background: transparent;
}

.theme-editor-content::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 2px;
}

/* ä¸»é¢˜å¼€å…³è¡Œ */
.theme-editor-toggle-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 14px;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 12px;
}

.theme-editor-toggle-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.theme-editor-toggle-label {
  font-size: 13px;
  font-weight: 600;
  color: var(--text-primary);
}

.theme-editor-toggle-hint {
  font-size: 10px;
  color: var(--text-tertiary);
}

/* ç¼–è¾‘åŒºå— */
.theme-editor-section {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.theme-editor-section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

/* åˆ†ç±»æ ‡é¢˜ - èƒ¶å›Šæ ‡ç­¾æ ·å¼ */
.theme-editor-section-header > span {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  font-size: 10px;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.6px;
  padding: 4px 10px;
  background: var(--bg-secondary);
  border-radius: 16px;
  border: 1px solid var(--border-color);
}

.theme-editor-section-header > span::before {
  content: 'â—†';
  font-size: 5px;
  opacity: 0.5;
}

.theme-editor-section-actions {
  display: flex;
  gap: 6px;
}

.theme-editor-action-btn {
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 8px;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  cursor: pointer;
  transition: all 0.2s ease;
}

.theme-editor-action-btn svg {
  width: 14px;
  height: 14px;
  stroke: var(--text-secondary);
  fill: none;
  stroke-width: 2;
}

.theme-editor-action-btn:hover {
  background: var(--text-primary);
}

.theme-editor-action-btn:hover svg {
  stroke: var(--bg-primary);
}

/* é¢„è®¾ä¸»é¢˜åˆ—è¡¨ */
.theme-editor-preset-list {
  display: flex;
  flex-direction: column;
  gap: 6px;
  max-height: 110px;
  overflow-y: auto;
  padding: 2px;
}

.theme-editor-preset-item {
  position: relative;
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 12px;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
}

.theme-editor-preset-item::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 3px;
  background: var(--text-tertiary);
  opacity: 0;
  transition: opacity 0.2s ease;
}

.theme-editor-preset-item:hover {
  background: var(--bg-tertiary);
  border-color: var(--text-tertiary);
  transform: translateX(3px);
}

.theme-editor-preset-item:hover::before {
  opacity: 1;
}

.theme-editor-preset-item.active {
  border-color: var(--text-primary);
}

.theme-editor-preset-item.active::before {
  background: var(--text-primary);
  opacity: 1;
}

/* é¢„è®¾åˆ†ç»„æ ‡ç­¾ */
.theme-editor-preset-section-label {
  font-size: 10px;
  font-weight: 600;
  color: var(--text-tertiary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  padding: 4px 2px;
  margin-bottom: 4px;
}

.theme-editor-preset-item-icon {
  width: 32px;
  height: 32px;
  border-radius: 8px;
  background: var(--bg-primary);
  border: 1px solid var(--border-color);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.theme-editor-preset-item-icon svg {
  width: 16px;
  height: 16px;
  stroke: var(--text-primary);
  fill: none;
  stroke-width: 1.5;
}

.theme-editor-preset-item-info {
  flex: 1;
  min-width: 0;
}

.theme-editor-preset-item-name {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-primary);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  letter-spacing: -0.2px;
}

.theme-editor-preset-item-author {
  font-size: 10px;
  color: var(--text-tertiary);
}

.theme-editor-preset-item-actions {
  display: flex;
  gap: 4px;
}

.theme-editor-preset-item-btn {
  width: 26px;
  height: 26px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 6px;
  background: transparent;
  border: none;
  cursor: pointer;
  transition: all 0.2s ease;
}

.theme-editor-preset-item-btn svg {
  width: 13px;
  height: 13px;
  stroke: var(--text-tertiary);
  fill: none;
  stroke-width: 2;
}

.theme-editor-preset-item-btn:hover {
  background: var(--bg-primary);
}

.theme-editor-preset-item-btn:hover svg {
  stroke: var(--text-primary);
}

.theme-editor-preset-item-btn.delete:hover svg {
  stroke: #ff3b30;
}

/* ç©ºçŠ¶æ€ */
.theme-editor-preset-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 20px;
  background: var(--bg-secondary);
  border: 1px dashed var(--border-color);
  border-radius: 12px;
  text-align: center;
}

.theme-editor-preset-empty svg {
  width: 28px;
  height: 28px;
  stroke: var(--text-tertiary);
  fill: none;
  stroke-width: 1.5;
  margin-bottom: 6px;
  opacity: 0.6;
}

.theme-editor-preset-empty > span {
  font-size: 12px;
  color: var(--text-secondary);
}

.theme-editor-preset-empty-hint {
  font-size: 10px;
  color: var(--text-tertiary);
  margin-top: 3px;
}

/* CSSç¼–è¾‘åŒº */
.theme-editor-css-hint {
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 6px 10px;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  font-size: 10px;
  color: var(--text-tertiary);
}

.theme-editor-css-hint svg {
  width: 12px;
  height: 12px;
  stroke: currentColor;
  fill: none;
  stroke-width: 2;
  flex-shrink: 0;
  opacity: 0.7;
}

.theme-editor-css-textarea {
  width: 100%;
  min-height: 130px;
  padding: 12px;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 10px;
  font-family: 'JetBrains Mono', 'SF Mono', 'Monaco', monospace;
  font-size: 11px;
  line-height: 1.5;
  color: var(--text-primary);
  resize: vertical;
  outline: none;
  transition: border-color 0.2s ease;
}

.theme-editor-css-textarea:focus {
  border-color: var(--text-secondary);
}

.theme-editor-css-textarea::placeholder {
  color: var(--text-tertiary);
  opacity: 0.7;
}

/* ========== ç¼–è¾‘æ¨¡å¼ V2 ========== */

/* ç¼–è¾‘æ¨¡å¼ä¸‹ï¼šå†…å®¹æ­£å¸¸æ˜¾ç¤ºï¼Œå…è®¸äº¤äº’ */
#chatDetailScreen.theme-editing-mode {
  /* ä¸å†éšè—å†…å®¹ï¼Œä¿æŒæ­£å¸¸çŠ¶æ€ */
}

/* ç¼–è¾‘æ¨¡å¼ä¸‹çš„è§†è§‰æç¤ºè¾¹æ¡† */
#chatDetailScreen.theme-editing-mode::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border: 2px solid var(--text-primary);
  border-radius: inherit;
  pointer-events: none;
  z-index: 9996;
  opacity: 0.3;
}

/* ç¼–è¾‘æ¨¡å¼ä¸‹çš„é¡¶éƒ¨æç¤ºæ¡ */
.theme-editing-indicator {
  display: none;
  position: absolute;
  top: calc(var(--app-header-total-padding) + 52px);
  left: 50%;
  transform: translateX(-50%);
  padding: 6px 14px;
  background: var(--text-primary);
  color: var(--bg-primary);
  font-size: 11px;
  font-weight: 600;
  border-radius: 20px;
  z-index: 9996;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
  white-space: nowrap;
}

#chatDetailScreen.theme-editing-mode .theme-editing-indicator {
  display: block;
}

/* ========== End Theme Editor V2 ========== */

